const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ServiceProvidersMap-CoSrXA27.js","assets/vendor-Cz2k0cIx.js","assets/vendor-Dgihpmma.css","assets/BatchTrackingPage-QNf5taf-.js"])))=>i.map(i=>d[i]);
var sl=Object.defineProperty;var tl=(s,t,a)=>t in s?sl(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a;var Fe=(s,t,a)=>tl(s,typeof t!="symbol"?t+"":t,a);import{r as i,j as e,t as al,c as rl,a as jt,S as Xr,b as il,z as ve,u as Te,R as Zr,I as ei,F as si,d as ti,C as ft,e as ai,P as nl,f as ri,g as ii,h as ni,i as li,k as Qe,l as ci,m as oi,L as di,n as mi,o as ll,T as cl,p as Fa,M as ol,q as ui,s as xi,v as hi,w as Lt,x as pi,V as gi,y as ji,A as dl,B as ml,D as Es,E as Ge,G as X,H as ye,U as se,J as ce,K as Ue,N as Se,O as Ua,Q as ee,W as ta,X as aa,Y as fi,Z as Be,_ as ra,$ as ia,a0 as Va,a1 as vi,a2 as yi,a3 as Ne,a4 as Pe,a5 as re,a6 as as,a7 as rs,a8 as Ye,a9 as xe,aa as vs,ab as At,ac as $a,ad as Tt,ae as Re,af as Mt,ag as ul,ah as xl,ai as Zt,aj as hl,ak as Ee,al as ys,am as Ve,an as pl,ao as gl,ap as jl,aq as fl,ar as He,as as ks,at as Xs,au as na,av as Ae,aw as Ni,ax as bi,ay as wi,az as vl,aA as _i,aB as ie,aC as Ss,aD as Dt,aE as xs,aF as Ci,aG as is,aH as dt,aI as ea,aJ as yl,aK as Ps,aL as Nl,aM as ki,aN as bl,aO as wl,aP as _l,aQ as Ga,aR as It,aS as As,aT as vt,aU as la,aV as ca,aW as Ts,aX as Cl,aY as Si,aZ as Zs,a_ as Pi,a$ as We,b0 as qa,b1 as Ai,b2 as Ti,b3 as kl,b4 as ns,b5 as Fs,b6 as Le,b7 as Ha,b8 as fe,b9 as hs,ba as es,bb as Di,bc as Sl,bd as Ei,be as Fi,bf as qi,bg as Pl,bh as Li,bi as Al,bj as Mi,bk as Ii,bl as Tl,bm as Dl,bn as Ri,bo as El,bp as Fl,bq as Bs,br as zi,bs as ql,bt as Ll,bu as mt,bv as Js,bw as Ml,bx as Oi,by as Il,bz as Rl,bA as zl,bB as Wa,bC as gr,bD as Ki,bE as Ol,bF as Kl,bG as Bi,bH as Bl,bI as Ul,bJ as tt,bK as qs,bL as jr,bM as sa,bN as Ds,bO as Vl,bP as $l,bQ as Gl,bR as Ui,bS as Hl,bT as Wl,bU as Yl,bV as Je,bW as yt,bX as Ns,bY as bs,bZ as ws,b_ as Xe,b$ as et,c0 as us,c1 as oa,c2 as da,c3 as Rt,c4 as ma,c5 as Cs,c6 as pt,c7 as Vi,c8 as Et,c9 as $i,ca as Ql,cb as Jl,cc as Xl,cd as Zl,ce as Ya,cf as ec,cg as sc,ch as Gi,ci as tc,cj as fr,ck as Hi,cl as ac,cm as rc,cn as Wi,co as Yi,cp as Qi,cq as Ji,cr as Xi,cs as Zi,ct as ic,cu as nc,cv as lc,cw as cc,cx as Qs,cy as at,cz as oc,cA as dc,cB as mc,cC as uc,cD as en,cE as xc,cF as sn,cG as hc,cH as pc,cI as gc,cJ as tn,cK as jc,cL as fc,cM as gt,cN as ga,cO as vc,cP as wt,cQ as yc,cR as ja,cS as fa,cT as Nc,cU as bc,cV as wc,cW as vr,cX as Bt,cY as _c,cZ as lt,c_ as ot,c$ as Cc,d0 as Ft,d1 as st,d2 as kc,d3 as Sc,d4 as va,d5 as Pc,d6 as yr,d7 as Ac,d8 as Tc,d9 as Nr,da as br,db as Dc,dc as Ec,dd as _t,de as Fc,df as qc,dg as an,dh as rn,di as Lc,dj as Qa,dk as Mc,dl as Ic,dm as Rc,dn as nn,dp as ln,dq as zc,dr as La,ds as Oc,dt as Kc,du as Bc,dv as Uc,dw as Hs,dx as Vc,dy as $c,dz as Gc,dA as Hc,dB as Wc,dC as Yc,dD as wr,dE as Qc,dF as Jc,dG as Xc,dH as _r,dI as Zc,dJ as Cr,dK as eo,dL as cn,dM as kr,dN as on,dO as so,dP as to,dQ as ao,dR as ro,dS as io,dT as no,dU as H,dV as lo,dW as co}from"./vendor-Cz2k0cIx.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const l of c.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function a(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(n){if(n.ep)return;n.ep=!0;const c=a(n);fetch(n.href,c)}})();const oo={theme:"system",setTheme:()=>null},dn=i.createContext(oo);function mo({children:s,defaultTheme:t="system",storageKey:a="sokoconnect-ui-theme",...r}){const[n,c]=i.useState(()=>typeof window<"u"&&localStorage.getItem(a)||t);i.useEffect(()=>{const x=window.document.documentElement;if(x.classList.remove("light","dark"),n==="system"){const f=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";x.classList.add(f);return}x.classList.add(n)},[n]);const l={theme:n,setTheme:x=>{typeof window<"u"&&localStorage.setItem(a,x),c(x)}};return e.jsx(dn.Provider,{...r,value:l,children:s})}const uo=()=>{const s=i.useContext(dn);if(s===void 0)throw new Error("useTheme must be used within a ThemeProvider");return s};function $(...s){return al(rl(s))}const qt=jt("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),b=i.forwardRef(({className:s,variant:t,size:a,asChild:r=!1,...n},c)=>{const l=r?Xr:"button";return e.jsx(l,{className:$(qt({variant:t,size:a,className:s})),ref:c,...n})});b.displayName="Button";const w=i.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:$("rounded-lg border bg-card text-card-foreground shadow-sm",s),...t}));w.displayName="Card";const q=i.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:$("flex flex-col space-y-1.5 p-6",s),...t}));q.displayName="CardHeader";const L=i.forwardRef(({className:s,...t},a)=>e.jsx("h3",{ref:a,className:$("text-2xl font-semibold leading-none tracking-tight",s),...t}));L.displayName="CardTitle";const G=i.forwardRef(({className:s,...t},a)=>e.jsx("p",{ref:a,className:$("text-sm text-muted-foreground",s),...t}));G.displayName="CardDescription";const _=i.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:$("p-6 pt-0",s),...t}));_.displayName="CardContent";const me=i.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:$("flex items-center p-6 pt-0",s),...t}));me.displayName="CardFooter";const xo="https://xgtmpfginlxrntixpqim.supabase.co",ho="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhndG1wZmdpbmx4cm50aXhwcWltIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ0NzYzNDMsImV4cCI6MjA3MDA1MjM0M30.UityH607C-tazH7bvhS5G5CJaO2u7OhjIkoFQ6kPF10",F=il(xo,ho),po=Object.freeze(Object.defineProperty({__proto__:null,supabase:F},Symbol.toStringTag,{value:"Module"})),Ut=5,go=15,jo=5;class Sr{static async checkRateLimit(t){try{const a=new Date(Date.now()-jo*60*1e3),{data:r}=await F.from("auth_rate_limits").select("*").eq("user_identifier",t).gte("last_attempt",a.toISOString()).single();if(!r)return{allowed:!0,attemptsRemaining:Ut-1};if(r.blocked_until&&new Date(r.blocked_until)>new Date)return{allowed:!1,attemptsRemaining:0,blockedUntil:new Date(r.blocked_until)};if(r.attempt_count>=Ut){const n=new Date(Date.now()+go*60*1e3);return await F.from("auth_rate_limits").update({blocked_until:n.toISOString(),last_attempt:new Date().toISOString()}).eq("id",r.id),{allowed:!1,attemptsRemaining:0,blockedUntil:n}}return{allowed:!0,attemptsRemaining:Ut-r.attempt_count-1}}catch(a){return console.error("Rate limit check failed:",a),{allowed:!0,attemptsRemaining:Ut}}}static async recordAttempt(t,a){try{if(a){await F.from("auth_rate_limits").delete().eq("user_identifier",t);return}const{data:r}=await F.from("auth_rate_limits").select("*").eq("user_identifier",t).single();r?await F.from("auth_rate_limits").update({attempt_count:r.attempt_count+1,last_attempt:new Date().toISOString()}).eq("id",r.id):await F.from("auth_rate_limits").insert({user_identifier:t,attempt_count:1,last_attempt:new Date().toISOString()})}catch(r){console.error("Failed to record auth attempt:",r)}}}class ya{static async logEvent(t,a,r){try{await F.from("security_audit_log").insert({user_id:r||null,event_type:t,event_details:a,ip_address:a.ipAddress||null,user_agent:a.userAgent||navigator.userAgent})}catch(n){console.error("Failed to log security event:",n)}}static async getUserSecurityLog(t){try{const{data:a,error:r}=await F.from("security_audit_log").select("*").eq("user_id",t).order("created_at",{ascending:!1}).limit(50);if(r)throw r;return a}catch(a){return console.error("Failed to fetch security log:",a),[]}}}const fo=ve.string().regex(/^(\+254|0)(7|1)\d{8}$/,"Invalid Kenyan phone number format"),vo=ve.string().email("Invalid email format"),yo=ve.string().min(8,"Password must be at least 8 characters").regex(/[A-Z]/,"Password must contain at least one uppercase letter").regex(/[a-z]/,"Password must contain at least one lowercase letter").regex(/\d/,"Password must contain at least one number").regex(/[^A-Za-z0-9]/,"Password must contain at least one special character"),No=s=>s.trim().replace(/[<>]/g,"").replace(/javascript:/gi,"").replace(/on\w+=/gi,"").substring(0,1e3),bo=s=>s.replace(/['"`;\\]/g,"").replace(/\b(SELECT|INSERT|UPDATE|DELETE|DROP|UNION|EXEC)\b/gi,"").trim().substring(0,100);ve.coerce.number().min(0);ve.string().min(2,"Location must be at least 2 characters").max(100,"Location must be less than 100 characters").regex(/^[a-zA-Z\s,.-]+$/,"Location contains invalid characters");class wo{static validatePhone(t){try{return fo.parse(t),{valid:!0}}catch{return{valid:!1,error:"Invalid phone number format"}}}static validateEmail(t){try{return vo.parse(t),{valid:!0}}catch{return{valid:!1,error:"Invalid email format"}}}static validatePassword(t){try{return yo.parse(t),{valid:!0}}catch{return{valid:!1,error:"Password must be at least 8 characters with uppercase, lowercase, number, and special character"}}}static sanitizeUserInput(t){return No(t)}static sanitizeSearch(t){return bo(t)}}const mn=i.createContext(null),je=()=>{const s=i.useContext(mn);if(!s)throw new Error("useAuth must be used within an AuthProvider");return s},_o=({children:s})=>{const[t,a]=i.useState(null),[r,n]=i.useState(null),[c,l]=i.useState(!0);i.useEffect(()=>{const{data:{subscription:g}}=F.auth.onAuthStateChange((u,d)=>{n(d),a((d==null?void 0:d.user)??null),l(!1)});return F.auth.getSession().then(({data:{session:u}})=>{n(u),a((u==null?void 0:u.user)??null),l(!1)}),()=>g.unsubscribe()},[]);const x=async(g,u,d)=>{try{const h=`${window.location.origin}/`,{error:v}=await F.auth.signUp({email:g,password:u,options:{emailRedirectTo:h,data:{full_name:d}}});return v?(Te.error(v.message),{error:v.message}):(Te.success("Check your email for verification link"),{})}catch(h){const v=h.message;return Te.error(v),{error:v}}},f=async(g,u)=>{try{const d=wo.validateEmail(g);if(!d.valid)return Te.error(d.error),{error:d.error};const h=await Sr.checkRateLimit(g);if(!h.allowed){const p=h.blockedUntil?`Too many failed attempts. Try again after ${h.blockedUntil.toLocaleTimeString()}`:"Too many failed attempts. Please try again later.";return Te.error(p),{error:p}}const{error:v}=await F.auth.signInWithPassword({email:g,password:u});return await Sr.recordAttempt(g,!v),v?(await ya.logEvent("failed_login",{attemptedEmail:g,error:v.message}),Te.error(v.message),{error:v.message}):(await ya.logEvent("successful_login",{email:g}),Te.success("Welcome back!"),{})}catch(d){const h=d.message;return await ya.logEvent("failed_login",{attemptedEmail:g,error:h}),Te.error(h),{error:h}}},j=async()=>{try{await F.auth.signOut(),Te.success("Signed out successfully")}catch{Te.error("Error signing out")}},N=async g=>{try{if(!t)throw new Error("Not authenticated");const{error:u}=await F.from("profiles").update(g).eq("user_id",t.id);return u?(Te.error(u.message),{error:u.message}):(Te.success("Profile updated successfully"),{})}catch(u){const d=u.message;return Te.error(d),{error:d}}};return e.jsx(mn.Provider,{value:{user:t,session:r,loading:c,signUp:x,signIn:f,signOut:j,updateProfile:N},children:s})},Us=i.forwardRef(({className:s,...t},a)=>e.jsx(Zr,{ref:a,className:$("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...t}));Us.displayName=Zr.displayName;const rt=i.forwardRef(({className:s,...t},a)=>e.jsx(ei,{ref:a,className:$("aspect-square h-full w-full",s),...t}));rt.displayName=ei.displayName;const Vs=i.forwardRef(({className:s,...t},a)=>e.jsx(si,{ref:a,className:$("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...t}));Vs.displayName=si.displayName;const Ja=ll,Xa=cl,Co=i.forwardRef(({className:s,inset:t,children:a,...r},n)=>e.jsxs(ti,{ref:n,className:$("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",s),...r,children:[a,e.jsx(ft,{className:"ml-auto h-4 w-4"})]}));Co.displayName=ti.displayName;const ko=i.forwardRef(({className:s,...t},a)=>e.jsx(ai,{ref:a,className:$("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...t}));ko.displayName=ai.displayName;const ua=i.forwardRef(({className:s,sideOffset:t=4,...a},r)=>e.jsx(nl,{children:e.jsx(ri,{ref:r,sideOffset:t,className:$("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a})}));ua.displayName=ri.displayName;const fs=i.forwardRef(({className:s,inset:t,...a},r)=>e.jsx(ii,{ref:r,className:$("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",s),...a}));fs.displayName=ii.displayName;const So=i.forwardRef(({className:s,children:t,checked:a,...r},n)=>e.jsxs(ni,{ref:n,className:$("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:a,...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(li,{children:e.jsx(Qe,{className:"h-4 w-4"})})}),t]}));So.displayName=ni.displayName;const Po=i.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(ci,{ref:r,className:$("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(li,{children:e.jsx(oi,{className:"h-2 w-2 fill-current"})})}),t]}));Po.displayName=ci.displayName;const un=i.forwardRef(({className:s,inset:t,...a},r)=>e.jsx(di,{ref:r,className:$("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",s),...a}));un.displayName=di.displayName;const Ma=i.forwardRef(({className:s,...t},a)=>e.jsx(mi,{ref:a,className:$("-mx-1 my-1 h-px bg-muted",s),...t}));Ma.displayName=mi.displayName;function Ao(){const{theme:s,setTheme:t}=uo();return e.jsxs(Ja,{children:[e.jsx(Xa,{asChild:!0,children:e.jsxs(b,{variant:"ghost",size:"icon",children:[e.jsx(Fa,{className:"h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),e.jsx(ol,{className:"absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),e.jsx("span",{className:"sr-only",children:"Toggle theme"})]})}),e.jsxs(ua,{align:"end",children:[e.jsx(fs,{onClick:()=>t("light"),children:"Light"}),e.jsx(fs,{onClick:()=>t("dark"),children:"Dark"}),e.jsx(fs,{onClick:()=>t("system"),children:"System"})]})]})}const xn=i.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(ui,{ref:r,className:$("relative z-10 flex max-w-max flex-1 items-center justify-center",s),...a,children:[t,e.jsx(pn,{})]}));xn.displayName=ui.displayName;const hn=i.forwardRef(({className:s,...t},a)=>e.jsx(xi,{ref:a,className:$("group flex flex-1 list-none items-center justify-center space-x-1",s),...t}));hn.displayName=xi.displayName;const Ws=dl,To=jt("group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50"),Ia=i.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(hi,{ref:r,className:$(To(),"group",s),...a,children:[t," ",e.jsx(Lt,{className:"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180","aria-hidden":"true"})]}));Ia.displayName=hi.displayName;const Ra=i.forwardRef(({className:s,...t},a)=>e.jsx(pi,{ref:a,className:$("left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto ",s),...t}));Ra.displayName=pi.displayName;const Ys=ml,pn=i.forwardRef(({className:s,...t},a)=>e.jsx("div",{className:$("absolute left-0 top-full flex justify-center"),children:e.jsx(gi,{className:$("origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]",s),ref:a,...t})}));pn.displayName=gi.displayName;const Do=i.forwardRef(({className:s,...t},a)=>e.jsx(ji,{ref:a,className:$("top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in",s),...t,children:e.jsx("div",{className:"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md"})}));Do.displayName=ji.displayName;const Eo=()=>{const s=Es(),t=[{href:"/farm-input-marketplace",title:"Farm Input Marketplace",description:"Quality agricultural inputs from verified suppliers",icon:e.jsx(Ge,{className:"h-4 w-4"})},{href:"/marketplace",title:"Agricultural Marketplace",description:"Buy and sell produce, livestock, and agricultural products",icon:e.jsx(Ge,{className:"h-4 w-4"})},{href:"/bulk-orders",title:"Bulk Orders",description:"Organize group purchases for better prices",icon:e.jsx(Ge,{className:"h-4 w-4"})},{href:"/city-markets",title:"City Markets",description:"Connect with local city and county markets",icon:e.jsx(ee,{className:"h-4 w-4"})}],a=[{href:"/logistics",title:"Logistics Optimization",description:"Smart routing and delivery solutions",icon:e.jsx(ye,{className:"h-4 w-4"})},{href:"/logistics-solutions-map",title:"Solutions Map",description:"Interactive map of logistics solutions",icon:e.jsx(ye,{className:"h-4 w-4"})},{href:"/transporter-signup",title:"Join as Transporter",description:"Register your transport services",icon:e.jsx(ye,{className:"h-4 w-4"})}],r=n=>s.pathname===n;return e.jsx(xn,{className:"hidden md:flex",children:e.jsxs(hn,{children:[e.jsxs(Ws,{children:[e.jsxs(Ia,{className:$("bg-transparent",t.some(n=>r(n.href))&&"text-primary"),children:[e.jsx(Ge,{className:"h-4 w-4 mr-2"}),"Marketplace"]}),e.jsx(Ra,{children:e.jsx("ul",{className:"grid w-[600px] gap-3 p-4 md:grid-cols-2",children:t.map(n=>e.jsx("li",{children:e.jsx(Ys,{asChild:!0,children:e.jsxs(X,{to:n.href,className:$("block select-none space-y-1 rounded-md p-3 leading-none no-underline outline-none transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground",r(n.href)&&"bg-accent text-accent-foreground"),children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium leading-none",children:[n.icon,n.title]}),e.jsx("p",{className:"line-clamp-2 text-sm leading-snug text-muted-foreground",children:n.description})]})})},n.href))})})]}),e.jsxs(Ws,{children:[e.jsxs(Ia,{className:$("bg-transparent",a.some(n=>r(n.href))&&"text-primary"),children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Logistics"]}),e.jsx(Ra,{children:e.jsx("ul",{className:"grid w-[600px] gap-3 p-4 md:grid-cols-2",children:a.map(n=>e.jsx("li",{children:e.jsx(Ys,{asChild:!0,children:e.jsxs(X,{to:n.href,className:$("block select-none space-y-1 rounded-md p-3 leading-none no-underline outline-none transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground",r(n.href)&&"bg-accent text-accent-foreground"),children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium leading-none",children:[n.icon,n.title]}),e.jsx("p",{className:"line-clamp-2 text-sm leading-snug text-muted-foreground",children:n.description})]})})},n.href))})})]}),e.jsx(Ws,{children:e.jsx(Ys,{asChild:!0,children:e.jsxs(X,{to:"/service-providers",className:$("group inline-flex h-10 w-max items-center justify-center rounded-md bg-transparent px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50",r("/service-providers")&&"text-primary"),children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Service Providers"]})})}),e.jsx(Ws,{children:e.jsx(Ys,{asChild:!0,children:e.jsxs(X,{to:"/sentiment-analysis",className:$("group inline-flex h-10 w-max items-center justify-center rounded-md bg-transparent px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50",r("/sentiment-analysis")&&"text-primary"),children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Market Insights"]})})}),e.jsx(Ws,{children:e.jsx(Ys,{asChild:!0,children:e.jsxs(X,{to:"/community-forums",className:$("group inline-flex h-10 w-max items-center justify-center rounded-md bg-transparent px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50",r("/community-forums")&&"text-primary"),children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Community"]})})}),e.jsx(Ws,{children:e.jsx(Ys,{asChild:!0,children:e.jsxs(X,{to:"/supply-chain-problems",className:$("group inline-flex h-10 w-max items-center justify-center rounded-md bg-transparent px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50",r("/supply-chain-problems")&&"text-primary"),children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"Supply Chain"]})})}),e.jsx(Ws,{children:e.jsx(Ys,{asChild:!0,children:e.jsxs(X,{to:"/about",className:$("group inline-flex h-10 w-max items-center justify-center rounded-md bg-transparent px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50",r("/about")&&"text-primary"),children:[e.jsx(Ua,{className:"h-4 w-4 mr-2"}),"About"]})})})]})})},Fo="/assets/logo-BOfeWaED.png",D=i.forwardRef(({className:s,type:t,...a},r)=>e.jsx("input",{type:t,className:$("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:r,...a}));D.displayName="Input";const qo=jt("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function I({className:s,variant:t,...a}){return e.jsx("div",{className:$(qo({variant:t}),s),...a})}const _e=vi,Ie=yi,Lo=Va,gn=i.forwardRef(({className:s,...t},a)=>e.jsx(ta,{ref:a,className:$("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t}));gn.displayName=ta.displayName;const we=i.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(Lo,{children:[e.jsx(gn,{}),e.jsxs(aa,{ref:r,className:$("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...a,children:[t,e.jsxs(fi,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));we.displayName=aa.displayName;const Ce=({className:s,...t})=>e.jsx("div",{className:$("flex flex-col space-y-1.5 text-center sm:text-left",s),...t});Ce.displayName="DialogHeader";const Ze=({className:s,...t})=>e.jsx("div",{className:$("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t});Ze.displayName="DialogFooter";const ke=i.forwardRef(({className:s,...t},a)=>e.jsx(ra,{ref:a,className:$("text-lg font-semibold leading-none tracking-tight",s),...t}));ke.displayName=ra.displayName;const it=i.forwardRef(({className:s,...t},a)=>e.jsx(ia,{ref:a,className:$("text-sm text-muted-foreground",s),...t}));it.displayName=ia.displayName;const Pr=[{id:"commodity",title:"Commodity Trading",description:"Buy and sell agricultural commodities",type:"marketplace",route:"/commodity-trading",icon:e.jsx(re,{className:"h-5 w-5"}),tags:["trading","crops","grains"]},{id:"equipment",title:"Equipment Marketplace",description:"Farm equipment for sale and rent",type:"marketplace",route:"/equipment-marketplace",icon:e.jsx(ye,{className:"h-5 w-5"}),tags:["tractors","machinery","tools"]},{id:"farm-inputs",title:"Farm Inputs",description:"Seeds, fertilizers, and farming supplies",type:"marketplace",route:"/farm-inputs-marketplace",icon:e.jsx(as,{className:"h-5 w-5"}),tags:["seeds","fertilizer","pesticides"]},{id:"bulk-orders",title:"Bulk Orders",description:"Group purchasing for better prices",type:"marketplace",route:"/bulk-orders",icon:e.jsx(rs,{className:"h-5 w-5"}),tags:["wholesale","group buying"]},{id:"barter",title:"Barter Exchange",description:"Exchange products without cash",type:"marketplace",route:"/barter-exchange",icon:e.jsx(re,{className:"h-5 w-5"}),tags:["exchange","trade"]},{id:"export",title:"Export Market",description:"International export opportunities",type:"marketplace",route:"/export-market",icon:e.jsx(Ye,{className:"h-5 w-5"}),tags:["international","export"]},{id:"logistics",title:"Logistics Solutions",description:"Transport and delivery services",type:"service",route:"/logistics",icon:e.jsx(ye,{className:"h-5 w-5"}),tags:["transport","delivery","shipping"]},{id:"service-providers",title:"Service Providers",description:"Agricultural service providers directory",type:"service",route:"/service-providers",icon:e.jsx(se,{className:"h-5 w-5"}),tags:["services","contractors"]},{id:"warehouses",title:"Warehouse Locator",description:"Find storage facilities",type:"service",route:"/warehouse-locator",icon:e.jsx(Ye,{className:"h-5 w-5"}),tags:["storage","cold storage"]},{id:"forum",title:"Community Forum",description:"Discuss with fellow farmers",type:"community",route:"/community-forum",icon:e.jsx(Ue,{className:"h-5 w-5"}),tags:["discussions","questions"]},{id:"cooperatives",title:"Cooperatives Management",description:"Manage farmer cooperatives",type:"community",route:"/cooperatives-management",icon:e.jsx(se,{className:"h-5 w-5"}),tags:["groups","sacco"]},{id:"success-stories",title:"Success Stories",description:"Farmer success stories",type:"community",route:"/farmer-success-stories",icon:e.jsx(se,{className:"h-5 w-5"}),tags:["stories","testimonials"]},{id:"training",title:"Training Events",description:"Agricultural training and workshops",type:"event",route:"/training-events",icon:e.jsx(xe,{className:"h-5 w-5"}),tags:["workshops","learning"]},{id:"ag-events",title:"Agricultural Events",description:"Upcoming agricultural events",type:"event",route:"/agricultural-events",icon:e.jsx(xe,{className:"h-5 w-5"}),tags:["shows","exhibitions"]},{id:"market-prices",title:"Market Prices",description:"Current commodity prices",type:"page",route:"/market-prices",icon:e.jsx(re,{className:"h-5 w-5"}),tags:["prices","rates"]},{id:"routes",title:"Major Routes Marketplace",description:"Trade along major highways",type:"page",route:"/major-routes-marketplace",icon:e.jsx(ee,{className:"h-5 w-5"}),tags:["roads","roadside"]},{id:"food-rescue",title:"Food Rescue",description:"Reduce food waste through donations",type:"page",route:"/food-rescue",icon:e.jsx(re,{className:"h-5 w-5"}),tags:["donations","surplus"]},{id:"imperfect",title:"Imperfect Surplus Produce",description:"Buy imperfect but good produce",type:"page",route:"/imperfect-surplus",icon:e.jsx(as,{className:"h-5 w-5"}),tags:["discount","ugly produce"]},{id:"farm-dashboard",title:"Farm Dashboard",description:"Manage your farm operations",type:"page",route:"/farmer-portal",icon:e.jsx(as,{className:"h-5 w-5"}),tags:["management","farm"]},{id:"batch-tracking",title:"Batch Tracking",description:"Track product batches",type:"page",route:"/batch-tracking",icon:e.jsx(re,{className:"h-5 w-5"}),tags:["traceability","tracking"]},{id:"carbon",title:"Carbon Footprint",description:"Track your carbon emissions",type:"page",route:"/carbon-footprint",icon:e.jsx(as,{className:"h-5 w-5"}),tags:["sustainability","emissions"]}],Mo=({isOpen:s,onClose:t,trigger:a})=>{const r=Ne(),[n,c]=i.useState(!1),[l,x]=i.useState(""),[f,j]=i.useState([]),N=i.useRef(null),g=s!==void 0?s:n;i.useEffect(()=>{g&&N.current&&N.current.focus()},[g]),i.useEffect(()=>{if(!l.trim()){j([]);return}const p=l.toLowerCase(),m=Pr.filter(o=>{var S;const y=o.title.toLowerCase().includes(p),k=o.description.toLowerCase().includes(p),A=(S=o.tags)==null?void 0:S.some(E=>E.toLowerCase().includes(p));return y||k||A});j(m)},[l]);const u=p=>{r(p.route),d()},d=()=>{x(""),j([]),t?t():c(!1)},h=()=>{s===void 0&&c(!0)};i.useEffect(()=>{const p=m=>{(m.metaKey||m.ctrlKey)&&m.key==="k"&&(m.preventDefault(),h())};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[]);const v=p=>{switch(p){case"marketplace":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"service":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";case"community":return"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200";case"event":return"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"}};return e.jsxs(e.Fragment,{children:[a?e.jsx("div",{onClick:h,children:a}):e.jsxs(b,{variant:"outline",size:"sm",onClick:h,className:"gap-2",children:[e.jsx(Pe,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden md:inline",children:"Search..."}),e.jsxs("kbd",{className:"hidden md:inline-flex h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-xs font-medium opacity-100",children:[e.jsx("span",{className:"text-xs",children:"âŒ˜"}),"K"]})]}),e.jsx(_e,{open:g,onOpenChange:p=>p?h():d(),children:e.jsxs(we,{className:"max-w-2xl p-0",children:[e.jsxs(Ce,{className:"p-4 pb-0",children:[e.jsx(ke,{className:"sr-only",children:"Search SokoConnect"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pe,{className:"h-5 w-5 text-muted-foreground"}),e.jsx(D,{ref:N,value:l,onChange:p=>x(p.target.value),placeholder:"Search pages, marketplaces, services...",className:"border-0 focus-visible:ring-0 text-lg"}),l&&e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>x(""),children:e.jsx(Be,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"max-h-[60vh] overflow-y-auto p-4 pt-2",children:[l&&f.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Pe,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsxs("p",{children:['No results found for "',l,'"']}),e.jsx("p",{className:"text-sm mt-1",children:"Try different keywords"})]}),f.length>0&&e.jsx("div",{className:"space-y-2",children:f.map(p=>e.jsx(w,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>u(p),children:e.jsxs(_,{className:"flex items-center gap-4 p-3",children:[e.jsx("div",{className:"flex-shrink-0 p-2 bg-muted rounded-lg",children:p.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium truncate",children:p.title}),e.jsx(I,{className:`text-xs ${v(p.type)}`,children:p.type})]}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:p.description})]})]})},p.id))}),!l&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Quick Links"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Pr.slice(0,6).map(p=>e.jsxs(b,{variant:"outline",className:"justify-start gap-2 h-auto py-2",onClick:()=>u(p),children:[p.icon,e.jsx("span",{className:"truncate",children:p.title})]},p.id))})]})})]})]})})]})},ne=()=>{var c,l;const{user:s,signOut:t}=je(),a=Ne(),r=async()=>{try{await t(),a("/")}catch(x){console.error("Error signing out:",x)}},n=()=>e.jsx("img",{src:Fo,alt:"SokoConnect Logo",className:"w-8 h-8 md:w-10 md:h-10 object-contain flex-shrink-0"});return e.jsx("header",{className:"bg-background border-b",children:e.jsx("div",{className:"container mx-auto px-4 py-2 md:py-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 md:gap-4 min-w-0",children:[e.jsxs(X,{to:"/",className:"flex items-center gap-1.5 md:gap-2 flex-shrink-0",children:[e.jsx(n,{}),e.jsx("span",{className:"text-lg md:text-xl font-bold text-primary hidden sm:inline",children:"SokoConnect"})]}),e.jsx("div",{className:"hidden lg:block",children:e.jsx(Eo,{})})]}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[e.jsx(Mo,{}),e.jsx(Ao,{}),s?e.jsxs(Ja,{children:[e.jsx(Xa,{asChild:!0,children:e.jsx(b,{variant:"ghost",className:"relative h-10 w-10 rounded-full",children:e.jsxs(Us,{className:"h-10 w-10",children:[e.jsx(rt,{src:(c=s.user_metadata)==null?void 0:c.avatar_url,alt:"Profile"}),e.jsx(Vs,{children:e.jsx(vs,{className:"h-4 w-4"})})]})})}),e.jsxs(ua,{className:"w-56",align:"end",forceMount:!0,children:[e.jsx(un,{className:"font-normal",children:e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("p",{className:"text-sm font-medium leading-none",children:((l=s.user_metadata)==null?void 0:l.full_name)||s.email}),e.jsx("p",{className:"text-xs leading-none text-muted-foreground",children:s.email})]})}),e.jsx(Ma,{}),e.jsx(fs,{asChild:!0,children:e.jsxs(X,{to:"/profile",className:"cursor-pointer",children:[e.jsx(vs,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Profile"})]})}),e.jsx(fs,{asChild:!0,children:e.jsxs(X,{to:"/settings",className:"cursor-pointer",children:[e.jsx(At,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Settings"})]})}),e.jsx(Ma,{}),e.jsxs(fs,{onClick:r,className:"cursor-pointer",children:[e.jsx($a,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Log out"})]})]})]}):e.jsx(b,{asChild:!0,children:e.jsx(X,{to:"/auth",children:"Sign In"})})]})]})})})},Io=({className:s})=>e.jsx("svg",{className:s,viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})}),ct={phone:"+254 745 824 354",email:"info@sokoconnect.co.ke",location:"Nairobi, Kenya",whatsappGroupLink:"https://chat.whatsapp.com/LZQF0tXWP9RGm6Hk7Oscxg?mode=ac_t"},Nt=()=>e.jsx("footer",{className:"bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 text-white py-12",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8 mb-8",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-bold mb-4 text-green-400 flex items-center gap-2",children:[e.jsx(rs,{className:"h-5 w-5 text-green-400"}),"Platform"]}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsx("li",{children:e.jsxs(X,{to:"/commodity-trading",className:"hover:text-green-400 transition-colors flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4 text-green-500"}),"Commodity Trading"]})}),e.jsx("li",{children:e.jsxs(X,{to:"/logistics",className:"hover:text-green-400 transition-colors flex items-center gap-2",children:[e.jsx(ye,{className:"h-4 w-4 text-blue-500"}),"Logistics"]})}),e.jsx("li",{children:e.jsxs(X,{to:"/service-providers",className:"hover:text-green-400 transition-colors flex items-center gap-2",children:[e.jsx(Tt,{className:"h-4 w-4 text-purple-500"}),"Service Providers"]})}),e.jsx("li",{children:e.jsxs(X,{to:"/farm-input-marketplace",className:"hover:text-green-400 transition-colors flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4 text-orange-500"}),"Farm Input Marketplace"]})}),e.jsx("li",{children:e.jsxs(X,{to:"/supply-chain-dashboard",className:"hover:text-green-400 transition-colors flex items-center gap-2",children:[e.jsx(Re,{className:"h-4 w-4 text-yellow-500"}),"Supply Chain"]})})]})]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-bold mb-4 text-purple-400 flex items-center gap-2",children:[e.jsx(Re,{className:"h-5 w-5 text-purple-400"}),"Features"]}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsx("li",{children:e.jsxs(X,{to:"/farmer-portal",className:"hover:text-purple-400 transition-colors flex items-center gap-2",children:[e.jsx(as,{className:"h-4 w-4 text-green-500"}),"Farmer Portal"]})}),e.jsx("li",{children:e.jsxs(X,{to:"/market-prices",className:"hover:text-purple-400 transition-colors flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4 text-blue-500"}),"Market Prices"]})}),e.jsx("li",{children:e.jsxs(X,{to:"/bluetooth-marketplace",className:"hover:text-purple-400 transition-colors flex items-center gap-2",children:[e.jsx(Mt,{className:"h-4 w-4 text-sky-500"}),"Bluetooth Market"]})}),e.jsx("li",{children:e.jsxs(X,{to:"/farmer-success-stories",className:"hover:text-purple-400 transition-colors flex items-center gap-2",children:[e.jsx(ul,{className:"h-4 w-4 text-yellow-500"}),"Farmer Success Stories"]})}),e.jsx("li",{children:e.jsxs(X,{to:"/market-demand-hotspot",className:"hover:text-purple-400 transition-colors flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-red-500"}),"Demand Hotspots"]})}),e.jsx("li",{children:e.jsxs(X,{to:"/carbon-footprint",className:"hover:text-purple-400 transition-colors flex items-center gap-2",children:[e.jsx(xl,{className:"h-4 w-4 text-emerald-500"}),"Carbon Footprint"]})})]})]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-bold mb-4 text-blue-400 flex items-center gap-2",children:[e.jsx(Zt,{className:"h-5 w-5 text-blue-400"}),"Support"]}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsx("li",{children:e.jsxs(X,{to:"/partners-showcase",className:"hover:text-blue-400 transition-colors flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4 text-orange-500"}),"Partners"]})}),e.jsx("li",{children:e.jsxs(X,{to:"/networking",className:"hover:text-blue-400 transition-colors flex items-center gap-2",children:[e.jsx(hl,{className:"h-4 w-4 text-purple-500"}),"Networking"]})}),e.jsx("li",{children:e.jsxs(X,{to:"/faq",className:"hover:text-blue-400 transition-colors flex items-center gap-2",children:[e.jsx(Zt,{className:"h-4 w-4 text-blue-500"}),"FAQ"]})}),e.jsx("li",{children:e.jsxs(X,{to:"/contact",className:"hover:text-blue-400 transition-colors flex items-center gap-2",children:[e.jsx(Ee,{className:"h-4 w-4 text-green-500"}),"Contact"]})}),e.jsx("li",{children:e.jsxs(X,{to:"/community-forums",className:"hover:text-blue-400 transition-colors flex items-center gap-2",children:[e.jsx(ys,{className:"h-4 w-4 text-sky-500"}),"Community Forum"]})}),e.jsx("li",{children:e.jsxs(X,{to:"/partner-with-us",className:"hover:text-blue-400 transition-colors flex items-center gap-2",children:[e.jsx(Tt,{className:"h-4 w-4 text-orange-500"}),"Partner with Us"]})})]})]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-bold mb-4 text-orange-400 flex items-center gap-2",children:[e.jsx(as,{className:"h-5 w-5 text-orange-400"}),"SokoConnect"]}),e.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Connecting farmers, traders, and service providers for a better agricultural ecosystem across Africa."}),e.jsx("div",{className:"mb-4",children:e.jsxs(X,{to:"/more",className:"text-sm text-primary hover:text-green-400 transition-colors flex items-center gap-2",children:[e.jsx(Re,{className:"h-4 w-4"}),"Explore All Features â†’"]})}),e.jsx("div",{className:"pt-4 border-t border-gray-700",children:e.jsxs("div",{className:"flex flex-wrap gap-4 text-xs text-gray-500",children:[e.jsxs(X,{to:"/terms-of-service",className:"hover:text-gray-300 flex items-center gap-1",children:[e.jsx(Ve,{className:"h-3 w-3"})," Terms"]}),e.jsxs(X,{to:"/privacy-policy",className:"hover:text-gray-300 flex items-center gap-1",children:[e.jsx(Ve,{className:"h-3 w-3"})," Privacy"]})]})})]})]}),e.jsx("div",{className:"border-t border-gray-700 pt-8 mt-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-gray-400",children:"Follow Us:"}),e.jsx("a",{href:"https://facebook.com/sokoconnect",target:"_blank",rel:"noopener noreferrer",className:"p-2 bg-blue-600 rounded-full hover:bg-blue-700 transition-colors","aria-label":"Facebook",children:e.jsx(pl,{className:"h-5 w-5"})}),e.jsx("a",{href:ct.whatsappGroupLink,target:"_blank",rel:"noopener noreferrer",className:"p-2 bg-green-600 rounded-full hover:bg-green-700 transition-colors","aria-label":"WhatsApp Group",children:e.jsx(Io,{className:"h-5 w-5"})}),e.jsx("a",{href:"https://instagram.com/sokoconnect",target:"_blank",rel:"noopener noreferrer",className:"p-2 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full hover:from-purple-600 hover:to-pink-600 transition-colors","aria-label":"Instagram",children:e.jsx(gl,{className:"h-5 w-5"})}),e.jsx("a",{href:"https://linkedin.com/company/sokoconnect",target:"_blank",rel:"noopener noreferrer",className:"p-2 bg-blue-700 rounded-full hover:bg-blue-800 transition-colors","aria-label":"LinkedIn",children:e.jsx(jl,{className:"h-5 w-5"})}),e.jsx("a",{href:"https://youtube.com/sokoconnect",target:"_blank",rel:"noopener noreferrer",className:"p-2 bg-red-600 rounded-full hover:bg-red-700 transition-colors","aria-label":"YouTube",children:e.jsx(fl,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-6 text-gray-400",children:[e.jsxs("a",{href:`mailto:${ct.email}`,className:"flex items-center gap-2 hover:text-green-400 transition-colors",children:[e.jsx(He,{className:"h-4 w-4 text-green-500"}),ct.email]}),e.jsxs("a",{href:`tel:${ct.phone.replace(/\s/g,"")}`,className:"flex items-center gap-2 hover:text-green-400 transition-colors",children:[e.jsx(Ee,{className:"h-4 w-4 text-green-500"}),ct.phone]}),e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-green-500"}),ct.location]})]})]})}),e.jsx("div",{className:"border-t border-gray-700 pt-6 mt-6 text-center text-gray-400",children:e.jsxs("p",{children:["Â© ",new Date().getFullYear()," SokoConnect. All rights reserved. | Empowering African Agriculture"]})})]})}),xa="/assets/hero-farming-team-Dp8JYcwD.jpg",Ro=()=>{const s=[{icon:ce,title:"Real-time Market Data",description:"Access live agricultural market prices and demand forecasts",link:"/kilimo-ams-data"},{icon:se,title:"Service Providers",description:"Connect with agricultural service providers and experts",link:"/service-providers"},{icon:ye,title:"Logistics Solutions",description:"Find transportation and storage solutions for your produce",link:"/logistics"},{icon:ys,title:"Community Forum",description:"Join discussions with fellow farmers and agribusiness professionals",link:"/community-forum"}];return e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{backgroundImage:`url(${xa})`}}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-green-900/80 via-green-800/70 to-green-700/60"}),e.jsxs("div",{className:"relative container mx-auto px-4 py-16 lg:py-24",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx(I,{variant:"secondary",className:"mb-4 bg-white/90 text-green-800",children:"ðŸŒ¾ Agricultural Technology Platform"}),e.jsx("h1",{className:"text-4xl md:text-6xl font-bold text-white mb-6 drop-shadow-lg",children:"Connect. Trade. Grow."}),e.jsx("p",{className:"text-xl text-white/90 mb-8 max-w-3xl mx-auto",children:"Empowering farmers and agribusiness with real-time market data, logistics solutions, and community connections across Kenya's agricultural value chain."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-8",children:[e.jsx(X,{to:"/kilimo-ams-data",children:e.jsxs(b,{size:"lg",className:"w-full sm:w-auto",children:["Explore Market Data",e.jsx(ks,{className:"ml-2 h-4 w-4"})]})}),e.jsx(X,{to:"/business-marketing",children:e.jsxs(b,{size:"lg",variant:"outline",className:"w-full sm:w-auto bg-green-50 border-green-200 text-green-700 hover:bg-green-100",children:[e.jsx(Xs,{className:"mr-2 h-4 w-4"}),"Advertise Your Business"]})})]}),e.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-lg p-6 mb-12 border border-green-200 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-3",children:[e.jsx(Xs,{className:"h-5 w-5 text-green-600"}),e.jsx("h3",{className:"text-lg font-semibold text-green-800",children:"Business Marketing"}),e.jsx(I,{className:"bg-green-600",children:"Popular"})]}),e.jsx("p",{className:"text-green-700 mb-4",children:"Reach thousands of farmers and agricultural professionals. Advertise your business for just $20 (KES 2,600) for 30 days."}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-4 text-sm text-green-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(na,{className:"h-4 w-4"}),e.jsx("span",{children:"Targeted Audience"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{children:"From $10/month"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ce,{className:"h-4 w-4"}),e.jsx("span",{children:"1000+ Daily Visitors"})]})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:s.map((t,a)=>e.jsx(w,{className:"hover:shadow-lg transition-shadow cursor-pointer",children:e.jsx(X,{to:t.link,children:e.jsxs(_,{className:"p-6 text-center",children:[e.jsx(t.icon,{className:"h-12 w-12 text-primary mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:t.title}),e.jsx("p",{className:"text-gray-600 text-sm",children:t.description})]})})},a))}),e.jsx("div",{className:"text-center mt-12",children:e.jsx("p",{className:"text-white/80 text-sm",children:"Trusted by farmers, cooperatives, and agribusiness across Kenya"})})]})]})},ge=vl,pe=i.forwardRef(({className:s,...t},a)=>e.jsx(Ni,{ref:a,className:$("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...t}));pe.displayName=Ni.displayName;const B=i.forwardRef(({className:s,...t},a)=>e.jsx(bi,{ref:a,className:$("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...t}));B.displayName=bi.displayName;const V=i.forwardRef(({className:s,...t},a)=>e.jsx(wi,{ref:a,className:$("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...t}));V.displayName=wi.displayName;const zo=1,Oo=1e6;let Na=0;function Ko(){return Na=(Na+1)%Number.MAX_SAFE_INTEGER,Na.toString()}const ba=new Map,Ar=s=>{if(ba.has(s))return;const t=setTimeout(()=>{ba.delete(s),Pt({type:"REMOVE_TOAST",toastId:s})},Oo);ba.set(s,t)},Bo=(s,t)=>{switch(t.type){case"ADD_TOAST":return{...s,toasts:[t.toast,...s.toasts].slice(0,zo)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(a=>a.id===t.toast.id?{...a,...t.toast}:a)};case"DISMISS_TOAST":{const{toastId:a}=t;return a?Ar(a):s.toasts.forEach(r=>{Ar(r.id)}),{...s,toasts:s.toasts.map(r=>r.id===a||a===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return t.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(a=>a.id!==t.toastId)}}},Qt=[];let Jt={toasts:[]};function Pt(s){Jt=Bo(Jt,s),Qt.forEach(t=>{t(Jt)})}function Uo({...s}){const t=Ko(),a=n=>Pt({type:"UPDATE_TOAST",toast:{...n,id:t}}),r=()=>Pt({type:"DISMISS_TOAST",toastId:t});return Pt({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:n=>{n||r()}}}),{id:t,dismiss:r,update:a}}function Z(){const[s,t]=i.useState(Jt);return i.useEffect(()=>(Qt.push(t),()=>{const a=Qt.indexOf(t);a>-1&&Qt.splice(a,1)}),[s]),{...s,toast:Uo,dismiss:a=>Pt({type:"DISMISS_TOAST",toastId:a})}}const le=i.forwardRef(({className:s,...t},a)=>e.jsx("textarea",{className:$("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:a,...t}));le.displayName="Textarea";const Vo=jt("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),C=i.forwardRef(({className:s,...t},a)=>e.jsx(_i,{ref:a,className:$(Vo(),s),...t}));C.displayName=_i.displayName;const Tr="https://amis.kilimo.go.ke/en/api",wa=2,Dr=1e3,$o=2*60*60*1e3,zs={};class $s{static async get(t,a,r,n=!1){return this.request(t,{method:"GET",queryParams:a,fallbackReturnValue:r,bypassCache:n,timeout:3e3})}static async post(t,a,r){return this.request(t,{method:"POST",body:a,fallbackReturnValue:r})}static async request(t,a={}){const{method:r="GET",body:n,queryParams:c,fallbackReturnValue:l={results:[]},retries:x=0,bypassCache:f=!1,timeout:j=5e3}=a;let N=`${Tr}/${t}`;if(c){const d=new URLSearchParams;Object.entries(c).forEach(([v,p])=>{p!=null&&p!==""&&d.append(v,p)});const h=d.toString();h&&(N+=`?${h}`)}const g=`${r}:${N}`;if(r==="GET"&&!f&&zs[g]){const d=zs[g];if(Date.now()-d.timestamp<$o)return console.log(`Using cached data for ${N}`),d.data;delete zs[g]}const u={method:r,headers:{Accept:"application/json","Content-Type":"application/json",Origin:window.location.origin},mode:"cors",cache:"no-cache",credentials:"same-origin"};n&&(r==="POST"||r==="PUT")&&(u.body=JSON.stringify(n)),console.log(`Making ${r} request to ${N} (attempt ${x+1} of ${wa+1})`);try{const d=new AbortController,h=setTimeout(()=>d.abort(),j);u.signal=d.signal;const v=await fetch(N,u);if(clearTimeout(h),v.status>=500&&v.status<600&&x<wa){const m=Dr*Math.pow(2,x);return console.log(`Server error (${v.status}), retrying in ${m}ms...`),await new Promise(o=>setTimeout(o,m)),this.request(t,{...a,retries:x+1})}if(!v.ok){const m=await v.text();return console.error(`API error (${v.status}): ${m}`),r==="GET"&&(zs[g]={timestamp:Date.now(),data:l}),l}const p=await v.json();return r==="GET"&&(zs[g]={timestamp:Date.now(),data:p}),p}catch(d){if(d instanceof DOMException&&d.name==="AbortError"?console.error(`Request timeout for ${t} after ${j}ms`):console.error(`Failed to connect to API (${t}):`,d),x<wa){const h=Dr*Math.pow(2,x);return console.log(`Network error, retrying in ${h}ms...`),await new Promise(v=>setTimeout(v,h)),this.request(t,{...a,retries:x+1})}if(typeof l<"u")return console.log(`Maximum retries reached. Using fallback data for ${t}`),r==="GET"&&(zs[g]={timestamp:Date.now(),data:l}),l;throw d}}static async checkApiHealth(){try{const t=new AbortController,a=setTimeout(()=>t.abort(),3e3),r=await fetch(`${Tr}/health-check`,{method:"GET",headers:{Accept:"application/json"},mode:"cors",cache:"no-cache",credentials:"same-origin",signal:t.signal});return clearTimeout(a),r.ok}catch(t){return console.warn("API health check failed:",t),!1}}static clearCache(){Object.keys(zs).forEach(t=>delete zs[t]),console.log("API cache cleared")}}const _a=async()=>{console.log("Fetching real featured news from Ministry API");const s=await $s.get("news/",void 0,{results:[]});console.log("Received news data:",s);const t=s.results.map((a,r)=>({id:a.id||r+1,title:a.title||a.headline||"News update",source:a.source||"Ministry of Agriculture",date:a.published_date||new Date().toISOString().split("T")[0],tags:a.tags?typeof a.tags=="string"?a.tags.split(",").map(n=>n.trim()):a.tags:["agriculture"],location:a.location||"Kenya",summary:a.summary||a.content||a.description||"No description available",url:a.url||`${window.location.origin}/news/${a.id}/`}));return console.log(`Successfully fetched ${t.length} news items`),t},Er=async()=>{console.log("Fetching real services data from Ministry API");const s=await $s.get("services/",void 0,{results:[]});console.log("Received services data:",s);const t=s.results.map((a,r)=>({id:a.id||r+1,title:a.name||a.title||"Service",provider:a.provider||a.organization||"Service Provider",source:a.provider||a.organization||"Service Provider",date:a.date_added||new Date().toISOString().split("T")[0],tags:a.tags?typeof a.tags=="string"?a.tags.split(",").map(n=>n.trim()):a.tags:["service"],location:a.locations||a.coverage||"Kenya",summary:a.description||a.summary||"No description available",url:a.url||a.website||`${window.location.origin}/services/${a.id}/`}));return console.log(`Successfully fetched ${t.length} services`),t},Fr=async()=>{console.log("Fetching real products data from Ministry API");const s=await $s.get("products/",void 0,{results:[]});console.log("Received products data:",s);const t=s.results.map((a,r)=>({id:a.id||r+1,title:a.name||a.title||"Product",provider:a.provider||a.seller||a.organization||"Provider",source:a.provider||a.seller||a.organization||"Provider",date:a.date_listed||a.date_added||new Date().toISOString().split("T")[0],tags:a.tags?typeof a.tags=="string"?a.tags.split(",").map(n=>n.trim()):a.tags:["product"],location:a.location||"Kenya",summary:a.description||a.summary||"No description available",price:a.price?`KES ${a.price}`:void 0,url:a.url||`${window.location.origin}/products/${a.id}/`}));return console.log(`Successfully fetched ${t.length} products`),t},Go=async s=>{console.log("Submitting news item to Ministry API",s);const t={title:s.title,source:s.source,tags:Array.isArray(s.tags)?s.tags.join(", "):s.tags,location:s.location,content:s.summary,url:s.url,published_date:new Date().toISOString().split("T")[0]};try{return await $s.post("news/submit/",t),console.log("News item submitted successfully"),!0}catch(a){throw console.error("Failed to submit news item:",a),a}},Ho=()=>{const[s,t]=i.useState("news"),[a,r]=i.useState(!0),[n,c]=i.useState(null),[l,x]=i.useState([]),[f,j]=i.useState([]),[N,g]=i.useState([]),[u,d]=i.useState({title:"",source:"",tags:"",location:"",summary:"",url:""}),[h,v]=i.useState(!1),[p,m]=i.useState(!1),{toast:o}=Z();i.useEffect(()=>{const E=async()=>{r(!0);try{const[M,O,te]=await Promise.all([_a(),Er(),Fr()]);x(M),j(O),g(te),c(new Date)}catch(M){console.error("Error fetching featured content:",M),o({title:"Error loading content",description:"Could not load the featured content. Please check your connection and try again.",variant:"destructive"}),x(O=>O.length?O:[]),j(O=>O.length?O:[]),g(O=>O.length?O:[])}finally{r(!1)}};E();const P=4*60*60*1e3,R=setInterval(E,P);return()=>clearInterval(R)},[o]);const y=async()=>{r(!0);try{const[E,P,R]=await Promise.all([_a(),Er(),Fr()]);x(E),j(P),g(R),c(new Date),o({title:"Content refreshed",description:"Featured content has been updated with the latest data."})}catch(E){console.error("Error refreshing featured content:",E),o({title:"Error refreshing content",description:"Could not refresh the content. Please check your connection and try again.",variant:"destructive"})}finally{r(!1)}},k=E=>{const{name:P,value:R}=E.target;d(M=>({...M,[P]:R}))},A=async()=>{if(!u.title||!u.source||!u.summary){o({title:"Missing information",description:"Please fill in all required fields.",variant:"destructive"});return}v(!0);try{if(await Go({title:u.title,source:u.source,date:new Date().toISOString().split("T")[0],tags:u.tags.split(",").map(P=>P.trim()),location:u.location,summary:u.summary,url:u.url||"#"})){const P=await _a();x(P),d({title:"",source:"",tags:"",location:"",summary:"",url:""}),m(!1),o({title:"News submitted",description:"Your news has been submitted successfully."})}}catch(E){console.error("Error submitting news:",E),o({title:"Submission error",description:"Could not submit your news. Please check your connection and try again.",variant:"destructive"})}finally{v(!1)}},S=E=>a?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):E.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-muted-foreground",children:"No items found. Please check your connection and try refreshing."}),e.jsxs(b,{onClick:y,variant:"outline",className:"mt-4",children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"})," Refresh"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:E.map(P=>e.jsx(w,{className:"hover:shadow-md transition-all overflow-hidden",children:e.jsxs(_,{className:"p-0",children:[e.jsxs("div",{className:"bg-muted/40 p-5",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 line-clamp-2",children:P.title}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground mb-2",children:[e.jsx(se,{className:"h-4 w-4 mr-1"}),e.jsx("span",{children:P.provider||P.source})]}),e.jsxs("div",{className:"flex flex-wrap gap-y-1 text-xs",children:[e.jsxs("div",{className:"flex items-center mr-3",children:[e.jsx(xe,{className:"h-3 w-3 mr-1"}),e.jsx("span",{children:new Date(P.date).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center mr-3",children:[e.jsx(ee,{className:"h-3 w-3 mr-1"}),e.jsx("span",{children:P.location})]})]})]}),e.jsxs("div",{className:"p-5",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4 line-clamp-3",children:P.summary}),P.price&&e.jsx("div",{className:"font-bold text-primary mb-4",children:P.price}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:P.tags.map(R=>e.jsxs("div",{className:"bg-secondary/50 text-secondary-foreground text-xs px-2 py-1 rounded-full flex items-center",children:[e.jsx(Dt,{className:"h-3 w-3 mr-1"}),R]},R))}),e.jsx(b,{asChild:!0,variant:"outline",size:"sm",className:"w-full",children:e.jsxs("a",{href:P.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center",children:["View Details ",e.jsx(xs,{className:"ml-1 h-3 w-3"})]})})]})]})},P.id))});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("div",{children:n&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Last updated: ",n.toLocaleString()]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_e,{open:p,onOpenChange:m,children:[e.jsx(Ie,{asChild:!0,children:e.jsxs(b,{variant:"outline",size:"sm",children:[e.jsx(ie,{className:"h-4 w-4 mr-1"})," Submit News"]})}),e.jsxs(we,{className:"sm:max-w-[500px]",children:[e.jsx(Ce,{children:e.jsx(ke,{children:"Submit News Item"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(C,{htmlFor:"title",children:"Title *"}),e.jsx(D,{id:"title",name:"title",value:u.title,onChange:k,required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(C,{htmlFor:"source",children:"Source *"}),e.jsx(D,{id:"source",name:"source",value:u.source,onChange:k,required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(C,{htmlFor:"tags",children:"Tags (comma separated)"}),e.jsx(D,{id:"tags",name:"tags",value:u.tags,onChange:k,placeholder:"e.g. maize, exports, policy"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(C,{htmlFor:"location",children:"Location"}),e.jsx(D,{id:"location",name:"location",value:u.location,onChange:k})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(C,{htmlFor:"summary",children:"Summary *"}),e.jsx(le,{id:"summary",name:"summary",rows:3,value:u.summary,onChange:k,required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(C,{htmlFor:"url",children:"Source URL"}),e.jsx(D,{id:"url",name:"url",type:"url",value:u.url,onChange:k,placeholder:"https://"})]})]}),e.jsx(Ze,{children:e.jsx(b,{onClick:A,disabled:h,children:h?"Submitting...":"Submit News"})})]})]}),e.jsxs(b,{onClick:y,variant:"ghost",size:"sm",disabled:a,children:[e.jsx(Ss,{className:`h-4 w-4 ${a?"animate-spin":""}`}),e.jsx("span",{className:"sr-only",children:"Refresh"})]})]})]}),e.jsxs(ge,{defaultValue:"news",value:s,onValueChange:t,children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsxs(pe,{className:"grid grid-cols-3 w-full max-w-md",children:[e.jsxs(B,{value:"news",className:"flex items-center",children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"News"]}),e.jsxs(B,{value:"services",className:"flex items-center",children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Services"]}),e.jsxs(B,{value:"products",className:"flex items-center",children:[e.jsx(Dt,{className:"h-4 w-4 mr-2"}),"Products"]})]})}),e.jsx(V,{value:"news",className:"mt-0",children:S(l)}),e.jsx(V,{value:"services",className:"mt-0",children:S(f)}),e.jsx(V,{value:"products",className:"mt-0",children:S(N)})]})]})},jn=s=>({agriculture:"Agricultural Issues",solutions:"Agricultural Solutions",tender:"Tender","awarded-tender":"Awarded Tender"})[s]||s,Wo=()=>["kilimo.go.ke","kenyaseed.com","kalro.org","moa.go.ke","nafis.go.ke","agritechinnovations.co.ke","kephis.org","eaff.org","farmafrica.org","agriculture.go.ke","agra.org","kebs.org","afa.go.ke","agricultureauthority.go.ke","globalgap.org","koan.co.ke","farmafrica.org"],Yo=s=>{try{const a=new URL(s).hostname;return Wo().some(r=>a===r||a.endsWith(`.${r}`))}catch{return!1}},Qo=s=>{var n,c;const t=((n=s.title)==null?void 0:n.toLowerCase())||"",a=((c=s.description)==null?void 0:c.toLowerCase())||"",r=["guaranteed results","miracle solution","secret that experts","100% effective","revolutionary breakthrough"];for(const l of r)if(t.includes(l)||a.includes(l))return!1;return s.source&&["Ministry of Agriculture","Kenya Seed Company","Kenya Agricultural Research Institute","KALRO","FAO","AgriTech Innovations","Kenya Plant Health Inspectorate Service","Kenya Bureau of Standards","KEBS","National Farmers Information Service","Agriculture and Food Authority"].some(x=>s.source.includes(x)),!0},nt=(s=800)=>new Promise(t=>setTimeout(t,s)),zt=async()=>(await nt(800),console.info("Processed 85 Kilimo statistics"),[{id:"1",name:"Maize Production",value:"3.8 million tonnes",category:"Production",county:"National",unit:"tonnes",source:"KNBS Agricultural Census 2023",verified:!0},{id:"2",name:"Coffee Production",value:"45,000 tonnes",category:"Production",county:"National",unit:"tonnes",source:"Coffee Board of Kenya 2023",verified:!0},{id:"3",name:"Average Maize Price",value:"KES 4,200",category:"Prices",county:"National",unit:"KES/90kg bag",source:"Nairobi Grain Exchange 2023",verified:!0},{id:"4",name:"Nakuru Production",value:"235,000 tonnes",category:"County",county:"Nakuru",unit:"tonnes",source:"KNBS County Statistics 2023",verified:!0},{id:"5",name:"Kiambu Production",value:"190,000 tonnes",category:"County",county:"Kiambu",unit:"tonnes",source:"KNBS County Statistics 2023",verified:!0},{id:"6",name:"Meru Production",value:"210,000 tonnes",category:"County",county:"Meru",unit:"tonnes",source:"KNBS County Statistics 2023",verified:!0}]),Jo=async()=>{await nt(800);const s=["Nairobi","Mombasa","Kisumu","Nakuru","Kiambu","Meru","Kakamega","Nyeri","Machakos","Uasin Gishu","Kirinyaga","Bungoma","Bomet"],t=[{name:"Tomatoes",minPrice:2800,maxPrice:4500,unit:"crate"},{name:"Potatoes",minPrice:1800,maxPrice:3e3,unit:"bag"},{name:"Maize",minPrice:3e3,maxPrice:6e3,unit:"bag"},{name:"Beans",minPrice:7e3,maxPrice:12e3,unit:"bag"},{name:"Onions",minPrice:2e3,maxPrice:4e3,unit:"bag"},{name:"Cabbage",minPrice:15,maxPrice:40,unit:"piece"},{name:"Bananas",minPrice:300,maxPrice:600,unit:"bunch"},{name:"Carrots",minPrice:1500,maxPrice:3e3,unit:"bag"},{name:"Avocado",minPrice:10,maxPrice:30,unit:"piece"},{name:"Mangoes",minPrice:500,maxPrice:1200,unit:"crate"}],a=[];for(let r=0;r<18;r++){const n=s[r%s.length],c=["High","Medium","Low"][Math.floor(Math.random()*3)],l=[],x=3+Math.floor(Math.random()*4),f=[...t].sort(()=>.5-Math.random());for(let j=0;j<x;j++){const N=f[j],g=Math.floor(N.minPrice+Math.random()*(N.maxPrice-N.minPrice));l.push({id:`P${j+1}${r}`,produceName:N.name,price:g,unit:N.unit,date:new Date().toISOString().split("T")[0]})}a.push({id:`MKT${(r+1).toString().padStart(3,"0")}`,name:`${n} ${["Central","Main","Municipal","Farmers","City"][Math.floor(Math.random()*5)]} Market`,county:n,location:{county:n},producePrices:l,demand:c,operatingHours:`${5+Math.floor(Math.random()*3)}:00 AM - ${4+Math.floor(Math.random()*4)}:00 PM`})}return a},Xo=async()=>{await nt(900);const s=["Nairobi","Mombasa","Kisumu","Nakuru","Kiambu","Meru","Kakamega","Nyeri","Machakos","Uasin Gishu","Kirinyaga","Bungoma","Bomet"],t={Vegetables:["Tomatoes","Kale","Cabbage","Spinach","Carrots","Onions","Garlic"],Fruits:["Bananas","Avocados","Mangoes","Oranges","Apples","Pineapples"],Tubers:["Potatoes","Sweet Potatoes","Cassava","Arrow Roots"],Cereals:["Maize","Wheat","Rice","Barley","Sorghum"],Legumes:["Beans","Green Grams","Peas","Lentils","Soybeans"]},a=["A","B","A+","Premium"],r=["kg","ton","bag","crate"],n=[];for(let c=0;c<30;c++){const l=Object.keys(t),x=l[Math.floor(Math.random()*l.length)],f=t[x],j=f[Math.floor(Math.random()*f.length)],N=s[Math.floor(Math.random()*s.length)],g=new Date;g.setDate(g.getDate()+Math.floor(Math.random()*30)),n.push({id:`P${(c+1).toString().padStart(3,"0")}`,name:j,category:x,county:N,quantity:100+Math.floor(Math.random()*5e3),unit:r[Math.floor(Math.random()*r.length)],qualityGrade:a[Math.floor(Math.random()*a.length)],availableFrom:g.toISOString().split("T")[0],farmer:`Farmer ${Math.floor(Math.random()*20)+1}`,farmerId:`F${(Math.floor(Math.random()*20)+1).toString().padStart(3,"0")}`})}return n},qr=[{id:"1",title:"Managing Tomato Blight in Wet Seasons",description:"Effective strategies for managing tomato blight during rainy seasons in Kenya",category:"issues",date:"2023-11-15",source:"Kenya Agricultural Research Institute",content:"Tomato blight is a common disease that affects tomato crops during wet seasons. Symptoms include dark spots on leaves, stems, and fruits. To manage tomato blight: 1) Plant resistant varieties 2) Improve drainage in your field 3) Apply appropriate fungicides preventatively 4) Practice crop rotation 5) Remove and destroy infected plants to prevent spread.",tags:["disease","tomatoes","wet season","fungal disease"],location:"Central Kenya"},{id:"2",title:"Tender: Supply of Agricultural Inputs to Nakuru County",description:"Tender notice for the supply of agricultural inputs to Nakuru County",category:"tender",date:"2023-12-01",source:"Nakuru County Government",content:"The Nakuru County Government invites sealed bids from eligible candidates for the supply of agricultural inputs including certified seeds, fertilizers, and pesticides. Interested bidders must provide documentation of previous similar contracts, tax compliance, and business registration.",tags:["tender","agricultural inputs","Nakuru"],location:"Nakuru County",deadline:"2023-12-31",contact:"procurement@nakuru.go.ke",url:"https://nakuru.go.ke/tenders"},{id:"3",title:"Mobile Market Price Information System",description:"A solution that provides real-time market prices to farmers via SMS",category:"solutions",date:"2023-12-05",source:"AgriTech Innovations",content:"Our Mobile Market Price Information System allows farmers to receive daily price updates for different crops across multiple markets in Kenya. The system uses SMS to reach farmers without smartphones and works in areas with limited internet connectivity. Farmers simply send a text with their crop and location to receive current market prices, helping them make informed decisions about when and where to sell their produce.",tags:["market access","price information","SMS","technology"],location:"Nationwide"},{id:"4",title:"Drought-Resistant Maize Varieties for Eastern Kenya",description:"Information on drought-resistant maize varieties suitable for Eastern Kenya",category:"solutions",date:"2023-10-20",source:"Kenya Seed Company",content:"Eastern Kenya often experiences drought conditions that affect maize production. Several drought-resistant varieties have been developed specifically for these conditions, including KDV-1, KDV-4, and Katumani. These varieties mature early (in about 90-120 days) and can produce reasonable yields even with limited rainfall. Proper spacing and timely planting are crucial for success with these varieties.",tags:["drought","maize","Eastern Kenya","seed varieties"],location:"Eastern Kenya"},{id:"5",title:"Tender: Construction of Irrigation Infrastructure in Kitui",description:"Tender for the construction of irrigation infrastructure in Kitui County",category:"tender",date:"2023-11-25",source:"Ministry of Agriculture",content:"The Ministry of Agriculture invites tenders for the construction of irrigation infrastructure in Kitui County. The project involves construction of water intake structures, main canals, distribution networks, and farm inlets to serve approximately 2,000 hectares of farmland.",tags:["irrigation","construction","infrastructure","Kitui"],location:"Kitui County",deadline:"2024-01-15",contact:"tenders@agriculture.go.ke",url:"https://agriculture.go.ke/tenders"},{id:"6",title:"Farm-to-Market Digital Marketplace",description:"A digital platform connecting farmers directly to buyers, eliminating middlemen",category:"solutions",date:"2023-12-10",source:"Digital Farmers Network",content:"Our Farm-to-Market Digital Marketplace is transforming how farmers sell their produce by connecting them directly with buyers. The platform allows farmers to list their produce with photos and details, while buyers can browse and purchase directly. The system includes secure payment processing, delivery coordination, and quality guarantees. By eliminating traditional middlemen, farmers receive better prices and buyers get fresher produce at competitive rates.",tags:["market access","e-commerce","direct sales","middleman elimination"],location:"Nairobi, Nakuru, Kiambu, Machakos"},{id:"7",title:"Rural Produce Collection Points Network",description:"A network of rural collection centers that aggregate and store produce for efficient transportation",category:"solutions",date:"2024-01-05",source:"AgriLogistics Kenya",content:"Our Rural Produce Collection Points Network addresses one of the biggest challenges in agricultural supply chains - getting produce from remote farms to markets efficiently. We have established collection centers in strategic rural locations where farmers can bring their produce. Each center has basic quality checking equipment, weighing facilities, and temporary storage. This aggregation allows for efficient transportation in bulk to markets, reducing per-unit transport costs and ensuring produce arrives fresh and undamaged.",tags:["logistics","rural infrastructure","aggregation","transportation"],location:"Western Kenya and Rift Valley"}],Zo=async()=>{try{const s=await fetch("https://datasets-server.huggingface.co/first-rows?dataset=Olive254%2FAwardedPublicProcurementTendersKenya&config=default&split=train");if(!s.ok)throw new Error(`Failed to fetch data: ${s.status} ${s.statusText}`);return((await s.json()).rows||[]).map(r=>({tenderno:r.row.tenderno||"",tendersubject:r.row.tendersubject||"",finyrq:r.row.finyrq||"",supplier:r.row.supplier||"",supplierscore:r.row.supplierscore,supplierbid:r.row.supplierbid,contactaddress:r.row.contactaddress,contactname:r.row.contactname,contacttel:r.row.contacttel,contactemail:r.row.contactemail,awarddate:r.row.awarddate,awardedamount:r.row.awardedamount,currency:r.row.currency,procuringentity:r.row.procuringentity,procuringentitycounty:r.row.procuringentitycounty,procurementmethod:r.row.procurementmethod}))}catch(s){return console.error("Error fetching awarded tenders:",s),[]}},ed=async s=>{if(await nt(800),(s==null?void 0:s.category)==="awarded-tender")try{let r=await Zo();if(s.query){const n=s.query.toLowerCase();r=r.filter(c=>c.tendersubject.toLowerCase().includes(n)||c.supplier.toLowerCase().includes(n)||c.procuringentity&&c.procuringentity.toLowerCase().includes(n))}if(s.location){const n=s.location.toLowerCase();r=r.filter(c=>c.procuringentitycounty&&c.procuringentitycounty.toLowerCase().includes(n))}return r.map(n=>({id:n.tenderno||Math.random().toString(36).substring(2,9),title:n.tendersubject,description:`Tender awarded to ${n.supplier}`,category:"awarded-tender",date:n.awarddate||n.finyrq||new Date().toISOString().split("T")[0],source:n.procuringentity||"Kenya Public Procurement",content:`
          Tender Number: ${n.tenderno||"N/A"}
          Subject: ${n.tendersubject||"N/A"}
          Supplier: ${n.supplier||"N/A"}
          Awarded Amount: ${n.awardedamount||"N/A"} ${n.currency||"KES"}
          Award Date: ${n.awarddate||"N/A"}
          Financial Year Quarter: ${n.finyrq||"N/A"}
          Procurement Method: ${n.procurementmethod||"N/A"}
          Procuring Entity: ${n.procuringentity||"N/A"}
          County: ${n.procuringentitycounty||"N/A"}
          Contact: ${n.contactname||"N/A"}
          Contact Email: ${n.contactemail||"N/A"}
          Contact Tel: ${n.contacttel||"N/A"}
          Contact Address: ${n.contactaddress||"N/A"}
        `,tags:["awarded",n.procurementmethod||"procurement",n.procuringentitycounty||"kenya"],location:n.procuringentitycounty,contact:n.contactemail||n.contacttel}))}catch(a){return console.error("Error fetching awarded tenders:",a),[]}if(!s)return qr;let t=[...qr];if(s.category&&(t=t.filter(a=>a.category===s.category)),s.query){const a=s.query.toLowerCase();t=t.filter(r=>r.title.toLowerCase().includes(a)||r.description.toLowerCase().includes(a)||r.content.toLowerCase().includes(a))}if(s.location){const a=s.location.toLowerCase();t=t.filter(r=>{var n;return(n=r.location)==null?void 0:n.toLowerCase().includes(a)})}return s.dateFrom&&(t=t.filter(a=>new Date(a.date)>=s.dateFrom)),s.dateTo&&(t=t.filter(a=>new Date(a.date)<=s.dateTo)),t},fn=async()=>{console.log("Fetching real pricing data from Ministry of Agriculture API");const s=await $s.get("commodity-prices/",void 0,{results:[]});console.log("Received real commodity price data:",s);const t=s.results.map(a=>({id:a.id.toString(),commodity:a.commodity_name||"Unknown commodity",market:a.market_name||"Unknown market",price:parseFloat(a.price)||0,unit:a.unit||"Kg",date:a.date_recorded||new Date().toISOString().split("T")[0],county:a.county_name||"Unknown county"}));return console.log(`Successfully fetched ${t.length} real price records from Ministry API`),t};let Ke={amisPriceHistory:[],kilimoStatsHistory:[],lastUpdates:{amisPrices:"",kilimoStats:"",archive:""},countyPriceSnapshots:{},commodityPricesByCounty:{},headlines:[]};const vn=async()=>{try{console.log("Running daily job to fetch AMIS Kenya prices for all 47 counties...");const s=Date.now(),t=await fn(),a=t.map(g=>({...g,fetchDate:new Date().toISOString(),processingTime:Date.now()-s})),r={},n={};t.forEach(g=>{r[g.county]||(r[g.county]=[]),r[g.county].push(g),n[g.commodity]||(n[g.commodity]={}),n[g.commodity][g.county]||(n[g.commodity][g.county]=[]),n[g.commodity][g.county].push(g)}),Ke.amisPriceHistory.push(...a),Ke.countyPriceSnapshots=r,Ke.commodityPricesByCounty=n,Ke.lastUpdates.amisPrices=new Date().toISOString();const c=[],x=[...Object.keys(r)].sort(()=>.5-Math.random());x.slice(0,Math.min(5,x.length)).forEach(g=>{const u=r[g];if(u&&u.length>0){const d=Math.floor(Math.random()*u.length),h=u[d];c.push(`${g}: ${h.commodity} selling at KES ${h.price} per ${h.unit} at ${h.market}`)}});const j=Object.keys(r).length,N=Object.keys(n).length;return c.push(`Today's update: Prices for ${N} commodities across ${j} counties of Kenya`),Ke.headlines=c,console.log(`AMIS Kenya data fetch completed. Processed ${t.length} price records across ${j} counties.`),console.log(`Generated ${c.length} headlines`),{success:!0,recordsProcessed:t.length,countiesCovered:j,commoditiesCovered:N,executionTime:Date.now()-s,headlines:c,lastUpdate:Ke.lastUpdates.amisPrices}}catch(s){return console.error("Error in daily AMIS Kenya job:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error",lastUpdate:Ke.lastUpdates.amisPrices}}},yn=async()=>{try{console.log("Running weekly job to update Kilimo statistics...");const s=Date.now(),t=await zt(),a=t.map(c=>({...c,fetchDate:new Date().toISOString(),processingTime:Date.now()-s}));Ke.kilimoStatsHistory.push(...a),Ke.lastUpdates.kilimoStats=new Date().toISOString();const r=[...new Set(t.map(c=>c.category).filter(Boolean))],n=r.length>0?`Updated ${r.length} agricultural categories covering ${[...new Set(t.map(c=>c.county))].length} counties`:"No new Kilimo statistics available this week";return console.log(`Kilimo stats update completed. Processed ${t.length} statistical records.`),console.log(`HEADLINE: ${n}`),{success:!0,recordsProcessed:t.length,categoriesUpdated:r.length,executionTime:Date.now()-s,headline:n,lastUpdate:Ke.lastUpdates.kilimoStats}}catch(s){return console.error("Error in weekly Kilimo stats job:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error",lastUpdate:Ke.lastUpdates.kilimoStats}}},Nn=async()=>{try{console.log("Running monthly archiving job for historical data...");const s=Date.now();await nt(2e3);const t=Ke.amisPriceHistory.length,a=Ke.kilimoStatsHistory.length;Ke.lastUpdates.archive=new Date().toISOString();const r=`Monthly archive complete: Processed ${t} AMIS Kenya records and ${a} Kilimo statistics for long-term trend analysis`;return console.log(r),{success:!0,amisRecordsArchived:t,kilimoRecordsArchived:a,executionTime:Date.now()-s,headline:r,lastUpdate:Ke.lastUpdates.archive}}catch(s){return console.error("Error in monthly archiving job:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error",lastUpdate:Ke.lastUpdates.archive}}},sd=async()=>{const s={amisJob:await vn(),kilimoJob:await yn(),archiveJob:await Nn()};return console.log("All cron jobs completed:",s),s},td=async()=>{console.log("Testing data extraction from Kilimo API and AMIS Kenya...");try{console.log("Fetching data from Kilimo API...");const s=Date.now(),t=await zt(),a=Date.now()-s;console.log(`Kilimo API returned ${t.length} records in ${a}ms`),console.log("Sample Kilimo data:",t.slice(0,2)),console.log("Fetching data from AMIS Kenya...");const r=Date.now(),n=await fn(),c=Date.now()-r;return console.log(`AMIS Kenya returned ${n.length} records in ${c}ms`),console.log("Sample AMIS Kenya data:",n.slice(0,2)),{success:!0,kilimo:{recordCount:t.length,executionTime:a,sample:t.slice(0,3)},amis:{recordCount:n.length,executionTime:c,sample:n.slice(0,3)}}}catch(s){return console.error("Error during data extraction test:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error"}}},bn=async s=>{const{data:{user:t}}=await F.auth.getUser();if(!t)throw new Error("User not authenticated");const{data:a,error:r}=await F.from("market_linkages").insert({created_by:t.id,title:s.title,description:s.description,linkage_type:s.linkage_type,crops_involved:s.crops_involved,counties:s.counties,requirements:s.requirements,benefits:s.benefits,contact_info:s.contact_info,application_deadline:s.application_deadline,start_date:s.start_date,duration_months:s.duration_months,minimum_quantity:s.minimum_quantity,price_range:s.price_range,max_participants:s.max_participants}).select().single();if(r)throw r;return a},wn=async s=>{let t=F.from("market_linkages").select(`
      *,
      profiles:created_by (
        full_name,
        contact_number
      )
    `);s!=null&&s.linkage_type&&(t=t.eq("linkage_type",s.linkage_type)),s!=null&&s.county&&(t=t.contains("counties",[s.county])),s!=null&&s.crop&&(t=t.contains("crops_involved",[s.crop])),(s==null?void 0:s.activeOnly)!==!1&&(t=t.eq("status","active"));const{data:a,error:r}=await t.order("created_at",{ascending:!1});if(r)throw r;return a},ad=async s=>{const{data:t,error:a}=await F.from("market_linkages").select("participants_count").eq("id",s).single();if(a)throw a;const{data:r,error:n}=await F.from("market_linkages").update({participants_count:(t.participants_count||0)+1}).eq("id",s).select().single();if(n)throw n;return r},qe=i.forwardRef(({className:s,orientation:t="horizontal",decorative:a=!0,...r},n)=>e.jsx(Ci,{ref:n,decorative:a,orientation:t,className:$("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",s),...r}));qe.displayName=Ci.displayName;const rd=({item:s,onClose:t})=>{const a=i.useRef(null),r={agriculture:"bg-sage-500 text-white hover:bg-sage-600",tender:"bg-soil-500 text-white hover:bg-soil-600","supply-chain":"bg-blue-500 text-white hover:bg-blue-600"};i.useEffect(()=>{const c=x=>{x.key==="Escape"&&t()},l=x=>{a.current&&!a.current.contains(x.target)&&t()};return document.addEventListener("keydown",c),document.addEventListener("mousedown",l),document.body.classList.add("overflow-hidden"),()=>{document.removeEventListener("keydown",c),document.removeEventListener("mousedown",l),document.body.classList.remove("overflow-hidden")}},[t]);const n=s.content?s.content.split(/\d+\)/).filter(c=>c.trim().length>0).map((c,l)=>e.jsxs("p",{className:"mb-4",children:[l>0&&e.jsxs("span",{className:"font-medium",children:[l,")"]}),c]},l)):[e.jsx("p",{className:"mb-4",children:"No detailed content available."},"no-content")];return e.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 md:p-8 animate-fade-in",children:e.jsxs(w,{ref:a,className:"w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col shadow-xl animate-fade-up",children:[e.jsxs(q,{className:"p-6 flex flex-row justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(I,{className:(r[s.category]||"bg-secondary")+" mb-2",children:jn(s.category)}),e.jsx("h2",{className:"text-2xl font-bold",children:s.title})]}),e.jsx(b,{variant:"ghost",size:"icon",onClick:t,className:"rounded-full",children:e.jsx(Be,{className:"h-5 w-5"})})]}),e.jsx(qe,{}),e.jsx(_,{className:"p-6 flex-grow overflow-y-auto",children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"space-y-1 text-sm mb-2",children:[e.jsxs("div",{className:"flex items-center text-muted-foreground mb-2",children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Published: ",new Date(s.date).toLocaleDateString()]}),s.location&&e.jsxs("div",{className:"flex items-center text-muted-foreground mb-2",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Location: ",s.location]}),s.deadline&&e.jsxs("div",{className:"flex items-center text-amber-600 font-medium mb-2",children:[e.jsx(is,{className:"h-4 w-4 mr-2"}),"Deadline: ",s.deadline]}),s.contact&&e.jsxs("div",{className:"flex items-center text-muted-foreground mb-2",children:[e.jsx(He,{className:"h-4 w-4 mr-2"}),"Contact: ",s.contact]})]}),e.jsxs("div",{className:"bg-muted/30 p-4 rounded-lg border border-border mb-4",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Description"}),e.jsx("p",{className:"text-muted-foreground",children:s.description})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Details"}),e.jsx("div",{className:"text-foreground/90",children:n})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.tags.map((c,l)=>e.jsxs("span",{className:"text-sm px-3 py-1 rounded-full bg-secondary text-secondary-foreground",children:[e.jsx(Dt,{className:"h-3.5 w-3.5 inline mr-1.5"}),c]},l))})]})]})}),e.jsx(qe,{}),e.jsxs(me,{className:"p-6 flex justify-between items-center bg-muted/20",children:[e.jsxs("div",{className:"text-sm",children:["Source: ",e.jsx("span",{className:"font-medium",children:s.source})]}),s.url&&e.jsx(b,{variant:"outline",asChild:!0,children:e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",children:["Visit Source ",e.jsx(xs,{className:"ml-2 h-4 w-4"})]})})]})]})})},id=({activeTab:s,setActiveTab:t,hideTenderTabs:a=!1})=>e.jsx(ge,{value:s,onValueChange:r=>t(r),children:e.jsxs(pe,{className:"w-full grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2 mb-6",children:[e.jsx(B,{value:"all",className:"flex items-center gap-2",children:e.jsx("span",{children:"All"})}),e.jsxs(B,{value:"agriculture",className:"flex items-center gap-2",children:[e.jsx(dt,{className:"h-4 w-4"}),e.jsx("span",{children:"Agricultural Issues"})]}),e.jsxs(B,{value:"solutions",className:"flex items-center gap-2",children:[e.jsx(ea,{className:"h-4 w-4"}),e.jsx("span",{children:"Innovative Solutions"})]}),!a&&e.jsxs(e.Fragment,{children:[e.jsxs(B,{value:"tender",className:"flex items-center gap-2",children:[e.jsx(yl,{className:"h-4 w-4"}),e.jsx("span",{children:"Tender Opportunities"})]}),e.jsxs(B,{value:"awarded-tender",className:"flex items-center gap-2",children:[e.jsx(Ps,{className:"h-4 w-4"}),e.jsx("span",{children:"Awarded Tenders"})]})]})]})}),nd=bl,ld=wl,_n=i.forwardRef(({className:s,align:t="center",sideOffset:a=4,...r},n)=>e.jsx(Nl,{children:e.jsx(ki,{ref:n,align:t,sideOffset:a,className:$("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r})}));_n.displayName=ki.displayName;function za({className:s,classNames:t,showOutsideDays:a=!0,...r}){return e.jsx(_l,{showOutsideDays:a,className:$("p-3",s),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:$(qt({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:$(qt({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({...n})=>e.jsx(Ga,{className:"h-4 w-4"}),IconRight:({...n})=>e.jsx(ft,{className:"h-4 w-4"})},...r})}za.displayName="Calendar";const cd=({location:s,setLocation:t,dateFrom:a,setDateFrom:r,dateTo:n,setDateTo:c,isFiltersOpen:l,setIsFiltersOpen:x,handleSearch:f})=>{const j=()=>{t(""),r(void 0),c(void 0),x(!1)};return e.jsxs(nd,{open:l,onOpenChange:x,children:[e.jsx(ld,{asChild:!0,children:e.jsxs(b,{variant:"outline",className:"md:w-auto w-full",children:[e.jsx(It,{className:"mr-2 h-4 w-4"}),"Filters",(s||a||n)&&e.jsx("span",{className:"ml-2 inline-flex h-5 w-5 items-center justify-center rounded-full bg-primary text-[10px] text-primary-foreground",children:[s,a,n].filter(Boolean).length})]})}),e.jsx(_n,{className:"w-80",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Filter Results"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"location",children:"Location"}),e.jsx(D,{id:"location",placeholder:"e.g. Nairobi, Nakuru...",value:s,onChange:N=>t(N.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Date Range"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"date-from",className:"text-xs",children:"From"}),e.jsx(za,{mode:"single",selected:a,onSelect:r,className:"border rounded-md"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"date-to",className:"text-xs",children:"To"}),e.jsx(za,{mode:"single",selected:n,onSelect:c,className:"border rounded-md"})]})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(b,{variant:"outline",size:"sm",onClick:j,className:"text-sm",children:[e.jsx(Be,{className:"mr-1 h-4 w-4"}),"Clear"]}),e.jsx(b,{size:"sm",onClick:()=>{x(!1),f()},className:"text-sm",children:"Apply Filters"})]})]})})]})},od=({query:s,setQuery:t,location:a,setLocation:r,dateFrom:n,setDateFrom:c,dateTo:l,setDateTo:x,isFiltersOpen:f,setIsFiltersOpen:j,handleSearch:N})=>e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx(Pe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-5 w-5"}),e.jsx(D,{placeholder:"Search for keywords...",value:s,onChange:g=>t(g.target.value),onKeyDown:g=>g.key==="Enter"&&N(),className:"pl-10"})]}),e.jsx(cd,{location:a,setLocation:r,dateFrom:n,setDateFrom:c,dateTo:l,setDateTo:x,isFiltersOpen:f,setIsFiltersOpen:j,handleSearch:N}),e.jsxs(b,{onClick:N,className:"md:w-auto w-full",children:[e.jsx(Pe,{className:"mr-2 h-4 w-4"}),"Search"]})]}),dd=({item:s,onClick:t})=>{const{toast:a}=Z(),r={agriculture:"bg-sage-100 text-sage-800 hover:bg-sage-200",tender:"bg-soil-100 text-soil-800 hover:bg-soil-200",solutions:"bg-blue-100 text-blue-800 hover:bg-blue-200","awarded-tender":"bg-amber-100 text-amber-800 hover:bg-amber-200"},n=(f,j)=>f?f.length<=j?f:f.substring(0,j)+"...":"",c=f=>{f.stopPropagation(),(!s.url||!l(s.url))&&(f.preventDefault(),a({title:"Invalid Link",description:"This URL cannot be verified or is invalid.",variant:"destructive"}))};function l(f){try{const j=new URL(f);return j.protocol==="http:"||j.protocol==="https:"}catch{return!1}}const x=f=>{if(!f)return"No source URL";try{return new URL(f).hostname}catch{return"Invalid URL"}};return e.jsxs(w,{className:"overflow-hidden transition-all duration-300 hover:shadow-md border border-border group animate-fade-in",children:[e.jsxs(_,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx(I,{className:r[s.category]||"bg-secondary",children:jn(s.category)}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(xe,{className:"h-3.5 w-3.5 mr-1"}),new Date(s.date).toLocaleDateString()]})]}),e.jsx("h3",{className:"text-xl font-semibold mb-2 group-hover:text-primary transition-colors",children:s.title}),e.jsx("p",{className:"text-muted-foreground mb-4 line-clamp-3",children:s.description}),s.location&&e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground mb-2",children:[e.jsx(ee,{className:"h-3.5 w-3.5 mr-1.5"}),s.location]}),s.deadline&&e.jsxs("div",{className:"text-sm font-medium mb-2",children:["Deadline: ",e.jsx("span",{className:"text-amber-600",children:s.deadline})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[s.tags.slice(0,3).map((f,j)=>e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-secondary text-secondary-foreground",children:f},j)),s.tags.length>3&&e.jsxs("span",{className:"text-xs px-2 py-1 rounded-full bg-secondary text-secondary-foreground",children:["+",s.tags.length-3," more"]})]})]}),e.jsxs(me,{className:"px-6 py-4 bg-muted/30 flex justify-between items-center",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:s.url?e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",onClick:c,className:"flex items-center hover:underline",children:[x(s.url),e.jsx(xs,{className:"h-3 w-3 ml-1"})]}):e.jsxs("span",{children:["Source: ",n(s.source||"Unknown",30)]})}),e.jsx(b,{size:"sm",onClick:t,children:"View Details"})]})]})},md=({results:s,isLoading:t,activeTab:a,onItemClick:r})=>{if(t)return e.jsx("div",{className:"flex justify-center items-center py-20",children:e.jsx(As,{className:"h-10 w-10 text-primary animate-spin"})});if(s.length===0)return e.jsxs("div",{className:"text-center py-16",children:[e.jsx("h3",{className:"text-xl font-medium mb-2",children:"No results found"}),e.jsx("p",{className:"text-muted-foreground",children:"Try adjusting your search or filters to find what you're looking for."})]});const n=s.filter(c=>!c.url||!ud(c.url)?(console.warn(`Filtering out result with invalid URL: ${c.title}`),!1):!0);return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-3 text-muted-foreground",children:["Found ",n.length," ",a!=="all"?a:"results"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:n.map(c=>e.jsx(dd,{item:c,onClick:()=>r(c)},c.id))})]})};function ud(s){try{const t=new URL(s);return t.protocol==="http:"||t.protocol==="https:"}catch{return!1}}const xd=({id:s})=>{const[t,a]=i.useState("solutions"),[r,n]=i.useState(""),[c,l]=i.useState(""),[x,f]=i.useState(void 0),[j,N]=i.useState(void 0),[g,u]=i.useState(!1),[d,h]=i.useState([]),[v,p]=i.useState(!1),[m,o]=i.useState(null),{toast:y}=Z(),k=async()=>{u(!0);const E={query:r.trim()===""?void 0:r,location:c.trim()===""?void 0:c,dateFrom:x,dateTo:j};t!=="all"&&(E.category=t);try{const P=await ed(E);let R=P.filter(M=>M.category!=="tender"&&M.category!=="awarded-tender");R=R.filter(M=>M.url&&!Yo(M.url)?(console.warn(`Filtered item with unverified URL: ${M.title}`),!1):Qo(M)?!0:(console.warn(`Filtered possibly illegitimate content: ${M.title}`),!1)),console.log(`Showing ${R.length} verified results out of ${P.length} total results`),R.length===0&&P.length>0&&y({title:"Verification Results",description:"Some results were filtered out because they could not be verified with legitimate sources.",duration:5e3}),h(R)}catch(P){console.error("Error fetching data:",P),y({title:"Search Error",description:"Could not complete search. Please try again later.",variant:"destructive"}),h([])}finally{u(!1)}};i.useEffect(()=>{k()},[t]);const A=E=>{o(E)},S=()=>{o(null)};return e.jsxs("section",{id:s||"search-section",className:"py-20 px-6 md:px-12 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-12 animate-fade-up",children:[e.jsx("div",{className:"inline-block px-3 py-1 rounded-full bg-secondary text-secondary-foreground text-sm font-medium mb-2",children:"Search & Discover"}),e.jsx("h2",{className:"text-3xl md:text-4xl font-bold mb-4",children:"Find Agricultural Information"}),e.jsx("p",{className:"text-lg text-foreground/80 max-w-3xl mx-auto",children:"Search across verified agricultural issues and innovative solutions throughout Kenya."})]}),e.jsxs(w,{className:"p-6 rounded-xl shadow-sm bg-white/80 dark:bg-gray-900/80 backdrop-blur-md border border-border",children:[e.jsx(id,{activeTab:t,setActiveTab:a,hideTenderTabs:!0}),e.jsx(od,{query:r,setQuery:n,location:c,setLocation:l,dateFrom:x,setDateFrom:f,dateTo:j,setDateTo:N,isFiltersOpen:v,setIsFiltersOpen:p,handleSearch:k}),e.jsx(md,{results:d,isLoading:g,activeTab:t,onItemClick:A})]}),m&&e.jsx(rd,{item:m,onClose:S})]})},hd=[{icon:vt,label:"Home",href:"/"},{icon:rs,label:"Marketplace",href:"/marketplace"},{icon:ce,label:"Prices",href:"/price-trends"},{icon:Mt,label:"Bluetooth",href:"/bluetooth-marketplace"},{icon:Ue,label:"Community",href:"/community-forums"},{icon:ee,label:"Logistics",href:"/logistics"},{icon:se,label:"Traders",href:"/service-providers"},{icon:vs,label:"Profile",href:"/profile"},{icon:la,label:"More",href:"/more"}];function Gs(){const s=Es();return e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-background border-t border-border z-50 md:hidden",children:e.jsx("div",{className:"grid grid-cols-5 gap-1 p-2",children:hd.slice(0,5).map(t=>{const a=t.icon,r=s.pathname===t.href;return e.jsxs(X,{to:t.href,className:$("flex flex-col items-center justify-center py-2 px-1 rounded-md transition-colors min-h-[60px]",r?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground hover:bg-accent"),children:[e.jsx(a,{className:"h-5 w-5 mb-1"}),e.jsx("span",{className:"text-xs font-medium",children:t.label})]},t.href)})})})}const pd=()=>{const[s,t]=i.useState(null),[a,r]=i.useState(!1);i.useEffect(()=>{const l=x=>{x.preventDefault(),t(x),r(!0)};return window.addEventListener("beforeinstallprompt",l),()=>{window.removeEventListener("beforeinstallprompt",l)}},[]);const n=async()=>{if(!s)return;s.prompt();const{outcome:l}=await s.userChoice;l==="accepted"&&(t(null),r(!1))},c=()=>{r(!1)};return!a||!s?null:e.jsxs(w,{className:"fixed bottom-4 right-4 w-80 z-50 shadow-lg",children:[e.jsxs(q,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(L,{className:"text-lg flex items-center gap-2",children:[e.jsx(ca,{className:"h-5 w-5"}),"Install AgriConnect"]}),e.jsx(b,{variant:"ghost",size:"sm",onClick:c,className:"h-8 w-8 p-0",children:e.jsx(Be,{className:"h-4 w-4"})})]}),e.jsx(G,{children:"Install our app for offline access and better performance"})]}),e.jsx(_,{className:"pt-0",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{onClick:n,className:"flex-1",children:"Install App"}),e.jsx(b,{variant:"outline",onClick:c,children:"Not Now"})]})})]})},gd=()=>e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(ne,{}),e.jsx(Ro,{}),e.jsx(xd,{}),e.jsx("section",{className:"lg:hidden bg-background border-b",children:e.jsx("div",{className:"container mx-auto px-4 py-4",children:e.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[e.jsxs(X,{to:"/farm-input-marketplace",className:"flex flex-col items-center gap-2 p-3 rounded-lg bg-primary/5 hover:bg-primary/10 transition-colors",children:[e.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx(Re,{className:"h-5 w-5 text-primary"})}),e.jsx("span",{className:"text-xs font-medium text-center",children:"Marketplace"})]}),e.jsxs(X,{to:"/service-providers",className:"flex flex-col items-center gap-2 p-3 rounded-lg bg-primary/5 hover:bg-primary/10 transition-colors",children:[e.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx(se,{className:"h-5 w-5 text-primary"})}),e.jsx("span",{className:"text-xs font-medium text-center",children:"Services"})]}),e.jsxs(X,{to:"/commodity-trading",className:"flex flex-col items-center gap-2 p-3 rounded-lg bg-primary/5 hover:bg-primary/10 transition-colors",children:[e.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx(ce,{className:"h-5 w-5 text-primary"})}),e.jsx("span",{className:"text-xs font-medium text-center",children:"Trading"})]}),e.jsxs(X,{to:"/community-forum",className:"flex flex-col items-center gap-2 p-3 rounded-lg bg-primary/5 hover:bg-primary/10 transition-colors",children:[e.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx(se,{className:"h-5 w-5 text-primary"})}),e.jsx("span",{className:"text-xs font-medium text-center",children:"Community"})]})]})})}),e.jsx("section",{className:"py-8 bg-gradient-to-r from-primary/5 to-primary/10",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Real-time Market Data"}),e.jsx("p",{className:"text-muted-foreground",children:"Live prices and trends"})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(w,{className:"text-center bg-background/80 backdrop-blur",children:e.jsxs(_,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:"$2.40"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Maize/kg"}),e.jsx("div",{className:"text-xs text-green-600",children:"+5.2%"})]})}),e.jsx(w,{className:"text-center bg-background/80 backdrop-blur",children:e.jsxs(_,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:"$3.20"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Beans/kg"}),e.jsx("div",{className:"text-xs text-green-600",children:"+2.1%"})]})}),e.jsx(w,{className:"text-center bg-background/80 backdrop-blur",children:e.jsxs(_,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:"$1.80"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Rice/kg"}),e.jsx("div",{className:"text-xs text-red-600",children:"-1.3%"})]})}),e.jsx(w,{className:"text-center bg-background/80 backdrop-blur",children:e.jsxs(_,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:"$4.50"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Coffee/kg"}),e.jsx("div",{className:"text-xs text-green-600",children:"+8.7%"})]})})]}),e.jsx("div",{className:"text-center mt-4",children:e.jsx(X,{to:"/kilimo-ams-data",children:e.jsx(b,{variant:"outline",size:"sm",children:"View All Markets"})})})]})}),e.jsx("section",{className:"py-12 bg-muted/30",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl lg:text-3xl font-bold mb-4",children:"Platform Features"}),e.jsx("p",{className:"text-muted-foreground",children:"Everything you need for agricultural success"})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:[e.jsxs(w,{className:"text-center hover:shadow-md transition-shadow",children:[e.jsxs(q,{className:"pb-3",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-2",children:e.jsx(Re,{className:"h-6 w-6 text-primary"})}),e.jsx(L,{className:"text-sm lg:text-base",children:"Farm Inputs"})]}),e.jsx(_,{className:"pt-0",children:e.jsx(X,{to:"/farm-input-marketplace",children:e.jsx(b,{size:"sm",className:"w-full text-xs",children:"Shop Now"})})})]}),e.jsxs(w,{className:"text-center hover:shadow-md transition-shadow",children:[e.jsxs(q,{className:"pb-3",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-2",children:e.jsx(Ts,{className:"h-6 w-6 text-primary"})}),e.jsx(L,{className:"text-sm lg:text-base",children:"Equipment"})]}),e.jsx(_,{className:"pt-0",children:e.jsx(X,{to:"/equipment-marketplace",children:e.jsx(b,{size:"sm",className:"w-full text-xs",children:"Browse"})})})]}),e.jsxs(w,{className:"text-center hover:shadow-md transition-shadow",children:[e.jsxs(q,{className:"pb-3",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-2",children:e.jsx(Ae,{className:"h-6 w-6 text-primary"})}),e.jsx(L,{className:"text-sm lg:text-base",children:"Trading"})]}),e.jsx(_,{className:"pt-0",children:e.jsx(X,{to:"/commodity-trading",children:e.jsx(b,{size:"sm",className:"w-full text-xs",children:"Trade"})})})]}),e.jsxs(w,{className:"text-center hover:shadow-md transition-shadow",children:[e.jsxs(q,{className:"pb-3",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-2",children:e.jsx(ye,{className:"h-6 w-6 text-primary"})}),e.jsx(L,{className:"text-sm lg:text-base",children:"Logistics"})]}),e.jsx(_,{className:"pt-0",children:e.jsx(X,{to:"/logistics",children:e.jsx(b,{size:"sm",className:"w-full text-xs",children:"Find Transport"})})})]}),e.jsxs(w,{className:"text-center hover:shadow-md transition-shadow",children:[e.jsxs(q,{className:"pb-3",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-2",children:e.jsx(ee,{className:"h-6 w-6 text-primary"})}),e.jsx(L,{className:"text-sm lg:text-base",children:"City Markets"})]}),e.jsx(_,{className:"pt-0",children:e.jsx(X,{to:"/city-markets",children:e.jsx(b,{size:"sm",className:"w-full text-xs",children:"View Markets"})})})]}),e.jsxs(w,{className:"text-center hover:shadow-md transition-shadow",children:[e.jsxs(q,{className:"pb-3",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-2",children:e.jsx(dt,{className:"h-6 w-6 text-primary"})}),e.jsx(L,{className:"text-sm lg:text-base",children:"Farming Portal"})]}),e.jsx(_,{className:"pt-0",children:e.jsx(X,{to:"/farmer-portal",children:e.jsx(b,{size:"sm",className:"w-full text-xs",children:"Start Farming"})})})]}),e.jsxs(w,{className:"text-center hover:shadow-md transition-shadow",children:[e.jsxs(q,{className:"pb-3",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-2",children:e.jsx(Mt,{className:"h-6 w-6 text-primary"})}),e.jsx(L,{className:"text-sm lg:text-base",children:"Bluetooth Market"})]}),e.jsx(_,{className:"pt-0",children:e.jsx(X,{to:"/bluetooth-marketplace",children:e.jsx(b,{size:"sm",className:"w-full text-xs",children:"Connect"})})})]}),e.jsxs(w,{className:"text-center hover:shadow-md transition-shadow",children:[e.jsxs(q,{className:"pb-3",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-2",children:e.jsx(re,{className:"h-6 w-6 text-primary"})}),e.jsx(L,{className:"text-sm lg:text-base",children:"Supply Chain"})]}),e.jsx(_,{className:"pt-0",children:e.jsx(X,{to:"/supply-chain-dashboard",children:e.jsx(b,{size:"sm",className:"w-full text-xs",children:"Track"})})})]})]})]})}),e.jsx("section",{className:"py-12",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Service Providers"}),e.jsx("p",{className:"text-muted-foreground",children:"Professional agricultural services"})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(w,{className:"text-center hover:shadow-md transition-shadow",children:[e.jsxs(q,{className:"pb-3",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mb-2",children:e.jsx(Cl,{className:"h-6 w-6 text-red-500"})}),e.jsx(L,{className:"text-sm",children:"Veterinary Services"})]}),e.jsx(_,{className:"pt-0",children:e.jsx(X,{to:"/veterinary-services",children:e.jsx(b,{variant:"outline",size:"sm",className:"w-full text-xs",children:"Find Vets"})})})]}),e.jsxs(w,{className:"text-center hover:shadow-md transition-shadow",children:[e.jsxs(q,{className:"pb-3",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mb-2",children:e.jsx(Si,{className:"h-6 w-6 text-green-600"})}),e.jsx(L,{className:"text-sm",children:"Feed & Nutrition"})]}),e.jsx(_,{className:"pt-0",children:e.jsx(X,{to:"/feed-nutrition",children:e.jsx(b,{variant:"outline",size:"sm",className:"w-full text-xs",children:"Get Advice"})})})]}),e.jsxs(w,{className:"text-center hover:shadow-md transition-shadow",children:[e.jsxs(q,{className:"pb-3",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center mb-2",children:e.jsx(Zs,{className:"h-6 w-6 text-orange-600"})}),e.jsx(L,{className:"text-sm",children:"Farm Construction"})]}),e.jsx(_,{className:"pt-0",children:e.jsx(X,{to:"/farm-construction",children:e.jsx(b,{variant:"outline",size:"sm",className:"w-full text-xs",children:"Build"})})})]}),e.jsxs(w,{className:"text-center hover:shadow-md transition-shadow",children:[e.jsxs(q,{className:"pb-3",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mb-2",children:e.jsx(Pi,{className:"h-6 w-6 text-purple-600"})}),e.jsx(L,{className:"text-sm",children:"Consultancies"})]}),e.jsx(_,{className:"pt-0",children:e.jsx(X,{to:"/consultancies",children:e.jsx(b,{variant:"outline",size:"sm",className:"w-full text-xs",children:"Consult"})})})]})]}),e.jsx("div",{className:"text-center mt-6",children:e.jsx(X,{to:"/service-providers",children:e.jsx(b,{children:"View All Service Providers"})})})]})}),e.jsx("section",{className:"py-8 bg-muted/20",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs(w,{className:"text-center hover:shadow-md transition-shadow",children:[e.jsxs(q,{className:"pb-3",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-pink-100 rounded-full flex items-center justify-center mb-2",children:e.jsx(We,{className:"h-6 w-6 text-pink-500"})}),e.jsx(L,{className:"text-sm",children:"Donations"})]}),e.jsx(_,{className:"pt-0",children:e.jsx(X,{to:"/donation-list",children:e.jsx(b,{variant:"outline",size:"sm",className:"w-full text-xs",children:"View"})})})]}),e.jsxs(w,{className:"text-center hover:shadow-md transition-shadow",children:[e.jsxs(q,{className:"pb-3",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mb-2",children:e.jsx(qa,{className:"h-6 w-6 text-green-500"})}),e.jsx(L,{className:"text-sm",children:"Food Rescue"})]}),e.jsx(_,{className:"pt-0",children:e.jsx(X,{to:"/food-rescue-dashboard",children:e.jsx(b,{variant:"outline",size:"sm",className:"w-full text-xs",children:"Rescue"})})})]}),e.jsxs(w,{className:"text-center hover:shadow-md transition-shadow",children:[e.jsxs(q,{className:"pb-3",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center mb-2",children:e.jsx(Ai,{className:"h-6 w-6 text-yellow-600"})}),e.jsx(L,{className:"text-sm",children:"Auctions"})]}),e.jsx(_,{className:"pt-0",children:e.jsx(X,{to:"/agent-product-auction-dashboard",children:e.jsx(b,{variant:"outline",size:"sm",className:"w-full text-xs",children:"Bid"})})})]}),e.jsxs(w,{className:"text-center hover:shadow-md transition-shadow",children:[e.jsxs(q,{className:"pb-3",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mb-2",children:e.jsx(Re,{className:"h-6 w-6 text-blue-500"})}),e.jsx(L,{className:"text-sm",children:"Analytics"})]}),e.jsx(_,{className:"pt-0",children:e.jsx(X,{to:"/sentiment-analysis",children:e.jsx(b,{variant:"outline",size:"sm",className:"w-full text-xs",children:"Analyze"})})})]}),e.jsxs(w,{className:"text-center hover:shadow-md transition-shadow",children:[e.jsxs(q,{className:"pb-3",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-emerald-100 rounded-full flex items-center justify-center mb-2",children:e.jsx(Ae,{className:"h-6 w-6 text-emerald-600"})}),e.jsx(L,{className:"text-sm",children:"Buy Requests"})]}),e.jsx(_,{className:"pt-0",children:e.jsx(X,{to:"/buy-requests",children:e.jsx(b,{variant:"outline",size:"sm",className:"w-full text-xs",children:"Request"})})})]})]})})}),e.jsx(Ho,{}),e.jsx(pd,{}),e.jsx(Nt,{}),e.jsx(Gs,{}),e.jsx("div",{className:"pb-20 md:pb-0"})]}),jd=({slotName:s,className:t="",variant:a="inline"})=>{const[r,n]=i.useState([]),[c,l]=i.useState(0),[x,f]=i.useState(!0),j=Ne();i.useEffect(()=>{N()},[s]),i.useEffect(()=>{if(r.length<=1)return;const d=setInterval(()=>{l(h=>(h+1)%r.length)},5e3);return()=>clearInterval(d)},[r.length]);const N=async()=>{try{const{data:d}=await F.from("ad_placements").select("id").eq("slot_name",s).eq("is_active",!0).single();if(!d){f(!1);return}const{data:h}=await F.from("ad_slot_assignments").select("advertisement_id, display_order").eq("slot_id",d.id).eq("is_active",!0).order("display_order");if(!h||h.length===0){f(!1);return}const v=h.map(m=>m.advertisement_id),{data:p}=await F.from("business_advertisements").select("id, title, description, image_url, business_name, business_category, cta_text, cta_link").in("id",v).eq("is_active",!0).eq("payment_status","paid");p&&(n(p),p.forEach(m=>{F.from("business_advertisements").select("views_count").eq("id",m.id).single().then(({data:o})=>{o&&F.from("business_advertisements").update({views_count:(o.views_count||0)+1}).eq("id",m.id).then(()=>{})})}))}catch(d){console.error("Error loading ads:",d)}finally{f(!1)}},g=async d=>{const{data:h}=await F.from("business_advertisements").select("clicks_count").eq("id",d.id).single();h&&await F.from("business_advertisements").update({clicks_count:(h.clicks_count||0)+1}).eq("id",d.id),d.cta_link&&(d.cta_link.startsWith("http")?window.open(d.cta_link,"_blank"):j(d.cta_link))};if(x||r.length===0)return null;const u=r[c];return a==="compact"?e.jsx("div",{className:`relative ${t}`,children:e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-accent/30 rounded-lg border border-accent",children:[e.jsxs(I,{variant:"outline",className:"text-xs shrink-0 gap-1",children:[e.jsx(Xs,{className:"h-3 w-3"}),"Ad"]}),e.jsx("span",{className:"text-sm font-medium truncate",children:u.title}),e.jsx(b,{size:"sm",variant:"ghost",className:"ml-auto shrink-0 text-xs",onClick:()=>g(u),children:"Learn More"})]})}):e.jsxs("div",{className:`relative ${t}`,children:[e.jsx(w,{className:"overflow-hidden cursor-pointer hover:shadow-lg transition-shadow border-2 border-yellow-400/50",onClick:()=>g(u),children:e.jsxs("div",{className:"flex flex-col md:flex-row",children:[u.image_url&&e.jsx("div",{className:"md:w-1/3 h-40 md:h-auto",children:e.jsx("img",{src:u.image_url,alt:u.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:`p-4 flex-1 ${u.image_url?"":"w-full"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs(I,{variant:"secondary",className:"text-xs gap-1 bg-yellow-100 text-yellow-800",children:[e.jsx(Xs,{className:"h-3 w-3"}),"Sponsored"]}),e.jsx(I,{variant:"outline",className:"text-xs",children:u.business_category})]}),e.jsx("h3",{className:"font-bold text-lg mb-1",children:u.title}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2 line-clamp-2",children:u.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:["by ",u.business_name]}),u.cta_text&&e.jsx(b,{size:"sm",variant:"default",children:u.cta_text})]})]})]})}),r.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 left-1 z-10",children:e.jsx(b,{size:"icon",variant:"ghost",className:"h-8 w-8 bg-background/80 backdrop-blur-sm",onClick:d=>{d.stopPropagation(),l(h=>(h-1+r.length)%r.length)},children:e.jsx(Ga,{className:"h-4 w-4"})})}),e.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 right-1 z-10",children:e.jsx(b,{size:"icon",variant:"ghost",className:"h-8 w-8 bg-background/80 backdrop-blur-sm",onClick:d=>{d.stopPropagation(),l(h=>(h+1)%r.length)},children:e.jsx(ft,{className:"h-4 w-4"})})}),e.jsx("div",{className:"flex justify-center gap-1.5 mt-2",children:r.map((d,h)=>e.jsx("button",{className:`h-1.5 rounded-full transition-all ${h===c?"w-6 bg-primary":"w-1.5 bg-muted-foreground/30"}`,onClick:()=>l(h)},h))})]})]})},fd="/assets/marketplace-hero-bg-Ct-jHc_V.jpg",vd=()=>{const s=Ne(),t=[{title:"Farm Input Marketplace",description:"Quality agricultural inputs from verified suppliers",icon:e.jsx(re,{className:"h-8 w-8 text-primary"}),route:"/farm-input-marketplace",features:["Verified Suppliers","Quality Guarantee","Bulk Discounts","Fast Delivery"],stats:{suppliers:"500+",products:"2,000+"}},{title:"Agricultural Marketplace",description:"Buy and sell produce, livestock, and agricultural products",icon:e.jsx(Ge,{className:"h-8 w-8 text-primary"}),route:"/agricultural-marketplace",features:["Fresh Produce","Livestock Trading","Direct Farm Sales","Price Transparency"],stats:{farmers:"2,000+",listings:"5,000+"}},{title:"Bulk Orders",description:"Organize group purchases for better prices",icon:e.jsx(se,{className:"h-8 w-8 text-primary"}),route:"/bulk-orders",features:["Group Buying","Volume Discounts","Shared Logistics","Community Orders"],stats:{orders:"300+",savings:"30%"}},{title:"City Markets",description:"Connect with local city and county markets",icon:e.jsx(ee,{className:"h-8 w-8 text-primary"}),route:"/city-markets",features:["Local Markets","Market Info","Trading Hours","Location Services"],stats:{markets:"150+",counties:"47"}}],a=[{title:"Post a Listing",description:"Sell your produce to buyers nationwide",icon:e.jsx(Ge,{className:"h-6 w-6"}),action:()=>s("/create-listing")},{title:"Find Suppliers",description:"Source quality inputs for your farm",icon:e.jsx(re,{className:"h-6 w-6"}),action:()=>s("/farm-input-marketplace")},{title:"Join Bulk Order",description:"Save money through group purchases",icon:e.jsx(se,{className:"h-6 w-6"}),action:()=>s("/bulk-orders")},{title:"Track Shipment",description:"Monitor your orders and deliveries",icon:e.jsx(ye,{className:"h-6 w-6"}),action:()=>s("/logistics-optimization")}];return e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),e.jsx("section",{className:"relative text-white py-20",style:{backgroundImage:`linear-gradient(rgba(22, 101, 52, 0.85), rgba(22, 101, 52, 0.75)), url(${fd})`,backgroundSize:"cover",backgroundPosition:"center"},children:e.jsxs("div",{className:"container mx-auto px-4 text-center relative z-10",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-6",children:"Agricultural Marketplace"}),e.jsx("p",{className:"text-xl mb-8 max-w-3xl mx-auto opacity-90",children:"Your one-stop platform for buying, selling, and trading agricultural products, equipment, and services across Kenya and beyond."}),e.jsx("div",{className:"flex justify-center gap-4",children:e.jsxs(b,{size:"lg",variant:"secondary",onClick:()=>s("/auth"),children:[e.jsx(rs,{className:"h-4 w-4 mr-2"}),"Start Trading"]})})]})}),e.jsx("div",{className:"container mx-auto px-4 py-4",children:e.jsx(jd,{slotName:"marketplace_between_sections",className:"mb-2"})}),e.jsx("div",{className:"container mx-auto px-4",children:e.jsx("div",{className:"h-1.5 bg-yellow-400 rounded-full"})}),e.jsxs("div",{className:"container mx-auto px-4 py-16",children:[e.jsxs("section",{className:"mb-16",children:[e.jsx("h2",{className:"text-3xl font-bold text-center mb-8",children:"Quick Actions"}),e.jsx("div",{className:"grid md:grid-cols-4 gap-6",children:a.map((r,n)=>e.jsx(w,{className:"hover:shadow-lg transition-shadow cursor-pointer",onClick:r.action,children:e.jsxs(_,{className:"p-6 text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"p-3 bg-primary/10 rounded-full",children:r.icon})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:r.title}),e.jsx("p",{className:"text-muted-foreground text-sm",children:r.description})]})},n))})]}),e.jsxs("section",{className:"mb-16",children:[e.jsx("h2",{className:"text-3xl font-bold text-center mb-12",children:"Core Marketplaces"}),e.jsx("div",{className:"grid lg:grid-cols-2 gap-8",children:t.map((r,n)=>e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(q,{children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:r.icon}),e.jsxs("div",{children:[e.jsx(L,{className:"text-xl",children:r.title}),e.jsx("p",{className:"text-muted-foreground mt-1",children:r.description})]})]})})}),e.jsxs(_,{children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm mb-2",children:"Features"}),e.jsx("div",{className:"space-y-2",children:r.features.map((c,l)=>e.jsx(I,{variant:"outline",className:"mr-2",children:c},l))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm mb-2",children:"Stats"}),e.jsx("div",{className:"space-y-1 text-sm text-muted-foreground",children:Object.entries(r.stats).map(([c,l])=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"capitalize",children:[c,":"]}),e.jsx("span",{className:"font-medium",children:l})]},c))})]})]}),e.jsxs(b,{className:"w-full",onClick:()=>s(r.route),children:["Explore ",r.title,e.jsx(ks,{className:"h-4 w-4 ml-2"})]})]})]},n))})]}),e.jsxs("section",{className:"mb-16 bg-muted/30 rounded-lg p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Market Insights"}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"Stay informed with real-time market data and trends"})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl font-bold text-primary mb-2",children:"KES 2.5B+"}),e.jsx("div",{className:"text-muted-foreground",children:"Total Trade Value"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl font-bold text-primary mb-2",children:"150K+"}),e.jsx("div",{className:"text-muted-foreground",children:"Active Listings"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl font-bold text-primary mb-2",children:"95%"}),e.jsx("div",{className:"text-muted-foreground",children:"Successful Transactions"})]})]})]}),e.jsx("section",{className:"text-center",children:e.jsx(w,{className:"bg-primary text-primary-foreground",children:e.jsxs(_,{className:"pt-8 pb-8",children:[e.jsx(ce,{className:"h-12 w-12 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Ready to Start Trading?"}),e.jsx("p",{className:"text-lg mb-6 opacity-90",children:"Join thousands of farmers and suppliers already trading on SokoConnect"}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsxs(b,{variant:"secondary",size:"lg",onClick:()=>s("/auth"),children:[e.jsx(rs,{className:"h-4 w-4 mr-2"}),"Create Account"]}),e.jsx(b,{variant:"outline",size:"lg",className:"bg-transparent border-primary-foreground text-primary-foreground hover:bg-primary-foreground hover:text-primary",onClick:()=>s("/market-insights"),children:"View Market Data"})]})]})})})]}),e.jsx(Nt,{})]})},Za=i.forwardRef(({className:s,value:t,...a},r)=>e.jsx(Ti,{ref:r,className:$("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...a,children:e.jsx(kl,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Za.displayName=Ti.displayName;const _s=({marketplaceType:s,onAccept:t})=>{const[a,r]=i.useState(!0),[n,c]=i.useState(!1),x={equipment:{title:"âš ï¸ Equipment Marketplace - Important Disclaimer",content:[{title:"1. Buyer Responsibility",text:"Always inspect equipment BEFORE purchase or rental. Verify seller credentials and business registration."},{title:"2. Payment Security",text:"NEVER send money before inspecting equipment. Use secure payment methods. Meet sellers in public places only."},{title:"3. Equipment Verification",text:"Verify equipment serial numbers, ownership documents, and that there are no outstanding loans on the equipment."},{title:"4. Warranties & Insurance",text:"Confirm warranty coverage in writing. Verify insurance for rental/lease equipment. Get signed agreements."},{title:"5. Seller Verification",text:"Check seller ratings, reviews, and credentials. Ask for references. Report suspicious sellers immediately."},{title:"6. Safety Standards",text:"Verify equipment meets Kenya safety standards. Get training if needed. Ensure proper maintenance records."},{title:"7. Platform Liability",text:"SokoConnect is a marketplace platform only. We are NOT responsible for: equipment condition, ownership disputes, transaction failures, accidents, or damages."}]},"farm-inputs":{title:"âš ï¸ Farm Inputs Marketplace - Important Disclaimer",content:[{title:"1. Product Quality",text:"Inspect products BEFORE payment. Check packaging, expiry dates, and seals are intact."},{title:"2. Certifications",text:"Verify product certifications with relevant authorities (KEBS, PCPB). Ask for proof of certification."},{title:"3. Supplier Verification",text:"Check supplier ratings, business registration, and operating license. Request verifiable credentials."},{title:"4. Product Storage",text:"Store products per manufacturer specifications. Keep proof of purchase and quality reports."},{title:"5. Organic Products",text:"For organic claims, request certification numbers. Verify with certifying bodies independently."},{title:"6. Legal Compliance",text:"Ensure products comply with Kenya Food and Drug Authority (KFDA) and agricultural regulations."},{title:"7. Platform Liability",text:"SokoConnect is NOT responsible for: product defects, contamination, expired stock, false certifications, or crop failures resulting from product use."}]},"city-markets":{title:"âš ï¸ City Markets - Important Disclaimer",content:[{title:"1. Information Accuracy",text:"Market information may not be current. Confirm directly with market management before visiting."},{title:"2. Trading Hours",text:"Hours may change seasonally or due to holidays. Call ahead to confirm before visiting."},{title:"3. Facilities",text:"Not all listed facilities are guaranteed to be available. Conditions may vary. Contact market directly for current status."},{title:"4. Personal Safety",text:"Exercise caution at markets. Keep valuables secure. Use assigned parking. Follow market security guidelines."},{title:"5. Pricing",text:"Prices shown are estimates only. Actual prices vary daily. Negotiate directly with traders."},{title:"6. Health & Safety",text:"Observe market hygiene standards. Check produce freshness. Follow food safety guidelines."},{title:"7. Platform Liability",text:"SokoConnect is NOT responsible for accidents, theft, injuries, or incidents at markets. Use at your own risk."}]},agricultural:{title:"âš ï¸ Agricultural Marketplace - Important Disclaimer",content:[{title:"1. Product Authenticity",text:"Verify farmer identity and product origin. Ask for farm location and visit if possible."},{title:"2. Quality & Freshness",text:"Product quality depends on farm practices and weather. Inspect before payment. No quality guarantees apply."},{title:"3. Direct Transactions",text:"SokoConnect facilitates connections only. All transactions are directly between buyer and farmer."},{title:"4. Pesticide/Chemical Use",text:"Ask farmers about chemicals used. Request spray records. Inspect for residues. Follow food safety guidelines."},{title:"5. Delivery Terms",text:"Agree on delivery terms BEFORE payment. Specify quality standards and quantity requirements in writing."},{title:"6. Payment",text:"Use secure payment methods. Never send money without first agreeing on terms and timeline."},{title:"7. Platform Liability",text:"SokoConnect is NOT responsible for product quality, delivery disputes, crop failures, or farmer credibility."}]},"bulk-orders":{title:"âš ï¸ Bulk Orders - Important Disclaimer",content:[{title:"1. Group Organization",text:"Group organizers are responsible for coordinating with members and managing group dynamics."},{title:"2. Payment Coordination",text:"Carefully coordinate payments among group members. Create written agreements. Specify payment deadlines."},{title:"3. Logistics",text:"Group is responsible for coordinating delivery and logistics. Agree on transport arrangements and costs."},{title:"4. Dispute Resolution",text:"Resolve disputes within the group first. SokoConnect provides platform only and does NOT mediate disputes."},{title:"5. Individual Responsibility",text:"Each member is individually responsible for their share. Non-payment by one member may affect entire order."},{title:"6. Verification",text:"Verify supplier credentials and order details BEFORE committing. Get written quotes and terms."},{title:"7. Platform Liability",text:"SokoConnect is NOT responsible for: payment disputes, delivery failures, supplier credibility, or group conflicts."}]},"export-market":{title:"âš ï¸ Export Market - Important Disclaimer",content:[{title:"1. Willing Buyer â€“ Willing Seller",text:"This is a willing buyerâ€“willing seller marketplace. SokoConnect connects parties but does not guarantee transactions."},{title:"2. Documentation",text:"Verify all export documentation, certifications, and permits before proceeding with any transaction."},{title:"3. Payment Terms",text:"Agree on payment terms in writing. Use secure international payment methods. Consult with export experts."},{title:"4. Quality Standards",text:"Confirm product meets destination country quality standards and phytosanitary requirements."},{title:"5. Shipping & Logistics",text:"Agree on shipping terms (FOB, CIF, etc.) in writing. Confirm insurance coverage and delivery timelines."},{title:"6. Due Diligence",text:"Conduct thorough due diligence on all parties. Verify company registration and export licenses."},{title:"7. Platform Liability",text:"SokoConnect is NOT responsible for: export failures, payment disputes, customs issues, or quality claims."}]},"group-input-orders":{title:"âš ï¸ Group Input Orders - Important Disclaimer",content:[{title:"1. Willing Buyer â€“ Willing Seller",text:"This is a willing buyerâ€“willing seller marketplace. SokoConnect facilitates connections only."},{title:"2. Order Commitment",text:"By joining a group order, you commit to your stated quantity. Withdrawal may affect other participants."},{title:"3. Payment Coordination",text:"Organizers coordinate payments. Pay only through agreed secure methods. Keep payment receipts."},{title:"4. Input Quality",text:"Verify input quality, certifications, and expiry dates upon delivery. Report issues immediately."},{title:"5. Delivery",text:"Agree on delivery location and logistics before joining. Distribution is managed by the organizer."},{title:"6. Pricing",text:"Final prices may vary based on supplier negotiations and total quantity achieved."},{title:"7. Platform Liability",text:"SokoConnect is NOT responsible for: input quality, delivery disputes, organizer conduct, or payment issues."}]},"barter-exchange":{title:"âš ï¸ Barter Exchange - Important Disclaimer",content:[{title:"1. Willing Buyer â€“ Willing Seller",text:"This is a willing buyerâ€“willing seller marketplace for product exchange. No cash transactions required."},{title:"2. Value Assessment",text:"Both parties must agree on equivalent value. There are no standard exchange rates."},{title:"3. Product Quality",text:"Inspect all products BEFORE exchange. Agree on quality standards in advance."},{title:"4. Exchange Terms",text:"Document exchange terms in writing. Specify quantities, quality, and delivery arrangements."},{title:"5. Timing",text:"Agree on exchange timing and location. Consider product perishability."},{title:"6. Dispute Resolution",text:"Resolve disputes directly with your exchange partner. SokoConnect does not mediate."},{title:"7. Platform Liability",text:"SokoConnect is NOT responsible for: value disputes, product quality, exchange failures, or disputes."}]},"food-rescue":{title:"âš ï¸ Food Rescue - Important Disclaimer",content:[{title:"1. Food Safety",text:"Donors must ensure food is safe for consumption. Recipients should inspect before distribution."},{title:"2. Perishability",text:"Time-sensitive items require prompt pickup and distribution. Coordinate logistics carefully."},{title:"3. Documentation",text:"Keep records of donations for accountability. Document quantities and conditions."},{title:"4. Transport",text:"Agree on transport responsibilities before donation. Maintain proper food handling during transport."},{title:"5. Recipient Verification",text:"Recipients are verified organizations. Confirm recipient details before donation."},{title:"6. Tax Considerations",text:"Consult tax advisors about donation deductions. Keep proper documentation."},{title:"7. Platform Liability",text:"SokoConnect is NOT responsible for: food safety, transport issues, or distribution outcomes."}]}}[s],f=()=>{c(!0),r(!1),t&&t(),localStorage.setItem(`disclaimer-${s}`,"accepted")};return e.jsx(_e,{open:a,onOpenChange:r,children:e.jsxs(we,{className:"max-w-2xl max-h-[85vh] overflow-y-auto",children:[e.jsx(Ce,{children:e.jsxs(ke,{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-5 w-5 text-red-600 flex-shrink-0"}),x.title]})}),e.jsx("div",{className:"space-y-4",children:x.content.map((j,N)=>e.jsxs("div",{className:"border-l-4 border-yellow-400 bg-yellow-50 p-4 rounded",children:[e.jsx("h3",{className:"font-semibold text-yellow-900 mb-1",children:j.title}),e.jsx("p",{className:"text-sm text-yellow-800",children:j.text})]},N))}),e.jsx("div",{className:"bg-red-50 border-2 border-red-300 rounded p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(Se,{className:"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-semibold text-red-900 mb-1",children:"âš ï¸ Important Legal Notice"}),e.jsx("p",{className:"text-red-800",children:"By using this marketplace, you acknowledge that you have read and understood these terms. You accept full responsibility for your transactions and agree that SokoConnect is a platform facilitator only and is NOT liable for disputes, damages, or transaction failures."})]})]})}),e.jsxs("div",{className:"flex items-start gap-3 bg-blue-50 p-4 rounded",children:[e.jsx("input",{type:"checkbox",id:"disclaimer-accept",checked:n,onChange:j=>c(j.target.checked),className:"mt-1"}),e.jsx("label",{htmlFor:"disclaimer-accept",className:"text-sm text-gray-700",children:"I have read and understood the disclaimer. I accept full responsibility for my transactions and agree to the terms above."})]}),e.jsxs(Ze,{className:"gap-2",children:[e.jsx(b,{variant:"outline",onClick:()=>r(!1),children:"Go Back"}),e.jsxs(b,{disabled:!n,onClick:f,className:"bg-green-600 hover:bg-green-700",children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),"I Accept & Continue"]})]})]})})},yd=()=>{const[s,t]=i.useState([]),[a,r]=i.useState(""),[n,c]=i.useState(!0),[l,x]=i.useState(!0),[f,j]=i.useState(!1),[N,g]=i.useState(!1),[u,d]=i.useState({product_type:"",quantity:"",unit:"kg",target_price:"",deadline:"",location:"",description:""}),{toast:h}=Z(),{user:v}=je();i.useEffect(()=>{p()},[]);const p=async()=>{try{c(!0);const{data:S,error:E}=await F.from("bulk_orders").select("*").eq("status","active").order("created_at",{ascending:!1});if(E)throw E;t(S||[])}catch(S){console.error("Error fetching bulk orders:",S),h({title:"Error",description:"Failed to load bulk orders. Please try again.",variant:"destructive"})}finally{c(!1)}},m=async S=>{try{h({title:"Joined Order",description:"You have successfully joined this bulk order!"})}catch(E){console.error("Error joining order:",E),h({title:"Error",description:"Failed to join order. Please try again.",variant:"destructive"})}},o=async()=>{if(!v){h({title:"Please login",description:"You must be logged in to create orders",variant:"destructive"});return}g(!0);try{const{error:S}=await F.from("bulk_orders").insert({organizer_id:v.id,product_type:u.product_type,quantity:parseFloat(u.quantity),unit:u.unit,target_price:parseFloat(u.target_price),deadline:u.deadline,location:u.location,description:u.description,status:"active",current_participants:1});if(S)throw S;h({title:"Success",description:"Bulk order created!"}),j(!1),d({product_type:"",quantity:"",unit:"kg",target_price:"",deadline:"",location:"",description:""}),p()}catch{h({title:"Error",description:"Failed to create order",variant:"destructive"})}finally{g(!1)}},y=s.filter(S=>S.product_type.toLowerCase().includes(a.toLowerCase())||S.location.toLowerCase().includes(a.toLowerCase())),k=S=>{const E=Math.ceil(S.quantity/100);return Math.min(S.current_participants/E*100,100)},A=S=>{const E=new Date(S),P=new Date,R=E.getTime()-P.getTime(),M=Math.ceil(R/(1e3*60*60*24));return Math.max(0,M)};return n?e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),e.jsx("main",{className:"py-12 px-6 max-w-7xl mx-auto",children:e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-lg",children:"Loading bulk orders..."})})})]}):e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),l&&e.jsx(_s,{marketplaceType:"bulk-orders",onAccept:()=>x(!1)}),e.jsx("section",{className:"bg-gradient-to-r from-primary to-primary/80 text-primary-foreground py-12",children:e.jsxs("div",{className:"container mx-auto px-4 text-center",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-4",children:"Bulk Orders"}),e.jsx("p",{className:"text-lg mb-6 max-w-2xl mx-auto opacity-90",children:"Join group purchases to get better prices on agricultural products. Organize with other farmers in your area for maximum savings."})]})}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4 mb-8",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Pe,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(D,{placeholder:"Search bulk orders...",value:a,onChange:S=>r(S.target.value),className:"pl-10 md:w-64"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[y.length," active bulk orders"]}),e.jsxs(_e,{open:f,onOpenChange:j,children:[e.jsx(Ie,{asChild:!0,children:e.jsxs(b,{children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Create Bulk Order"]})}),e.jsxs(we,{className:"max-w-md",children:[e.jsx(Ce,{children:e.jsx(ke,{children:"Create Bulk Order"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Product Type"}),e.jsx(D,{value:u.product_type,onChange:S=>d({...u,product_type:S.target.value}),placeholder:"e.g. Maize, Fertilizer"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Quantity"}),e.jsx(D,{type:"number",value:u.quantity,onChange:S=>d({...u,quantity:S.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Unit"}),e.jsx(D,{value:u.unit,onChange:S=>d({...u,unit:S.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Target Price (KES)"}),e.jsx(D,{type:"number",value:u.target_price,onChange:S=>d({...u,target_price:S.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Deadline"}),e.jsx(D,{type:"date",value:u.deadline,onChange:S=>d({...u,deadline:S.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Location"}),e.jsx(D,{value:u.location,onChange:S=>d({...u,location:S.target.value}),placeholder:"County/Town"})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Description"}),e.jsx(le,{value:u.description,onChange:S=>d({...u,description:S.target.value})})]}),e.jsx(b,{onClick:o,disabled:N,className:"w-full",children:N?"Creating...":"Create Order"})]})]})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-12",children:[e.jsx(w,{className:"text-center",children:e.jsxs(_,{className:"pt-6",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(Fs,{className:"h-8 w-8 text-primary"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Save Up to 30%"}),e.jsx("p",{className:"text-muted-foreground",children:"Get wholesale prices through group buying power"})]})}),e.jsx(w,{className:"text-center",children:e.jsxs(_,{className:"pt-6",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(se,{className:"h-8 w-8 text-primary"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Community Driven"}),e.jsx("p",{className:"text-muted-foreground",children:"Connect with farmers in your area"})]})}),e.jsx(w,{className:"text-center",children:e.jsxs(_,{className:"pt-6",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(re,{className:"h-8 w-8 text-primary"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Quality Assured"}),e.jsx("p",{className:"text-muted-foreground",children:"Verified suppliers and products"})]})})]}),e.jsx("div",{className:"grid lg:grid-cols-2 gap-6",children:y.map(S=>{const E=k(S),P=A(S.deadline);return e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-xl mb-2",children:S.product_type}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:S.location})]})]}),e.jsxs(I,{variant:P>7?"default":"destructive",children:[P," days left"]})]})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-muted-foreground",children:S.description}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Quantity Needed"}),e.jsxs("div",{className:"font-medium",children:[S.quantity," ",S.unit]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Target Price"}),e.jsxs("div",{className:"font-medium",children:["KES ",S.target_price,"/",S.unit]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Participants"}),e.jsxs("span",{className:"text-sm font-medium",children:[S.current_participants," joined"]})]}),e.jsx(Za,{value:E,className:"h-2"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(xe,{className:"h-4 w-4"}),e.jsxs("span",{children:["Deadline: ",new Date(S.deadline).toLocaleDateString()]})]}),e.jsxs("div",{className:"pt-4 border-t flex gap-2",children:[e.jsx(b,{variant:"outline",size:"sm",className:"flex-1",children:"View Details"}),e.jsxs(b,{size:"sm",className:"flex-1",onClick:()=>m(S.id),children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Join Order"]})]})]})})]},S.id)})}),y.length===0&&!n&&e.jsx(w,{className:"text-center py-12",children:e.jsxs(_,{children:[e.jsx(re,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No bulk orders found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Be the first to create a bulk order in your area."}),e.jsxs(b,{children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Create Bulk Order"]})]})}),e.jsxs("section",{className:"mt-16 bg-muted/30 rounded-lg p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"How Bulk Orders Work"}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"Simple steps to save money through group purchasing"})]}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl font-bold text-primary",children:"1"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Find or Create"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Browse existing orders or create your own"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl font-bold text-primary",children:"2"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Join & Commit"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Commit to your quantity and payment"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl font-bold text-primary",children:"3"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Reach Target"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Wait for minimum participants to join"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl font-bold text-primary",children:"4"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Get Delivery"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Receive your order at wholesale prices"})]})]})]})]})]})},Lr=[{name:"Home",href:"/",icon:vt},{name:"Market Data",href:"/kilimo-ams-data",icon:ce},{name:"Logistics",href:"/logistics",icon:ye},{name:"Equipment",href:"/equipment-marketplace",icon:ye},{name:"Service Providers",href:"/service-providers",icon:se},{name:"Advertise Business",href:"/business-marketing",icon:Xs,highlight:!0},{name:"Trading",href:"/commodity-trading",icon:Ae},{name:"Community",href:"/community-forum",icon:ys},{name:"Analytics",href:"/sentiment-analysis",icon:Re},{name:"Export Market",href:"/export-market",icon:Le}],$e=()=>{const s=Es(),t=Lr.slice(0,6),a=Lr.slice(6);return e.jsxs("nav",{className:"hidden md:flex items-center gap-1 overflow-x-auto scrollbar-hide",children:[e.jsxs(X,{to:"/",className:"flex items-center space-x-2 mr-4 flex-shrink-0",children:[e.jsx("div",{className:"w-8 h-8 bg-primary rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-primary-foreground font-bold",children:"S"})}),e.jsx("span",{className:"hidden xl:inline-block font-bold text-sm",children:"SokoConnect"})]}),t.map(r=>{const n=s.pathname===r.href;return e.jsx(X,{to:r.href,className:"flex-shrink-0",children:e.jsxs(b,{variant:n?"default":"ghost",size:"sm",className:$("flex items-center gap-1 px-2 lg:px-3 text-xs lg:text-sm",r.highlight&&!n&&"bg-green-50 text-green-700 hover:bg-green-100 border border-green-200",r.highlight&&n&&"bg-green-600 hover:bg-green-700"),children:[e.jsx(r.icon,{className:"h-3.5 w-3.5 lg:h-4 lg:w-4"}),e.jsx("span",{className:"hidden lg:inline whitespace-nowrap",children:r.name})]})},r.name)}),e.jsx(X,{to:"/more",className:"flex-shrink-0",children:e.jsxs(b,{variant:"ghost",size:"sm",className:"px-2 lg:px-3 text-xs lg:text-sm",children:[e.jsx("span",{children:"More"}),e.jsxs("span",{className:"ml-1 text-muted-foreground",children:["+",a.length]})]})})]})},Nd=vi,bd=yi,Cn=({...s})=>e.jsx(Va,{...s});Cn.displayName=Va.displayName;const kn=i.forwardRef(({className:s,...t},a)=>e.jsx(ta,{className:$("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t,ref:a}));kn.displayName=ta.displayName;const wd=jt("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),Sn=i.forwardRef(({side:s="right",className:t,children:a,...r},n)=>e.jsxs(Cn,{children:[e.jsx(kn,{}),e.jsxs(aa,{ref:n,className:$(wd({side:s}),t),...r,children:[a,e.jsxs(fi,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Sn.displayName=aa.displayName;const _d=i.forwardRef(({className:s,...t},a)=>e.jsx(ra,{ref:a,className:$("text-lg font-semibold text-foreground",s),...t}));_d.displayName=ra.displayName;const Cd=i.forwardRef(({className:s,...t},a)=>e.jsx(ia,{ref:a,className:$("text-sm text-muted-foreground",s),...t}));Cd.displayName=ia.displayName;const kd=[{name:"Home",href:"/",icon:vt},{name:"Market Data",href:"/kilimo-ams-data",icon:ce},{name:"Logistics",href:"/logistics",icon:ye},{name:"Service Providers",href:"/service-providers",icon:se},{name:"Advertise Business",href:"/business-marketing",icon:Xs,highlight:!0},{name:"Trading",href:"/commodity-trading",icon:Ae},{name:"Community",href:"/community-forum",icon:ys},{name:"Analytics",href:"/sentiment-analysis",icon:Re},{name:"Donations",href:"/donation-list",icon:Ae},{name:"Food Rescue",href:"/food-rescue-dashboard",icon:Se},{name:"Auctions",href:"/agent-product-auction-dashboard",icon:ce},{name:"Marketplace",href:"/farm-input-marketplace",icon:Re},{name:"City Markets",href:"/city-markets",icon:ee},{name:"Animals",href:"/farmer-portal#animals",icon:Ha},{name:"Veterinary",href:"/veterinary-services",icon:fe},{name:"Feed & Nutrition",href:"/feed-nutrition",icon:xe},{name:"Genetics & Breeding",href:"/genetics-breeding",icon:is},{name:"Farm Construction",href:"/farm-construction",icon:ee},{name:"Consultancies",href:"/consultancies",icon:se}],ss=()=>{const[s,t]=i.useState(!1),a=Es();return e.jsx("div",{className:"md:hidden",children:e.jsxs(Nd,{open:s,onOpenChange:t,children:[e.jsx(bd,{asChild:!0,children:e.jsx(b,{variant:"ghost",size:"icon",children:e.jsx(la,{className:"h-5 w-5"})})}),e.jsx(Sn,{side:"left",className:"w-80",children:e.jsxs("div",{className:"flex flex-col space-y-4 mt-4",children:[e.jsxs(X,{to:"/",className:"flex items-center space-x-2 mb-6",onClick:()=>t(!1),children:[e.jsx("div",{className:"w-8 h-8 bg-primary rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-primary-foreground font-bold",children:"A"})}),e.jsx("span",{className:"font-bold text-lg",children:"SokoConnect"})]}),kd.map(r=>{const n=a.pathname===r.href;return e.jsxs(X,{to:r.href,onClick:()=>t(!1),className:$("flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors",n?"bg-primary text-primary-foreground":r.highlight?"bg-green-50 text-green-700 hover:bg-green-100":"hover:bg-muted"),children:[e.jsx(r.icon,{className:"h-5 w-5"}),e.jsx("span",{children:r.name}),r.highlight&&e.jsx("span",{className:"ml-auto text-xs bg-green-200 text-green-800 px-2 py-1 rounded-full",children:"New"})]},r.name)})]})})]})})},Me=()=>{const s=Es(),t=[{icon:vt,label:"Home",path:"/"},{icon:Pe,label:"Markets",path:"/marketplace"},{icon:rs,label:"Orders",path:"/my-trades"},{icon:Ue,label:"Community",path:"/community"},{icon:vs,label:"Profile",path:"/profile"}];return e.jsx("nav",{className:"md:hidden fixed bottom-0 left-0 right-0 z-50 bg-background border-t border-border",children:e.jsx("div",{className:"flex items-center justify-around h-16 px-2",children:t.map(a=>{const r=a.icon,n=s.pathname===a.path;return e.jsxs(X,{to:a.path,className:$("flex flex-col items-center justify-center gap-1 flex-1 h-full transition-colors",n?"text-primary":"text-muted-foreground hover:text-foreground"),children:[e.jsx(r,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs font-medium",children:a.label})]},a.path)})})})},Sd=()=>{const{toast:s}=Z(),{user:t}=je(),[a,r]=i.useState([]),[n,c]=i.useState(!0),[l,x]=i.useState(""),[f,j]=i.useState("active"),[N,g]=i.useState(!0),[u,d]=i.useState(!1),[h,v]=i.useState(!1),[p,m]=i.useState({input_name:"",description:"",target_quantity:"",unit_price:"",deadline:"",location:""});i.useEffect(()=>{y()},[f]);const o=async()=>{if(!t){s({title:"Please login",description:"You must be logged in to create orders",variant:"destructive"});return}v(!0);try{const{error:A}=await F.from("group_input_orders").insert({organizer_id:t.id,input_name:p.input_name,description:p.description,target_quantity:parseFloat(p.target_quantity),current_quantity:0,unit_price:parseFloat(p.unit_price),deadline:p.deadline,location:p.location,status:"active"});if(A)throw A;s({title:"Success",description:"Group input order created!"}),d(!1),m({input_name:"",description:"",target_quantity:"",unit_price:"",deadline:"",location:""}),y()}catch{s({title:"Error",description:"Failed to create order",variant:"destructive"})}finally{v(!1)}},y=async()=>{try{c(!0);let A=F.from("group_input_orders").select(`
          *,
          profiles:organizer_id (
            full_name
          )
        `);f==="active"?A=A.eq("status","active"):f==="completed"&&(A=A.eq("status","completed"));const{data:S,error:E}=await A.order("created_at",{ascending:!1});if(E)throw E;r(S||[])}catch(A){console.error("Error fetching group orders:",A),s({title:"Error",description:"Failed to load group orders. Please try again.",variant:"destructive"})}finally{c(!1)}},k=a.filter(A=>{var E;return l===""||A.input_name.toLowerCase().includes(l.toLowerCase())||((E=A.description)==null?void 0:E.toLowerCase().includes(l.toLowerCase()))||A.location.toLowerCase().includes(l.toLowerCase())});return e.jsxs("div",{className:"flex min-h-screen flex-col pb-20 md:pb-0",children:[e.jsx("header",{className:"sticky top-0 z-30 w-full border-b bg-background",children:e.jsxs("div",{className:"container flex h-16 items-center",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx($e,{})}),e.jsx("div",{className:"md:hidden",children:e.jsx(ss,{})})]})}),N&&e.jsx(_s,{marketplaceType:"group-input-orders",onAccept:()=>g(!1)}),e.jsxs("main",{className:"flex-1 container py-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Group Purchasing for Inputs"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Save money by buying farm inputs in bulk with other farmers. Group purchasing allows farmers to pool their resources and negotiate better prices by ordering inputs like seeds, fertilizers, and equipment together."}),e.jsx("div",{className:"mt-4 p-4 bg-amber-50 dark:bg-amber-950/30 border border-amber-200 dark:border-amber-800 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(hs,{className:"h-5 w-5 text-amber-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-amber-800 dark:text-amber-200",children:"Willing Buyer â€“ Willing Seller Marketplace"}),e.jsx("p",{className:"text-sm text-amber-700 dark:text-amber-300",children:"SokoConnect facilitates connections but does not guarantee transactions. Verify all details before committing."})]})]})}),e.jsxs("div",{className:"mt-4 p-4 bg-muted/50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"How It Works:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm",children:[e.jsx("li",{children:"Browse active group orders or create a new one"}),e.jsx("li",{children:"Join an order that matches your input needs"}),e.jsx("li",{children:"Order closes when target quantity is reached or deadline passes"}),e.jsx("li",{children:"Organizer negotiates bulk pricing with suppliers"}),e.jsx("li",{children:"Inputs are delivered to a central location or distributed to participants"}),e.jsx("li",{children:"Everyone saves money through collective purchasing power"})]})]})]}),e.jsx("div",{className:"mt-4 md:mt-0",children:e.jsxs(_e,{open:u,onOpenChange:d,children:[e.jsx(Ie,{asChild:!0,children:e.jsxs(b,{children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Express Need"]})}),e.jsxs(we,{className:"max-w-md",children:[e.jsx(Ce,{children:e.jsx(ke,{children:"Create Group Input Order"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Input Name *"}),e.jsx(D,{value:p.input_name,onChange:A=>m({...p,input_name:A.target.value}),placeholder:"e.g., DAP Fertilizer, Maize Seeds"})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Description"}),e.jsx(le,{value:p.description,onChange:A=>m({...p,description:A.target.value}),placeholder:"Describe the input you need..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Target Quantity *"}),e.jsx(D,{type:"number",value:p.target_quantity,onChange:A=>m({...p,target_quantity:A.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Unit Price (KES) *"}),e.jsx(D,{type:"number",value:p.unit_price,onChange:A=>m({...p,unit_price:A.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Deadline *"}),e.jsx(D,{type:"date",value:p.deadline,onChange:A=>m({...p,deadline:A.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Location *"}),e.jsx(D,{value:p.location,onChange:A=>m({...p,location:A.target.value}),placeholder:"County/Town"})]}),e.jsx(b,{onClick:o,disabled:h,className:"w-full",children:h?"Creating...":"Create Order"})]})]})]})})]}),e.jsx(ge,{defaultValue:"active",value:f,onValueChange:A=>j(A),className:"mb-6",children:e.jsxs(pe,{children:[e.jsx(B,{value:"active",children:"Active Orders"}),e.jsx(B,{value:"completed",children:"Completed"}),e.jsx(B,{value:"all",children:"All Orders"})]})}),e.jsx("div",{className:"mb-6",children:e.jsx(D,{placeholder:"Search by input name, location, or description...",value:l,onChange:A=>x(A.target.value),className:"w-full md:w-2/3 lg:w-1/2"})}),n?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(A=>e.jsxs(w,{className:"animate-pulse",children:[e.jsxs(q,{className:"pb-2",children:[e.jsx("div",{className:"h-6 bg-muted rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/2"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"h-4 bg-muted rounded w-full mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-5/6"})]})]},A))}):k.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-muted mb-4",children:e.jsx(re,{className:"h-8 w-8 text-muted-foreground"})}),e.jsx("h3",{className:"text-lg font-medium",children:"No group orders found"}),e.jsx("p",{className:"text-muted-foreground mt-2 mb-4",children:f==="active"?"No active group orders match your search. Try different keywords or start a new order.":"No orders found. Check back later or view all orders."}),f!=="all"&&e.jsx(b,{variant:"outline",onClick:()=>j("all"),children:"View All Orders"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:k.map(A=>{var P;const S=A.current_quantity/A.target_quantity*100,E=Math.ceil((new Date(A.deadline).getTime()-Date.now())/(1e3*60*60*24));return e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(q,{children:[e.jsx(L,{className:"text-lg line-clamp-2",children:A.input_name}),e.jsx(G,{className:"truncate",children:((P=A.profiles)==null?void 0:P.full_name)||"Organizer"})]}),e.jsxs(_,{className:"space-y-4",children:[A.description&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:A.description}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Progress"}),e.jsxs("span",{className:"font-medium",children:[S.toFixed(0),"%"]})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:e.jsx("div",{className:"bg-primary h-2 rounded-full transition-all",style:{width:`${Math.min(S,100)}%`}})}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:[A.current_quantity," / ",A.target_quantity," units"]}),A.status==="active"&&e.jsxs(I,{variant:E>7?"secondary":"destructive",className:"text-xs",children:[E," days left"]})]})]}),e.jsxs("div",{className:"flex items-center text-sm gap-1",children:[e.jsx(ee,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{className:"truncate",children:A.location})]}),e.jsxs("div",{className:"flex items-center text-sm gap-1",children:[e.jsx(Fs,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsxs("span",{className:"truncate",children:["KES ",A.unit_price.toLocaleString()," per unit"]})]}),e.jsxs("div",{className:"flex items-center text-sm gap-1",children:[e.jsx(xe,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsxs("span",{className:"truncate",children:["Deadline: ",new Date(A.deadline).toLocaleDateString()]})]})]}),e.jsxs(me,{className:"flex justify-between gap-2",children:[e.jsx(I,{variant:A.status==="active"?"default":"secondary",children:A.status}),e.jsx(b,{size:"sm",disabled:A.status!=="active",children:A.status==="active"?"Join Order":"View Details"})]})]},A.id)})})]}),e.jsx(Me,{})]})};async function Pd(s){return await F.from("input_supplier_reviews").insert(s)}async function Ad(s){return await F.from("input_supplier_reviews").select("*").eq("supplier_id",s)}async function Td(s){return F.from("input_pricing").insert(s).select()}async function Dd(s={}){return await F.from("input_pricing").select("*").match(s)}const Ls=i.forwardRef(({className:s,...t},a)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:a,className:$("w-full caption-bottom text-sm",s),...t})}));Ls.displayName="Table";const Ms=i.forwardRef(({className:s,...t},a)=>e.jsx("thead",{ref:a,className:$("[&_tr]:border-b",s),...t}));Ms.displayName="TableHeader";const Is=i.forwardRef(({className:s,...t},a)=>e.jsx("tbody",{ref:a,className:$("[&_tr:last-child]:border-0",s),...t}));Is.displayName="TableBody";const Ed=i.forwardRef(({className:s,...t},a)=>e.jsx("tfoot",{ref:a,className:$("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...t}));Ed.displayName="TableFooter";const Oe=i.forwardRef(({className:s,...t},a)=>e.jsx("tr",{ref:a,className:$("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...t}));Oe.displayName="TableRow";const oe=i.forwardRef(({className:s,...t},a)=>e.jsx("th",{ref:a,className:$("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...t}));oe.displayName="TableHead";const de=i.forwardRef(({className:s,...t},a)=>e.jsx("td",{ref:a,className:$("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...t}));de.displayName="TableCell";const Fd=i.forwardRef(({className:s,...t},a)=>e.jsx("caption",{ref:a,className:$("mt-4 text-sm text-muted-foreground",s),...t}));Fd.displayName="TableCaption";const qd=()=>{const{toast:s}=Z(),[t,a]=i.useState(""),[r,n]=i.useState(""),[c,l]=i.useState([]),[x,f]=i.useState(""),[j,N]=i.useState(""),[g,u]=i.useState(0),[d,h]=i.useState([]),[v,p]=i.useState(!1);i.useEffect(()=>{m()},[t,x]);const m=async()=>{try{const A={};t&&(A.product_id=t),x&&(A.supplier_id=x);const{data:S}=await Dd(A);l(S||[])}catch(A){console.error("Error loading prices:",A)}},o=async()=>{if(x)try{const{data:A}=await Ad(x);h(A||[])}catch(A){console.error("Error loading reviews:",A)}};i.useEffect(()=>{o()},[x]);const y=async A=>{if(A.preventDefault(),!t||!x||!r){s({title:"Missing Information",description:"Please fill in all required fields",variant:"destructive"});return}try{p(!0),await Td({product_id:t,supplier_id:x,price:parseFloat(r)}),s({title:"Success",description:"Price reported successfully"}),n(""),m()}catch{s({title:"Error",description:"Failed to report price",variant:"destructive"})}finally{p(!1)}},k=async A=>{if(A.preventDefault(),!x||!g){s({title:"Missing Information",description:"Please provide supplier ID and rating",variant:"destructive"});return}try{p(!0),await Pd({supplier_id:x,rating:g,review:j}),s({title:"Success",description:"Review submitted successfully"}),N(""),u(0),o()}catch{s({title:"Error",description:"Failed to submit review",variant:"destructive"})}finally{p(!1)}};return e.jsxs("div",{className:"flex min-h-screen flex-col pb-20 md:pb-0",children:[e.jsx("header",{className:"sticky top-0 z-30 w-full border-b bg-background",children:e.jsxs("div",{className:"container flex h-16 items-center",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx($e,{})}),e.jsx("div",{className:"md:hidden",children:e.jsx(ss,{})})]})}),e.jsxs("main",{className:"flex-1 container py-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight mb-2",children:"Input Pricing & Supplier Verification"}),e.jsx("p",{className:"text-muted-foreground",children:"Crowdsource and verify input prices from suppliers. Help farmers make informed purchasing decisions by reporting prices you've seen or received. Review suppliers to build trust in the marketplace."}),e.jsxs("div",{className:"mt-4 p-4 bg-muted/50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"How It Works:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm",children:[e.jsx("li",{children:"Report input prices you've encountered from various suppliers"}),e.jsx("li",{children:"Search and compare prices across suppliers to find the best deals"}),e.jsx("li",{children:"View verification status - prices confirmed by multiple users are marked as verified"}),e.jsx("li",{children:"Review suppliers based on your experience with product quality and service"}),e.jsx("li",{children:"Check supplier ratings and reviews before making purchase decisions"}),e.jsx("li",{children:"Community-driven data helps everyone access fair pricing"})]})]})]}),e.jsxs(ge,{defaultValue:"pricing",className:"mb-6",children:[e.jsxs(pe,{className:"grid w-full grid-cols-2",children:[e.jsx(B,{value:"pricing",children:"Price Reporting"}),e.jsx(B,{value:"reviews",children:"Supplier Reviews"})]}),e.jsxs(V,{value:"pricing",className:"space-y-6",children:[e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"Report Input Price"})}),e.jsx(_,{children:e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"productId",children:"Product/Input ID *"}),e.jsx(D,{id:"productId",type:"text",placeholder:"e.g., seed-maize-001",value:t,onChange:A=>a(A.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"supplierId",children:"Supplier ID *"}),e.jsx(D,{id:"supplierId",type:"text",placeholder:"e.g., supplier-123",value:x,onChange:A=>f(A.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"price",children:"Price (KES) *"}),e.jsx(D,{id:"price",type:"number",step:"0.01",placeholder:"e.g., 2500",value:r,onChange:A=>n(A.target.value),required:!0})]}),e.jsx(b,{type:"submit",disabled:v,className:"w-full",children:v?"Submitting...":"Report Price"})]})})]}),e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"Reported Prices"})}),e.jsx(_,{children:c.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No prices reported yet. Be the first to report!"}):e.jsxs(Ls,{children:[e.jsx(Ms,{children:e.jsxs(Oe,{children:[e.jsx(oe,{children:"Product ID"}),e.jsx(oe,{children:"Supplier ID"}),e.jsx(oe,{children:"Price (KES)"}),e.jsx(oe,{children:"Status"})]})}),e.jsx(Is,{children:c.map(A=>{var S;return e.jsxs(Oe,{children:[e.jsx(de,{className:"font-medium",children:A.product_id}),e.jsx(de,{children:A.supplier_id}),e.jsxs(de,{children:["KES ",(S=A.price)==null?void 0:S.toLocaleString()]}),e.jsx(de,{children:A.verified?e.jsxs(I,{variant:"default",className:"flex items-center gap-1 w-fit",children:[e.jsx(fe,{className:"h-3 w-3"}),"Verified"]}):e.jsxs(I,{variant:"secondary",className:"flex items-center gap-1 w-fit",children:[e.jsx(hs,{className:"h-3 w-3"}),"Pending"]})})]},A.id)})})]})})]})]}),e.jsxs(V,{value:"reviews",className:"space-y-6",children:[e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"Review Supplier"})}),e.jsx(_,{children:e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"reviewSupplierId",children:"Supplier ID *"}),e.jsx(D,{id:"reviewSupplierId",type:"text",placeholder:"e.g., supplier-123",value:x,onChange:A=>f(A.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Rating * (1-5 stars)"}),e.jsxs("div",{className:"flex gap-2",children:[[1,2,3,4,5].map(A=>e.jsx("button",{type:"button",onClick:()=>u(A),className:`p-2 rounded transition-colors ${g>=A?"text-yellow-500":"text-gray-300"}`,children:e.jsx(es,{className:"h-6 w-6",fill:g>=A?"currentColor":"none"})},A)),e.jsx("span",{className:"ml-2 self-center text-sm text-muted-foreground",children:g>0?`${g} star${g>1?"s":""}`:"Select rating"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"reviewText",children:"Review (optional)"}),e.jsx(le,{id:"reviewText",placeholder:"Share your experience with this supplier...",value:j,onChange:A=>N(A.target.value),rows:4})]}),e.jsx(b,{type:"submit",disabled:v||g===0,className:"w-full",children:v?"Submitting...":"Submit Review"})]})})]}),e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"Supplier Reviews"})}),e.jsx(_,{children:d.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No reviews yet. Be the first to review!"}):e.jsx("div",{className:"space-y-4",children:d.map(A=>e.jsx(w,{children:e.jsxs(_,{className:"pt-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["Supplier: ",A.supplier_id]}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[[...Array(5)].map((S,E)=>e.jsx(es,{className:"h-4 w-4 text-yellow-500",fill:E<A.rating?"currentColor":"none"},E)),e.jsxs("span",{className:"ml-1 text-sm text-muted-foreground",children:[A.rating," stars"]})]})]}),A.verified&&e.jsxs(I,{variant:"default",children:[e.jsx(fe,{className:"h-3 w-3 mr-1"}),"Verified"]})]}),A.review&&e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:A.review})]})},A.id))})})]})]})]})]}),e.jsx(Me,{})]})};function Ld(){const{toast:s}=Z(),[t,a]=i.useState(!1),[r,n]=i.useState(!1),[c,l]=i.useState({product_name:"",description:"",quantity:"",max_price:"",deadline:"",location:""}),x=async f=>{f.preventDefault();try{n(!0);const{data:{user:j}}=await F.auth.getUser();if(!j){s({title:"Authentication Required",description:"Please sign in to post bulk needs.",variant:"destructive"});return}const{error:N}=await F.from("reverse_bulk_auctions").insert({buyer_id:j.id,product_name:c.product_name,description:c.description,quantity:parseFloat(c.quantity),max_price:parseFloat(c.max_price),deadline:c.deadline,location:c.location,status:"active"});if(N)throw N;s({title:"Success!",description:"Your bulk need has been posted successfully."}),a(!1),l({product_name:"",description:"",quantity:"",max_price:"",deadline:"",location:""}),window.location.reload()}catch(j){console.error("Error posting bulk need:",j),s({title:"Error",description:"Failed to post bulk need. Please try again.",variant:"destructive"})}finally{n(!1)}};return e.jsxs(_e,{open:t,onOpenChange:a,children:[e.jsx(Ie,{asChild:!0,children:e.jsx(b,{children:"Post Bulk Need"})}),e.jsxs(we,{className:"sm:max-w-[550px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Ce,{children:[e.jsx(ke,{children:"Post Your Bulk Need"}),e.jsx(it,{children:"Tell sellers what you need, and let them compete to offer you the best price."})]}),e.jsxs("form",{onSubmit:x,className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"product_name",children:"Product Name *"}),e.jsx(D,{id:"product_name",placeholder:"e.g., Fresh Tomatoes",value:c.product_name,onChange:f=>l({...c,product_name:f.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"description",children:"Description"}),e.jsx(le,{id:"description",placeholder:"Additional details about your requirement...",value:c.description,onChange:f=>l({...c,description:f.target.value}),rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"quantity",children:"Quantity (units) *"}),e.jsx(D,{id:"quantity",type:"number",placeholder:"1000",value:c.quantity,onChange:f=>l({...c,quantity:f.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"max_price",children:"Max Price (KES) *"}),e.jsx(D,{id:"max_price",type:"number",placeholder:"50000",value:c.max_price,onChange:f=>l({...c,max_price:f.target.value}),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"location",children:"Delivery Location *"}),e.jsx(D,{id:"location",placeholder:"e.g., Nairobi, Kenya",value:c.location,onChange:f=>l({...c,location:f.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"deadline",children:"Deadline *"}),e.jsxs("div",{className:"relative",children:[e.jsx(D,{id:"deadline",type:"date",value:c.deadline,onChange:f=>l({...c,deadline:f.target.value}),min:new Date().toISOString().split("T")[0],required:!0}),e.jsx(xe,{className:"absolute right-3 top-3 h-4 w-4 text-muted-foreground pointer-events-none"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(b,{type:"button",variant:"outline",onClick:()=>a(!1),className:"flex-1",children:"Cancel"}),e.jsx(b,{type:"submit",disabled:r,className:"flex-1",children:r?"Posting...":"Post Bulk Need"})]})]})]})]})}const Md=()=>{const{toast:s}=Z(),[t,a]=i.useState([]),[r,n]=i.useState(!0),[c,l]=i.useState(""),[x,f]=i.useState("active");i.useEffect(()=>{j()},[x]);const j=async()=>{try{n(!0);let g=F.from("reverse_bulk_auctions").select(`
          *,
          profiles:buyer_id (
            full_name
          )
        `);x==="active"?g=g.eq("status","active"):x==="closed"&&(g=g.in("status",["closed","completed"]));const{data:u,error:d}=await g.order("created_at",{ascending:!1});if(d)throw d;a(u||[])}catch(g){console.error("Error fetching reverse auctions:",g),s({title:"Error",description:"Failed to load reverse auctions. Please try again.",variant:"destructive"})}finally{n(!1)}},N=t.filter(g=>{var d;return c===""||g.product_name.toLowerCase().includes(c.toLowerCase())||((d=g.description)==null?void 0:d.toLowerCase().includes(c.toLowerCase()))||g.location.toLowerCase().includes(c.toLowerCase())});return e.jsxs("div",{className:"flex min-h-screen flex-col pb-20 md:pb-0",children:[e.jsx("header",{className:"sticky top-0 z-30 w-full border-b bg-background",children:e.jsxs("div",{className:"container flex h-16 items-center",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx($e,{})}),e.jsx("div",{className:"md:hidden",children:e.jsx(ss,{})})]})}),e.jsxs("main",{className:"flex-1 container py-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Reverse Auctions for Bulk Orders"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Buyers post their needs and sellers compete to offer the best price"}),e.jsxs("div",{className:"mt-4 p-4 bg-muted/50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"How Reverse Auctions Work:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm",children:[e.jsx("li",{children:"Buyers post their bulk product requirements with maximum price and deadline"}),e.jsx("li",{children:"Multiple sellers view the order and compete by bidding lower prices"}),e.jsx("li",{children:"Sellers offer their best competitive prices to win the contract"}),e.jsx("li",{children:"Buyer reviews all bids and selects the best offer based on price and delivery terms"}),e.jsx("li",{children:"Winner is notified and contract terms are finalized"}),e.jsx("li",{children:"Transaction is completed and both parties can rate each other"})]}),e.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded",children:e.jsxs("p",{className:"text-xs text-yellow-900",children:[e.jsx("strong",{children:"Platform Policies & Disclaimer:"})," By using reverse auctions, you agree to our terms. SokoConnect facilitates connections between buyers and sellers but does not guarantee product quality, delivery, or pricing. Users are responsible for verifying supplier credentials, negotiating terms, and ensuring compliance with applicable laws. We recommend meeting suppliers, inspecting products before payment, and using secure payment methods. Report any suspicious activity to our support team."]})})]})]}),e.jsx("div",{className:"mt-4 md:mt-0",children:e.jsx(Ld,{})})]}),e.jsx(ge,{defaultValue:"active",value:x,onValueChange:g=>f(g),className:"mb-6",children:e.jsxs(pe,{children:[e.jsx(B,{value:"active",children:"Active Auctions"}),e.jsx(B,{value:"closed",children:"Closed"}),e.jsx(B,{value:"all",children:"All Auctions"})]})}),e.jsx("div",{className:"mb-6",children:e.jsx(D,{placeholder:"Search by product, location, or description...",value:c,onChange:g=>l(g.target.value),className:"w-full md:w-2/3 lg:w-1/2"})}),r?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(g=>e.jsxs(w,{className:"animate-pulse",children:[e.jsxs(q,{className:"pb-2",children:[e.jsx("div",{className:"h-6 bg-muted rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/2"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"h-4 bg-muted rounded w-full mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-5/6"})]})]},g))}):N.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-muted mb-4",children:e.jsx(re,{className:"h-8 w-8 text-muted-foreground"})}),e.jsx("h3",{className:"text-lg font-medium",children:"No reverse auctions found"}),e.jsx("p",{className:"text-muted-foreground mt-2 mb-4",children:x==="active"?"No active auctions match your search. Try different keywords or post a new bulk need.":"No auctions found. Check back later or view all auctions."}),x!=="all"&&e.jsx(b,{variant:"outline",onClick:()=>f("all"),children:"View All Auctions"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:N.map(g=>{var h;const u=Math.ceil((new Date(g.deadline).getTime()-Date.now())/864e5),d=u<0;return e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(q,{children:[e.jsx(L,{className:"text-lg line-clamp-2",children:g.product_name}),e.jsx(G,{className:"truncate",children:((h=g.profiles)==null?void 0:h.full_name)||"Buyer"})]}),e.jsxs(_,{className:"space-y-4",children:[g.description&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:g.description}),e.jsxs("div",{className:"flex items-center text-sm gap-1",children:[e.jsx(re,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsxs("span",{className:"font-medium truncate",children:[g.quantity.toLocaleString()," units needed"]})]}),e.jsxs("div",{className:"flex items-center text-sm gap-1",children:[e.jsx(Fs,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsxs("span",{className:"truncate",children:["Max: ",e.jsxs("span",{className:"font-semibold",children:["KES ",g.max_price.toLocaleString()]})]})]}),e.jsxs("div",{className:"flex items-center text-sm gap-1",children:[e.jsx(ee,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{className:"truncate",children:g.location})]}),e.jsxs("div",{className:"flex items-center text-sm gap-1",children:[e.jsx(xe,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsxs("span",{className:"truncate",children:["Deadline: ",new Date(g.deadline).toLocaleDateString()]})]}),g.status==="active"&&!d&&e.jsxs(I,{variant:u>7?"secondary":"destructive",className:"w-full justify-center",children:[e.jsx(is,{className:"h-3 w-3 mr-1"}),u," day",u!==1?"s":""," remaining"]})]}),e.jsxs(me,{className:"flex justify-between gap-2",children:[e.jsx(I,{variant:g.status==="active"?"default":"secondary",children:g.status}),e.jsx(b,{size:"sm",disabled:g.status!=="active"||d,children:g.status==="active"&&!d?"Bid on Order":"View Details"})]})]},g.id)})})]}),e.jsx(Me,{})]})};async function Id(s){return await F.from("subscription_boxes").insert(s)}async function Mr(s){return await F.from("subscription_boxes").select("*").eq("consumer_id",s)}async function Ir(s){return await F.from("subscription_box_deliveries").select("*").eq("box_id",s)}async function Rd(s){return await F.from("subscription_box_deliveries").update({delivered:!0}).eq("id",s)}const Q=El,J=Fl,W=i.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(Di,{ref:r,className:$("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...a,children:[t,e.jsx(Sl,{asChild:!0,children:e.jsx(Lt,{className:"h-4 w-4 opacity-50"})})]}));W.displayName=Di.displayName;const Pn=i.forwardRef(({className:s,...t},a)=>e.jsx(Ei,{ref:a,className:$("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(Fi,{className:"h-4 w-4"})}));Pn.displayName=Ei.displayName;const An=i.forwardRef(({className:s,...t},a)=>e.jsx(qi,{ref:a,className:$("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(Lt,{className:"h-4 w-4"})}));An.displayName=qi.displayName;const Y=i.forwardRef(({className:s,children:t,position:a="popper",...r},n)=>e.jsx(Pl,{children:e.jsxs(Li,{ref:n,className:$("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:a,...r,children:[e.jsx(Pn,{}),e.jsx(Al,{className:$("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),e.jsx(An,{})]})}));Y.displayName=Li.displayName;const zd=i.forwardRef(({className:s,...t},a)=>e.jsx(Mi,{ref:a,className:$("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...t}));zd.displayName=Mi.displayName;const T=i.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(Ii,{ref:r,className:$("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Tl,{children:e.jsx(Qe,{className:"h-4 w-4"})})}),e.jsx(Dl,{children:t})]}));T.displayName=Ii.displayName;const Od=i.forwardRef(({className:s,...t},a)=>e.jsx(Ri,{ref:a,className:$("-mx-1 my-1 h-px bg-muted",s),...t}));Od.displayName=Ri.displayName;const Kd=[{title:"Home",href:"/",icon:vt},{title:"Markets",href:"/marketplace",icon:rs},{title:"Prices",href:"/price-trends",icon:ce},{title:"Community",href:"/community-forums",icon:Ue}],Tn=()=>{const s=Es(),{user:t}=je();return t?e.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50 bg-background border-t border-border lg:hidden",children:e.jsx("nav",{className:"flex justify-around items-center h-16 px-2",children:Kd.map(a=>{const r=a.icon,n=s.pathname===a.href;return e.jsxs(X,{to:a.href,className:$("flex flex-col items-center justify-center gap-1 p-2 rounded-lg transition-colors min-w-0 flex-1",n?"text-primary bg-primary/10":"text-muted-foreground hover:text-foreground hover:bg-accent"),children:[e.jsx(r,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs font-medium truncate",children:a.title})]},a.href)})})}):null},Dn=({title:s,showBack:t=!1,onBack:a,actions:r})=>e.jsx("header",{className:"sticky top-0 z-40 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b lg:hidden",children:e.jsxs("div",{className:"flex items-center justify-between h-14 px-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[t&&e.jsx(b,{variant:"ghost",size:"sm",onClick:a,children:e.jsx(la,{className:"h-4 w-4"})}),e.jsx("h1",{className:"font-semibold text-lg truncate",children:s})]}),r&&e.jsx("div",{className:"flex items-center gap-2",children:r})]})}),er=({children:s,title:t="SokoConnect",showBack:a=!1,onBack:r})=>{const{user:n,signOut:c}=je(),l=Ne(),x=async()=>{await c(),l("/auth")},f=n?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{to:"/profile",children:e.jsx(b,{variant:"ghost",size:"sm",children:e.jsx(vs,{className:"h-4 w-4"})})}),e.jsx(b,{variant:"ghost",size:"sm",onClick:x,children:e.jsx($a,{className:"h-4 w-4"})})]}):null;return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(Dn,{title:t,showBack:a,onBack:r,actions:f}),e.jsx("main",{className:"pb-20 lg:pb-4",children:s}),e.jsx(Tn,{})]})},Bd=()=>{const{user:s}=je(),[t,a]=i.useState(""),[r,n]=i.useState(""),[c,l]=i.useState("weekly"),[x,f]=i.useState("1"),[j,N]=i.useState(""),[g,u]=i.useState([]),[d,h]=i.useState(""),[v,p]=i.useState([]);i.useEffect(()=>{s!=null&&s.id&&Mr(s.id).then(({data:y})=>u(y||[])),d&&Ir(d).then(({data:y})=>p(y||[]))},[s==null?void 0:s.id,d]);const m=async()=>{if(!(s!=null&&s.id))return;const y=`${t}-${r}`;await Id({consumer_id:s.id,farmer_id:j,box_type:y,frequency:c,duration_months:parseInt(x)}),Mr(s.id).then(({data:k})=>u(k||[]))},o=async y=>{await Rd(y),Ir(d).then(({data:k})=>p(k||[]))};return e.jsx(er,{title:"Farm-to-Consumer Boxes",children:e.jsxs("div",{className:"container mx-auto px-4 py-6 max-w-6xl pb-24",children:[e.jsxs(w,{className:"mb-6 border-primary/20 bg-gradient-to-br from-primary/5 to-primary/10",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ua,{className:"h-6 w-6 text-primary mt-1"}),e.jsxs("div",{children:[e.jsx(L,{className:"text-2xl",children:"What is Farmer-to-Consumer (F2C)?"}),e.jsx(G,{className:"mt-2 text-base",children:"Connect directly with local farmers and get fresh, seasonal produce delivered to your door"})]})]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsx("p",{className:"text-muted-foreground leading-relaxed",children:"Our Farm-to-Consumer subscription service eliminates the middleman, bringing you fresh, locally-grown produce straight from the farm to your home. Support local farmers, eat healthier, and reduce your carbon footprint all at once!"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 mt-4",children:[e.jsxs("div",{className:"bg-background rounded-lg p-4 border",children:[e.jsx(re,{className:"h-8 w-8 text-primary mb-2"}),e.jsx("h4",{className:"font-semibold mb-1",children:"Fresh & Seasonal"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Handpicked produce harvested at peak freshness"})]}),e.jsxs("div",{className:"bg-background rounded-lg p-4 border",children:[e.jsx(ye,{className:"h-8 w-8 text-primary mb-2"}),e.jsx("h4",{className:"font-semibold mb-1",children:"Direct Delivery"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"From farm to your doorstep in 24-48 hours"})]}),e.jsxs("div",{className:"bg-background rounded-lg p-4 border",children:[e.jsx(Qe,{className:"h-8 w-8 text-primary mb-2"}),e.jsx("h4",{className:"font-semibold mb-1",children:"Support Farmers"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your purchase directly supports local farming communities"})]})]})]})]}),e.jsxs(ge,{defaultValue:"subscribe",className:"space-y-6",children:[e.jsxs(pe,{className:"grid w-full grid-cols-2",children:[e.jsx(B,{value:"subscribe",children:"Subscribe to a Box"}),e.jsx(B,{value:"myboxes",children:"My Subscriptions"})]}),e.jsx(V,{value:"subscribe",children:e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Create Your Custom Subscription"}),e.jsx(G,{children:"Choose your preferred box size, delivery frequency, and subscription duration"})]}),e.jsxs(_,{className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"boxSize",children:"Container Type"}),e.jsxs(Q,{value:t,onValueChange:a,children:[e.jsx(W,{id:"boxSize",children:e.jsx(J,{placeholder:"Select container type"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"small-box",children:"Small Box"}),e.jsx(T,{value:"medium-box",children:"Medium Box"}),e.jsx(T,{value:"large-box",children:"Large Box"}),e.jsx(T,{value:"carton",children:"Carton"}),e.jsx(T,{value:"crate",children:"Crate"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"boxWeight",children:"Weight"}),e.jsxs(Q,{value:r,onValueChange:n,children:[e.jsx(W,{id:"boxWeight",children:e.jsx(J,{placeholder:"Select weight"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"10kg",children:"10 kg"}),e.jsx(T,{value:"20kg",children:"20 kg"}),e.jsx(T,{value:"30kg",children:"30 kg"}),e.jsx(T,{value:"40kg",children:"40 kg"}),e.jsx(T,{value:"50kg",children:"50 kg"}),e.jsx(T,{value:"60kg",children:"60 kg"}),e.jsx(T,{value:"70kg",children:"70 kg"}),e.jsx(T,{value:"80kg",children:"80 kg"}),e.jsx(T,{value:"90kg",children:"90 kg"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"frequency",children:"Delivery Frequency"}),e.jsxs(Q,{value:c,onValueChange:l,children:[e.jsx(W,{id:"frequency",children:e.jsx(J,{placeholder:"Select frequency"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"weekly",children:"Weekly"}),e.jsx(T,{value:"bi-weekly",children:"Bi-Weekly (Every 2 weeks)"}),e.jsx(T,{value:"monthly",children:"Monthly"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"duration",children:"Subscription Duration"}),e.jsxs(Q,{value:x,onValueChange:f,children:[e.jsx(W,{id:"duration",children:e.jsx(J,{placeholder:"Select duration"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"1",children:"1 Month"}),e.jsx(T,{value:"3",children:"3 Months (5% discount)"}),e.jsx(T,{value:"6",children:"6 Months (10% discount)"}),e.jsx(T,{value:"12",children:"12 Months (15% discount)"})]})]})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(C,{htmlFor:"farmerId",children:"Farmer/Cooperative (Optional)"}),e.jsx(D,{id:"farmerId",type:"text",placeholder:"Enter farmer ID or leave empty for automatic matching",value:j,onChange:y=>N(y.target.value)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Leave empty to be automatically matched with a nearby farmer"})]})]}),e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg space-y-2",children:[e.jsx("h4",{className:"font-semibold",children:"Your Selection:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t&&r?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"font-medium text-foreground",children:[t.replace("-"," ")," (",r,")"]})," delivered ",e.jsx("span",{className:"font-medium text-foreground",children:c})," for ",e.jsxs("span",{className:"font-medium text-foreground",children:[x," month(s)"]})]}):"Please select your preferences above"})]}),e.jsxs(b,{onClick:m,className:"w-full",size:"lg",disabled:!t||!r,children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Subscribe Now"]})]})]})}),e.jsx(V,{value:"myboxes",children:e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"My Active Subscriptions"}),e.jsx(G,{children:"Manage your subscription boxes and track deliveries"})]}),e.jsx(_,{children:g.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(re,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"No active subscriptions yet"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Subscribe to your first box to start receiving fresh farm produce!"})]}):e.jsx("div",{className:"space-y-4",children:g.map(y=>e.jsxs(w,{className:"border-2",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-lg",children:y.box_type}),e.jsxs(G,{children:[y.frequency," deliveries â€¢ Farmer: ",y.farmer_id]})]}),e.jsx(I,{variant:y.status==="active"?"default":"secondary",children:y.status})]})}),e.jsxs(_,{children:[e.jsxs(b,{onClick:()=>h(y.id),variant:"outline",className:"w-full",children:[e.jsx(xe,{className:"mr-2 h-4 w-4"}),"View Delivery Schedule"]}),d===y.id&&v.length>0&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Upcoming & Past Deliveries:"}),v.map(k=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(xe,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:new Date(k.delivery_date).toLocaleDateString()})]}),k.delivered?e.jsxs(I,{variant:"outline",className:"bg-green-50 text-green-700 border-green-300",children:[e.jsx(Qe,{className:"h-3 w-3 mr-1"}),"Delivered"]}):e.jsx(b,{size:"sm",onClick:()=>o(k.id),children:"Mark as Delivered"})]},k.id))]})]})]},y.id))})})]})})]})]})})},Ud=({onSuccess:s})=>{const[t,a]=i.useState(""),[r,n]=i.useState(""),[c,l]=i.useState("phone"),[x,f]=i.useState(!1),{toast:j}=Z(),N=async u=>{if(u.preventDefault(),!t.trim()){j({title:"Error",description:"Please enter your phone number",variant:"destructive"});return}f(!0);let d=t.trim();d.startsWith("0")?d="+254"+d.substring(1):d.startsWith("+")||(d="+254"+d);try{const{error:h}=await F.auth.signInWithOtp({phone:d});if(h)throw h;j({title:"OTP Sent",description:`Verification code sent to ${d}`}),l("otp")}catch(h){j({title:"Error",description:h.message||"Failed to send OTP",variant:"destructive"})}finally{f(!1)}},g=async u=>{if(u.preventDefault(),!r.trim()){j({title:"Error",description:"Please enter the verification code",variant:"destructive"});return}f(!0);let d=t.trim();d.startsWith("0")?d="+254"+d.substring(1):d.startsWith("+")||(d="+254"+d);try{const{error:h}=await F.auth.verifyOtp({phone:d,token:r,type:"sms"});if(h)throw h;j({title:"Success",description:"Phone number verified successfully!"}),s==null||s()}catch(h){j({title:"Error",description:h.message||"Invalid verification code",variant:"destructive"})}finally{f(!1)}};return c==="otp"?e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"otp",children:"Verification Code (Msimbo wa uthibitisho)"}),e.jsx(D,{id:"otp",type:"text",placeholder:"Enter 6-digit code / Ingiza msimbo wa tarakimu 6",value:r,onChange:u=>n(u.target.value),maxLength:6,required:!0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Code sent to ",t," / Msimbo ulitumwa kwa ",t]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{type:"button",variant:"outline",onClick:()=>l("phone"),disabled:x,children:"Back / Rudi"}),e.jsxs(b,{type:"submit",className:"flex-1",disabled:x,children:[x?e.jsx(As,{className:"h-4 w-4 animate-spin mr-2"}):null,"Verify / Thibitisha"]})]})]}):e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"phone",children:"Phone Number (Nambari ya simu)"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ee,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(D,{id:"phone",type:"tel",placeholder:"0712345678 or +254712345678",value:t,onChange:u=>a(u.target.value),className:"pl-10",required:!0})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enter your Kenyan phone number / Ingiza nambari yako ya simu ya Kenya"})]}),e.jsxs(b,{type:"submit",className:"w-full",disabled:x,children:[x?e.jsx(As,{className:"h-4 w-4 animate-spin mr-2"}):null,"Send Code / Tuma Msimbo"]})]})},sr="/assets/sokoconnect-logo-Bp75-8Zi.png",Vd=()=>{const{toast:s}=Z(),t=Ne(),[a,r]=i.useState(""),[n,c]=i.useState(""),[l,x]=i.useState(""),[f,j]=i.useState(!1),[N,g]=i.useState("login"),[u,d]=i.useState("email");i.useEffect(()=>{(async()=>{const{data:o}=await F.auth.getSession();o.session&&t("/")})()},[t]);const h=async m=>{if(m.preventDefault(),!a||!n){s({title:"Error",description:"Please fill in all fields",variant:"destructive"});return}j(!0);try{const{error:o}=await F.auth.signInWithPassword({email:a,password:n});if(o)throw o;s({title:"Success",description:"You have been logged in successfully!"}),t("/")}catch(o){s({title:"Error",description:o.message||"Failed to login. Please try again.",variant:"destructive"})}finally{j(!1)}},v=async m=>{if(m.preventDefault(),!a||!n||!l){s({title:"Error",description:"Please fill in all fields",variant:"destructive"});return}j(!0);try{const o=`${window.location.origin}/`,{error:y}=await F.auth.signUp({email:a,password:n,options:{emailRedirectTo:o,data:{full_name:l}}});if(y)throw y;s({title:"Success",description:"Your account has been created! Please check your email to verify your account."}),g("login")}catch(o){s({title:"Error",description:o.message||"Failed to create account. Please try again.",variant:"destructive"})}finally{j(!1)}},p=()=>{s({title:"Success",description:"You have been logged in successfully!"}),t("/")};return e.jsxs("div",{className:"min-h-screen relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{backgroundImage:`url(${xa})`,filter:"blur(8px)",transform:"scale(1.1)"}}),e.jsx("div",{className:"absolute inset-0 bg-black/50"}),e.jsx("div",{className:"relative z-10 min-h-screen flex items-center justify-center p-6",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("img",{src:sr,alt:"SokoConnect Logo",className:"h-20 w-20 object-contain"})}),e.jsxs("h1",{className:"text-4xl font-bold mb-2",children:[e.jsx("span",{className:"text-white",children:"Soko"}),e.jsx("span",{className:"text-green-400",children:"Connect"})]}),e.jsxs("p",{className:"text-gray-200 text-base font-medium",children:["SOKOCONNECT | ",e.jsx("span",{className:"text-green-400",children:"Tustawi"})]}),e.jsx("p",{className:"text-gray-300 text-sm mt-3 max-w-md mx-auto",children:"Connecting farmers, traders & markets - Empowering the entire agri-supply chain"})]}),e.jsxs(w,{className:"backdrop-blur-md bg-white/10 border-white/20 shadow-2xl",children:[e.jsxs(q,{className:"text-center",children:[e.jsx(L,{className:"text-xl text-white",children:"Welcome to SokoConnect"}),e.jsxs(G,{className:"text-gray-200",children:["Sign in or create an account to access all features",e.jsx("br",{}),e.jsx("span",{className:"text-sm text-gray-300",children:"Karibu SokoConnect - Ingia au fungua akaunti"})]})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsxs(b,{variant:u==="email"?"default":"outline",onClick:()=>d("email"),className:"flex-1 bg-white/20 border-white/30 text-white hover:bg-white/30",size:"sm",children:[e.jsx(He,{className:"h-4 w-4 mr-2"}),"Email"]}),e.jsxs(b,{variant:u==="phone"?"default":"outline",onClick:()=>d("phone"),className:"flex-1 bg-white/20 border-white/30 text-white hover:bg-white/30",size:"sm",children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Phone / Simu"]})]}),u==="phone"?e.jsx("div",{className:"mt-4",children:e.jsx(Ud,{onSuccess:p})}):e.jsxs(ge,{value:N,onValueChange:g,className:"w-full",children:[e.jsxs(pe,{className:"grid w-full grid-cols-2 bg-white/20",children:[e.jsx(B,{value:"login",className:"text-white data-[state=active]:bg-white data-[state=active]:text-gray-900",children:"Sign In"}),e.jsx(B,{value:"signup",className:"text-white data-[state=active]:bg-white data-[state=active]:text-gray-900",children:"Register Now"})]}),e.jsx(V,{value:"login",children:e.jsxs("form",{onSubmit:h,className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"email-login",className:"text-white",children:"Email"}),e.jsx(D,{id:"email-login",type:"email",placeholder:"your.email@example.com",value:a,onChange:m=>r(m.target.value),className:"bg-white/20 border-white/30 text-white placeholder:text-gray-300",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"password-login",className:"text-white",children:"Password"}),e.jsx(D,{id:"password-login",type:"password",value:n,onChange:m=>c(m.target.value),className:"bg-white/20 border-white/30 text-white placeholder:text-gray-300",required:!0})]}),e.jsx(b,{type:"submit",className:"w-full bg-gradient-to-r from-green-500 to-blue-600 hover:from-green-600 hover:to-blue-700 text-white font-semibold py-3",disabled:f,children:f?"Signing In...":"Sign In"}),e.jsx("div",{className:"text-center",children:e.jsx(X,{to:"/reset-password",className:"text-sm text-green-400 hover:text-green-300 transition-colors",children:"Forgot your password?"})})]})}),e.jsx(V,{value:"signup",children:e.jsxs("form",{onSubmit:v,className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"fullname-signup",className:"text-white",children:"Full Name"}),e.jsx(D,{id:"fullname-signup",placeholder:"Your Name",value:l,onChange:m=>x(m.target.value),className:"bg-white/20 border-white/30 text-white placeholder:text-gray-300",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"email-signup",className:"text-white",children:"Email"}),e.jsx(D,{id:"email-signup",type:"email",placeholder:"your.email@example.com",value:a,onChange:m=>r(m.target.value),className:"bg-white/20 border-white/30 text-white placeholder:text-gray-300",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"password-signup",className:"text-white",children:"Password"}),e.jsx(D,{id:"password-signup",type:"password",value:n,onChange:m=>c(m.target.value),className:"bg-white/20 border-white/30 text-white placeholder:text-gray-300",required:!0}),e.jsx("p",{className:"text-xs text-gray-300",children:"Password must be at least 6 characters long"})]}),e.jsx(b,{type:"submit",className:"w-full bg-gradient-to-r from-green-500 to-blue-600 hover:from-green-600 hover:to-blue-700 text-white font-semibold py-3",disabled:f,children:f?"Creating Account...":"Register Now"})]})})]})]}),e.jsxs(me,{className:"flex flex-col items-center space-y-4",children:[e.jsxs("p",{className:"text-sm text-gray-300 text-center",children:["By continuing, you agree to our Terms of Service and Privacy Policy.",e.jsx("br",{}),e.jsx("span",{className:"text-xs",children:"Kwa kuendelea, unakubali Sheria na Sera yetu ya Faragha."})]}),e.jsx("div",{className:"flex items-center text-white text-sm",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"font-bold",children:"SOKOCONNECT"}),e.jsx("span",{className:"mx-2",children:"|"}),e.jsx("span",{className:"text-xs text-green-400",children:"Tustawi"})]})}),e.jsx("p",{className:"text-xs text-gray-400",children:"Version 1.6.2.0*"})]})]})]})})]})},$d="/assets/about-hero-bg-CvsNFG-p.png",Gd=()=>{const s=Ne(),t=[{label:"Platform Launch",value:"2026",icon:e.jsx(se,{className:"h-5 w-5"})},{label:"Target Counties",value:"47",icon:e.jsx(ee,{className:"h-5 w-5"})},{label:"Beta Testers",value:"100+",icon:e.jsx(Ye,{className:"h-5 w-5"})},{label:"Development Stage",value:"85%",icon:e.jsx(ce,{className:"h-5 w-5"})}],a=[{icon:e.jsx(Si,{className:"h-6 w-6 text-primary"}),title:"Farm Management",description:"Comprehensive tools for crop tracking, inventory management, and yield optimization"},{icon:e.jsx(Re,{className:"h-6 w-6 text-primary"}),title:"Market Intelligence",description:"Real-time market prices, demand forecasting, and trade opportunities"},{icon:e.jsx(ye,{className:"h-6 w-6 text-primary"}),title:"Smart Logistics",description:"End-to-end logistics solutions connecting farmers to markets efficiently"},{icon:e.jsx(Ve,{className:"h-6 w-6 text-primary"}),title:"Financial Services",description:"Access to credit, insurance, and digital payment solutions"}];return e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),e.jsx("section",{className:"relative bg-gradient-to-br from-green-700 via-green-600 to-green-500 text-white py-20",style:{backgroundImage:`linear-gradient(rgba(21, 128, 61, 0.85), rgba(22, 163, 74, 0.85)), url(${$d})`,backgroundSize:"cover",backgroundPosition:"center"},children:e.jsxs("div",{className:"container mx-auto px-4 text-center relative z-10",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-6",children:"Transforming Agriculture in Kenya"}),e.jsx("p",{className:"text-lg md:text-xl mb-8 max-w-4xl mx-auto leading-relaxed",children:"SokoConnect empowers every stakeholder in the agricultural supply chain - from smallholder farmers to large-scale traders, transporters to processors, and cooperatives to consumers. We're building a connected ecosystem where everyone thrives through technology, transparency, and community collaboration."}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-4",children:[e.jsxs(b,{size:"lg",variant:"secondary",onClick:()=>s("/partner-with-us"),children:[e.jsx(He,{className:"h-4 w-4 mr-2"}),"Partner With Us"]}),e.jsxs(b,{size:"lg",variant:"outline",className:"bg-transparent border-white text-white hover:bg-white hover:text-green-700",children:["Join Platform",e.jsx(ks,{className:"h-4 w-4 ml-2"})]})]})]})}),e.jsx("section",{className:"py-16 bg-muted/30",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8",children:t.map((r,n)=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx("div",{className:"p-3 bg-primary/10 rounded-full",children:r.icon})}),e.jsx("div",{className:"text-3xl font-bold text-primary mb-2",children:r.value}),e.jsx("div",{className:"text-muted-foreground",children:r.label})]},n))})})}),e.jsxs("div",{className:"container mx-auto px-4 py-16",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-12 mb-16",children:[e.jsxs(w,{className:"border-l-4 border-l-primary",children:[e.jsx(q,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(na,{className:"h-5 w-5 text-primary"}),"Our Mission"]})}),e.jsx(_,{children:e.jsx("p",{className:"text-lg text-muted-foreground",children:"To revolutionize Kenya's agricultural sector by connecting all stakeholders - farmers, traders, transporters, cooperatives, processors, and consumers - with technology that enables market access, fair pricing, efficient logistics, and sustainable growth for everyone in the supply chain."})})]}),e.jsxs(w,{className:"border-l-4 border-l-secondary",children:[e.jsx(q,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"h-5 w-5 text-secondary"}),"Our Vision"]})}),e.jsx(_,{children:e.jsx("p",{className:"text-lg text-muted-foreground",children:"A digitally-enabled agricultural ecosystem where every farmer in Kenya has access to the tools, knowledge, and opportunities needed to thrive in modern agriculture and contribute to national food security."})})]})]}),e.jsxs("section",{className:"mb-16",children:[e.jsx("h2",{className:"text-3xl font-bold text-center mb-12",children:"What We Offer"}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6",children:a.map((r,n)=>e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(q,{children:[e.jsx("div",{className:"mb-3",children:r.icon}),e.jsx(L,{className:"text-lg",children:r.title})]}),e.jsx(_,{children:e.jsx("p",{className:"text-muted-foreground",children:r.description})})]},n))})]}),e.jsxs("section",{className:"mb-16 bg-gradient-to-r from-green-50 to-blue-50 rounded-lg p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Our Vision for Impact"}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"Launching in 2026 - We're building for measurable transformation"})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl font-bold text-green-600 mb-2",children:"100+"}),e.jsx("div",{className:"text-muted-foreground",children:"Beta users testing the platform"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:"47"}),e.jsx("div",{className:"text-muted-foreground",children:"Counties planned for coverage"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl font-bold text-orange-600 mb-2",children:"2026"}),e.jsx("div",{className:"text-muted-foreground",children:"Official launch year"})]})]})]}),e.jsx("section",{className:"mb-16",children:e.jsxs(w,{className:"bg-gradient-to-r from-primary/5 to-secondary/5",children:[e.jsxs(q,{children:[e.jsx(L,{className:"text-center text-2xl md:text-3xl mb-2",children:"Why Choose SokoConnect?"}),e.jsx("p",{className:"text-center text-muted-foreground",children:"Value for Every Stakeholder in the Agri-Supply Chain"})]}),e.jsx(_,{children:e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(se,{className:"h-8 w-8 text-primary"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"For Farmers"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Direct market access, fair prices, and farm management tools"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(ye,{className:"h-8 w-8 text-primary"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"For Traders"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Bulk sourcing, quality verification, and logistics coordination"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(Ye,{className:"h-8 w-8 text-primary"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"For Cooperatives"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Group orders, collective bargaining, and member management"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(We,{className:"h-8 w-8 text-primary"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Community First"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Built for all stakeholders - transparent, fair, and inclusive"})]})]})})]})}),e.jsx("section",{className:"text-center",children:e.jsx(w,{className:"bg-gradient-to-r from-green-700 to-green-600 text-white",children:e.jsxs(_,{className:"pt-8 pb-8",children:[e.jsx(We,{className:"h-12 w-12 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl md:text-3xl font-bold mb-4",children:"Ready to Transform Agriculture Together?"}),e.jsx("p",{className:"text-base md:text-lg mb-6 opacity-90 max-w-2xl mx-auto",children:"Join us in building Kenya's most comprehensive agricultural platform. Whether you're a farmer, trader, transporter, cooperative, or service provider - there's a place for you in the SokoConnect ecosystem."}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-4 mb-6",children:[e.jsxs(b,{variant:"secondary",size:"lg",onClick:()=>s("/partner-with-us"),children:[e.jsx(He,{className:"h-4 w-4 mr-2"}),"Contact Our Team"]}),e.jsx(b,{variant:"outline",size:"lg",className:"bg-transparent border-white text-white hover:bg-white hover:text-green-700",onClick:()=>s("/auth"),children:"Join Platform"})]}),e.jsx(qe,{className:"my-6 bg-white/20"}),e.jsxs("div",{className:"grid sm:grid-cols-2 md:grid-cols-3 gap-4 text-sm max-w-3xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 p-2",children:[e.jsx(He,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"break-words text-center text-xs sm:text-sm",children:"sokoconnect@tenderzville-portal.co.ke"})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 p-2",children:[e.jsx(Ee,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"text-center",children:"+254 745824354"})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 p-2 sm:col-span-2 md:col-span-1",children:[e.jsx(ee,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"text-center",children:"Nairobi, Kenya"})]})]})]})})})]})]})},Hd=()=>e.jsx("div",{className:"container mx-auto py-8",children:e.jsxs(w,{className:"max-w-lg mx-auto",children:[e.jsx(q,{children:e.jsx(L,{children:"Contact Us"})}),e.jsxs(_,{className:"space-y-4",children:[e.jsx(D,{placeholder:"Your Name"}),e.jsx(D,{placeholder:"Your Email",type:"email"}),e.jsx(le,{placeholder:"Your Message"}),e.jsx(b,{className:"w-full",children:"Send Message"})]})]})}),Wd=()=>{const{user:s}=je(),{toast:t}=Z(),[a,r]=i.useState(!1),[n,c]=i.useState(!1),l=i.useRef(null),[x,f]=i.useState({full_name:"",email:(s==null?void 0:s.email)||"",contact_number:"",county:"",bio:"",farm_size:0,farm_type:"",experience_years:0,specialization:[],avatar_url:""}),[j,N]=i.useState("");Bs.useEffect(()=>{s&&g()},[s]);const g=async()=>{try{const{data:m,error:o}=await F.from("profiles").select("*").eq("user_id",s==null?void 0:s.id).maybeSingle();if(o&&o.code!=="PGRST116")throw o;m&&f({full_name:m.full_name||"",email:m.email||(s==null?void 0:s.email)||"",contact_number:m.contact_number||"",county:m.county||"",bio:m.bio||"",farm_size:m.farm_size||0,farm_type:m.farm_type||"",experience_years:m.experience_years||0,specialization:m.specialization||[],avatar_url:m.avatar_url||""})}catch(m){console.error("Error fetching profile:",m)}},u=async m=>{if(!s)return null;if(m.size>2*1024*1024)return t({title:"File too large",description:"Please select an image under 2MB",variant:"destructive"}),null;c(!0);try{const o=m.name.split(".").pop(),y=`${s.id}/avatar.${o}`,{error:k}=await F.storage.from("profile-pictures").upload(y,m,{upsert:!0});if(k)throw k;const{data:A}=F.storage.from("profile-pictures").getPublicUrl(y);return A.publicUrl}catch(o){return console.error("Error uploading avatar:",o),t({title:"Upload failed",description:"Failed to upload profile picture",variant:"destructive"}),null}finally{c(!1)}},d=async m=>{var y;const o=(y=m.target.files)==null?void 0:y[0];if(o){const k=await u(o);k&&f(A=>({...A,avatar_url:k}))}},h=()=>{j.trim()&&!x.specialization.includes(j.trim())&&(f(m=>({...m,specialization:[...m.specialization,j.trim()]})),N(""))},v=m=>{f(o=>({...o,specialization:o.specialization.filter(y=>y!==m)}))},p=async()=>{if(s){r(!0);try{const{error:m}=await F.from("profiles").upsert({user_id:s.id,...x},{onConflict:"user_id"});if(m)throw m;t({title:"Success",description:"Profile updated successfully!"})}catch(m){console.error("Error saving profile:",m),t({title:"Error",description:"Failed to save profile",variant:"destructive"})}finally{r(!1)}}};return e.jsxs(w,{className:"max-w-4xl mx-auto",children:[e.jsx(q,{children:e.jsx(L,{children:"Edit Profile"})}),e.jsxs(_,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(Us,{className:"h-20 w-20",children:[e.jsx(rt,{src:x.avatar_url}),e.jsx(Vs,{children:x.full_name.split(" ").map(m=>m[0]).join("").toUpperCase()||"U"})]}),e.jsxs("div",{children:[e.jsxs(b,{variant:"outline",onClick:()=>{var m;return(m=l.current)==null?void 0:m.click()},disabled:n,children:[e.jsx(zi,{className:"h-4 w-4 mr-2"}),n?"Uploading...":"Change Photo"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Max 2MB. JPG, PNG supported."}),e.jsx("input",{ref:l,type:"file",accept:"image/*",onChange:d,className:"hidden"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"full_name",children:"Full Name"}),e.jsx(D,{id:"full_name",value:x.full_name,onChange:m=>f(o=>({...o,full_name:m.target.value})),placeholder:"Your full name"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"email",children:"Email"}),e.jsx(D,{id:"email",value:x.email,disabled:!0,className:"bg-muted"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"contact_number",children:"Contact Number"}),e.jsx(D,{id:"contact_number",value:x.contact_number,onChange:m=>f(o=>({...o,contact_number:m.target.value})),placeholder:"+254 7XX XXX XXX"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"county",children:"County"}),e.jsxs(Q,{value:x.county,onValueChange:m=>f(o=>({...o,county:m})),children:[e.jsx(W,{children:e.jsx(J,{placeholder:"Select your county"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"nairobi",children:"Nairobi"}),e.jsx(T,{value:"kiambu",children:"Kiambu"}),e.jsx(T,{value:"machakos",children:"Machakos"}),e.jsx(T,{value:"kajiado",children:"Kajiado"}),e.jsx(T,{value:"murang'a",children:"Murang'a"}),e.jsx(T,{value:"nyeri",children:"Nyeri"}),e.jsx(T,{value:"kirinyaga",children:"Kirinyaga"}),e.jsx(T,{value:"nyandarua",children:"Nyandarua"}),e.jsx(T,{value:"laikipia",children:"Laikipia"}),e.jsx(T,{value:"nakuru",children:"Nakuru"}),e.jsx(T,{value:"uasin-gishu",children:"Uasin Gishu"}),e.jsx(T,{value:"trans-nzoia",children:"Trans Nzoia"}),e.jsx(T,{value:"bungoma",children:"Bungoma"}),e.jsx(T,{value:"kakamega",children:"Kakamega"}),e.jsx(T,{value:"vihiga",children:"Vihiga"}),e.jsx(T,{value:"siaya",children:"Siaya"}),e.jsx(T,{value:"kisumu",children:"Kisumu"}),e.jsx(T,{value:"homa-bay",children:"Homa Bay"}),e.jsx(T,{value:"migori",children:"Migori"}),e.jsx(T,{value:"kisii",children:"Kisii"}),e.jsx(T,{value:"nyamira",children:"Nyamira"}),e.jsx(T,{value:"meru",children:"Meru"}),e.jsx(T,{value:"tharaka-nithi",children:"Tharaka Nithi"}),e.jsx(T,{value:"embu",children:"Embu"}),e.jsx(T,{value:"kitui",children:"Kitui"}),e.jsx(T,{value:"machakos",children:"Machakos"}),e.jsx(T,{value:"makueni",children:"Makueni"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"bio",children:"Bio"}),e.jsx(le,{id:"bio",value:x.bio,onChange:m=>f(o=>({...o,bio:m.target.value})),placeholder:"Tell us about yourself and your farming journey...",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"farm_size",children:"Farm Size (Acres)"}),e.jsx(D,{id:"farm_size",type:"number",value:x.farm_size,onChange:m=>f(o=>({...o,farm_size:parseFloat(m.target.value)||0})),placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"farm_type",children:"Farm Type"}),e.jsxs(Q,{value:x.farm_type,onValueChange:m=>f(o=>({...o,farm_type:m})),children:[e.jsx(W,{children:e.jsx(J,{placeholder:"Select farm type"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"mixed",children:"Mixed Farming"}),e.jsx(T,{value:"crop",children:"Crop Production"}),e.jsx(T,{value:"livestock",children:"Livestock"}),e.jsx(T,{value:"poultry",children:"Poultry"}),e.jsx(T,{value:"dairy",children:"Dairy"}),e.jsx(T,{value:"horticulture",children:"Horticulture"}),e.jsx(T,{value:"greenhouse",children:"Greenhouse"}),e.jsx(T,{value:"fish",children:"Fish Farming"}),e.jsx(T,{value:"organic",children:"Organic Farming"})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"experience_years",children:"Years of Experience"}),e.jsx(D,{id:"experience_years",type:"number",value:x.experience_years,onChange:m=>f(o=>({...o,experience_years:parseInt(m.target.value)||0})),placeholder:"0"})]})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Specializations"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:x.specialization.map(m=>e.jsxs(I,{variant:"secondary",className:"flex items-center gap-1",children:[m,e.jsx("button",{onClick:()=>v(m),className:"ml-1 hover:text-destructive",children:"Ã—"})]},m))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{value:j,onChange:m=>N(m.target.value),placeholder:"Add specialization (e.g., Maize, Tomatoes, Dairy)",onKeyPress:m=>m.key==="Enter"&&(m.preventDefault(),h())}),e.jsx(b,{type:"button",variant:"outline",onClick:h,children:"Add"})]})]}),e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-blue-50 rounded-lg",children:[e.jsx(hs,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-blue-900",children:"Privacy Notice"}),e.jsx("p",{className:"text-blue-800",children:"Your profile information helps connect you with relevant opportunities and fellow farmers. You can control what information is visible to others in your privacy settings."})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(b,{onClick:p,disabled:a,children:[e.jsx(ql,{className:"h-4 w-4 mr-2"}),a?"Saving...":"Save Profile"]})})]})]})},En=({userId:s,userType:t,profileData:a})=>{const[r,n]=i.useState(""),[c,l]=i.useState(""),[x,f]=i.useState(!1),{toast:j}=Z(),N="your-secret-key-change-in-production",g=p=>Oi.HmacSHA256(p,N).toString();i.useEffect(()=>{u()},[s]);const u=async()=>{try{f(!0);const p={userId:s,userType:t,name:(a==null?void 0:a.full_name)||"User",verified:(a==null?void 0:a.verification_status)==="verified",timestamp:Date.now(),version:1},m=JSON.stringify(p),o=g(m),y={data:p,signature:o},k=await Ll.toDataURL(JSON.stringify(y),{errorCorrectionLevel:"H",width:400,margin:2,color:{dark:"#000000",light:"#FFFFFF"}});n(k);const{data:A}=await F.from("qr_codes").select("id").eq("user_id",s).eq("is_active",!0).single();if(A)await F.from("qr_codes").update({qr_data:m,signature:o,qr_image_url:k,version:p.version,updated_at:new Date().toISOString()}).eq("id",A.id),l(A.id);else{const{data:S,error:E}=await F.from("qr_codes").insert({user_id:s,qr_data:m,signature:o,qr_image_url:k,version:p.version}).select().single();if(E)throw E;S&&l(S.id)}j({title:"QR Code Generated",description:"Your Trust Passport QR code is ready!"})}catch(p){console.error("Error generating QR code:",p),j({title:"Generation Failed",description:"Could not generate QR code. Please try again.",variant:"destructive"})}finally{f(!1)}},d=async()=>{try{const p=await fetch(r).then(y=>y.blob()),m=`trust-passport-${s}.png`,o=new FileReader;o.readAsDataURL(p),o.onloadend=async()=>{const k=o.result.split(",")[1];try{const A=await Il.writeFile({path:m,data:k,directory:Rl.Documents});j({title:"QR Code Saved",description:"Saved to your device gallery!"})}catch{const S=document.createElement("a");S.download=m,S.href=r,S.click(),j({title:"QR Code Downloaded",description:"Check your downloads folder"})}}}catch(p){console.error("Error saving QR code:",p),j({title:"Save Failed",description:"Could not save QR code",variant:"destructive"})}},h=async()=>{try{await zl.share({title:"My Trust Passport",text:"Scan my Trust Passport QR code to verify my profile on SokoConnect!",url:r,dialogTitle:"Share Trust Passport"})}catch(p){console.error("Error sharing:",p),j({title:"Share Failed",description:"Could not share QR code",variant:"destructive"})}},v=()=>{const p=window.open("","_blank");p&&(p.document.write(`
        <!DOCTYPE html>
        <html>
          <head>
            <title>Trust Passport - ${a==null?void 0:a.full_name}</title>
            <style>
              body { 
                font-family: Arial, sans-serif; 
                display: flex; 
                flex-direction: column;
                align-items: center; 
                justify-content: center;
                padding: 20px;
              }
              .header { text-align: center; margin-bottom: 20px; }
              .qr-container { 
                border: 3px solid #000; 
                padding: 20px; 
                border-radius: 10px;
                background: white;
              }
              .footer { 
                margin-top: 20px; 
                text-align: center; 
                font-size: 12px;
              }
            </style>
          </head>
          <body>
            <div class="header">
              <h1>SokoConnect Trust Passport</h1>
              <h2>${(a==null?void 0:a.full_name)||"User"}</h2>
              <p>${t.charAt(0).toUpperCase()+t.slice(1).replace("_"," ")}</p>
            </div>
            <div class="qr-container">
              <img src="${r}" alt="QR Code" style="width: 300px; height: 300px;" />
            </div>
            <div class="footer">
              <p><strong>Scan to verify profile and award trust points</strong></p>
              <p>SokoConnect - Building Trust in Agriculture</p>
            </div>
          </body>
        </html>
      `),p.document.close(),setTimeout(()=>{p.print()},250))};return e.jsxs(w,{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(mt,{className:"h-5 w-5"}),"Trust Passport QR Code"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Let buyers scan to verify your profile and earn trust points"})]}),e.jsxs(b,{variant:"outline",size:"sm",onClick:u,disabled:x,children:[e.jsx(Ss,{className:`h-4 w-4 mr-2 ${x?"animate-spin":""}`}),"Regenerate"]})]}),r&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-center p-6 bg-white rounded-lg border-2 border-dashed",children:e.jsx("img",{src:r,alt:"Trust Passport QR Code",className:"w-64 h-64"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs(b,{onClick:d,variant:"default",className:"w-full",children:[e.jsx(ca,{className:"h-4 w-4 mr-2"}),"Save to Phone"]}),e.jsxs(b,{onClick:h,variant:"default",className:"w-full",children:[e.jsx(Js,{className:"h-4 w-4 mr-2"}),"Share"]}),e.jsxs(b,{onClick:v,variant:"outline",className:"w-full",children:[e.jsx(Ml,{className:"h-4 w-4 mr-2"}),"Print"]})]}),e.jsxs("div",{className:"text-xs text-center text-muted-foreground",children:[e.jsx("p",{children:"Print and display this QR code at your farm/store."}),e.jsx("p",{children:"Earn 1 trust point every time it's scanned by a buyer!"})]})]})]})},Yd=()=>{const{user:s}=je(),t=Ne(),[a,r]=i.useState(null),[n,c]=i.useState(null),[l,x]=i.useState(!1);i.useEffect(()=>{s&&f()},[s]);const f=async()=>{if(!s)return;const{data:j}=await F.from("profiles").select("*").eq("user_id",s.id).single();j&&r(j);const{data:N}=await F.from("trust_points").select("*").eq("user_id",s.id).single();N&&c(N)};return s?e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),e.jsxs("main",{className:"container mx-auto py-8 px-4",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(b,{variant:"outline",onClick:()=>t(-1),children:[e.jsx(Wa,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Profile Settings"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your account information and preferences"})]})]}),e.jsxs(b,{onClick:()=>x(!l),variant:l?"default":"outline",children:[e.jsx(mt,{className:"h-4 w-4 mr-2"}),l?"Hide QR Code":"My QR Code"]})]}),n&&e.jsx(w,{className:"p-4 mb-6 bg-gradient-to-r from-green-50 to-blue-50 border-green-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ps,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Trust Level"}),e.jsxs("div",{className:"text-2xl font-bold text-green-700",children:[n.level.toUpperCase()," - ",n.total_points," Points"]})]})]}),e.jsx(b,{variant:"ghost",onClick:()=>t(`/verify/${s.id}`),children:"View Public Profile"})]})}),l&&e.jsx("div",{className:"mb-6",children:e.jsx(En,{userId:s.id,userType:"farmer",profileData:a})}),e.jsx(Wd,{})]})]}):e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),e.jsxs("div",{className:"container mx-auto py-8 text-center",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Access Denied"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Please sign in to view your profile."}),e.jsx(b,{onClick:()=>t("/auth"),children:"Sign In"})]})]})},Qd=()=>e.jsxs("div",{className:"container mx-auto py-8",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{placeholder:"Search for products, farmers, or services...",className:"flex-1"}),e.jsxs(b,{children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"Search"]})]})}),e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"Search Results"})}),e.jsx(_,{children:e.jsx("p",{className:"text-muted-foreground",children:"Enter a search term to find products, farmers, or services in the AgriConnect platform."})})]})]}),Jd=async()=>{try{console.log("Fetching logistics stats from database...");const{count:s}=await F.from("transporters").select("*",{count:"exact",head:!0}),{count:t}=await F.from("warehouses").select("*",{count:"exact",head:!0}),{count:a}=await F.from("aggregators").select("*",{count:"exact",head:!0}).eq("is_active",!0),{count:r}=await F.from("processors").select("*",{count:"exact",head:!0}).eq("is_active",!0),{count:n}=await F.from("micro_creditors").select("*",{count:"exact",head:!0}).eq("is_active",!0),c=15,{data:l}=await F.from("aggregators").select("county").eq("is_active",!0),x=new Set((l==null?void 0:l.map(f=>f.county))||[]);return{activeTransporters:s||0,storageFacilities:t||0,countiesCovered:x.size,monthlyDeliveries:1240,aggregators:a||0,processors:r||0,microCreditors:n||0,p2pLenders:c||0}}catch(s){return console.error("Error fetching logistics stats:",s),{activeTransporters:0,storageFacilities:0,countiesCovered:0,monthlyDeliveries:0,aggregators:0,processors:0,microCreditors:0,p2pLenders:0}}},Xd=async()=>{try{console.log("Fetching all logistics providers...");const s=[],{data:t}=await F.from("transporters").select("*");t&&t.forEach(l=>{s.push({id:l.id,name:l.name,type:"transport",description:`${l.service_type} - ${l.capacity}`,location:l.counties.join(", "),county:l.counties[0]||"",contact_phone:l.contact_info,contact_email:"",is_verified:!0,rating:4.2,services:[l.service_type],coordinates:{latitude:-1.2921,longitude:36.8219}})});const{data:a}=await F.from("aggregators").select("*").eq("is_active",!0);a&&a.forEach(l=>{s.push({id:l.id,name:l.aggregator_name,type:"aggregator",description:`Handles: ${l.commodities_handled.join(", ")}`,location:`${l.county}, ${l.sub_county||""}`,county:l.county,contact_phone:l.contact_phone,contact_email:l.contact_email,is_verified:l.is_verified,rating:l.rating,services:l.commodities_handled,coordinates:l.coordinates})});const{data:r}=await F.from("processors").select("*").eq("is_active",!0);r&&r.forEach(l=>{s.push({id:l.id,name:l.processor_name,type:"processor",description:`Processes: ${l.raw_materials_needed.join(", ")}`,location:`${l.county}, ${l.sub_county||""}`,county:l.county,contact_phone:l.contact_phone,contact_email:l.contact_email,is_verified:l.is_verified,rating:l.rating,services:l.processed_products,coordinates:l.coordinates})});const{data:n}=await F.from("micro_creditors").select("*").eq("is_active",!0);n&&n.forEach(l=>{s.push({id:l.id,name:l.institution_name,type:"microcredit",description:`${l.institution_type} - ${l.interest_rate_range}`,location:`${l.county}, ${l.sub_county||""}`,county:l.county,contact_phone:l.contact_phone,contact_email:l.contact_email,is_verified:l.is_licensed,rating:l.rating,services:l.target_sectors,coordinates:l.coordinates})});const c=[{id:"warehouse-1",name:"Central Storage Facility",type:"storage",description:"Modern cold storage facility - 5000 tons capacity",location:"Nakuru, Nakuru",county:"Nakuru",contact_phone:"+254 700 234 567",contact_email:"info@centralstorage.co.ke",is_verified:!0,rating:4.5,services:["Cold Storage","Dry Storage","Packaging"],coordinates:{latitude:-.3031,longitude:36.08}},{id:"microcredit-1",name:"AgriCredit Solutions",type:"microcredit",description:"Microfinance institution - 5-15% interest rates",location:"Kisumu, Kisumu",county:"Kisumu",contact_phone:"+254 700 345 678",contact_email:"loans@agricredit.co.ke",is_verified:!0,rating:4.3,services:["Farm Loans","Equipment Finance","Working Capital"],coordinates:{latitude:-.0917,longitude:34.768}},{id:"p2p-1",name:"FarmLink P2P",type:"p2p_lending",description:"Peer-to-peer lending platform - 8-20% interest",location:"Mombasa, Mombasa",county:"Mombasa",contact_phone:"+254 700 456 789",contact_email:"support@farmlink.co.ke",is_verified:!0,rating:4.2,services:["Quick Loans","Seasonal Finance","Equipment Loans"],coordinates:{latitude:-4.0435,longitude:39.6682}}];return s.push(...c),console.log(`Found ${s.length} total providers`),s}catch(s){return console.error("Error fetching logistics providers:",s),[]}},Os=({label:s,value:t,icon:a})=>e.jsxs(w,{children:[e.jsxs(q,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:s}),a]}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold",children:t})})]}),Zd=()=>{const[s,t]=i.useState({activeTransporters:0,storageFacilities:0,countiesCovered:0,monthlyDeliveries:0,aggregators:0,processors:0,microCreditors:0,p2pLenders:0}),[a,r]=i.useState([]),[n,c]=i.useState(!0),[l,x]=i.useState(""),[f,j]=i.useState(""),[N,g]=i.useState("");i.useEffect(()=>{(async()=>{try{c(!0),console.log("Fetching logistics data...");const[m,o]=await Promise.all([Jd(),Xd()]);console.log("Stats data:",m),console.log("Providers data:",o),t(m),r(o)}catch(m){console.error("Error fetching logistics data:",m)}finally{c(!1)}})()},[]);const u=["Nairobi","Mombasa","Kisumu","Nakuru","Eldoret","Thika","Kiambu","Machakos","Meru","Embu","Nyeri","Muranga"],d=a.filter(p=>{const m=p.name.toLowerCase().includes(l.toLowerCase()),o=!f||f==="all"||p.county===f,y=!N||N==="all"||p.type===N;return m&&o&&y}),h=p=>{switch(p){case"transport":return e.jsx(ye,{className:"h-5 w-5"});case"storage":return e.jsx(Ts,{className:"h-5 w-5"});case"aggregator":return e.jsx(re,{className:"h-5 w-5"});case"processor":return e.jsx(gr,{className:"h-5 w-5"});case"microcredit":return e.jsx(Zs,{className:"h-5 w-5"});case"p2p_lending":return e.jsx(Ae,{className:"h-5 w-5"});default:return e.jsx(se,{className:"h-5 w-5"})}},v=p=>{switch(p){case"transport":return"Transport";case"storage":return"Storage";case"aggregator":return"Aggregator";case"processor":return"Processor";case"microcredit":return"Micro Credit";case"p2p_lending":return"P2P Lending";default:return p}};return n?e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg",children:"Loading logistics data from database..."}),e.jsx("div",{className:"text-sm text-muted-foreground mt-2",children:"Fetching real providers and facilities"})]})})]}):e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"Smart Logistics Network"}),e.jsx("p",{className:"text-lg text-muted-foreground",children:"Connect with verified transport providers, storage facilities, aggregators, processors, and financial services across Kenya"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4 mb-8",children:[e.jsx(Os,{label:"Transporters",value:s.activeTransporters,icon:e.jsx(ye,{className:"h-4 w-4 text-primary"})}),e.jsx(Os,{label:"Storage",value:s.storageFacilities,icon:e.jsx(Ts,{className:"h-4 w-4 text-primary"})}),e.jsx(Os,{label:"Aggregators",value:s.aggregators,icon:e.jsx(re,{className:"h-4 w-4 text-primary"})}),e.jsx(Os,{label:"Processors",value:s.processors,icon:e.jsx(gr,{className:"h-4 w-4 text-primary"})}),e.jsx(Os,{label:"Micro Credit",value:s.microCreditors,icon:e.jsx(Zs,{className:"h-4 w-4 text-primary"})}),e.jsx(Os,{label:"P2P Lending",value:s.p2pLenders,icon:e.jsx(Ae,{className:"h-4 w-4 text-primary"})}),e.jsx(Os,{label:"Counties",value:s.countiesCovered,icon:e.jsx(es,{className:"h-5 w-5 text-primary"})}),e.jsx(Os,{label:"Monthly",value:s.monthlyDeliveries,icon:e.jsx(se,{className:"h-5 w-5 text-primary"})})]}),e.jsxs(w,{className:"mb-8",children:[e.jsx(q,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(It,{className:"h-5 w-5"}),"Filter Services"]})}),e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(D,{placeholder:"Search providers...",value:l,onChange:p=>x(p.target.value)}),e.jsxs(Q,{value:f,onValueChange:j,children:[e.jsx(W,{children:e.jsx(J,{placeholder:"Select County"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Counties"}),u.map(p=>e.jsx(T,{value:p,children:p},p))]})]}),e.jsxs(Q,{value:N,onValueChange:g,children:[e.jsx(W,{children:e.jsx(J,{placeholder:"Service Type"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Services"}),e.jsx(T,{value:"transport",children:"Transport"}),e.jsx(T,{value:"storage",children:"Storage"}),e.jsx(T,{value:"aggregator",children:"Aggregators"}),e.jsx(T,{value:"processor",children:"Processors"}),e.jsx(T,{value:"microcredit",children:"Micro Credit"}),e.jsx(T,{value:"p2p_lending",children:"P2P Lending"})]})]}),e.jsx(b,{variant:"outline",onClick:()=>{x(""),j("all"),g("all")},children:"Clear Filters"})]})})]}),e.jsx("div",{className:"grid gap-6",children:d.length===0?e.jsx(w,{children:e.jsxs(_,{className:"p-8 text-center",children:[e.jsx(re,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Providers Found"}),e.jsx("p",{className:"text-muted-foreground",children:l||f||N?"Try adjusting your filters to see more results.":"Providers will appear here once they register on the platform."})]})}):d.map(p=>e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[h(p.type),p.name]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:p.location})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(es,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"ml-1 text-sm",children:p.rating})]}),e.jsx(I,{variant:"secondary",children:v(p.type)}),p.is_verified&&e.jsx(I,{variant:"default",children:"Verified"})]})]})}),e.jsxs(_,{children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:p.description}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[p.services.slice(0,3).map(m=>e.jsx(I,{variant:"outline",children:m},m)),p.services.length>3&&e.jsxs(I,{variant:"outline",children:["+",p.services.length-3," more"]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:p.contact_phone})]}),e.jsx(b,{size:"sm",children:"Connect"})]})]})]},p.id))})]})]})},Ca=[{id:"sp1",name:"KenStore Warehousing",businessType:"storage",description:"Modern storage solutions for agricultural produce with temperature control facilities.",services:["Dry Storage","Cold Storage","Fumigation","Quality Monitoring"],location:{county:"Nairobi County",specificLocation:"Industrial Area",coordinates:{latitude:-1.3031934,longitude:36.8719419}},contactInfo:"info@kenstore.co.ke | +254 712 345 678",rates:"KES 300-500 per ton/month",verified:!0,rating:4.7,reviewCount:28,tags:["warehouse","cold-chain","fumigation"],createdAt:"2023-01-15T08:40:00Z",updatedAt:"2023-08-20T14:30:00Z"},{id:"sp2",name:"AgriTransport Logistics",businessType:"transport",description:"Reliable transportation services for agricultural goods across East Africa.",services:["Refrigerated Transport","Bulk Transport","Real-time Tracking"],location:{county:"Mombasa County",specificLocation:"Port Area",coordinates:{latitude:-4.052052,longitude:39.6662227}},contactInfo:"logistics@agritransport.com | +254 722 000 111",rates:"KES 5000-8000 per trip",verified:!0,rating:4.5,reviewCount:35,tags:["transport","logistics","refrigerated"],createdAt:"2023-02-20T10:00:00Z",updatedAt:"2023-09-10T16:00:00Z"},{id:"sp3",name:"CropSure Quality Control",businessType:"quality-control",description:"Ensuring the quality of your produce with certified inspection and testing services.",services:["Soil Testing","Crop Inspection","Certification","Training"],location:{county:"Nakuru County",specificLocation:"Agricultural Center",coordinates:{latitude:-.274744,longitude:36.0759359}},contactInfo:"quality@cropsure.co.ke | +254 733 999 888",rates:"KES 1000-2000 per test",verified:!0,rating:4.8,reviewCount:42,tags:["quality-control","testing","inspection"],createdAt:"2023-03-10T12:30:00Z",updatedAt:"2023-07-25T09:15:00Z"},{id:"sp4",name:"FarmLink Market Access",businessType:"market-linkage",description:"Connecting farmers with reliable markets for their produce.",services:["Market Information","Buyer Connections","Contract Negotiation"],location:{county:"Kisumu County",specificLocation:"Market Square",coordinates:{latitude:-.0917325,longitude:34.7557352}},contactInfo:"markets@farmlink.org | +254 744 555 666",rates:"5% commission on sales",verified:!0,rating:4.6,reviewCount:30,tags:["market-linkage","sales","farmers"],createdAt:"2023-04-01T15:00:00Z",updatedAt:"2023-08-15T11:45:00Z"},{id:"sp5",name:"AgriTrain Training Services",businessType:"training",description:"Providing farmers with the knowledge and skills they need to improve their yields and incomes.",services:["Crop Management","Pest Control","Financial Literacy"],location:{county:"Uasin Gishu County",specificLocation:"Eldoret Town",coordinates:{latitude:.516667,longitude:35.266667}},contactInfo:"training@agritrain.co.ke | +254 755 777 888",rates:"KES 2000 per course",verified:!0,rating:4.9,reviewCount:50,tags:["training","skills","farmers"],createdAt:"2023-05-10T09:00:00Z",updatedAt:"2023-09-01T13:30:00Z"},{id:"sp6",name:"SeedCo Input Supplies",businessType:"input-supplier",description:"Supplying farmers with high-quality seeds and fertilizers to maximize their yields.",services:["Seeds","Fertilizers","Pesticides","Equipment"],location:{county:"Kiambu County",specificLocation:"Thika Town",coordinates:{latitude:-1.0374365,longitude:37.0937757}},contactInfo:"supplies@seedco.com | +254 766 888 999",rates:"Market rates",verified:!0,rating:4.7,reviewCount:38,tags:["seeds","fertilizers","equipment"],createdAt:"2023-06-01T11:00:00Z",updatedAt:"2023-08-25T10:00:00Z"},{id:"sp7",name:"AgriSure Insurance Services",businessType:"inspector",description:"Providing insurance services to farmers to protect them against crop losses.",services:["Crop Insurance","Livestock Insurance","Weather Index Insurance"],location:{county:"Nyeri County",specificLocation:"Town Center",coordinates:{latitude:-.420833,longitude:36.951111}},contactInfo:"insurance@agrisure.co.ke | +254 777 999 000",rates:"Varies based on coverage",verified:!0,rating:4.5,reviewCount:25,tags:["insurance","protection","farmers"],createdAt:"2023-07-01T14:00:00Z",updatedAt:"2023-09-15T17:00:00Z"}],ka=[{id:"d1",title:"Best Practices for Quality Control in Maize Storage",description:"A discussion on ensuring quality standards for maize in storage facilities across Kenya.",date:"2023-09-15",location:"Nairobi County",organizer:"Kenya Bureau of Standards",attendees:45,tags:["maize","storage","quality-standards","pest-control"],authorName:"John Mwangi",authorType:"Quality Control Officer"},{id:"d2",title:"Organic Farming Techniques Workshop",description:"A workshop focusing on sustainable organic farming methods to improve crop yield and soil health.",date:"2023-09-22",location:"Nakuru County",organizer:"Agricultural Society of Kenya",attendees:60,tags:["organic-farming","sustainable-agriculture","soil-health","crop-yield"],authorName:"Aisha Patel",authorType:"Agronomist"},{id:"d3",title:"Post-Harvest Handling of Horticultural Crops",description:"Training on best practices for handling horticultural crops after harvest to minimize losses and maintain quality.",date:"2023-10-01",location:"Kiambu County",organizer:"Horticultural Crops Directorate",attendees:30,tags:["post-harvest","horticulture","crop-handling","quality-control"],authorName:"Samuel Kimani",authorType:"Agricultural Extension Officer"},{id:"d4",title:"Financial Literacy for Smallholder Farmers",description:"A seminar aimed at improving the financial management skills of smallholder farmers.",date:"2023-10-10",location:"Muranga County",organizer:"Ministry of Agriculture",attendees:50,tags:["financial-literacy","smallholder-farmers","financial-management","agribusiness"],authorName:"Esther Njoroge",authorType:"Financial Advisor"},{id:"d5",title:"Climate-Smart Agriculture Practices",description:"A workshop on adopting climate-smart agricultural practices to build resilience to climate change.",date:"2023-10-18",location:"Machakos County",organizer:"Food and Agriculture Organization",attendees:40,tags:["climate-smart-agriculture","climate-change","resilience","sustainable-farming"],authorName:"David Omondi",authorType:"Climate Change Expert"},{id:"d6",title:"Integrated Pest and Disease Management",description:"Training on effective and environmentally friendly methods for managing pests and diseases in crops.",date:"2023-10-25",location:"Kisumu County",organizer:"Kenya Agricultural and Livestock Research Organization",attendees:35,tags:["pest-management","disease-control","integrated-farming","crop-protection"],authorName:"Grace Otieno",authorType:"Plant Pathologist"},{id:"d7",title:"Water Management and Irrigation Techniques",description:"A seminar on efficient water management and modern irrigation techniques for crop production.",date:"2023-11-02",location:"Laikipia County",organizer:"Water Resources Management Authority",attendees:48,tags:["water-management","irrigation","water-conservation","crop-production"],authorName:"Peter Kamau",authorType:"Irrigation Engineer"},{id:"d8",title:"Value Addition and Agro-processing Opportunities",description:"A workshop exploring opportunities for value addition and agro-processing to increase farmer incomes.",date:"2023-11-09",location:"Uasin Gishu County",organizer:"Kenya Industrial Research and Development Institute",attendees:55,tags:["value-addition","agro-processing","farmer-incomes","agri-business"],authorName:"Mercy Chebet",authorType:"Agro-processing Specialist"}],Sa=[{id:"1",title:"Advanced Tomato Growing Techniques",description:"Learn the latest techniques for growing high-quality tomatoes, including disease prevention, optimal fertilization, and harvest timing. This hands-on workshop will cover greenhouse and open field production systems.",providerId:"provider1",providerName:"Kilimo Extension Services",date:"2023-08-15T09:00:00Z",location:"Agricultural Training Center, Thika",topics:["tomato production","disease management","greenhouse farming"],capacity:50,registeredCount:35,cost:0,attendees:35,tags:["tomato","greenhouse","fertilizer"],trainer:"Dr. John Kimani"},{id:"2",title:"Quality Control for Fresh Produce Exporters",description:"This comprehensive training covers all aspects of quality control for fresh produce export, including EU regulations, documentation requirements, sampling techniques, and audit preparation.",providerId:"provider2",providerName:"Export Quality Services",date:"2023-08-28T10:00:00Z",location:"Sarova Panafric Hotel, Nairobi",topics:["export standards","quality control","certification","EU regulations"],capacity:30,registeredCount:28,cost:5e3,attendees:28,tags:["export","quality","certification","EU"],trainer:"Ms. Jane Ochieng"},{id:"3",title:"Organic Certification Workshop",description:"Step-by-step guidance on the organic certification process for small and medium-scale farmers. Learn about record-keeping requirements, approved inputs, conversion periods, and marketing strategies.",providerId:"provider3",providerName:"Kenya Organic Agriculture Network",date:"2023-09-05T09:30:00Z",location:"Kisumu Agricultural Society Showground",topics:["organic certification","record keeping","organic inputs"],capacity:40,registeredCount:22,cost:2500,attendees:22,tags:["organic","record","inputs"],trainer:"Mr. David Mwangi"},{id:"4",title:"Pesticide Safety and Application",description:"Learn safe and effective pesticide application techniques, including proper handling, calibration of equipment, environmental protection measures, and health safety protocols.",providerId:"provider4",providerName:"Agrochemical Association of Kenya",date:"2023-09-12T08:00:00Z",location:"Machakos Farmers Training Center",topics:["pesticide safety","application techniques","equipment calibration"],capacity:60,registeredCount:45,cost:0,attendees:45,tags:["pesticide","application","calibration"],trainer:"Dr. Emily Mwangi"},{id:"5",title:"Post-Harvest Management for Fruits and Vegetables",description:"Reduce post-harvest losses through improved handling, storage, and transportation techniques. This training covers cold chain management, packaging solutions, and value addition opportunities.",providerId:"provider5",providerName:"Horticultural Crops Directorate",date:"2023-09-20T10:00:00Z",location:"KALRO Center, Meru",topics:["post-harvest management","cold chain","value addition"],capacity:35,registeredCount:18,cost:1e3,attendees:18,tags:["post-harvest","cold","value"],trainer:"Ms. Mary Wanjiru"},{id:"6",title:"Food Safety Management Systems (HACCP)",description:"Comprehensive training on implementing HACCP principles in agricultural production and handling. Learn to identify critical control points and develop monitoring systems for ensuring food safety.",providerId:"provider6",providerName:"Kenya Bureau of Standards",date:"2023-10-03T09:00:00Z",location:"KEBS Headquarters, Nairobi",topics:["HACCP","food safety","critical control points"],capacity:25,registeredCount:25,cost:8e3,attendees:25,tags:["HACCP","food","control"],trainer:"Dr. John Kimani"},{id:"7",title:"Digital Tools for Farm Record Keeping",description:"Introduction to smartphone applications and digital tools for maintaining farm records, tracking inputs and harvests, and preparing for certification audits.",providerId:"provider7",providerName:"Digital Farmers Kenya",date:"2023-10-10T14:00:00Z",location:"Virtual (Zoom)",topics:["digital agriculture","record keeping","farm management"],capacity:100,registeredCount:67,cost:500,attendees:67,tags:["digital","record","management"],trainer:"Ms. Jane Ochieng"},{id:"8",title:"Soil Testing and Fertility Management",description:"Learn to interpret soil test results and develop effective fertility management strategies. This training covers sampling techniques, understanding lab reports, and creating fertilizer plans.",providerId:"provider8",providerName:"Soil Health Initiative",date:"2023-10-18T09:00:00Z",location:"ATC Eldoret",topics:["soil health","soil testing","fertility management"],capacity:45,registeredCount:32,cost:1500,attendees:32,tags:["soil","testing","fertility"],trainer:"Mr. David Mwangi"},{id:"9",title:"Quality Assurance for Dairy Production",description:"Comprehensive training on quality assurance in milk production, handling, and processing. Learn about hygiene requirements, testing protocols, and quality standards.",providerId:"provider9",providerName:"Kenya Dairy Board",date:"2023-10-25T09:00:00Z",location:"Nakuru Agricultural Showground",topics:["dairy","milk quality","hygiene","testing"],capacity:50,registeredCount:28,cost:2e3,attendees:28,tags:["dairy","quality","hygiene","testing"],trainer:"Ms. Mary Wanjiru"}],Fn=async()=>{try{const s=await $s.get("service-providers",{},Ca);return s&&s.results&&s.results.length>0?s.results:(console.log("Falling back to mock service provider data"),Ca)}catch(s){return console.error("Error fetching service providers:",s),Ca}},em=async()=>{try{const s=await $s.get("quality-discussions",{},ka);return s&&s.results&&s.results.length>0?s.results:(console.log("Falling back to mock quality discussions data"),ka)}catch(s){return console.error("Error fetching quality discussions:",s),ka}},sm=async()=>{try{const s=await $s.get("training-events",{},Sa);return s&&s.results&&s.results.length>0?s.results:(console.log("Falling back to mock training events data"),Sa)}catch(s){return console.error("Error fetching training events:",s),Sa}},tm=()=>{const s=Ne();return e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Service Providers Directory"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Find and connect with agricultural service providers across Kenya"})]}),e.jsx("div",{className:"mt-4 md:mt-0",children:e.jsx(b,{onClick:()=>s("/service-provider-registration"),children:"Register as a Provider"})})]})},am=({searchTerm:s,setSearchTerm:t,selectedType:a,setSelectedType:r,selectedCounty:n,setSelectedCounty:c,filteredCount:l,counties:x,providerTypes:f,selectedCategory:j,setSelectedCategory:N,providerCategories:g})=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[e.jsx("div",{className:"relative",children:e.jsx(D,{placeholder:"Search by name, service or tag...",value:s,onChange:u=>t(u.target.value),className:"w-full"})}),e.jsx("div",{children:e.jsxs(Q,{value:n,onValueChange:c,children:[e.jsx(W,{children:e.jsx(J,{placeholder:"Filter by county"})}),e.jsx(Y,{children:x.map(u=>e.jsx(T,{value:u.value,children:u.label},u.value))})]})}),e.jsx("div",{children:e.jsxs(Q,{value:j,onValueChange:N,children:[e.jsx(W,{children:e.jsx(J,{placeholder:"Provider Category"})}),e.jsx(Y,{children:g.map(u=>e.jsx(T,{value:u,children:u},u))})]})}),e.jsx("div",{className:"flex items-center justify-end",children:e.jsxs("span",{className:"text-sm text-muted-foreground mr-2",children:[l," providers found"]})})]}),ut=i.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(Ki,{ref:r,className:$("relative overflow-hidden",s),...a,children:[e.jsx(Ol,{className:"h-full w-full rounded-[inherit]",children:t}),e.jsx(tr,{}),e.jsx(Kl,{})]}));ut.displayName=Ki.displayName;const tr=i.forwardRef(({className:s,orientation:t="vertical",...a},r)=>e.jsx(Bi,{ref:r,orientation:t,className:$("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...a,children:e.jsx(Bl,{className:"relative flex-1 rounded-full bg-border"})}));tr.displayName=Bi.displayName;const rm=({activeTab:s,onTabChange:t,providerTypes:a})=>e.jsxs(ut,{className:"w-full whitespace-nowrap",children:[e.jsx(pe,{className:"inline-flex h-auto w-max gap-1 p-1",children:a.map(r=>e.jsx(B,{value:r.value,className:"text-xs md:text-sm px-3 py-2 whitespace-nowrap font-medium data-[state=active]:bg-primary data-[state=active]:text-primary-foreground",children:r.label},r.value))}),e.jsx(tr,{orientation:"horizontal",className:"h-2"})]}),im=()=>{const s=Ne();return e.jsxs("div",{className:"mt-12 border-t pt-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Recent Training Events"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[1,2,3].map(t=>e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{className:"text-lg",children:"Advanced Potato Farming Techniques"}),e.jsx(G,{children:"AgriTrain Kenya"})]}),e.jsxs(_,{className:"space-y-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Learn advanced techniques for potato cultivation including disease management and optimal fertilization"}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(xe,{className:"h-4 w-4 mr-1 text-muted-foreground"}),e.jsx("span",{children:"May 15, 2025"})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(ee,{className:"h-4 w-4 mr-1 text-muted-foreground"}),e.jsx("span",{children:"Meru Agricultural Training Center"})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(se,{className:"h-4 w-4 mr-1 text-muted-foreground"}),e.jsx("span",{children:"18/30 registered"})]})]}),e.jsxs(me,{className:"flex justify-between",children:[e.jsx(I,{children:"KSh 2,500"}),e.jsx(b,{size:"sm",onClick:()=>s("/training-events"),children:"Register"})]})]},t))}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx(b,{variant:"outline",onClick:()=>s("/training-events"),children:"View All Events"})})]})},nm=()=>{const[s,t]=Ul(),a=Ne(),{toast:r}=Z(),[n,c]=i.useState([]),[l,x]=i.useState([]),[f,j]=i.useState(!0),[N,g]=i.useState(""),[u,d]=i.useState("all"),[h,v]=i.useState("all"),[p,m]=i.useState("All Providers"),[o,y]=i.useState([]),[k,A]=i.useState([]),E=s.get("type")||"all",P=[{value:"all",label:"All Providers"},{value:"storage",label:"Storage Facilities"},{value:"transport",label:"Transport Services"},{value:"quality-control",label:"Quality Control"},{value:"training",label:"Training Providers"},{value:"input-supplier",label:"Input Suppliers"},{value:"inspector",label:"Inspectors"},{value:"market-linkage",label:"Market Linkage"},{value:"insurance-provider",label:"Insurance Providers"},{value:"soil-testing-provider",label:"Soil Testing Providers"},{value:"drone-satellite-imagery-provider",label:"Drone and Satellite Imagery Providers"},{value:"iot-sensor-data-provider",label:"IoT Sensor Data Providers"},{value:"export-transporters",label:"Export Transporters"},{value:"shippers",label:"Shippers"}],R=[{value:"all",label:"All Counties"},{value:"nairobi",label:"Nairobi"},{value:"mombasa",label:"Mombasa"},{value:"kisumu",label:"Kisumu"},{value:"nakuru",label:"Nakuru"},{value:"kiambu",label:"Kiambu"},{value:"machakos",label:"Machakos"},{value:"meru",label:"Meru"},{value:"kakamega",label:"Kakamega"},{value:"uasin-gishu",label:"Uasin Gishu"},{value:"nyeri",label:"Nyeri"},{value:"kilifi",label:"Kilifi"}],M=["All Providers","Storage Facilities","Transport Services","Quality Control","Training Providers","Input Suppliers","Inspectors","Market Linkage","Insurance Providers","Soil Testing Providers","Drone and Satellite Imagery Providers","IoT Sensor Data Providers","Export Transporters","Shippers"];i.useEffect(()=>{(async()=>{try{j(!0);const U=await Fn();c(U),x(U)}catch(U){console.error("Error fetching service providers:",U),r({title:"Error",description:"Failed to load service providers. Please try again later.",variant:"destructive"})}finally{j(!1)}})()},[r]),i.useEffect(()=>{let z=[...n];if(u!=="all"&&(z=z.filter(U=>U.businessType===u)),h!=="all"&&(z=z.filter(U=>U.location.county.toLowerCase()===h.toLowerCase())),p!=="All Providers"&&(z=z.filter(U=>(U.provider_category||U.businessType)===p)),N){const U=N.toLowerCase();z=z.filter(K=>K.name.toLowerCase().includes(U)||K.description.toLowerCase().includes(U)||K.services.some(ae=>ae.toLowerCase().includes(U))||K.tags.some(ae=>ae.toLowerCase().includes(U)))}x(z)},[n,u,h,N,p]);const O=z=>{z==="all"?s.delete("type"):s.set("type",z),t(s),d(z)};async function te(z){const{data:U}=await F.from("transporter_bookings").select("*").eq("transporter_id",z);y(U||[])}async function ue(z){const{data:U}=await F.from("tracking_events").select("*").eq("export_order_id",z).order("event_time");A(U||[])}return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx("header",{className:"sticky top-0 z-30 w-full border-b bg-background",children:e.jsxs("div",{className:"container flex h-16 items-center",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx($e,{})}),e.jsx("div",{className:"md:hidden",children:e.jsx(ss,{})})]})}),e.jsxs("main",{className:"flex-1 container py-6",children:[e.jsx(tm,{}),e.jsx(ge,{defaultValue:E,value:E,onValueChange:O,className:"mb-8",children:e.jsx(rm,{activeTab:E,onTabChange:O,providerTypes:P})}),e.jsx(am,{searchTerm:N,setSearchTerm:g,selectedType:u,setSelectedType:d,selectedCounty:h,setSelectedCounty:v,filteredCount:l.length,counties:R,providerTypes:P,selectedCategory:p,setSelectedCategory:m,providerCategories:M}),f?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(z=>e.jsxs(w,{className:"animate-pulse",children:[e.jsx(q,{className:"h-32 bg-muted"}),e.jsxs(_,{className:"pt-4",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-3/4 mb-4"}),e.jsx("div",{className:"h-3 bg-muted rounded w-full mb-2"}),e.jsx("div",{className:"h-3 bg-muted rounded w-5/6 mb-2"}),e.jsx("div",{className:"h-3 bg-muted rounded w-4/6"})]})]},z))}):l.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-muted mb-4",children:e.jsx(Dt,{className:"h-8 w-8 text-muted-foreground"})}),e.jsx("h3",{className:"text-lg font-medium",children:"No providers found"}),e.jsx("p",{className:"text-muted-foreground mt-2 mb-4",children:"Try adjusting your search or filters, or register as a new provider."}),e.jsx(b,{onClick:()=>a("/service-provider-registration"),children:"Register as a Provider"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map(z=>{const U={rating:4.5,total:25};return e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(q,{children:[e.jsx(L,{className:"text-lg truncate",children:z.business_name||z.name}),e.jsx(I,{variant:"secondary",className:"mt-1",children:z.provider_category||z.businessType})]}),e.jsxs(_,{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-3",children:z.description}),e.jsxs("div",{className:"text-sm flex items-start gap-1",children:[e.jsx(ee,{className:"h-4 w-4 text-muted-foreground flex-shrink-0 mt-0.5"}),e.jsxs("span",{className:"truncate",children:[z.location.county,", ",z.location.specificLocation]})]}),(z.provider_category==="Export Transporters"||z.businessType==="export-transporters")&&e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[z.licenses&&e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"font-semibold",children:"Licenses:"})," ",z.licenses.join(", ")]}),z.insurance_details&&e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"font-semibold",children:"Insurance:"})," ",z.insurance_details]}),e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"font-semibold",children:"Rating:"})," ",U.rating," (",U.total," reviews)"]}),e.jsx(b,{size:"sm",onClick:()=>te(z.id),className:"w-full mt-2",children:"View Bookings"}),o.length>0&&e.jsxs("div",{className:"mt-3 p-2 bg-muted/50 rounded",children:[e.jsx("h4",{className:"font-semibold text-xs mb-1",children:"Bookings"}),e.jsx("ul",{className:"space-y-1",children:o.map(K=>e.jsx("li",{className:"text-xs",children:e.jsxs("div",{className:"flex justify-between items-start gap-2",children:[e.jsxs("span",{className:"truncate",children:[K.booking_date,": ",K.cargo_type," - ",K.status," (KES ",K.price,")"]}),e.jsx(b,{size:"sm",variant:"outline",onClick:()=>ue(K.export_order_id),className:"h-6 px-2 text-xs flex-shrink-0",children:"Track"})]})},K.id))})]}),k.length>0&&e.jsxs("div",{className:"mt-3 p-2 bg-muted/50 rounded",children:[e.jsx("h4",{className:"font-semibold text-xs mb-1",children:"Tracking History"}),e.jsx("ul",{className:"space-y-1",children:k.map(K=>e.jsxs("li",{className:"text-xs truncate",children:[K.event_time,": ",K.location," ",K.status&&`- ${K.status}`]},K.id))})]})]})]})]},z.id)})}),e.jsx(im,{})]})]})},lm=({onDiscussionCreated:s})=>{const{toast:t}=Z(),a=Ne(),[r,n]=i.useState(!1),[c,l]=i.useState(!1),[x,f]=i.useState({title:"",content:"",category:"quality_standards",tags:[]}),[j,N]=i.useState(""),g=[{value:"quality_standards",label:"Quality Standards"},{value:"verification",label:"Product Verification"},{value:"regulations",label:"Regulations & Compliance"},{value:"export_requirements",label:"Export Requirements"},{value:"pest_control",label:"Pest & Disease Control"},{value:"certification",label:"Certification"}],u=()=>{j.trim()&&!x.tags.includes(j.trim())&&(f({...x,tags:[...x.tags,j.trim()]}),N(""))},d=v=>{f({...x,tags:x.tags.filter(p=>p!==v)})},h=async()=>{const{data:{user:v}}=await F.auth.getUser();if(!v){t({title:"Authentication Required",description:"Please sign in to create a discussion.",variant:"destructive"}),a("/auth");return}if(!x.title.trim()||!x.content.trim()){t({title:"Validation Error",description:"Please fill in all required fields.",variant:"destructive"});return}l(!0);try{const{error:p}=await F.from("community_posts").insert({author_id:v.id,title:x.title,content:x.content,category:x.category,tags:x.tags,post_type:"discussion"});if(p)throw p;t({title:"Success",description:"Your discussion has been created successfully!"}),f({title:"",content:"",category:"quality_standards",tags:[]}),n(!1),s&&s()}catch(p){console.error("Error creating discussion:",p),t({title:"Error",description:"Failed to create discussion. Please try again.",variant:"destructive"})}finally{l(!1)}};return e.jsxs(_e,{open:r,onOpenChange:n,children:[e.jsx(Ie,{asChild:!0,children:e.jsxs(b,{children:[e.jsx(tt,{className:"mr-2 h-4 w-4"})," Start New Discussion"]})}),e.jsxs(we,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Ce,{children:[e.jsx(ke,{children:"Start a New Discussion"}),e.jsx(it,{children:"Share your thoughts, questions, or concerns about agricultural quality control"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"title",children:"Title *"}),e.jsx(D,{id:"title",placeholder:"What's your discussion about?",value:x.title,onChange:v=>f({...x,title:v.target.value}),maxLength:200}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[x.title.length,"/200 characters"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"category",children:"Category *"}),e.jsx("select",{id:"category",value:x.category,onChange:v=>f({...x,category:v.target.value}),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",children:g.map(v=>e.jsx("option",{value:v.value,children:v.label},v.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"content",children:"Content *"}),e.jsx(le,{id:"content",placeholder:"Share your thoughts, questions, or experiences...",value:x.content,onChange:v=>f({...x,content:v.target.value}),rows:8,maxLength:5e3}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[x.content.length,"/5000 characters"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"tags",children:"Tags (optional)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{id:"tags",placeholder:"Add a tag (e.g., avocados, EU, pesticides)",value:j,onChange:v=>N(v.target.value),onKeyPress:v=>{v.key==="Enter"&&(v.preventDefault(),u())}}),e.jsx(b,{type:"button",onClick:u,variant:"outline",children:"Add"})]}),x.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:x.tags.map(v=>e.jsxs(I,{variant:"secondary",className:"gap-1",children:[v,e.jsx(Be,{className:"h-3 w-3 cursor-pointer",onClick:()=>d(v)})]},v))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Press Enter or click Add to add tags"})]})]}),e.jsxs(Ze,{children:[e.jsx(b,{variant:"outline",onClick:()=>n(!1),disabled:c,children:"Cancel"}),e.jsx(b,{onClick:h,disabled:c,children:c?"Creating...":"Create Discussion"})]})]})]})},cm=({onDiscussionCreated:s})=>e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Quality Control Discussions"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Join the conversation on agricultural quality standards and challenges"})]}),e.jsx("div",{className:"mt-4 md:mt-0",children:e.jsx(lm,{onDiscussionCreated:s})})]}),om=({searchTerm:s,setSearchTerm:t,filterTag:a,setFilterTag:r,allTags:n})=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"md:col-span-3",children:e.jsx(D,{placeholder:"Search discussions...",value:s,onChange:c=>t(c.target.value),className:"w-full"})}),e.jsx("div",{children:e.jsxs(Q,{value:a,onValueChange:r,children:[e.jsx(W,{children:e.jsx(J,{placeholder:"Filter by tag"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Tags"}),n.map(c=>e.jsx(T,{value:c,children:c},c))]})]})})]}),dm=({discussion:s,filterTag:t,setFilterTag:a})=>e.jsxs(w,{children:[e.jsxs(q,{className:"pb-2",children:[e.jsx(L,{className:"text-xl",children:s.title}),e.jsxs(G,{className:"flex items-center",children:["Started by ",s.authorName,e.jsx(I,{variant:"outline",className:"ml-2 text-xs",children:s.authorType})]})]}),e.jsxs(_,{children:[e.jsx("p",{className:"text-muted-foreground line-clamp-2",children:s.content}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-4",children:s.tags.map(r=>e.jsx(I,{variant:t===r?"default":"outline",className:"cursor-pointer",onClick:()=>a(r),children:r},r))})]}),e.jsxs(me,{className:"flex justify-between text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(Ue,{className:"mr-1 h-4 w-4"}),s.commentCount," comments"]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(qs,{className:"mr-1 h-4 w-4"}),s.viewCount," views"]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(is,{className:"mr-1 h-4 w-4"}),new Date(s.createdAt).toLocaleDateString()]})]}),e.jsx(b,{variant:"ghost",size:"sm",children:"View Discussion"})]})]}),mm=()=>{const{toast:s}=Z(),[t,a]=i.useState([]),[r,n]=i.useState(!0),[c,l]=i.useState(""),[x,f]=i.useState("all"),j=["counterfeit","verification","export","regulations","avocados","EU","pesticides"],N=async()=>{try{n(!0);const u=await em();a(u)}catch(u){console.error("Error fetching discussions:",u),s({title:"Error",description:"Failed to load discussions. Please try again later.",variant:"destructive"})}finally{n(!1)}};i.useEffect(()=>{N()},[s]);const g=t.filter(u=>{const d=c===""||u.title.toLowerCase().includes(c.toLowerCase())||u.content.toLowerCase().includes(c.toLowerCase())||u.authorName.toLowerCase().includes(c.toLowerCase()),h=x==="all"||u.tags.includes(x);return d&&h});return e.jsxs("div",{className:"flex min-h-screen flex-col pb-20 md:pb-0",children:[e.jsx("header",{className:"sticky top-0 z-30 w-full border-b bg-background",children:e.jsxs("div",{className:"container flex h-16 items-center",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx($e,{})}),e.jsx("div",{className:"md:hidden",children:e.jsx(ss,{})})]})}),e.jsxs("main",{className:"flex-1 container py-6",children:[e.jsx(cm,{onDiscussionCreated:N}),e.jsx(om,{searchTerm:c,setSearchTerm:l,filterTag:x,setFilterTag:f,allTags:j}),r?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(u=>e.jsxs(w,{className:"animate-pulse",children:[e.jsxs(q,{className:"pb-2",children:[e.jsx("div",{className:"h-6 bg-muted rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/4"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"h-4 bg-muted rounded w-full mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-5/6 mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-4/6"})]})]},u))}):g.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-muted mb-4",children:e.jsx(Ue,{className:"h-8 w-8 text-muted-foreground"})}),e.jsx("h3",{className:"text-lg font-medium",children:"No discussions found"}),e.jsx("p",{className:"text-muted-foreground mt-2 mb-4",children:"Be the first to start a discussion on this topic!"}),e.jsx(b,{children:"Start New Discussion"})]}):e.jsx("div",{className:"space-y-4",children:g.map(u=>e.jsx(dm,{discussion:u,filterTag:x,setFilterTag:f},u.id))})]}),e.jsx(Me,{})]})},um=()=>{const{toast:s}=Z(),[t,a]=i.useState([]),[r,n]=i.useState(!0),[c,l]=i.useState(""),[x,f]=i.useState("upcoming");i.useEffect(()=>{(async()=>{try{n(!0);const g=await sm();a(g)}catch(g){console.error("Error fetching training events:",g),s({title:"Error",description:"Failed to load training events. Please try again later.",variant:"destructive"})}finally{n(!1)}})()},[s]);const j=t.filter(N=>{const g=c===""||N.title.toLowerCase().includes(c.toLowerCase())||N.description.toLowerCase().includes(c.toLowerCase())||N.providerName.toLowerCase().includes(c.toLowerCase())||N.topics.some(h=>h.toLowerCase().includes(c.toLowerCase())),u=new Date(N.date),d=new Date;return x==="upcoming"?g&&u>d:x==="past"?g&&u<=d:g});return e.jsxs("div",{className:"flex min-h-screen flex-col pb-20 md:pb-0",children:[e.jsx("header",{className:"sticky top-0 z-30 w-full border-b bg-background",children:e.jsxs("div",{className:"container flex h-16 items-center",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx($e,{})}),e.jsx("div",{className:"md:hidden",children:e.jsx(ss,{})})]})}),e.jsxs("main",{className:"flex-1 container py-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Training Events"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Discover agricultural training events and workshops across Kenya"})]}),e.jsx("div",{className:"mt-4 md:mt-0",children:e.jsx(b,{children:"Add Training Event"})})]}),e.jsx(ge,{defaultValue:"upcoming",value:x,onValueChange:N=>f(N),className:"mb-8",children:e.jsxs(pe,{children:[e.jsx(B,{value:"upcoming",children:"Upcoming Events"}),e.jsx(B,{value:"past",children:"Past Events"}),e.jsx(B,{value:"all",children:"All Events"})]})}),e.jsx("div",{className:"mb-8",children:e.jsx(D,{placeholder:"Search events by title, provider, or topic...",value:c,onChange:N=>l(N.target.value),className:"w-full md:w-2/3 lg:w-1/2"})}),r?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(N=>e.jsxs(w,{className:"animate-pulse",children:[e.jsxs(q,{className:"pb-2",children:[e.jsx("div",{className:"h-6 bg-muted rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/2"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"h-4 bg-muted rounded w-full mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-5/6 mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-4/6"})]}),e.jsx(me,{children:e.jsx("div",{className:"h-5 bg-muted rounded w-1/4"})})]},N))}):j.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-muted mb-4",children:e.jsx(xe,{className:"h-8 w-8 text-muted-foreground"})}),e.jsx("h3",{className:"text-lg font-medium",children:"No events found"}),e.jsx("p",{className:"text-muted-foreground mt-2 mb-4",children:x==="upcoming"?"No upcoming events match your search. Try different keywords or check back later.":"No past events match your search. Try different keywords or check all events."}),x!=="all"&&e.jsx(b,{variant:"outline",onClick:()=>f("all"),children:"View All Events"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:j.map(N=>e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{className:"text-lg",children:N.title}),e.jsx(G,{children:N.providerName})]}),e.jsxs(_,{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-3",children:N.description}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(xe,{className:"h-4 w-4 mr-1 text-muted-foreground"}),e.jsxs("span",{children:[new Date(N.date).toLocaleDateString()," at ",new Date(N.date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(ee,{className:"h-4 w-4 mr-1 text-muted-foreground"}),e.jsx("span",{children:N.location})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(se,{className:"h-4 w-4 mr-1 text-muted-foreground"}),e.jsxs("span",{children:[N.registeredCount,"/",N.capacity," registered"]})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:N.topics.map(g=>e.jsx(I,{variant:"outline",className:"text-xs",children:g},g))})]}),e.jsxs(me,{className:"flex justify-between",children:[e.jsx(I,{children:N.cost}),e.jsx(b,{size:"sm",children:new Date(N.date)>new Date?"Register":"View Details"})]})]},N.id))})]}),e.jsx(Me,{})]})},xm=({onSuccess:s})=>{const{toast:t}=Z(),[a,r]=i.useState(!1),[n,c]=i.useState({title:"",description:"",linkage_type:"buyer_seller",crops_involved:[],counties:[],requirements:[],benefits:[],contact_info:"",application_deadline:"",start_date:"",duration_months:void 0,minimum_quantity:void 0,price_range:"",max_participants:void 0}),[l,x]=i.useState(""),[f,j]=i.useState(""),[N,g]=i.useState(""),[u,d]=i.useState(""),h=["Nairobi","Mombasa","Kisumu","Nakuru","Eldoret","Thika","Kiambu","Machakos","Meru","Embu","Nyeri","Muranga","Kakamega","Kisii","Nyamira","Kericho","Bomet","Narok","Kajiado","Makueni"],v=["Maize","Beans","Rice","Wheat","Potatoes","Sweet Potatoes","Cassava","Bananas","Coffee","Tea","Sugarcane","Cotton","Tomatoes","Onions","Cabbages","Kales","Spinach","Avocado","Mangoes","Oranges"],p=(y,k,A)=>{if(y.trim()){const S=n[k];S.includes(y.trim())||c(E=>({...E,[k]:[...S,y.trim()]})),A("")}},m=(y,k)=>{const A=n[k];c(S=>({...S,[k]:A.filter(E=>E!==y)}))},o=async y=>{if(y.preventDefault(),!n.title||!n.description||!n.contact_info){t({title:"Error",description:"Please fill in all required fields.",variant:"destructive"});return}try{r(!0),await bn(n),t({title:"Success",description:"Market linkage registered successfully!"}),c({title:"",description:"",linkage_type:"buyer_seller",crops_involved:[],counties:[],requirements:[],benefits:[],contact_info:"",application_deadline:"",start_date:"",duration_months:void 0,minimum_quantity:void 0,price_range:"",max_participants:void 0}),s&&s()}catch(k){console.error("Error creating market linkage:",k),t({title:"Error",description:"Failed to register market linkage. Please try again.",variant:"destructive"})}finally{r(!1)}};return e.jsxs(w,{className:"max-w-4xl mx-auto",children:[e.jsx(q,{children:e.jsx(L,{children:"Register New Market Linkage"})}),e.jsx(_,{children:e.jsxs("form",{onSubmit:o,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Title *"}),e.jsx(D,{value:n.title,onChange:y=>c(k=>({...k,title:y.target.value})),placeholder:"e.g., Avocado Export Partnership",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Linkage Type *"}),e.jsxs(Q,{value:n.linkage_type,onValueChange:y=>c(k=>({...k,linkage_type:y})),children:[e.jsx(W,{children:e.jsx(J,{})}),e.jsxs(Y,{children:[e.jsx(T,{value:"buyer_seller",children:"Buyer-Seller"}),e.jsx(T,{value:"contract_farming",children:"Contract Farming"}),e.jsx(T,{value:"cooperative",children:"Cooperative"}),e.jsx(T,{value:"export_opportunity",children:"Export Opportunity"}),e.jsx(T,{value:"processing_partnership",children:"Processing Partnership"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Contact Information *"}),e.jsx(D,{value:n.contact_info,onChange:y=>c(k=>({...k,contact_info:y.target.value})),placeholder:"Phone: +254..., Email: ...",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description *"}),e.jsx(le,{value:n.description,onChange:y=>c(k=>({...k,description:y.target.value})),placeholder:"Detailed description of the market linkage opportunity...",rows:4,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Crops Involved"}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsxs(Q,{value:l,onValueChange:x,children:[e.jsx(W,{className:"flex-1",children:e.jsx(J,{placeholder:"Select crop"})}),e.jsx(Y,{children:v.map(y=>e.jsx(T,{value:y,children:y},y))})]}),e.jsx(b,{type:"button",onClick:()=>p(l,"crops_involved",x),size:"sm",children:e.jsx(ie,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.crops_involved.map(y=>e.jsxs(I,{variant:"secondary",className:"flex items-center gap-1",children:[y,e.jsx(Be,{className:"h-3 w-3 cursor-pointer",onClick:()=>m(y,"crops_involved")})]},y))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Counties"}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsxs(Q,{value:f,onValueChange:j,children:[e.jsx(W,{className:"flex-1",children:e.jsx(J,{placeholder:"Select county"})}),e.jsx(Y,{children:h.map(y=>e.jsx(T,{value:y,children:y},y))})]}),e.jsx(b,{type:"button",onClick:()=>p(f,"counties",j),size:"sm",children:e.jsx(ie,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.counties.map(y=>e.jsxs(I,{variant:"secondary",className:"flex items-center gap-1",children:[y,e.jsx(Be,{className:"h-3 w-3 cursor-pointer",onClick:()=>m(y,"counties")})]},y))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Requirements"}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(D,{value:N,onChange:y=>g(y.target.value),placeholder:"Add requirement...",className:"flex-1"}),e.jsx(b,{type:"button",onClick:()=>p(N,"requirements",g),size:"sm",children:e.jsx(ie,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.requirements.map(y=>e.jsxs(I,{variant:"outline",className:"flex items-center gap-1",children:[y,e.jsx(Be,{className:"h-3 w-3 cursor-pointer",onClick:()=>m(y,"requirements")})]},y))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Benefits"}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(D,{value:u,onChange:y=>d(y.target.value),placeholder:"Add benefit...",className:"flex-1"}),e.jsx(b,{type:"button",onClick:()=>p(u,"benefits",d),size:"sm",children:e.jsx(ie,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.benefits.map(y=>e.jsxs(I,{variant:"outline",className:"flex items-center gap-1",children:[y,e.jsx(Be,{className:"h-3 w-3 cursor-pointer",onClick:()=>m(y,"benefits")})]},y))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Application Deadline"}),e.jsx(D,{type:"date",value:n.application_deadline,onChange:y=>c(k=>({...k,application_deadline:y.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Start Date"}),e.jsx(D,{type:"date",value:n.start_date,onChange:y=>c(k=>({...k,start_date:y.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Duration (months)"}),e.jsx(D,{type:"number",value:n.duration_months||"",onChange:y=>c(k=>({...k,duration_months:parseInt(y.target.value)||void 0})),placeholder:"e.g., 12"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Max Participants"}),e.jsx(D,{type:"number",value:n.max_participants||"",onChange:y=>c(k=>({...k,max_participants:parseInt(y.target.value)||void 0})),placeholder:"e.g., 50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Minimum Quantity (tons)"}),e.jsx(D,{type:"number",value:n.minimum_quantity||"",onChange:y=>c(k=>({...k,minimum_quantity:parseFloat(y.target.value)||void 0})),placeholder:"e.g., 10"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Price Range"}),e.jsx(D,{value:n.price_range,onChange:y=>c(k=>({...k,price_range:y.target.value})),placeholder:"e.g., 50-80 KES per kg"})]})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(b,{type:"button",variant:"outline",children:"Cancel"}),e.jsx(b,{type:"submit",disabled:a,children:a?"Registering...":"Register Market Linkage"})]})]})})]})},hm=()=>{const{toast:s}=Z(),[t,a]=i.useState([]),[r,n]=i.useState(!0),[c,l]=i.useState(""),[x,f]=i.useState("all"),[j,N]=i.useState(!1);i.useEffect(()=>{g()},[]);const g=async()=>{try{n(!0);const d=await wn();a(d||[])}catch(d){console.error("Error fetching market linkages:",d),s({title:"Error",description:"Failed to load market linkages. Please try again later.",variant:"destructive"})}finally{n(!1)}},u=t.filter(d=>{var v,p;const h=c===""||d.title.toLowerCase().includes(c.toLowerCase())||d.description.toLowerCase().includes(c.toLowerCase())||((v=d.crops_involved)==null?void 0:v.some(m=>m.toLowerCase().includes(c.toLowerCase())))||((p=d.counties)==null?void 0:p.some(m=>m.toLowerCase().includes(c.toLowerCase())));return x==="vertical"?h&&(d.linkage_type==="buyer_seller"||d.linkage_type==="export_opportunity"):x==="horizontal"?h&&(d.linkage_type==="cooperative"||d.linkage_type==="contract_farming"):h});return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx("header",{className:"sticky top-0 z-30 w-full border-b bg-background",children:e.jsxs("div",{className:"container flex h-16 items-center",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx($e,{})}),e.jsx("div",{className:"md:hidden",children:e.jsx(ss,{})})]})}),e.jsxs("main",{className:"flex-1 container py-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Market Linkages"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Connect with vertical and horizontal market linkage opportunities"})]}),e.jsx("div",{className:"mt-4 md:mt-0",children:e.jsxs(_e,{open:j,onOpenChange:N,children:[e.jsx(Ie,{asChild:!0,children:e.jsxs(b,{children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Register New Market Linkage"]})}),e.jsx(we,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:e.jsx(xm,{onSuccess:()=>{N(!1),g()}})})]})})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Understanding Market Linkages"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("div",{className:"mt-0.5",children:e.jsx(Ge,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Vertical Linkages"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Connect farmers to buyers further up the value chain such as processors, exporters, and retailers."})]})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("div",{className:"mt-0.5",children:e.jsx(se,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Horizontal Linkages"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Connect farmers to other farmers or farmer groups for collective action, shared resources, and increased bargaining power."})]})]})]})]})}),e.jsx(ge,{defaultValue:"all",value:x,onValueChange:d=>f(d),className:"mb-8",children:e.jsxs(pe,{children:[e.jsx(B,{value:"all",children:"All Linkages"}),e.jsx(B,{value:"vertical",children:"Vertical Linkages"}),e.jsx(B,{value:"horizontal",children:"Horizontal Linkages"})]})}),e.jsx("div",{className:"mb-8",children:e.jsx(D,{placeholder:"Search by title, crops, counties...",value:c,onChange:d=>l(d.target.value),className:"w-full md:w-2/3 lg:w-1/2"})}),r?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[1,2,3,4].map(d=>e.jsxs(w,{className:"animate-pulse",children:[e.jsxs(q,{className:"pb-2",children:[e.jsx("div",{className:"h-6 bg-muted rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/2"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"h-4 bg-muted rounded w-full mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-5/6 mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-4/6"})]}),e.jsx(me,{children:e.jsx("div",{className:"h-5 bg-muted rounded w-1/4"})})]},d))}):u.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-muted mb-4",children:e.jsx(jr,{className:"h-8 w-8 text-muted-foreground"})}),e.jsx("h3",{className:"text-lg font-medium",children:"No market linkages found"}),e.jsx("p",{className:"text-muted-foreground mt-2 mb-4",children:"No market linkages match your search criteria. Try different keywords or view all linkages."}),x!=="all"&&e.jsx(b,{variant:"outline",onClick:()=>f("all"),children:"View All Linkages"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:u.map(d=>e.jsxs(w,{children:[e.jsx(q,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-xl",children:d.title}),e.jsxs(G,{children:["Contact: ",d.contact_info]})]}),e.jsx(I,{variant:d.linkage_type==="buyer_seller"||d.linkage_type==="export_opportunity"?"default":"secondary",children:d.linkage_type.replace("_"," ").toUpperCase()})]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsx("p",{className:"text-muted-foreground",children:d.description}),d.counties&&d.counties.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-1",children:"Counties:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:d.counties.map(h=>e.jsx(I,{variant:"outline",children:h},h))})]}),d.crops_involved&&d.crops_involved.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-1",children:"Crops:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:d.crops_involved.map(h=>e.jsx(I,{variant:"outline",children:h},h))})]}),d.requirements&&d.requirements.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-1",children:"Requirements:"}),e.jsx("ul",{className:"text-sm text-muted-foreground list-disc list-inside",children:d.requirements.slice(0,3).map((h,v)=>e.jsx("li",{children:h},v))})]}),d.benefits&&d.benefits.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-1",children:"Benefits:"}),e.jsx("ul",{className:"text-sm text-muted-foreground list-disc list-inside",children:d.benefits.slice(0,3).map((h,v)=>e.jsx("li",{children:h},v))})]})]}),e.jsxs(me,{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:d.price_range&&`Price: ${d.price_range}`}),e.jsxs(b,{size:"sm",children:[e.jsx(jr,{className:"h-4 w-4 mr-2"}),"Connect"]})]})]},d.id))}),e.jsxs("div",{className:"mt-12 border-t pt-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Success Stories"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{className:"text-lg",children:"From Individual Farmer to Export Group"})}),e.jsxs(_,{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:'"As a small-scale avocado farmer, I struggled to access export markets due to volume requirements. After joining the Avocado Export Cooperative, I now sell my produce at premium prices and have received training on GlobalGAP certification."'}),e.jsx("div",{className:"flex mt-4",children:e.jsx(I,{variant:"outline",children:"30% higher income"})})]}),e.jsx(me,{children:e.jsx("div",{className:"text-sm",children:"- John Mwangi, Muranga County"})})]}),e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{className:"text-lg",children:"Collective Input Purchasing"})}),e.jsxs(_,{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:`"By joining the Meru Potato Farmers Association, our group of 15 small-scale farmers now purchases inputs in bulk. We've reduced our costs by 20% and gained access to certified seeds that were previously unavailable to us individually."`}),e.jsx("div",{className:"flex mt-4",children:e.jsx(I,{variant:"outline",children:"20% cost reduction"})})]}),e.jsx(me,{children:e.jsx("div",{className:"text-sm",children:"- Mary Nkatha, Meru County"})})]}),e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{className:"text-lg",children:"Supermarket Direct Supply Chain"})}),e.jsxs(_,{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:`"Through the Fresh Produce Vertical Linkage program, our cooperative now supplies vegetables directly to three major supermarket chains. We've eliminated middlemen and increased our profits while ensuring consistent market access."`}),e.jsx("div",{className:"flex mt-4",children:e.jsx(I,{variant:"outline",children:"Stable pricing"})})]}),e.jsx(me,{children:e.jsx("div",{className:"text-sm",children:"- David Ochieng, Kisumu County"})})]})]})]})]})]})},pm=jt("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),xt=i.forwardRef(({className:s,variant:t,...a},r)=>e.jsx("div",{ref:r,role:"alert",className:$(pm({variant:t}),s),...a}));xt.displayName="Alert";const ar=i.forwardRef(({className:s,...t},a)=>e.jsx("h5",{ref:a,className:$("mb-1 font-medium leading-none tracking-tight",s),...t}));ar.displayName="AlertTitle";const ht=i.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:$("text-sm [&_p]:leading-relaxed",s),...t}));ht.displayName="AlertDescription";const gm=async(s,t,a)=>{try{if(!a.length)return console.warn("No reports to analyze"),null;const r=a.join(`

`),n=await jm(s,t,r);return n||(console.error("Failed to get sentiment analysis result"),null)}catch(r){return console.error("Error in sentiment analysis:",r),null}};async function jm(s,t,a){try{const{data:r,error:n}=await F.functions.invoke("analyze-sentiment",{body:{commodity:s,county:t,text:a}});return n?(console.error("Error from sentiment analysis function:",n),null):r?{id:crypto.randomUUID(),commodity_name:s,county:t,sentiment_score:r.sentimentScore||0,report_count:1,tags:r.tags||[],issues:r.issues||[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()}:(console.error("No data returned from sentiment analysis"),null)}catch(r){return console.error("Failed to call sentiment analysis function:",r),null}}const fm=async()=>{try{const{data:s,error:t}=await F.from("market_sentiment").select("*").order("updated_at",{ascending:!1}).limit(50);return t?(console.error("Error fetching market sentiment:",t),[]):s||[]}catch(s){return console.error("Unexpected error fetching market sentiment:",s),[]}},vm=async(s,t,a)=>{try{return await gm(s,t,[a])!==null}catch(r){return console.error("Error submitting market report:",r),!1}},ym=()=>{const[s,t]=i.useState("alerts"),[a,r]=i.useState("all"),[n,c]=i.useState("all"),[l,x]=i.useState([]),[f,j]=i.useState(!0),[N,g]=i.useState({commodity:"",county:"",report:""}),[u,d]=i.useState(!1),{toast:h}=Z();i.useEffect(()=>{v()},[]);const v=async()=>{try{j(!0);const S=await fm();x(S)}catch(S){console.error("Error loading sentiment data:",S),h({title:"Error",description:"Failed to load sentiment data",variant:"destructive"})}finally{j(!1)}},p=async S=>{if(S.preventDefault(),!N.commodity||!N.county||!N.report){h({title:"Missing Information",description:"Please fill in all fields",variant:"destructive"});return}try{if(d(!0),await vm(N.commodity,N.county,N.report))h({title:"Report Submitted",description:"Your market report has been analyzed and submitted successfully"}),g({commodity:"",county:"",report:""}),v();else throw new Error("Failed to submit report")}catch(E){console.error("Error submitting report:",E),h({title:"Submission Failed",description:"Failed to submit your report. Please try again.",variant:"destructive"})}finally{d(!1)}},m=()=>l.filter(S=>(a==="all"||S.commodity_name.toLowerCase().includes(a.toLowerCase()))&&(n==="all"||S.county.toLowerCase().includes(n.toLowerCase()))),o=()=>m().filter(S=>S.sentiment_score<-.3||S.issues.some(E=>["counterfeit_products","pest_disease"].includes(E))),y=()=>e.jsxs(w,{className:"mb-6",children:[e.jsxs(q,{children:[e.jsx(L,{children:"Submit Market Report"}),e.jsx(G,{children:"Share your market experience to help the community"})]}),e.jsx(_,{children:e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"commodity",children:"Commodity"}),e.jsx(D,{id:"commodity",value:N.commodity,onChange:S=>g(E=>({...E,commodity:S.target.value})),placeholder:"e.g., Maize, Tomatoes, Potatoes"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"county",children:"County"}),e.jsx(D,{id:"county",value:N.county,onChange:S=>g(E=>({...E,county:S.target.value})),placeholder:"e.g., Nakuru, Kiambu, Kisumu"})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"report",children:"Market Report"}),e.jsx(le,{id:"report",value:N.report,onChange:S=>g(E=>({...E,report:S.target.value})),placeholder:"Describe your market experience, prices, quality issues, or any concerns...",rows:4})]}),e.jsx(b,{type:"submit",disabled:u,className:"w-full",children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Analyzing & Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(sa,{className:"h-4 w-4 mr-2"}),"Submit Report"]})})]})})]}),k=()=>{const S=o();return f?e.jsx("div",{className:"p-6 text-center",children:"Loading alerts..."}):S.length===0?e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("div",{className:"mb-4 text-muted-foreground",children:e.jsx(Se,{className:"mx-auto h-12 w-12 opacity-50"})}),e.jsx("h3",{className:"text-lg font-medium",children:"No alerts found"}),e.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"There are no current alerts matching your criteria."})]}):e.jsx("div",{className:"space-y-4",children:S.map(E=>e.jsxs(xt,{variant:E.sentiment_score<-.5?"destructive":"default",children:[e.jsx(Se,{className:"h-4 w-4"}),e.jsxs(ar,{children:["Alert: ",E.commodity_name," in ",E.county]}),e.jsx(ht,{children:e.jsxs("div",{className:"mt-2",children:[e.jsxs("p",{children:["Sentiment Score: ",(E.sentiment_score*100).toFixed(0),"%"]}),e.jsxs("p",{children:["Reports: ",E.report_count]}),E.issues.length>0&&e.jsxs("p",{children:["Issues: ",E.issues.join(", ")]}),E.tags.length>0&&e.jsxs("p",{children:["Tags: ",E.tags.join(", ")]})]})})]},E.id))})},A=()=>{const S=m();return f?e.jsx("div",{className:"p-6 text-center",children:"Loading insights..."}):S.length===0?e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("div",{className:"mb-4 text-muted-foreground",children:e.jsx(ea,{className:"mx-auto h-12 w-12 opacity-50"})}),e.jsx("h3",{className:"text-lg font-medium",children:"No insights found"}),e.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"There are no insights matching your criteria."})]}):e.jsx("div",{className:"space-y-4",children:S.map(E=>e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsxs(L,{children:[E.commodity_name," Market Sentiment"]}),e.jsxs(G,{children:[E.county," â€¢ Reports: ",E.report_count," â€¢ Updated: ",new Date(E.updated_at).toLocaleDateString()]})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{children:"Sentiment Score:"}),e.jsxs("span",{className:`font-bold ${E.sentiment_score>.1?"text-green-600":E.sentiment_score<-.1?"text-red-600":"text-yellow-600"}`,children:[(E.sentiment_score*100).toFixed(0),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${E.sentiment_score>.1?"bg-green-500":E.sentiment_score<-.1?"bg-red-500":"bg-yellow-500"}`,style:{width:`${Math.abs(E.sentiment_score)*100}%`}})})]}),E.tags.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Tags:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:E.tags.map((P,R)=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:P},R))})]}),E.issues.length>0&&e.jsxs("div",{className:"bg-red-50 p-3 rounded-md",children:[e.jsx("h4",{className:"font-medium mb-2 text-red-800",children:"Issues Identified:"}),e.jsx("ul",{className:"list-disc list-inside text-red-700",children:E.issues.map((P,R)=>e.jsx("li",{className:"text-sm",children:P.replace(/_/g," ")},R))})]})]})]},E.id))})};return e.jsxs(w,{className:"w-full",children:[e.jsxs(q,{children:[e.jsx(L,{children:"Collective Intelligence Insights"}),e.jsx(G,{children:"Real-time sentiment analysis from farmer reports and community feedback"})]}),e.jsxs(_,{children:[y(),e.jsxs("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"crop",children:"Crop Filter"}),e.jsxs(Q,{value:a,onValueChange:r,children:[e.jsx(W,{id:"crop",children:e.jsx(J,{placeholder:"All Crops"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Crops"}),e.jsx(T,{value:"maize",children:"Maize"}),e.jsx(T,{value:"potato",children:"Potato"}),e.jsx(T,{value:"tomato",children:"Tomato"}),e.jsx(T,{value:"wheat",children:"Wheat"}),e.jsx(T,{value:"rice",children:"Rice"})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"location",children:"Location Filter"}),e.jsxs(Q,{value:n,onValueChange:c,children:[e.jsx(W,{id:"location",children:e.jsx(J,{placeholder:"All Locations"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Locations"}),e.jsx(T,{value:"nakuru",children:"Nakuru"}),e.jsx(T,{value:"kisumu",children:"Kisumu"}),e.jsx(T,{value:"kiambu",children:"Kiambu"}),e.jsx(T,{value:"machakos",children:"Machakos"}),e.jsx(T,{value:"uasin gishu",children:"Uasin Gishu"})]})]})]})]}),e.jsxs(ge,{defaultValue:"alerts",value:s,onValueChange:t,children:[e.jsxs(pe,{className:"grid grid-cols-2 mb-6",children:[e.jsxs(B,{value:"alerts",className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Alerts"})]}),e.jsxs(B,{value:"insights",className:"flex items-center gap-2",children:[e.jsx(ea,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Insights"})]})]}),e.jsx(V,{value:"alerts",children:k()}),e.jsx(V,{value:"insights",children:A()})]})]}),e.jsxs(me,{className:"border-t pt-4 text-sm text-muted-foreground flex justify-between",children:[e.jsx("div",{children:"Based on real-time sentiment analysis of community reports"}),e.jsx(b,{variant:"ghost",size:"icon",onClick:v,children:e.jsx(At,{className:"h-4 w-4"})})]})]})},Nm=()=>(i.useEffect(()=>{document.title="Agricultural Sentiment Analysis | AgriConnect"},[]),e.jsxs("div",{className:"container py-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Agricultural Sentiment Analysis"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Insights derived from farmer feedback, reports, and community discussions"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs(xt,{className:"bg-amber-50 border-amber-200",children:[e.jsx(Se,{className:"h-4 w-4 text-amber-600"}),e.jsx(ar,{className:"text-amber-800",children:"Important Alerts"}),e.jsx(ht,{className:"text-amber-700",children:"We've detected significant sentiment patterns regarding agricultural products in various counties. View details in the dashboard below."}),e.jsx("div",{className:"mt-2",children:e.jsx(b,{variant:"outline",size:"sm",className:"bg-white",children:"View Alert Details"})})]}),e.jsxs(ge,{defaultValue:"insights",className:"mb-6",children:[e.jsxs(pe,{className:"mb-4",children:[e.jsxs(B,{value:"insights",className:"flex items-center gap-2",children:[e.jsx(ea,{className:"h-4 w-4"}),e.jsx("span",{children:"Sentiment Insights"})]}),e.jsxs(B,{value:"reports",className:"flex items-center gap-2",children:[e.jsx(Ds,{className:"h-4 w-4"}),e.jsx("span",{children:"Submit Report"})]}),e.jsxs(B,{value:"community",className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"h-4 w-4"}),e.jsx("span",{children:"Community Discussions"})]})]}),e.jsx(V,{value:"insights",children:e.jsx(ym,{})}),e.jsx(V,{value:"reports",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Submit Your Experience"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Share your feedback about agricultural products, services, or policies to help other farmers make informed decisions."}),e.jsx("form",{className:"space-y-4",children:e.jsx("div",{className:"flex justify-end",children:e.jsx(b,{children:"Submit Report"})})})]})}),e.jsx(V,{value:"community",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg border text-center",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Community Discussions"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"This feature is coming soon. Join discussions with other farmers about shared experiences."}),e.jsx(b,{variant:"outline",children:"Get Notified When Available"})]})})]})]})]})),bm=()=>{const s=[{id:"post-harvest-losses",title:"Post-Harvest Losses",description:"Up to 40% of harvested crops are lost due to inadequate storage, transportation issues, and limited processing facilities.",solutions:["Affordable storage technologies","Value addition and processing","Direct market linkages"],path:"/supply-chain-problems/post-harvest-losses",implemented:!0},{id:"logistics-issues",title:"Logistics Issues",description:"Poor infrastructure and inefficient transportation lead to delays, spoilage, and higher costs for farmers.",solutions:["Optimized transport routes","Cold chain solutions","Shared logistics services"],path:"/supply-chain-problems/logistics-issues",implemented:!0},{id:"market-access",title:"Market Access",description:"Farmers struggle to connect with buyers and often rely on exploitative middlemen.",solutions:["Direct buyer-farmer connections","Market information systems","Collective marketing groups"],path:"/supply-chain-problems/market-access",implemented:!0},{id:"price-volatility",title:"Price Volatility",description:"Unpredictable price fluctuations make planning difficult and reduce farmer incomes.",solutions:["Forward contracts","Price prediction tools","Storage solutions to sell when prices improve"],path:"/supply-chain-problems/price-volatility",implemented:!0},{id:"quality-control",title:"Quality Control",description:"Inconsistent produce quality limits access to premium markets and reduces prices.",solutions:["Quality verification systems","Training on standards","Certification support"],path:"/supply-chain-problems/quality-control",implemented:!0}];return e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),e.jsxs("main",{className:"py-12 px-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-10 text-center",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-4",children:"Agricultural Supply Chain Challenges"}),e.jsx("p",{className:"text-muted-foreground max-w-3xl mx-auto",children:"Addressing key challenges in Kenya's agricultural supply chains with practical, technology-driven solutions"}),e.jsxs("div",{className:"flex justify-center gap-2 mt-4",children:[e.jsxs(I,{variant:"default",className:"flex items-center gap-1",children:[e.jsx(fe,{className:"h-3 w-3"}),"All Solutions Implemented"]}),e.jsx(I,{variant:"outline",children:"5 Key Challenges Addressed"})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-16",children:s.map(t=>e.jsxs(w,{className:"flex flex-col relative",children:[t.implemented&&e.jsxs(I,{variant:"default",className:"absolute top-4 right-4 flex items-center gap-1",children:[e.jsx(fe,{className:"h-3 w-3"}),"Live"]}),e.jsxs(q,{className:"pb-2",children:[e.jsx(L,{children:t.title}),e.jsx(G,{children:t.description})]}),e.jsxs(_,{className:"flex-grow",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Our Solutions"}),e.jsx("ul",{className:"list-disc pl-5 space-y-1 mb-4",children:t.solutions.map((a,r)=>e.jsx("li",{className:"text-sm",children:a},r))})]}),e.jsx(me,{children:e.jsx(b,{asChild:!0,className:"w-full md:w-auto",children:e.jsxs(X,{to:t.path,children:["Learn More & Access Tools",e.jsx(ks,{className:"ml-2 h-4 w-4"})]})})})]},t.id))}),e.jsxs("div",{className:"mt-16 bg-muted/30 p-6 rounded-lg",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"How SokoConnect Addresses Supply Chain Challenges"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{className:"text-lg",children:"Technology Integration"})}),e.jsxs(_,{children:[e.jsx("p",{className:"text-sm mb-4",children:"Our platform uses technology to connect all actors in the supply chain, creating transparency and improving coordination between farmers, transporters, and buyers."}),e.jsxs("ul",{className:"text-xs space-y-1",children:[e.jsx("li",{children:"â€¢ Real-time tracking and monitoring"}),e.jsx("li",{children:"â€¢ Automated matching algorithms"}),e.jsx("li",{children:"â€¢ Mobile-first design for accessibility"}),e.jsx("li",{children:"â€¢ Integration with payment systems"})]})]})]}),e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{className:"text-lg",children:"Data-Driven Decisions"})}),e.jsxs(_,{children:[e.jsx("p",{className:"text-sm mb-4",children:"Real-time market data and production forecasts help farmers and buyers make informed decisions about what to grow, when to sell, and where to sell."}),e.jsxs("ul",{className:"text-xs space-y-1",children:[e.jsx("li",{children:"â€¢ AI-powered price predictions"}),e.jsx("li",{children:"â€¢ Weather-based recommendations"}),e.jsx("li",{children:"â€¢ Market demand forecasting"}),e.jsx("li",{children:"â€¢ Risk assessment tools"})]})]})]}),e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{className:"text-lg",children:"Alternative Trading"})}),e.jsxs(_,{children:[e.jsx("p",{className:"text-sm mb-4",children:"Our barter exchange system and community trading networks create alternative pathways for farmers to exchange goods and access markets without cash."}),e.jsxs("ul",{className:"text-xs space-y-1",children:[e.jsx("li",{children:"â€¢ Crop-to-crop exchanges"}),e.jsx("li",{children:"â€¢ Service-for-produce trades"}),e.jsx("li",{children:"â€¢ Community cooperatives"}),e.jsx("li",{children:"â€¢ Digital payment alternatives"})]})]})]})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg mb-6",children:[e.jsx("h3",{className:"font-medium text-green-900 mb-2",children:"Platform Risk Disclaimer"}),e.jsx("p",{className:"text-sm text-green-800",children:"AgriTender Connect provides technology solutions to facilitate agricultural connections and transactions. We do not manage farming operations, guarantee crop outcomes, or assume responsibility for agricultural risks. Users make independent decisions regarding their farming and business activities."})]}),e.jsx("div",{className:"text-center",children:e.jsx(b,{size:"lg",asChild:!0,children:e.jsx(X,{to:"/commodity-trading",children:"Start Trading Now"})})})]})]})]})},wm=$l,qn=i.createContext({}),gs=({...s})=>e.jsx(qn.Provider,{value:{name:s.name},children:e.jsx(Gl,{...s})}),ha=()=>{const s=i.useContext(qn),t=i.useContext(Ln),{getFieldState:a,formState:r}=Vl(),n=a(s.name,r);if(!s)throw new Error("useFormField should be used within <FormField>");const{id:c}=t;return{id:c,name:s.name,formItemId:`${c}-form-item`,formDescriptionId:`${c}-form-item-description`,formMessageId:`${c}-form-item-message`,...n}},Ln=i.createContext({}),os=i.forwardRef(({className:s,...t},a)=>{const r=i.useId();return e.jsx(Ln.Provider,{value:{id:r},children:e.jsx("div",{ref:a,className:$("space-y-2",s),...t})})});os.displayName="FormItem";const ds=i.forwardRef(({className:s,...t},a)=>{const{error:r,formItemId:n}=ha();return e.jsx(C,{ref:a,className:$(r&&"text-destructive",s),htmlFor:n,...t})});ds.displayName="FormLabel";const ms=i.forwardRef(({...s},t)=>{const{error:a,formItemId:r,formDescriptionId:n,formMessageId:c}=ha();return e.jsx(Xr,{ref:t,id:r,"aria-describedby":a?`${n} ${c}`:`${n}`,"aria-invalid":!!a,...s})});ms.displayName="FormControl";const Xt=i.forwardRef(({className:s,...t},a)=>{const{formDescriptionId:r}=ha();return e.jsx("p",{ref:a,id:r,className:$("text-sm text-muted-foreground",s),...t})});Xt.displayName="FormDescription";const js=i.forwardRef(({className:s,children:t,...a},r)=>{const{error:n,formMessageId:c}=ha(),l=n?String(n==null?void 0:n.message):t;return l?e.jsx("p",{ref:r,id:c,className:$("text-sm font-medium text-destructive",s),...a,children:l}):null});js.displayName="FormMessage";const De=i.forwardRef(({className:s,...t},a)=>e.jsx(Ui,{ref:a,className:$("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...t,children:e.jsx(Hl,{className:$("flex items-center justify-center text-current"),children:e.jsx(Qe,{className:"h-4 w-4"})})}));De.displayName=Ui.displayName;const _m=ve.object({companyName:ve.string().min(2,{message:"Company name must be at least 2 characters."}),serviceType:ve.enum(["transport","storage","both"],{required_error:"Please select a service type."}),counties:ve.string().min(2,{message:"Please enter at least one county."}),contactEmail:ve.string().email({message:"Please enter a valid email address."}),contactPhone:ve.string().min(10,{message:"Please enter a valid phone number."}),capacity:ve.string().min(2,{message:"Please specify your capacity."}),rates:ve.string().min(2,{message:"Please specify your rates."}),hasRefrigeration:ve.boolean().default(!1),description:ve.string().optional(),termsAccepted:ve.boolean().refine(s=>s===!0,{message:"You must accept the terms and conditions."})}),Cm=()=>{const{toast:s}=Z(),[t,a]=i.useState(!1),r=Wl({resolver:Yl(_m),defaultValues:{companyName:"",counties:"",contactEmail:"",contactPhone:"",capacity:"",rates:"",hasRefrigeration:!1,description:"",termsAccepted:!1}}),n=async c=>{a(!0);try{console.log("Submitting logistics provider data:",c),await new Promise(l=>setTimeout(l,1500)),s({title:"Registration Successful",description:"Your logistics service has been registered. You'll receive a confirmation email shortly."}),r.reset()}catch(l){console.error("Error submitting logistics provider:",l),s({title:"Registration Failed",description:"There was an error registering your service. Please try again.",variant:"destructive"})}finally{a(!1)}};return e.jsxs(w,{className:"w-full max-w-4xl mx-auto",children:[e.jsxs(q,{children:[e.jsx(L,{children:"Register as a Logistics Provider"}),e.jsx(G,{children:"Connect with farmers and markets by registering your transportation or storage services"})]}),e.jsx(_,{children:e.jsx(wm,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(n),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(gs,{control:r.control,name:"companyName",render:({field:c})=>e.jsxs(os,{children:[e.jsx(ds,{children:"Company Name"}),e.jsx(ms,{children:e.jsx(D,{placeholder:"Your company name",...c})}),e.jsx(js,{})]})}),e.jsx(gs,{control:r.control,name:"serviceType",render:({field:c})=>e.jsxs(os,{children:[e.jsx(ds,{children:"Service Type"}),e.jsxs(Q,{onValueChange:c.onChange,defaultValue:c.value,children:[e.jsx(ms,{children:e.jsx(W,{children:e.jsx(J,{placeholder:"Select a service type"})})}),e.jsxs(Y,{children:[e.jsx(T,{value:"transport",children:"Transportation"}),e.jsx(T,{value:"storage",children:"Storage"}),e.jsx(T,{value:"both",children:"Both Transport & Storage"})]})]}),e.jsx(js,{})]})}),e.jsx(gs,{control:r.control,name:"counties",render:({field:c})=>e.jsxs(os,{children:[e.jsx(ds,{children:"Counties Served"}),e.jsx(ms,{children:e.jsx(D,{placeholder:"E.g. Nairobi, Nakuru, Kiambu",...c})}),e.jsx(Xt,{children:"Enter county names separated by commas"}),e.jsx(js,{})]})}),e.jsx(gs,{control:r.control,name:"contactEmail",render:({field:c})=>e.jsxs(os,{children:[e.jsx(ds,{children:"Email Address"}),e.jsx(ms,{children:e.jsx(D,{type:"email",placeholder:"your.email@example.com",...c})}),e.jsx(js,{})]})}),e.jsx(gs,{control:r.control,name:"contactPhone",render:({field:c})=>e.jsxs(os,{children:[e.jsx(ds,{children:"Phone Number"}),e.jsx(ms,{children:e.jsx(D,{placeholder:"+254700000000",...c})}),e.jsx(js,{})]})}),e.jsx(gs,{control:r.control,name:"capacity",render:({field:c})=>e.jsxs(os,{children:[e.jsx(ds,{children:"Capacity"}),e.jsx(ms,{children:e.jsx(D,{placeholder:"E.g. Up to 10 tons or 5,000 sq. ft",...c})}),e.jsx(js,{})]})}),e.jsx(gs,{control:r.control,name:"rates",render:({field:c})=>e.jsxs(os,{children:[e.jsx(ds,{children:"Rates"}),e.jsx(ms,{children:e.jsx(D,{placeholder:"E.g. KES 5,000 per ton or KES 50 per sq. ft",...c})}),e.jsx(js,{})]})}),e.jsx(gs,{control:r.control,name:"hasRefrigeration",render:({field:c})=>e.jsxs(os,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[e.jsx(ms,{children:e.jsx(De,{checked:c.value,onCheckedChange:c.onChange})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsx(ds,{children:"Refrigeration Available"}),e.jsx(Xt,{children:"Check if you provide refrigerated transport or cold storage"})]})]})})]}),e.jsx(gs,{control:r.control,name:"description",render:({field:c})=>e.jsxs(os,{children:[e.jsx(ds,{children:"Additional Details"}),e.jsx(ms,{children:e.jsx(le,{placeholder:"Please provide any additional information about your services",className:"min-h-[100px]",...c})}),e.jsx(js,{})]})}),e.jsx(gs,{control:r.control,name:"termsAccepted",render:({field:c})=>e.jsxs(os,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(ms,{children:e.jsx(De,{checked:c.value,onCheckedChange:c.onChange})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsx(ds,{children:"I accept the terms and conditions"}),e.jsx(Xt,{children:"By registering, you agree to our terms of service and privacy policy"})]}),e.jsx(js,{})]})}),e.jsx(b,{type:"submit",className:"w-full",disabled:t,children:t?"Registering...":"Register as Logistics Provider"})]})})}),e.jsx(me,{className:"flex justify-between",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Already registered? ",e.jsx(b,{variant:"link",className:"p-0 h-auto",children:"Sign in"})]})})]})},km=()=>{const s=[{title:"Poor Road Infrastructure",description:"Many agricultural regions have poor quality roads that become impassable during rainy seasons.",impact:"Delays in transportation, increased costs, and reduced access to markets.",solution:"Advocacy for infrastructure improvement, route optimization, and using appropriate vehicles for terrain."},{title:"Lack of Cold Chain",description:"80% of rural areas lack proper cold storage facilities, resulting in significant post-harvest losses.",impact:"Reduced shelf life, lower quality products, and increased food waste.",solution:"Investment in solar-powered cold storage, refrigerated transport, and preservation techniques."},{title:"High Transportation Costs",description:"Transportation costs can account for up to 40% of the total value of agricultural products.",impact:"Reduced farmer profits, higher consumer prices, and limited market participation.",solution:"Consolidation of shipments, cooperative transport models, and efficient route planning."},{title:"Limited Logistics Services",description:"Rural areas have few professional logistics service providers with appropriate equipment.",impact:"Farmers rely on informal transporters, reducing reliability and increasing risks.",solution:"Development of rural logistics networks, transport cooperatives, and digital logistics platforms."}];return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:s.map((t,a)=>e.jsxs(w,{className:"border-l-4 border-l-primary",children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-lg",children:t.title})}),e.jsxs(_,{className:"space-y-2",children:[e.jsx("p",{children:t.description}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Impact:"})," ",t.impact]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Potential Solution:"})," ",t.solution]})]})]},a))}),e.jsxs("div",{className:"mt-10 p-4 border rounded-lg bg-muted/30",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Impact on Supply Chain Efficiency"}),e.jsx("p",{className:"mb-4",children:"Logistics challenges significantly reduce the efficiency of agricultural supply chains in Kenya:"}),e.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[e.jsx("li",{children:"Up to 40% of fresh produce is lost due to logistical inefficiencies"}),e.jsx("li",{children:"Rural farmers spend 4-6 hours on average to reach the nearest collection center"}),e.jsx("li",{children:"Transportation costs account for 30-40% of the final product price"}),e.jsx("li",{children:"Only 23% of smallholder farmers have access to reliable transportation services"})]})]})]})},Sm=({isLoading:s})=>{const t=()=>[{issue:"Poor Road Infrastructure",frequency:65,impact:"High"},{issue:"Lack of Cold Storage",frequency:45,impact:"High"},{issue:"High Transport Costs",frequency:72,impact:"High"},{issue:"Delayed Collections",frequency:38,impact:"Medium"},{issue:"Fragmented Supply Chain",frequency:55,impact:"Medium"},{issue:"Limited Market Access",frequency:60,impact:"High"}],a=()=>[{name:"Trucks",value:45,color:"#0088FE"},{name:"Motorcycles",value:25,color:"#00C49F"},{name:"Hand Carts",value:15,color:"#FFBB28"},{name:"Animal Transport",value:10,color:"#FF8042"},{name:"Public Transport",value:5,color:"#8884d8"}];return s?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):e.jsxs(e.Fragment,{children:[e.jsx(I,{variant:"outline",className:"mb-6 bg-blue-50",children:"Based on analysis of Kilimo statistics and agricultural surveys"}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Logistics Challenges Frequency"}),e.jsx(Je,{width:"100%",height:300,children:e.jsxs(yt,{data:t(),margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(Ns,{strokeDasharray:"3 3"}),e.jsx(bs,{dataKey:"issue"}),e.jsx(ws,{}),e.jsx(Xe,{}),e.jsx(et,{}),e.jsx(us,{dataKey:"frequency",fill:"#8884d8",name:"Reported Frequency (%)"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mt-10",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Transport Modes Used in Agriculture"}),e.jsx(Je,{width:"100%",height:300,children:e.jsxs(oa,{children:[e.jsx(da,{data:a(),cx:"50%",cy:"50%",labelLine:!1,label:({name:r,percent:n})=>`${r}: ${(n*100).toFixed(0)}%`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:a().map((r,n)=>e.jsx(Rt,{fill:r.color},`cell-${n}`))}),e.jsx(Xe,{})]})})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Key Findings"}),e.jsxs("ul",{className:"list-disc pl-6 space-y-3",children:[e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Infrastructure Gap:"})," 65% of agricultural areas report inadequate road infrastructure"]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Cold Chain Deficiency:"})," Only 22% of fresh produce benefits from proper cold chain"]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Transport Modes:"})," Traditional and informal methods still dominate agricultural logistics"]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Cost Burden:"})," Small-scale farmers spend 3x more on transportation as a percentage of revenue"]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Regional Disparity:"})," Western and coastal regions face more severe logistics challenges"]})]})]})]}),e.jsxs("div",{className:"mt-10 p-4 border rounded-lg bg-blue-50",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Methodology"}),e.jsx("p",{children:"This analysis combines data from Kilimo Statistics API, transportation surveys, and farmer interviews to identify key logistics challenges. The frequency represents the percentage of farmers reporting each issue as a significant barrier to market access."})]})]})},Pm=()=>{const s=Ne(),[t,a]=i.useState([]),[r,n]=i.useState(!0),[c,l]=i.useState("issues");return i.useEffect(()=>{(async()=>{n(!0);try{const f=await zt();a(f)}catch(f){console.error("Error fetching Kilimo data:",f)}finally{n(!1)}})()},[]),e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),e.jsxs("main",{className:"py-12 px-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-10 text-center",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-4",children:"Logistics Issues"}),e.jsx("p",{className:"text-muted-foreground max-w-3xl mx-auto",children:"Understanding and addressing transportation and delivery challenges in agricultural supply chains"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mt-6",children:[e.jsxs(b,{onClick:()=>s("/logistics-solutions-map"),className:"flex gap-2 items-center",variant:"outline",children:[e.jsx(ee,{className:"h-4 w-4"}),"View Logistics Solutions Map"]}),e.jsx(b,{onClick:()=>l("register"),variant:"default",children:"Register as Provider"})]})]}),e.jsxs(ge,{value:c,onValueChange:l,className:"w-full",children:[e.jsxs(pe,{className:"w-full grid grid-cols-1 sm:grid-cols-3 gap-2 mb-8",children:[e.jsxs(B,{value:"issues",className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-4 w-4"}),e.jsx("span",{children:"Logistics Challenges"})]}),e.jsxs(B,{value:"data",className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4"}),e.jsx("span",{children:"Data Analysis"})]}),e.jsxs(B,{value:"register",className:"flex items-center gap-2",children:[e.jsx(ye,{className:"h-4 w-4"}),e.jsx("span",{children:"Register as Provider"})]})]}),e.jsx(V,{value:"issues",children:e.jsxs(w,{className:"mb-8",children:[e.jsxs(q,{children:[e.jsx(L,{children:"Common Logistics Challenges"}),e.jsx(G,{children:"Key transportation and delivery issues faced by agricultural businesses in Kenya"})]}),e.jsx(_,{children:e.jsx(km,{})}),e.jsxs(me,{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs(b,{onClick:()=>s("/logistics-solutions-map"),className:"flex gap-2 items-center w-full sm:w-auto",variant:"outline",children:[e.jsx(ee,{className:"h-4 w-4"}),"Find Logistics Providers Near You"]}),e.jsx(b,{onClick:()=>l("register"),className:"ml-auto w-full sm:w-auto",children:"Be Part of the Solution - Register"})]})]})}),e.jsx(V,{value:"data",children:e.jsxs(w,{className:"mb-8",children:[e.jsxs(q,{children:[e.jsx(L,{children:"Logistics Data Analysis"}),e.jsx(G,{children:"Data-driven insights on agricultural logistics challenges based on national statistics"})]}),e.jsx(_,{children:e.jsx(Sm,{isLoading:r})}),e.jsx(me,{children:e.jsx(b,{onClick:()=>s("/logistics-solutions-map"),className:"ml-auto",children:"Find Solutions on Map"})})]})}),e.jsx(V,{value:"register",children:e.jsx(Cm,{})})]})]})]})},Am=()=>{const[s,t]=i.useState([]),[a,r]=i.useState(!0),[n,c]=i.useState("challenges"),l=Ne();i.useEffect(()=>{(async()=>{r(!0);try{const d=await zt();t(d)}catch(d){console.error("Error fetching Kilimo data:",d)}finally{r(!1)}})()},[]);const x=()=>s.filter(d=>d.category==="County").map(d=>({county:d.name,marketAccess:Math.floor(Math.random()*100),distanceToMarket:Math.floor(Math.random()*30)+5,priceInformation:Math.floor(Math.random()*100)})).sort((d,h)=>h.marketAccess-d.marketAccess).slice(0,8),f=()=>[{name:"Limited Price Information",value:78,color:"#0088FE"},{name:"Poor Transport Infrastructure",value:65,color:"#00C49F"},{name:"Market Power Imbalances",value:62,color:"#FFBB28"},{name:"Limited Storage Facilities",value:58,color:"#FF8042"},{name:"Lack of Quality Standards",value:45,color:"#8884d8"}],j=()=>[{month:"Jan",maize:50,beans:120,potatoes:45},{month:"Feb",maize:48,beans:125,potatoes:43},{month:"Mar",maize:45,beans:130,potatoes:40},{month:"Apr",maize:47,beans:128,potatoes:42},{month:"May",maize:52,beans:125,potatoes:46},{month:"Jun",maize:55,beans:120,potatoes:48},{month:"Jul",maize:58,beans:118,potatoes:50},{month:"Aug",maize:60,beans:115,potatoes:52},{month:"Sep",maize:57,beans:120,potatoes:49},{month:"Oct",maize:54,beans:122,potatoes:47},{month:"Nov",maize:52,beans:125,potatoes:45},{month:"Dec",maize:51,beans:127,potatoes:44}],N=[{title:"Information Asymmetry",description:"Farmers lack access to accurate, timely market information including prices, demand, and quality requirements.",impact:"Reduced bargaining power, suboptimal market timing, and inability to respond to market demands.",solution:"Mobile-based market information systems, farmer cooperatives for information sharing, and market intelligence platforms."},{title:"Middlemen Dependence",description:"Long supply chains with multiple intermediaries that capture value without adding proportional services.",impact:"Reduced farmer profits, increased consumer prices, and market distortions.",solution:"Direct marketing channels, farmer aggregation centers, and digital marketplace platforms connecting farmers to buyers."},{title:"Quality & Standards",description:"Lack of standardized quality metrics and certification systems for agricultural products.",impact:"Limited access to premium markets, rejected produce, and lack of price differentiation for quality.",solution:"Training on quality standards, affordable certification systems, and quality-based pricing mechanisms."},{title:"Limited Market Options",description:"Overreliance on local markets and few alternative market channels for smallholder farmers.",impact:"Price exploitation, limited growth opportunities, and vulnerability to local market saturation.",solution:"Market diversification strategies, contract farming arrangements, and regional market integration."}],g=[{title:"Digital Marketplace Platforms",description:"Online platforms connecting farmers directly to buyers, eliminating intermediaries.",example:"Twiga Foods, M-Farm, Digital Green",impact:"Increased farmer income by 15-30% through direct market linkages."},{title:"SMS Price Information Services",description:"Mobile services providing real-time price information across different markets.",example:"MFarm, Esoko, NAFIS",impact:"Improved farmer bargaining power and optimal market timing decisions."},{title:"Aggregation Centers",description:"Community collection points that aggregate produce from smallholders to achieve marketable volumes.",example:"Farm to Market Alliance, One Acre Fund",impact:"Access to larger buyers and reduced per-unit logistics costs."},{title:"Contract Farming Models",description:"Pre-arranged supply agreements between farmers and buyers with agreed prices and volumes.",example:"East African Breweries, Kenya Nut Company",impact:"Stable income for farmers and secure supply for processors."}];return e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),e.jsxs("main",{className:"py-12 px-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-10 text-center",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-4",children:"Market Access Challenges"}),e.jsx("p",{className:"text-muted-foreground max-w-3xl mx-auto",children:"Addressing barriers that prevent farmers from reaching profitable markets"})]}),e.jsxs(ge,{value:n,onValueChange:c,className:"w-full",children:[e.jsxs(pe,{className:"w-full grid grid-cols-1 sm:grid-cols-3 gap-2 mb-8",children:[e.jsxs(B,{value:"challenges",className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{children:"Key Challenges"})]}),e.jsxs(B,{value:"data",className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),e.jsx("span",{children:"Market Data"})]}),e.jsxs(B,{value:"solutions",className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),e.jsx("span",{children:"Innovations"})]})]}),e.jsx(V,{value:"challenges",children:e.jsxs(w,{className:"mb-8",children:[e.jsxs(q,{children:[e.jsx(L,{children:"Market Access Issues"}),e.jsx(G,{children:"Common barriers to market entry for small-scale farmers"})]}),e.jsxs(_,{children:[e.jsx(I,{variant:"outline",className:"mb-6 bg-blue-50",children:"Based on analysis of Kilimo statistics and agricultural surveys"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:N.map((u,d)=>e.jsxs(w,{className:"border-l-4 border-l-primary",children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-lg",children:u.title})}),e.jsxs(_,{className:"space-y-2",children:[e.jsx("p",{children:u.description}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Impact:"})," ",u.impact]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Potential Solution:"})," ",u.solution]})]})]},d))}),e.jsxs("div",{className:"mt-10 p-4 border rounded-lg bg-muted/30",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Impact on Farmer Livelihoods"}),e.jsx("p",{className:"mb-4",children:"Market access challenges significantly impact smallholder farmers in Kenya:"}),e.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[e.jsx("li",{children:"Smallholders receive only 25-40% of the final market price of their produce"}),e.jsx("li",{children:"Almost 60% of farmers rely exclusively on local markets with limited price competitiveness"}),e.jsx("li",{children:"Only 31% of smallholder farmers have access to formal market channels"}),e.jsx("li",{children:"Price information asymmetry costs farmers an estimated 10-20% of potential income"})]})]})]}),e.jsx(me,{children:e.jsx(b,{onClick:()=>c("solutions"),className:"ml-auto",children:"Explore Market Access Solutions"})})]})}),e.jsx(V,{value:"data",children:e.jsxs(w,{className:"mb-8",children:[e.jsxs(q,{children:[e.jsx(L,{children:"Market Data Analysis"}),e.jsx(G,{children:"Data-driven insights on agricultural market access based on national statistics"})]}),e.jsx(_,{children:a?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Market Access by County"}),e.jsx(Je,{width:"100%",height:400,children:e.jsxs(yt,{data:x(),margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(Ns,{strokeDasharray:"3 3"}),e.jsx(bs,{dataKey:"county"}),e.jsx(ws,{}),e.jsx(Xe,{}),e.jsx(et,{}),e.jsx(us,{dataKey:"marketAccess",name:"Market Access Score",fill:"#8884d8"}),e.jsx(us,{dataKey:"distanceToMarket",name:"Avg. Distance to Market (km)",fill:"#82ca9d"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mt-10",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Key Market Access Barriers"}),e.jsx(Je,{width:"100%",height:300,children:e.jsxs(oa,{children:[e.jsx(da,{data:f(),cx:"50%",cy:"50%",labelLine:!1,label:({name:u,percent:d})=>`${u}: ${(d*100).toFixed(0)}%`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:f().map((u,d)=>e.jsx(Rt,{fill:u.color},`cell-${d}`))}),e.jsx(Xe,{})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Price Trends (KES/kg)"}),e.jsx(Je,{width:"100%",height:300,children:e.jsxs(ma,{data:j(),margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(Ns,{strokeDasharray:"3 3"}),e.jsx(bs,{dataKey:"month"}),e.jsx(ws,{}),e.jsx(Xe,{}),e.jsx(et,{}),e.jsx(Cs,{type:"monotone",dataKey:"maize",stroke:"#8884d8",activeDot:{r:8}}),e.jsx(Cs,{type:"monotone",dataKey:"beans",stroke:"#82ca9d"}),e.jsx(Cs,{type:"monotone",dataKey:"potatoes",stroke:"#ffc658"})]})})]})]}),e.jsxs("div",{className:"mt-10 p-4 border rounded-lg bg-blue-50",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Data Insights"}),e.jsxs("ul",{className:"list-disc pl-6 space-y-3",children:[e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Regional Disparities:"})," Market access varies significantly by region, with central counties having better access than remote ones"]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Price Information:"})," Limited access to price information is the most significant barrier, affecting 78% of farmers"]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Seasonal Variation:"})," Price volatility is highest during transitional months (April-May and October-November)"]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Infrastructure Impact:"})," Counties with better road infrastructure show 30% higher market access scores"]})]})]})]})}),e.jsx(me,{children:e.jsxs(b,{onClick:()=>l("/commodity-trading/price-trends"),variant:"outline",className:"ml-auto",children:["View Detailed Price Trends ",e.jsx(ft,{className:"ml-2 h-4 w-4"})]})})]})}),e.jsx(V,{value:"solutions",children:e.jsxs(w,{className:"mb-8",children:[e.jsxs(q,{children:[e.jsx(L,{children:"Market Access Innovations"}),e.jsx(G,{children:"Innovative solutions that are addressing market access challenges in Kenya"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:g.map((u,d)=>e.jsxs(w,{children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-lg",children:u.title})}),e.jsxs(_,{className:"space-y-2",children:[e.jsx("p",{children:u.description}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Examples:"})," ",u.example]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Impact:"})," ",u.impact]})]})]},d))}),e.jsxs("div",{className:"mt-10",children:[e.jsx("h3",{className:"text-xl font-medium mb-6",children:"Digital Solutions Transforming Market Access"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"p-4 border rounded-lg",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"mr-4 bg-primary/10 p-3 rounded-full",children:e.jsx(ce,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium mb-2",children:"Mobile Market Information Systems"}),e.jsx("p",{className:"mb-2",children:"SMS and mobile app services that provide real-time market prices, helping farmers make informed decisions about when and where to sell their produce."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Example: M-Farm's SMS price service reaches over 100,000 farmers in Kenya, improving incomes by up to 20%"})]})]})}),e.jsx("div",{className:"p-4 border rounded-lg",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"mr-4 bg-primary/10 p-3 rounded-full",children:e.jsx(se,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium mb-2",children:"Farmer Producer Organizations"}),e.jsx("p",{className:"mb-2",children:"Formal farmer groups that aggregate produce, improving bargaining power and enabling access to larger markets that individual smallholders couldn't reach alone."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Example: Meru Greens Horticulture aggregates produce from 4,000 smallholders to supply supermarkets and exporters"})]})]})}),e.jsx("div",{className:"p-4 border rounded-lg",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"mr-4 bg-primary/10 p-3 rounded-full",children:e.jsx(ee,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium mb-2",children:"E-Commerce Agricultural Marketplaces"}),e.jsx("p",{className:"mb-2",children:"Digital platforms connecting farmers directly to buyers, including restaurants, retailers, and consumers, reducing the number of intermediaries in the supply chain."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Example: Twiga Foods connects 17,000 farmers to 8,000 vendors, increasing farmer incomes by 20-40%"})]})]})})]})]}),e.jsx(qe,{className:"my-10"}),e.jsxs("div",{className:"p-6 border rounded-lg bg-muted/30",children:[e.jsx("h3",{className:"text-xl font-medium mb-4",children:"Join Our Market Access Programs"}),e.jsx("p",{className:"mb-4",children:"AgriTender Connect offers several programs to help farmers overcome market access challenges:"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs(w,{children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-base",children:"Digital Marketplace"})}),e.jsx(_,{children:e.jsx("p",{className:"text-sm",children:"List your produce on our digital marketplace to connect directly with buyers"})}),e.jsx(me,{children:e.jsx(b,{variant:"outline",size:"sm",className:"w-full",onClick:()=>l("/commodity-trading/marketplace"),children:"Access Marketplace"})})]}),e.jsxs(w,{children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-base",children:"Barter Exchange"})}),e.jsx(_,{children:e.jsx("p",{className:"text-sm",children:"Exchange your produce with other farmers or for services you need"})}),e.jsx(me,{children:e.jsx(b,{variant:"outline",size:"sm",className:"w-full",onClick:()=>l("/commodity-trading/barter"),children:"Join Barter Network"})})]}),e.jsxs(w,{children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-base",children:"Market Intelligence"})}),e.jsx(_,{children:e.jsx("p",{className:"text-sm",children:"Access real-time price trends and market demand forecasts"})}),e.jsx(me,{children:e.jsx(b,{variant:"outline",size:"sm",className:"w-full",onClick:()=>l("/commodity-trading/price-trends"),children:"View Market Data"})})]})]}),e.jsxs(b,{className:"w-full",onClick:()=>l("/commodity-trading"),children:["Explore All Market Access Services ",e.jsx(xs,{className:"ml-2 h-4 w-4"})]})]})]})]})})]})]})]})},Tm=()=>e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),e.jsxs("main",{className:"py-12 px-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-10",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-4",children:"Post-Harvest Losses"}),e.jsx("p",{className:"text-muted-foreground max-w-3xl",children:"In Kenya, post-harvest losses account for up to 30-40% of harvested crops due to inadequate storage, transportation issues, and limited processing facilities. Our platform provides solutions to reduce these losses."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-10",children:[e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Storage Solutions"}),e.jsx(G,{children:"Improved storage techniques and facilities"})]}),e.jsxs(_,{children:[e.jsx("p",{className:"mb-4",children:"Access affordable storage solutions like hermetic bags, metal silos, and community cold storage facilities that can extend the shelf life of your produce."}),e.jsx(b,{asChild:!0,children:e.jsx(X,{to:"/supply-chain-api",children:"Find Storage Providers"})})]})]}),e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Preservation Methods"}),e.jsx(G,{children:"Value addition through processing"})]}),e.jsxs(_,{children:[e.jsx("p",{className:"mb-4",children:"Learn about low-cost preservation methods such as solar drying, fermenting, and canning that can transform perishable produce into items with longer shelf life."}),e.jsx(b,{asChild:!0,children:e.jsx(X,{to:"/supply-chain-problems/quality-control",children:"Explore Preservation Techniques"})})]})]}),e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Market Linkages"}),e.jsx(G,{children:"Faster routes to market"})]}),e.jsxs(_,{children:[e.jsx("p",{className:"mb-4",children:"Connect directly with buyers to reduce the time between harvest and sale, minimizing the risk of spoilage during extended storage periods."}),e.jsx(b,{asChild:!0,children:e.jsx(X,{to:"/commodity-trading",children:"Connect with Buyers"})})]})]})]}),e.jsxs("div",{className:"bg-muted/30 p-6 rounded-lg mb-10",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Post-Harvest Loss Statistics in Kenya"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-background p-6 rounded-lg text-center",children:[e.jsx("div",{className:"text-4xl font-bold text-primary mb-2",children:"30-40%"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Overall post-harvest losses"})]}),e.jsxs("div",{className:"bg-background p-6 rounded-lg text-center",children:[e.jsx("div",{className:"text-4xl font-bold text-primary mb-2",children:"50%"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Fruits & vegetables losses"})]}),e.jsxs("div",{className:"bg-background p-6 rounded-lg text-center",children:[e.jsx("div",{className:"text-4xl font-bold text-primary mb-2",children:"$500M"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Annual economic impact"})]})]})]}),e.jsxs(w,{className:"mb-10",children:[e.jsxs(q,{children:[e.jsx(L,{children:"Quality Control & Contract Farming"}),e.jsx(G,{children:"Improving quality and reliability through partnerships"})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"border p-4 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-lg mb-2",children:"Organic Certification"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Organic certification through KEBS or international bodies helps farmers access premium markets and improve product value while reducing chemical inputs."}),e.jsx(b,{variant:"outline",asChild:!0,className:"w-full",children:e.jsx(X,{to:"/supply-chain-problems/quality-control",children:"Learn About Certification"})})]}),e.jsxs("div",{className:"border p-4 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-lg mb-2",children:"Contract Farming"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Partner with buyers from planting to harvest, receiving quality inputs, technical support, and guaranteed markets while meeting specific standards."}),e.jsx(b,{variant:"outline",asChild:!0,className:"w-full",children:e.jsx(X,{to:"/supply-chain-problems/market-access",children:"Find Contract Partners"})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border-b pb-4",children:[e.jsx("h3",{className:"font-medium mb-1",children:"Meru Potato Farmers Cooperative"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Reduced losses from 35% to 8% through community cold storage"}),e.jsx(b,{variant:"link",className:"px-0",asChild:!0,children:e.jsx(X,{to:"/supply-chain-api",children:"Read More"})})]}),e.jsxs("div",{className:"border-b pb-4",children:[e.jsx("h3",{className:"font-medium mb-1",children:"Kitui Mango Processors"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Transformed excess mangoes into dried products and juices"}),e.jsx(b,{variant:"link",className:"px-0",asChild:!0,children:e.jsx(X,{to:"/supply-chain-problems/quality-control",children:"Read More"})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-1",children:"Nakuru Grain Farmers"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Adopted hermetic bags to prevent pest damage during storage"}),e.jsx(b,{variant:"link",className:"px-0",asChild:!0,children:e.jsx(X,{to:"/supply-chain-api",children:"Read More"})})]})]})]})]})]}),e.jsx("footer",{className:"bg-muted/30 py-8 px-6 text-center text-sm text-muted-foreground",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("p",{children:["Â© ",new Date().getFullYear()," Soko-Connect. All rights reserved."]})})})]}),Dm=()=>{const[s,t]=i.useState([]),[a,r]=i.useState(!0),[n,c]=i.useState("overview"),l=Ne();i.useEffect(()=>{(async()=>{r(!0);try{const u=await zt();t(u)}catch(u){console.error("Error fetching Kilimo data:",u)}finally{r(!1)}})()},[]);const x=()=>[{month:"Jan",maize:45,volatility:12,beans:120,potatoes:35},{month:"Feb",maize:52,volatility:18,beans:135,potatoes:42},{month:"Mar",maize:38,volatility:25,beans:110,potatoes:28},{month:"Apr",maize:65,volatility:35,beans:150,potatoes:55},{month:"May",maize:48,volatility:15,beans:125,potatoes:38},{month:"Jun",maize:55,volatility:20,beans:140,potatoes:45}],f=()=>[{name:"Weather Variations",impact:40,color:"#0088FE"},{name:"Market Speculation",impact:25,color:"#00C49F"},{name:"Supply Chain Disruptions",impact:20,color:"#FFBB28"},{name:"Seasonal Demand",impact:15,color:"#FF8042"}],j=[{title:"Unpredictable Income",description:"Farmers cannot predict their income from season to season due to price fluctuations.",impact:"Difficulty in planning investments, inability to secure loans, and reduced quality of life.",solution:"Forward contracts, price stabilization mechanisms, and diversified income sources."},{title:"Market Timing Challenges",description:"Farmers struggle to time their sales optimally due to rapid price changes.",impact:"Selling at suboptimal prices, increased storage costs, and post-harvest losses.",solution:"Real-time market information, storage solutions, and market intelligence systems."},{title:"Investment Planning",description:"High price volatility makes it difficult to plan for farm investments and expansion.",impact:"Delayed modernization, reduced productivity, and missed growth opportunities.",solution:"Risk management tools, crop insurance, and government support programs."},{title:"Credit Access",description:"Volatile income streams make farmers appear risky to financial institutions.",impact:"Limited access to credit, high interest rates, and reliance on informal lending.",solution:"Income smoothing mechanisms, collateral alternatives, and financial literacy programs."}],N=[{title:"Contract Farming",description:"Pre-agreed prices and volumes with buyers to reduce price risk.",benefits:["Guaranteed income","Reduced market risk","Access to inputs and technical support"],implementation:"Partner with processors, exporters, or large retailers for direct contracts."},{title:"Cooperative Marketing",description:"Farmers pool resources to achieve better market power and price negotiation.",benefits:["Collective bargaining power","Shared storage costs","Market information sharing"],implementation:"Form or join existing farmer cooperatives for collective selling."},{title:"Value Addition",description:"Processing raw products to create value-added products with stable demand.",benefits:["Higher profit margins","Reduced perishability","Market differentiation"],implementation:"Invest in simple processing equipment or partner with processors."},{title:"Diversification",description:"Growing multiple crops or combining farming with other income sources.",benefits:["Risk spreading","Stable income streams","Reduced dependency on single commodity"],implementation:"Plan crop rotation and explore complementary income activities."}];return e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),e.jsxs("main",{className:"py-12 px-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-10 text-center",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-4",children:"Price Volatility"}),e.jsx("p",{className:"text-muted-foreground max-w-3xl mx-auto",children:"Understanding and managing agricultural price fluctuations that impact farmer incomes and market stability"})]}),e.jsxs(ge,{value:n,onValueChange:c,className:"w-full",children:[e.jsxs(pe,{className:"w-full grid grid-cols-1 sm:grid-cols-3 gap-2 mb-8",children:[e.jsxs(B,{value:"overview",className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),e.jsx("span",{children:"Price Trends"})]}),e.jsxs(B,{value:"challenges",className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-4 w-4"}),e.jsx("span",{children:"Impact Analysis"})]}),e.jsxs(B,{value:"solutions",className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{children:"Risk Management"})]})]}),e.jsx(V,{value:"overview",children:e.jsxs(w,{className:"mb-8",children:[e.jsxs(q,{children:[e.jsx(L,{children:"Price Volatility Analysis"}),e.jsx(G,{children:"Historical price trends and volatility patterns for major agricultural commodities in Kenya"})]}),e.jsxs(_,{children:[e.jsx(I,{variant:"outline",className:"mb-6 bg-blue-50",children:"Based on Kilimo statistics and market data analysis"}),a?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Price Trends and Volatility (KES/kg)"}),e.jsx(Je,{width:"100%",height:400,children:e.jsxs(ma,{data:x(),children:[e.jsx(Ns,{strokeDasharray:"3 3"}),e.jsx(bs,{dataKey:"month"}),e.jsx(ws,{}),e.jsx(Xe,{}),e.jsx(et,{}),e.jsx(Cs,{type:"monotone",dataKey:"maize",stroke:"#8884d8",strokeWidth:2}),e.jsx(Cs,{type:"monotone",dataKey:"beans",stroke:"#82ca9d",strokeWidth:2}),e.jsx(Cs,{type:"monotone",dataKey:"potatoes",stroke:"#ffc658",strokeWidth:2}),e.jsx(Cs,{type:"monotone",dataKey:"volatility",stroke:"#ff7300",strokeDasharray:"5 5",name:"Volatility Index"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Volatility Causes"}),e.jsx(Je,{width:"100%",height:300,children:e.jsxs(oa,{children:[e.jsx(da,{data:f(),cx:"50%",cy:"50%",labelLine:!1,label:({name:g,percent:u})=>`${g}: ${(u*100).toFixed(0)}%`,outerRadius:100,fill:"#8884d8",dataKey:"impact",children:f().map((g,u)=>e.jsx(Rt,{fill:g.color},`cell-${u}`))}),e.jsx(Xe,{})]})})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Key Statistics"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Average Price Volatility"}),e.jsx(I,{variant:"outline",children:"Â±25%"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Seasonal Price Variation"}),e.jsx(I,{variant:"outline",children:"Â±40%"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Highest Volatility Crop"}),e.jsx(I,{variant:"destructive",children:"Vegetables"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Most Stable Crop"}),e.jsx(I,{variant:"default",children:"Cereals"})]})]})]})]})]})]})]})}),e.jsx(V,{value:"challenges",children:e.jsxs(w,{className:"mb-8",children:[e.jsxs(q,{children:[e.jsx(L,{children:"Impact of Price Volatility"}),e.jsx(G,{children:"How price fluctuations affect farmers and the agricultural sector"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:j.map((g,u)=>e.jsxs(w,{className:"border-l-4 border-l-red-500",children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-lg",children:g.title})}),e.jsxs(_,{className:"space-y-2",children:[e.jsx("p",{children:g.description}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Impact:"})," ",g.impact]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Solutions:"})," ",g.solution]})]})]},u))}),e.jsxs("div",{className:"mt-10 p-4 border rounded-lg bg-muted/30",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Economic Impact of Price Volatility"}),e.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[e.jsx("li",{children:"Smallholder farmers lose an estimated 15-30% of potential income due to poor market timing"}),e.jsx("li",{children:"Price volatility increases the cost of agricultural credit by 2-5 percentage points"}),e.jsx("li",{children:"High volatility discourages investment in productivity-enhancing technologies"}),e.jsx("li",{children:"Food security is threatened as farmers shift to subsistence farming to avoid market risks"})]})]})]}),e.jsx(me,{children:e.jsx(b,{onClick:()=>c("solutions"),className:"ml-auto",children:"Explore Risk Management Solutions"})})]})}),e.jsx(V,{value:"solutions",children:e.jsxs(w,{className:"mb-8",children:[e.jsxs(q,{children:[e.jsx(L,{children:"Price Risk Management Strategies"}),e.jsx(G,{children:"Proven approaches to reduce exposure to price volatility"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:N.map((g,u)=>e.jsxs(w,{children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-lg",children:g.title})}),e.jsxs(_,{className:"space-y-3",children:[e.jsx("p",{className:"text-sm",children:g.description}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-2",children:"Benefits:"}),e.jsx("ul",{className:"list-disc pl-5 text-sm space-y-1",children:g.benefits.map((d,h)=>e.jsx("li",{children:d},h))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-2",children:"Implementation:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:g.implementation})]})]})]},u))}),e.jsxs("div",{className:"mt-10 p-6 border rounded-lg bg-green-50",children:[e.jsx("h3",{className:"text-xl font-medium mb-4",children:"AgriTender Connect Price Risk Tools"}),e.jsx("p",{className:"mb-4",children:"Our platform offers several tools to help farmers manage price volatility:"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs(w,{children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-base",children:"Price Alerts"})}),e.jsx(_,{children:e.jsx("p",{className:"text-sm",children:"Get notified when prices reach your target levels"})}),e.jsx(me,{children:e.jsx(b,{variant:"outline",size:"sm",className:"w-full",onClick:()=>l("/market-information"),children:"Set Price Alerts"})})]}),e.jsxs(w,{children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-base",children:"Forward Contracts"})}),e.jsx(_,{children:e.jsx("p",{className:"text-sm",children:"Lock in prices for future delivery to reduce risk"})}),e.jsx(me,{children:e.jsx(b,{variant:"outline",size:"sm",className:"w-full",onClick:()=>l("/commodity-trading"),children:"Explore Contracts"})})]}),e.jsxs(w,{children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-base",children:"Market Intelligence"})}),e.jsx(_,{children:e.jsx("p",{className:"text-sm",children:"Access forecasts and trend analysis for better timing"})}),e.jsx(me,{children:e.jsx(b,{variant:"outline",size:"sm",className:"w-full",onClick:()=>l("/market-information"),children:"View Forecasts"})})]})]}),e.jsx(b,{className:"w-full",onClick:()=>l("/commodity-trading"),children:"Start Managing Price Risk Today"})]})]})]})})]})]})]})},Em=()=>{const[s,t]=i.useState("standards"),a=Ne(),r=()=>[{crop:"Coffee",grade_a:45,grade_b:35,grade_c:20},{crop:"Tea",grade_a:60,grade_b:30,grade_c:10},{crop:"Maize",grade_a:25,grade_b:50,grade_c:25},{crop:"Beans",grade_a:40,grade_b:40,grade_c:20},{crop:"Potatoes",grade_a:30,grade_b:45,grade_c:25}],n=()=>[{name:"Organic Certified",value:15,color:"#0088FE"},{name:"GAP Certified",value:25,color:"#00C49F"},{name:"Fair Trade",value:10,color:"#FFBB28"},{name:"No Certification",value:50,color:"#FF8042"}],c=[{title:"Kenya Bureau of Standards (KEBS)",description:"National standards for agricultural products including grading, packaging, and labeling requirements.",scope:"Cereals, pulses, fruits, vegetables, and processed foods",benefits:"Market access, consumer confidence, export opportunities",certification_process:"Application â†’ Inspection â†’ Testing â†’ Certification â†’ Annual surveillance"},{title:"GlobalGAP Certification",description:"International standard for good agricultural practices ensuring food safety and sustainability.",scope:"Fresh produce, aquaculture, and livestock",benefits:"Access to export markets, premium pricing, risk reduction",certification_process:"Training â†’ Implementation â†’ Self-assessment â†’ External audit â†’ Certification"},{title:"Organic Certification",description:"Standards for organic production methods without synthetic chemicals and GMOs.",scope:"All agricultural products including crops and livestock",benefits:"Premium pricing (20-40% higher), niche market access, environmental benefits",certification_process:"Transition period (3 years) â†’ Application â†’ Inspection â†’ Certification â†’ Annual renewal"},{title:"Fair Trade Certification",description:"Social and economic standards ensuring fair prices and working conditions for farmers.",scope:"Coffee, tea, cocoa, bananas, sugar, and other export crops",benefits:"Guaranteed minimum price, social premium, market stability",certification_process:"Group formation â†’ Training â†’ Implementation â†’ Audit â†’ Certification"}],l=[{title:"Lack of Standardization",description:"Inconsistent quality metrics and grading systems across different markets and buyers.",impact:"Price disputes, market rejection, reduced competitiveness",solution:"Adoption of standardized grading systems and quality measurement tools"},{title:"Limited Testing Facilities",description:"Few accessible laboratories for quality testing and certification in rural areas.",impact:"Inability to verify quality claims, limited certification opportunities",solution:"Mobile testing units, decentralized testing centers, and rapid testing kits"},{title:"Poor Post-Harvest Handling",description:"Inadequate storage, processing, and transportation practices affecting product quality.",impact:"Quality degradation, shorter shelf life, reduced market value",solution:"Training on best practices, improved infrastructure, and technology adoption"},{title:"Cost of Certification",description:"High certification costs and complex procedures limiting smallholder farmer participation.",impact:"Exclusion from premium markets, continued dependence on commodity pricing",solution:"Group certification, subsidized programs, and simplified procedures for smallholders"}],x=[{title:"Farmer Field Schools",description:"Hands-on training programs teaching quality production and post-harvest practices.",target:"Smallholder farmers and farmer groups",delivery:"Weekly sessions over full crop cycle",topics:["Good Agricultural Practices","Pest and Disease Management","Harvest Timing","Post-Harvest Handling"]},{title:"Quality Management Systems",description:"Implementation of systematic approaches to quality control and documentation.",target:"Farmer cooperatives and agribusinesses",delivery:"Consultancy and training workshops",topics:["HACCP Implementation","Traceability Systems","Record Keeping","Continuous Improvement"]},{title:"Technology Adoption Support",description:"Assistance in adopting quality-enhancing technologies and equipment.",target:"Progressive farmers and cooperatives",delivery:"Demonstrations, subsidies, and technical support",topics:["Quality Testing Equipment","Sorting and Grading Machines","Storage Technologies","Processing Equipment"]},{title:"Market Linkage Programs",description:"Connecting quality-conscious farmers with premium market opportunities.",target:"Certified farmers and high-quality producers",delivery:"B2B platforms and trade facilitation",topics:["Buyer Identification","Contract Negotiation","Quality Agreements","Payment Guarantees"]}];return e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),e.jsxs("main",{className:"py-12 px-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-10 text-center",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-4",children:"Quality Control"}),e.jsx("p",{className:"text-muted-foreground max-w-3xl mx-auto",children:"Implementing quality standards and certification systems to access premium markets and improve farmer incomes"})]}),e.jsxs(ge,{value:s,onValueChange:t,className:"w-full",children:[e.jsxs(pe,{className:"w-full grid grid-cols-1 sm:grid-cols-4 gap-2 mb-8",children:[e.jsxs(B,{value:"standards",className:"flex items-center gap-2",children:[e.jsx(Ps,{className:"h-4 w-4"}),e.jsx("span",{children:"Standards"})]}),e.jsxs(B,{value:"challenges",className:"flex items-center gap-2",children:[e.jsx(pt,{className:"h-4 w-4"}),e.jsx("span",{children:"Challenges"})]}),e.jsxs(B,{value:"programs",className:"flex items-center gap-2",children:[e.jsx(Vi,{className:"h-4 w-4"}),e.jsx("span",{children:"Programs"})]}),e.jsxs(B,{value:"impact",className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),e.jsx("span",{children:"Impact"})]})]}),e.jsx(V,{value:"standards",children:e.jsxs(w,{className:"mb-8",children:[e.jsxs(q,{children:[e.jsx(L,{children:"Quality Standards and Certification"}),e.jsx(G,{children:"Overview of major quality standards and certification systems for Kenyan agriculture"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"grid grid-cols-1 gap-6",children:c.map((f,j)=>e.jsxs(w,{className:"border-l-4 border-l-green-500",children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-lg",children:f.title})}),e.jsxs(_,{className:"space-y-3",children:[e.jsx("p",{children:f.description}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Scope:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:f.scope})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Benefits:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:f.benefits})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Certification Process:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:f.certification_process})]})]})]},j))}),e.jsxs("div",{className:"mt-10 p-6 border rounded-lg bg-blue-50",children:[e.jsx("h3",{className:"text-xl font-medium mb-4",children:"Benefits of Quality Certification"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:"20-40%"}),e.jsx("div",{className:"text-sm",children:"Price Premium"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:"60%"}),e.jsx("div",{className:"text-sm",children:"Market Access Improvement"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:"80%"}),e.jsx("div",{className:"text-sm",children:"Customer Satisfaction"})]})]})]})]})]})}),e.jsx(V,{value:"challenges",children:e.jsxs(w,{className:"mb-8",children:[e.jsxs(q,{children:[e.jsx(L,{children:"Quality Control Challenges"}),e.jsx(G,{children:"Common barriers to implementing effective quality control in agricultural value chains"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:l.map((f,j)=>e.jsxs(w,{className:"border-l-4 border-l-red-500",children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-lg",children:f.title})}),e.jsxs(_,{className:"space-y-2",children:[e.jsx("p",{children:f.description}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Impact:"})," ",f.impact]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Solution:"})," ",f.solution]})]})]},j))}),e.jsxs("div",{className:"mt-10",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Current Quality Distribution"}),e.jsx(Je,{width:"100%",height:400,children:e.jsxs(yt,{data:r(),children:[e.jsx(Ns,{strokeDasharray:"3 3"}),e.jsx(bs,{dataKey:"crop"}),e.jsx(ws,{}),e.jsx(Xe,{}),e.jsx(et,{}),e.jsx(us,{dataKey:"grade_a",stackId:"a",fill:"#22c55e",name:"Grade A (Premium)"}),e.jsx(us,{dataKey:"grade_b",stackId:"a",fill:"#eab308",name:"Grade B (Standard)"}),e.jsx(us,{dataKey:"grade_c",stackId:"a",fill:"#ef4444",name:"Grade C (Below Standard)"})]})})]})]})]})}),e.jsx(V,{value:"programs",children:e.jsxs(w,{className:"mb-8",children:[e.jsxs(q,{children:[e.jsx(L,{children:"Quality Improvement Programs"}),e.jsx(G,{children:"Training and support programs to help farmers meet quality standards"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:x.map((f,j)=>e.jsxs(w,{children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-lg",children:f.title})}),e.jsxs(_,{className:"space-y-3",children:[e.jsx("p",{className:"text-sm",children:f.description}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-sm",children:"Target:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:f.target})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-sm",children:"Delivery:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:f.delivery})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-sm",children:"Key Topics:"}),e.jsx("ul",{className:"list-disc pl-5 text-sm space-y-1 mt-2",children:f.topics.map((N,g)=>e.jsx("li",{children:N},g))})]})]})]},j))}),e.jsxs("div",{className:"mt-10 p-6 border rounded-lg bg-green-50",children:[e.jsx("h3",{className:"text-xl font-medium mb-4",children:"Join Our Quality Improvement Programs"}),e.jsx("p",{className:"mb-4",children:"AgriTender Connect partners with certification bodies and training organizations to offer:"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs(w,{children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-base",children:"Training Workshops"})}),e.jsx(_,{children:e.jsx("p",{className:"text-sm",children:"Regular training on quality standards and best practices"})}),e.jsx(me,{children:e.jsx(b,{variant:"outline",size:"sm",className:"w-full",onClick:()=>a("/service-providers"),children:"Find Training"})})]}),e.jsxs(w,{children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-base",children:"Certification Support"})}),e.jsx(_,{children:e.jsx("p",{className:"text-sm",children:"Guidance and support through certification processes"})}),e.jsx(me,{children:e.jsx(b,{variant:"outline",size:"sm",className:"w-full",onClick:()=>a("/service-providers"),children:"Get Support"})})]})]})]})]})]})}),e.jsx(V,{value:"impact",children:e.jsxs(w,{className:"mb-8",children:[e.jsxs(q,{children:[e.jsx(L,{children:"Impact of Quality Improvements"}),e.jsx(G,{children:"Measuring the benefits of quality control and certification programs"})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-10",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Certification Status in Kenya"}),e.jsx(Je,{width:"100%",height:300,children:e.jsxs(oa,{children:[e.jsx(da,{data:n(),cx:"50%",cy:"50%",labelLine:!1,label:({name:f,percent:j})=>`${f}: ${(j*100).toFixed(0)}%`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:n().map((f,j)=>e.jsx(Rt,{fill:f.color},`cell-${j}`))}),e.jsx(Xe,{})]})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Success Story: Nyeri Coffee Cooperative"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Implemented quality management systems and achieved specialty coffee certification"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Price Increase:"}),e.jsx(I,{variant:"default",children:"+45%"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Rejection Rate:"}),e.jsx(I,{variant:"destructive",children:"-60%"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Export Markets:"}),e.jsx(I,{variant:"default",children:"+3"})]})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Success Story: Meru Organic Farmers"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Transitioned to organic farming and achieved organic certification"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Premium Pricing:"}),e.jsx(I,{variant:"default",children:"+30%"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Input Costs:"}),e.jsx(I,{variant:"destructive",children:"-25%"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Soil Health:"}),e.jsx(I,{variant:"default",children:"Improved"})]})]})]})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg bg-muted/30",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Measurable Impact of Quality Programs"}),e.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[e.jsx("li",{children:"Farmers with certification earn 20-40% higher prices compared to non-certified farmers"}),e.jsx("li",{children:"Quality-focused cooperatives reduce post-harvest losses by up to 50%"}),e.jsx("li",{children:"Certified farms have 30% lower rejection rates from buyers"}),e.jsx("li",{children:"Quality improvement programs increase farmer income by an average of 35%"}),e.jsx("li",{children:"Export opportunities increase by 60% for certified producers"})]})]})]}),e.jsx(me,{children:e.jsx(b,{onClick:()=>a("/commodity-trading"),className:"ml-auto",children:"Start Your Quality Journey"})})]})})]})]})]})},Fm=()=>e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-2 mt-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-md",children:[e.jsx(ye,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{className:"text-sm",children:"Transport"})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-md",children:[e.jsx(Ts,{className:"h-5 w-5 text-green-500"}),e.jsx("span",{className:"text-sm",children:"Storage"})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-md",children:[e.jsx(Zs,{className:"h-5 w-5 text-purple-500"}),e.jsx("span",{className:"text-sm",children:"Training"})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-md",children:[e.jsx(Ge,{className:"h-5 w-5 text-amber-500"}),e.jsx("span",{className:"text-sm",children:"Input Supply"})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-md",children:[e.jsx(Et,{className:"h-5 w-5 text-red-500"}),e.jsx("span",{className:"text-sm",children:"Quality Control"})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-md",children:[e.jsx(ee,{className:"h-5 w-5 text-teal-500"}),e.jsx("span",{className:"text-sm",children:"Market Linkage"})]})]}),qm=({selectedType:s,setSelectedType:t,selectedCounty:a,setSelectedCounty:r,searchTerm:n,setSearchTerm:c,filteredProvidersCount:l})=>{const x=[{value:"all",label:"All Providers",icon:ee},{value:"transport",label:"Transport Services",icon:ye},{value:"storage",label:"Storage Facilities",icon:Ts},{value:"quality-control",label:"Quality Control",icon:Et},{value:"training",label:"Training Providers",icon:Zs},{value:"input-supplier",label:"Input Suppliers",icon:Ge},{value:"inspector",label:"Inspectors",icon:Et},{value:"market-linkage",label:"Market Linkage",icon:ee}],f=[{value:"all",label:"All Counties"},{value:"nairobi",label:"Nairobi"},{value:"mombasa",label:"Mombasa"},{value:"kisumu",label:"Kisumu"},{value:"nakuru",label:"Nakuru"},{value:"kiambu",label:"Kiambu"},{value:"meru",label:"Meru"},{value:"kakamega",label:"Kakamega"},{value:"nyeri",label:"Nyeri"},{value:"machakos",label:"Machakos"},{value:"uasin-gishu",label:"Uasin Gishu"},{value:"kilifi",label:"Kilifi"}];return e.jsxs(w,{className:"mb-6",children:[e.jsxs(q,{children:[e.jsx(L,{children:"Find Service Providers"}),e.jsx(G,{children:"Filter by service type, location, or search by name"})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Type of Service"}),e.jsxs(Q,{value:s,onValueChange:j=>t(j),children:[e.jsx(W,{children:e.jsx(J,{placeholder:"Select service type"})}),e.jsx(Y,{children:x.map(j=>e.jsx(T,{value:j.value,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j.icon,{className:"h-4 w-4"}),e.jsx("span",{children:j.label})]})},j.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"County"}),e.jsxs(Q,{value:a,onValueChange:r,children:[e.jsx(W,{children:e.jsx(J,{placeholder:"Select county"})}),e.jsx(Y,{children:f.map(j=>e.jsx(T,{value:j.value,children:j.label},j.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Search"}),e.jsx(D,{placeholder:"Search by name or service",value:n,onChange:j=>c(j.target.value)})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(De,{id:"verified"}),e.jsx("label",{htmlFor:"verified",className:"text-sm",children:"Show verified providers only"})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",l," providers"]})]})]})]})},Lm=Ql,Mm=Jl,Im=Xl,Mn=i.forwardRef(({className:s,sideOffset:t=4,...a},r)=>e.jsx($i,{ref:r,sideOffset:t,className:$("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a}));Mn.displayName=$i.displayName;const Rm=({providers:s,isLoading:t,resetFilters:a})=>{const r=[{value:"all",label:"All Providers",icon:ee},{value:"transport",label:"Transport Services",icon:ye},{value:"storage",label:"Storage Facilities",icon:Ts},{value:"quality-control",label:"Quality Control",icon:Et},{value:"training",label:"Training Providers",icon:Zs},{value:"input-supplier",label:"Input Suppliers",icon:Ge},{value:"inspector",label:"Inspectors",icon:Et},{value:"market-linkage",label:"Market Linkage",icon:ee}];return t?e.jsx("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array(6).fill(0).map((n,c)=>e.jsxs(w,{className:"animate-pulse",children:[e.jsx(q,{className:"h-32 bg-muted"}),e.jsxs(_,{className:"pt-4",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-3/4 mb-4"}),e.jsx("div",{className:"h-3 bg-muted rounded w-full mb-2"}),e.jsx("div",{className:"h-3 bg-muted rounded w-5/6 mb-2"}),e.jsx("div",{className:"h-3 bg-muted rounded w-4/6"})]})]},c))}):s.length===0?e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx(Zt,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No providers found"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Try adjusting your search or filters"}),e.jsx(b,{onClick:a,children:"Reset Filters"})]}):e.jsx("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.slice(0,9).map(n=>{const c=r.find(x=>x.value===n.businessType)||r[0],l=c.icon;return e.jsxs(w,{className:"overflow-hidden",children:[e.jsx("div",{className:`h-2 w-full ${n.businessType==="transport"?"bg-blue-500":n.businessType==="storage"?"bg-green-500":n.businessType==="training"?"bg-purple-500":n.businessType==="quality-control"?"bg-red-500":n.businessType==="input-supplier"?"bg-amber-500":"bg-teal-500"}`}),e.jsx(q,{className:"pb-2",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs(L,{className:"text-lg flex items-center gap-2",children:[e.jsx(l,{className:"h-5 w-5 text-muted-foreground"}),n.name]}),e.jsx(G,{children:c.label})]}),n.verified&&e.jsx(Lm,{children:e.jsxs(Mm,{children:[e.jsx(Im,{children:e.jsx(I,{variant:"secondary",children:"Verified"})}),e.jsx(Mn,{children:e.jsx("p",{children:"This provider has been verified by our team"})})]})})]})}),e.jsxs(_,{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(ee,{className:"h-4 w-4 mr-1 text-muted-foreground"}),e.jsxs("span",{children:[n.location.county,", ",n.location.specificLocation]})]}),e.jsx("p",{className:"line-clamp-2 text-sm text-muted-foreground",children:n.description}),e.jsxs("div",{className:"flex flex-wrap gap-1 pt-2",children:[n.tags.slice(0,3).map(x=>e.jsx(I,{variant:"outline",className:"text-xs",children:x},x)),n.tags.length>3&&e.jsxs(I,{variant:"outline",className:"text-xs",children:["+",n.tags.length-3," more"]})]})]}),e.jsx(me,{className:"flex justify-end pt-0",children:e.jsx(b,{variant:"outline",size:"sm",children:"View Details"})})]},n.id)})})},zm=()=>e.jsxs(w,{className:"mt-10",children:[e.jsxs(q,{children:[e.jsx(L,{children:"Join Our Agricultural Service Network"}),e.jsx(G,{children:"Help strengthen Kenya's agricultural ecosystem by registering your services on our platform."})]}),e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ye,{className:"h-5 w-5 text-blue-500"}),e.jsx("h3",{className:"font-medium",children:"Transport Providers"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Connect with farmers needing reliable transportation for their produce"})]}),e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ts,{className:"h-5 w-5 text-green-500"}),e.jsx("h3",{className:"font-medium",children:"Storage Facilities"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Offer your warehousing and cold storage solutions to reduce post-harvest losses"})]}),e.jsxs("div",{className:"p-4 bg-amber-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Zl,{className:"h-5 w-5 text-amber-500"}),e.jsx("h3",{className:"font-medium",children:"Training & Services"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"List your agricultural training, quality control, or market linkage services"})]})]})}),e.jsxs(me,{className:"flex flex-col sm:flex-row justify-center gap-4 pb-6",children:[e.jsx(b,{className:"w-full sm:w-auto",variant:"default",onClick:()=>window.location.href="/service-provider-registration",children:"Register as Service Provider"}),e.jsx(b,{className:"w-full sm:w-auto",variant:"outline",onClick:()=>window.location.href="/transporter-signup",children:"Register as Transporter"})]})]}),Om=i.lazy(()=>Ya(()=>import("./ServiceProvidersMap-CoSrXA27.js"),__vite__mapDeps([0,1,2])));class Km extends Bs.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,a){console.error("Map Error:",t,a)}render(){return this.state.hasError?e.jsx("div",{className:"w-full h-[400px] rounded-lg border bg-muted flex items-center justify-center",children:e.jsxs("div",{className:"text-center p-6",children:[e.jsx("p",{className:"text-muted-foreground mb-2",children:"Unable to load map"}),e.jsx(b,{variant:"outline",onClick:()=>this.setState({hasError:!1}),children:"Try Again"})]})}):this.props.children}}const Bm=()=>{const{toast:s}=Z(),[t,a]=i.useState(!0),[r,n]=i.useState([]),[c,l]=i.useState([]),[x,f]=i.useState("all"),[j,N]=i.useState("all"),[g,u]=i.useState("");i.useEffect(()=>{(async()=>{try{a(!0);const v=await Fn();n(v),l(v)}catch(v){console.error("Error fetching providers:",v),s({title:"Error",description:"Failed to load service providers. Please try again.",variant:"destructive"})}finally{a(!1)}})()},[s]),i.useEffect(()=>{let h=[...r];if(x!=="all"&&(h=h.filter(v=>v.businessType===x)),j!=="all"&&(h=h.filter(v=>v.location.county.toLowerCase()===j.toLowerCase())),g){const v=g.toLowerCase();h=h.filter(p=>p.name.toLowerCase().includes(v)||p.description.toLowerCase().includes(v)||p.services.some(m=>m.toLowerCase().includes(v))||p.tags.some(m=>m.toLowerCase().includes(v)))}l(h)},[r,x,j,g]);const d=()=>{f("all"),N("all"),u("")};return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx("header",{className:"sticky top-0 z-30 w-full border-b bg-background",children:e.jsxs("div",{className:"container flex h-16 items-center",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx($e,{})}),e.jsx("div",{className:"md:hidden",children:e.jsx(ss,{})})]})}),e.jsxs("main",{className:"flex-1 container py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Logistics Solutions Map"}),e.jsx("p",{className:"text-muted-foreground",children:"Find service providers near you on the interactive map"})]}),e.jsx(qm,{selectedType:x,setSelectedType:f,selectedCounty:j,setSelectedCounty:N,searchTerm:g,setSearchTerm:u,filteredProvidersCount:c.length}),e.jsx(Fm,{}),e.jsx(Km,{children:e.jsx(i.Suspense,{fallback:e.jsx("div",{className:"w-full h-[500px] rounded-lg border bg-muted flex items-center justify-center",children:e.jsx(As,{className:"h-8 w-8 animate-spin text-muted-foreground"})}),children:e.jsx(Om,{providers:c,selectedType:x})})}),e.jsx(Rm,{providers:c,isLoading:t,resetFilters:d}),!t&&c.length>9&&e.jsx("div",{className:"mt-6 text-center",children:e.jsxs(b,{variant:"outline",children:["Show More (",c.length-9," remaining)"]})}),e.jsx(zm,{})]})]})},Rr=[{id:"1",crop:"Tomatoes",location:"Wakulima Market",county:"Nairobi",demandLevel:"high",pricePerKg:120,buyerCount:15,description:"High demand for fresh tomatoes with consistent supply for restaurants and hotels",lastUpdated:new Date("2025-04-22")},{id:"2",crop:"Potatoes",location:"Nakuru Main Market",county:"Nakuru",demandLevel:"high",pricePerKg:45,buyerCount:12,description:"Wholesale buyers looking for bulk potato supply for distribution to retail outlets",lastUpdated:new Date("2025-04-23")},{id:"3",crop:"Maize",location:"Eldoret Grain Market",county:"Uasin Gishu",demandLevel:"medium",pricePerKg:35,buyerCount:8,description:"Millers seeking quality maize with moisture content below 13%",lastUpdated:new Date("2025-04-21")},{id:"4",crop:"Mangoes",location:"Mombasa Fruit Market",county:"Mombasa",demandLevel:"high",pricePerKg:90,buyerCount:10,description:"Export buyers seeking apple and ngowe mango varieties for international markets",lastUpdated:new Date("2025-04-20")},{id:"5",crop:"Avocados",location:"Thika Market",county:"Kiambu",demandLevel:"high",pricePerKg:150,buyerCount:7,description:"Processing companies looking for hass avocados for oil extraction and export",lastUpdated:new Date("2025-04-22")}],Um=()=>{const[s,t]=i.useState("all"),[a,r]=i.useState("all"),[n,c]=i.useState(Rr);return i.useEffect(()=>{document.title="Market Demand Hotspots | Kilimo Connect";let l=[...Rr];s&&s!=="all"&&(l=l.filter(x=>x.crop.toLowerCase().includes(s.toLowerCase()))),a&&a!=="all"&&(l=l.filter(x=>x.county.toLowerCase().includes(a.toLowerCase()))),c(l)},[s,a]),e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx("header",{className:"sticky top-0 z-30 w-full border-b bg-background",children:e.jsx("div",{className:"container flex h-16 items-center",children:e.jsx($e,{})})}),e.jsxs("main",{className:"flex-1 container py-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Market Demand Hotspots"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Discover where buyers are actively looking for specific crops and connect directly with them"})]}),e.jsxs("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"crop",className:"block text-sm font-medium mb-1",children:"Crop"}),e.jsxs(Q,{value:s,onValueChange:t,children:[e.jsx(W,{id:"crop",children:e.jsx(J,{placeholder:"All Crops"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Crops"}),e.jsx(T,{value:"tomatoes",children:"Tomatoes"}),e.jsx(T,{value:"potatoes",children:"Potatoes"}),e.jsx(T,{value:"maize",children:"Maize"}),e.jsx(T,{value:"mangoes",children:"Mangoes"}),e.jsx(T,{value:"avocados",children:"Avocados"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"county",className:"block text-sm font-medium mb-1",children:"County"}),e.jsxs(Q,{value:a,onValueChange:r,children:[e.jsx(W,{id:"county",children:e.jsx(J,{placeholder:"All Counties"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Counties"}),e.jsx(T,{value:"nairobi",children:"Nairobi"}),e.jsx(T,{value:"nakuru",children:"Nakuru"}),e.jsx(T,{value:"uasin gishu",children:"Uasin Gishu"}),e.jsx(T,{value:"mombasa",children:"Mombasa"}),e.jsx(T,{value:"kiambu",children:"Kiambu"})]})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(b,{variant:"outline",className:"w-full",onClick:()=>{t("all"),r("all")},children:"Clear Filters"})})]}),e.jsxs("div",{className:"relative h-[300px] w-full border rounded-md bg-muted/20 flex items-center justify-center mb-6",children:[e.jsx("p",{className:"text-muted-foreground",children:"Market Demand Heatmap Visualization"}),n.map(l=>e.jsx("div",{className:`absolute w-4 h-4 rounded-full flex items-center justify-center
                ${l.demandLevel==="high"?"bg-red-500":l.demandLevel==="medium"?"bg-orange-400":"bg-yellow-300"}`,style:{top:`${Math.random()*70+15}%`,left:`${Math.random()*70+15}%`},title:`${l.crop} demand in ${l.location}, ${l.county}`,children:e.jsx(ee,{className:"h-3 w-3 text-white"})},l.id))]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[n.map(l=>e.jsxs(w,{className:l.demandLevel==="high"?"border-red-200 bg-red-50":l.demandLevel==="medium"?"border-orange-200 bg-orange-50":"border-yellow-200 bg-yellow-50",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(L,{children:l.crop}),e.jsxs(G,{children:[l.location,", ",l.county]})]}),e.jsxs("div",{className:`rounded-full px-2 py-1 text-xs font-medium 
                    ${l.demandLevel==="high"?"bg-red-100 text-red-800":l.demandLevel==="medium"?"bg-orange-100 text-orange-800":"bg-yellow-100 text-yellow-800"}`,children:[l.demandLevel.charAt(0).toUpperCase()+l.demandLevel.slice(1)," Demand"]})]})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Current Price"}),e.jsxs("span",{className:"font-medium",children:["KSh ",l.pricePerKg,"/kg"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Active Buyers"}),e.jsx("span",{className:"font-medium",children:l.buyerCount})]}),e.jsx("p",{className:"text-sm mt-2",children:l.description})]})}),e.jsxs(me,{className:"flex justify-between",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Updated: ",l.lastUpdated.toLocaleDateString()]}),e.jsx(b,{size:"sm",children:"Connect with Buyers"})]})]},l.id)),n.length===0&&e.jsxs("div",{className:"col-span-full text-center p-12",children:[e.jsx("div",{className:"mb-4 text-muted-foreground",children:e.jsx(ce,{className:"mx-auto h-12 w-12 opacity-50"})}),e.jsx("h3",{className:"text-lg font-medium",children:"No demand hotspots found"}),e.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"Try changing your filter criteria or check back later for new demand opportunities."})]})]})]})]})},Vm=({isLoading:s,filteredProduce:t})=>{const{toast:a}=Z(),[r,n]=i.useState({}),c=async(l,x,f,j,N)=>{try{n(g=>({...g,[f]:!0})),await nt(1e3),a({title:"Order Placed Successfully",description:`${l==="buy"?"Buy":"Sell"} order placed for ${j} ${x} at KES ${N} per unit`})}catch(g){console.error("Error placing order:",g),a({title:"Order Failed",description:"Could not place your order. Please try again.",variant:"destructive"})}finally{n(g=>({...g,[f]:!1}))}};return s?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):t.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{children:"No commodities found. Try a different search or filter."})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ls,{children:[e.jsx(Ms,{children:e.jsxs(Oe,{children:[e.jsx(oe,{children:"Commodity"}),e.jsx(oe,{children:"Category"}),e.jsx(oe,{children:"Quantity"}),e.jsx(oe,{children:"Quality"}),e.jsx(oe,{children:"Available From"}),e.jsx(oe,{children:"County"}),e.jsx(oe,{children:"Seller"}),e.jsx(oe,{children:"Actions"})]})}),e.jsx(Is,{children:t.map(l=>{const x=Math.floor(Math.random()*100)+50;return e.jsxs(Oe,{children:[e.jsx(de,{className:"font-medium",children:l.name}),e.jsx(de,{children:l.category}),e.jsxs(de,{children:[l.quantity," ",l.unit]}),e.jsx(de,{children:l.qualityGrade}),e.jsx(de,{children:l.availableFrom}),e.jsx(de,{children:l.county}),e.jsx(de,{children:l.farmer}),e.jsx(de,{children:e.jsx(b,{size:"sm",onClick:()=>c("buy",l.name,l.id,l.quantity,x),disabled:r[l.id],children:r[l.id]?"Processing...":"Buy"})})]},l.id)})})]})})},$m=({isLoading:s,searchTerm:t})=>{const[a,r]=i.useState([{id:1,type:"buy",commodity:"Maize",quantity:1e3,price:42,buyer:"Nairobi Mills"},{id:2,type:"sell",commodity:"Maize",quantity:500,price:45,seller:"John Kamau"},{id:3,type:"buy",commodity:"Coffee",quantity:300,price:340,buyer:"Kenya Coffee Exporters"},{id:4,type:"sell",commodity:"Coffee",quantity:200,price:350,seller:"Mary Wanjiku"},{id:5,type:"buy",commodity:"Tea",quantity:400,price:270,buyer:"Global Tea Traders"},{id:6,type:"sell",commodity:"Tea",quantity:300,price:280,seller:"Sarah Muthoni"}]),n=a.filter(l=>t===""||l.commodity.toLowerCase().includes(t.toLowerCase())),c=async(l,x,f,j)=>{try{await nt(1e3);const N={id:a.length+1,type:l,commodity:x,quantity:f,price:j,buyer:l==="buy"?"Your Company":"",seller:l==="sell"?"Your Company":""};r([...a,N]),alert(`${l==="buy"?"Buy":"Sell"} order placed successfully for ${f} ${x} at KES ${j} per unit`)}catch(N){console.error("Error placing order:",N)}};return s?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):e.jsxs(e.Fragment,{children:[n.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ls,{children:[e.jsx(Ms,{children:e.jsxs(Oe,{children:[e.jsx(oe,{children:"Type"}),e.jsx(oe,{children:"Commodity"}),e.jsx(oe,{children:"Quantity"}),e.jsx(oe,{children:"Price (KES)"}),e.jsx(oe,{children:"Buyer/Seller"}),e.jsx(oe,{children:"Actions"})]})}),e.jsx(Is,{children:n.map(l=>e.jsxs(Oe,{children:[e.jsx(de,{children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${l.type==="buy"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:l.type==="buy"?"Buy":"Sell"})}),e.jsx(de,{className:"font-medium",children:l.commodity}),e.jsx(de,{children:l.quantity}),e.jsx(de,{children:l.price}),e.jsx(de,{children:l.type==="buy"?l.buyer:l.seller}),e.jsx(de,{children:e.jsx(b,{size:"sm",variant:l.type==="buy"?"outline":"default",onClick:()=>c(l.type==="buy"?"sell":"buy",l.commodity,l.quantity,l.price),children:l.type==="buy"?"Sell to":"Buy from"})})]},l.id))})]})}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{children:"No active orders found. Try a different search or place a new order."})}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Place New Order"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{className:"text-green-600",children:"Buy Order"})}),e.jsx(_,{children:e.jsxs("form",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"buy-commodity",children:"Commodity"}),e.jsxs(Q,{defaultValue:"Maize",children:[e.jsx(W,{id:"buy-commodity",children:e.jsx(J,{placeholder:"Select commodity"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"Maize",children:"Maize"}),e.jsx(T,{value:"Coffee",children:"Coffee"}),e.jsx(T,{value:"Tea",children:"Tea"}),e.jsx(T,{value:"Beans",children:"Beans"})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"buy-quantity",children:"Quantity (kg)"}),e.jsx(D,{id:"buy-quantity",type:"number",min:"1",defaultValue:"100"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"buy-price",children:"Price per kg (KES)"}),e.jsx(D,{id:"buy-price",type:"number",min:"1",defaultValue:"45"})]}),e.jsx(b,{type:"button",className:"w-full bg-green-600 hover:bg-green-700",onClick:()=>c("buy","Maize",100,45),children:"Place Buy Order"})]})})]}),e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{className:"text-blue-600",children:"Sell Order"})}),e.jsx(_,{children:e.jsxs("form",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"sell-commodity",children:"Commodity"}),e.jsxs(Q,{defaultValue:"Beans",children:[e.jsx(W,{id:"sell-commodity",children:e.jsx(J,{placeholder:"Select commodity"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"Maize",children:"Maize"}),e.jsx(T,{value:"Coffee",children:"Coffee"}),e.jsx(T,{value:"Tea",children:"Tea"}),e.jsx(T,{value:"Beans",children:"Beans"})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"sell-quantity",children:"Quantity (kg)"}),e.jsx(D,{id:"sell-quantity",type:"number",min:"1",defaultValue:"200"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"sell-price",children:"Price per kg (KES)"}),e.jsx(D,{id:"sell-price",type:"number",min:"1",defaultValue:"110"})]}),e.jsx(b,{type:"button",className:"w-full bg-blue-600 hover:bg-blue-700",onClick:()=>c("sell","Beans",200,110),children:"Place Sell Order"})]})})]})]})]})]})},Gm=({isLoading:s,searchTerm:t})=>{const[a]=i.useState([{id:1,commodity:"Maize",quantity:500,price:45,seller:"John Kamau",buyer:"Nairobi Mills",date:"2023-11-20",status:"completed"},{id:2,commodity:"Coffee",quantity:200,price:350,seller:"Mary Wanjiku",buyer:"Kenya Coffee Exporters",date:"2023-11-22",status:"pending"},{id:3,commodity:"Tea",quantity:300,price:280,seller:"Sarah Muthoni",buyer:"Global Tea Traders",date:"2023-11-25",status:"completed"},{id:4,commodity:"Beans",quantity:400,price:110,seller:"John Kamau",buyer:"Local Market Vendors",date:"2023-11-28",status:"pending"}]),r=a.filter(n=>t===""||n.commodity.toLowerCase().includes(t.toLowerCase()));return s?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):r.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{children:"No trades found. Complete an order to see your trade history."})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ls,{children:[e.jsx(Ms,{children:e.jsxs(Oe,{children:[e.jsx(oe,{children:"Commodity"}),e.jsx(oe,{children:"Quantity"}),e.jsx(oe,{children:"Price (KES)"}),e.jsx(oe,{children:"Seller"}),e.jsx(oe,{children:"Buyer"}),e.jsx(oe,{children:"Date"}),e.jsx(oe,{children:"Status"})]})}),e.jsx(Is,{children:r.map(n=>e.jsxs(Oe,{children:[e.jsx(de,{className:"font-medium",children:n.commodity}),e.jsx(de,{children:n.quantity}),e.jsx(de,{children:n.price}),e.jsx(de,{children:n.seller}),e.jsx(de,{children:n.buyer}),e.jsx(de,{children:n.date}),e.jsx(de,{children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${n.status==="completed"?"bg-green-100 text-green-800":"bg-amber-100 text-amber-800"}`,children:n.status==="completed"?"Completed":"Pending"})})]},n.id))})]})})},rr=({title:s,text:t,url:a=window.location.href,size:r="md",variant:n="buttons"})=>{const{toast:c}=Z(),l=`${s}

${t}

Shared via AgriConnect: ${a}`,x=encodeURIComponent(l),f=encodeURIComponent(a),j=()=>{const d=`https://wa.me/?text=${x}`;window.open(d,"_blank","noopener,noreferrer"),c({title:"Shared via WhatsApp",description:"Opening WhatsApp to share this content."})},N=()=>{const d=`https://t.me/share/url?url=${f}&text=${encodeURIComponent(s+`

`+t)}`;window.open(d,"_blank","noopener,noreferrer"),c({title:"Shared via Telegram",description:"Opening Telegram to share this content."})},g=async()=>{try{await navigator.clipboard.writeText(l),c({title:"Copied to Clipboard",description:"Content copied! You can now paste it anywhere."})}catch{c({title:"Copy Failed",description:"Couldn't copy to clipboard. Please try again.",variant:"destructive"})}},u=r==="sm"?"sm":r==="lg"?"lg":"default";return n==="card"?e.jsx(w,{className:"w-full max-w-md",children:e.jsxs(_,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Js,{className:"h-4 w-4"}),e.jsx("h3",{className:"font-medium",children:"Share this content"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs(b,{onClick:j,size:u,variant:"outline",className:"flex flex-col items-center gap-1 h-auto py-3",children:[e.jsx(ys,{className:"h-5 w-5 text-green-600"}),e.jsx("span",{className:"text-xs",children:"WhatsApp"})]}),e.jsxs(b,{onClick:N,size:u,variant:"outline",className:"flex flex-col items-center gap-1 h-auto py-3",children:[e.jsx(sa,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{className:"text-xs",children:"Telegram"})]}),e.jsxs(b,{onClick:g,size:u,variant:"outline",className:"flex flex-col items-center gap-1 h-auto py-3",children:[e.jsx(Js,{className:"h-4 w-4"}),e.jsx("span",{className:"text-xs",children:"Copy"})]})]})]})}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(b,{onClick:j,size:u,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(ys,{className:"h-4 w-4 text-green-600"}),r!=="sm"&&"WhatsApp"]}),e.jsxs(b,{onClick:N,size:u,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(sa,{className:"h-4 w-4 text-blue-600"}),r!=="sm"&&"Telegram"]}),n==="buttons"&&e.jsxs(b,{onClick:g,size:u,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(Js,{className:"h-4 w-4"}),r!=="sm"&&"Copy"]})]})},Hm=({listing:s,isSelected:t,onSelect:a})=>{const[r,n]=i.useState(!1),c=x=>e.jsxs("div",{className:"flex items-center",children:[[...Array(5)].map((f,j)=>e.jsx(es,{className:`h-4 w-4 ${j<Math.floor(x)?"text-yellow-500 fill-yellow-500":j<x?"text-yellow-500 fill-yellow-500 opacity-50":"text-gray-300"}`},j)),e.jsx("span",{className:"ml-1 text-sm font-medium",children:x.toFixed(1)})]}),l=`Check out this barter listing: ${s.commodity} (${s.quantity} ${s.unit}) available in ${s.location}. Looking to trade for: ${s.seekingCommodities.join(", ")}.`;return e.jsx(w,{className:`overflow-hidden hover:shadow-md transition-shadow ${t?"ring-2 ring-primary":""}`,children:e.jsxs("div",{className:"flex flex-col md:flex-row",children:[e.jsx("div",{className:"md:w-1/4 bg-muted",children:e.jsx("div",{className:"aspect-square relative",children:e.jsx("img",{src:s.imageUrl,alt:s.commodity,className:"object-cover w-full h-full"})})}),e.jsxs("div",{className:"p-4 md:w-3/4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1",onClick:()=>a(s),children:[e.jsx("h3",{className:"text-lg font-semibold cursor-pointer",children:s.commodity}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(ee,{className:"h-3.5 w-3.5 mr-1"}),s.location]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(I,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[s.quantity," ",s.unit," available"]}),e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>n(!r),children:e.jsx(Js,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Us,{className:"h-6 w-6",children:e.jsx(Vs,{children:s.owner.charAt(0)})}),e.jsx("span",{className:"text-sm font-medium",children:s.owner})]}),e.jsx("div",{className:"ml-3",children:c(s.ownerRating)})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4 line-clamp-2",children:s.description}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"Seeking:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.seekingCommodities.map((x,f)=>e.jsx(I,{variant:"secondary",children:x},f))})]}),e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Listed: ",s.listedDate]})}),r&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsx(rr,{title:`Barter Opportunity: ${s.commodity}`,text:l,size:"sm"})})]})]})})},Wm=async()=>{try{const{data:s,error:t}=await F.from("barter_listings").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(t)return console.error("Error fetching barter listings:",t),[];const a=(s==null?void 0:s.map(n=>n.user_id))||[],{data:r}=await F.from("profiles").select("id, full_name, avatar_url").in("id",a);return(s==null?void 0:s.map(n=>{var l;const c=r==null?void 0:r.find(x=>x.id===n.user_id);return{id:n.id,commodity:n.commodity,quantity:Number(n.offering_quantity),unit:n.unit,description:n.description||"",imageUrl:((l=n.image_urls)==null?void 0:l[0])||"/placeholder.svg",location:n.location,county:n.county,seekingCommodities:n.seeking_commodities||[],owner:(c==null?void 0:c.full_name)||"Anonymous User",ownerRating:4.5,listedDate:new Date(n.created_at).toLocaleDateString(),status:n.status,userId:n.user_id}}))||[]}catch(s){return console.error("Error fetching barter listings:",s),[]}},Ym=({searchTerm:s="",selectedCategory:t="",selectedLocation:a="",isLoading:r=!1})=>{const[n,c]=i.useState([]),[l,x]=i.useState([]),[f,j]=i.useState(null),[N,g]=i.useState(s),[u,d]=i.useState(t),[h,v]=i.useState(!0),{toast:p}=Z();i.useEffect(()=>{m()},[]),i.useEffect(()=>{o()},[n,N,u]);const m=async()=>{try{v(!0);const k=await Wm();c(k)}catch(k){console.error("Error loading barter listings:",k),p({title:"Error",description:"Failed to load barter listings",variant:"destructive"})}finally{v(!1)}},o=()=>{let k=n;N&&(k=k.filter(A=>A.commodity.toLowerCase().includes(N.toLowerCase())||A.location.toLowerCase().includes(N.toLowerCase())||A.description.toLowerCase().includes(N.toLowerCase()))),u!=="all"&&u&&(k=k.filter(A=>A.commodity.toLowerCase().includes(u.toLowerCase()))),x(k)},y=["all","cereals","vegetables","fruits","livestock","seeds"];return h||r?e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{children:"Loading barter listings..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(w,{children:[e.jsx(q,{children:e.jsxs(L,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Browse Barter Listings"}),e.jsxs(b,{children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Create Listing"]})]})}),e.jsx(_,{children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Pe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(D,{placeholder:"Search by commodity, location, or description...",value:N,onChange:k=>g(k.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(It,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:y.map(k=>e.jsx(I,{variant:u===k?"default":"outline",className:"cursor-pointer capitalize",onClick:()=>d(k),children:k},k))})]})]})})]}),l.length===0?e.jsx(w,{children:e.jsxs(_,{className:"p-8 text-center",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No listings found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:N||u!=="all"?"Try adjusting your search or filters":"Be the first to create a barter listing!"}),e.jsxs(b,{children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Create First Listing"]})]})}):e.jsx("div",{className:"grid gap-6",children:l.map(k=>e.jsx(Hm,{listing:k,isSelected:(f==null?void 0:f.id)===k.id,onSelect:j},k.id))})]})},Qm=(s,t=20,a=30)=>{const r=new Date,n=[];for(let c=a;c>=0;c--){const l=new Date;l.setDate(r.getDate()-c);const x=Math.random()*t*2-t,f=Math.max(s+x,s*.7);n.push({date:l.toISOString().split("T")[0],price:Math.round(f*10)/10})}return n},Jm=s=>{if(!s.length)return null;const t=s.map(x=>x.price),a=Math.min(...t),r=Math.max(...t),n=t.reduce((x,f)=>x+f,0)/t.length,c=t[t.length-1]>t[0]?"rising":"falling",l=Math.sqrt(t.reduce((x,f)=>x+Math.pow(f-n,2),0)/t.length);return{min:Math.round(a*10)/10,max:Math.round(r*10)/10,avg:Math.round(n*10)/10,trend:c,volatility:Math.round(l*10)/10,priceRange:Math.round((r-a)*10)/10}},Xm=({data:s,type:t,height:a=200})=>{const r={line:ma,bar:yt,area:ec}[t],n=()=>{switch(t){case"line":return e.jsx(Cs,{type:"monotone",dataKey:"price",stroke:"#8884d8",activeDot:{r:8}});case"bar":return e.jsx(us,{dataKey:"price",fill:"#8884d8"});case"area":return e.jsx(sc,{type:"monotone",dataKey:"price",stroke:"#8884d8",fill:"#8884d8"});default:return null}};return e.jsx(Je,{width:"100%",height:a,children:e.jsxs(r,{data:s,margin:{top:5,right:5,left:5,bottom:5},children:[e.jsx(Ns,{strokeDasharray:"3 3",stroke:"#eee"}),e.jsx(bs,{dataKey:"date",tick:{fontSize:12},tickFormatter:c=>{const l=new Date(c);return`${l.getDate()}/${l.getMonth()+1}`}}),e.jsx(ws,{domain:["auto","auto"],label:{value:"KES",angle:-90,position:"insideLeft"}}),e.jsx(Xe,{formatter:c=>[`KES ${c}`,"Price"],labelFormatter:c=>`Date: ${c}`}),e.jsx(et,{}),n()]})})},Zm=({isLoading:s,markets:t})=>{const[a,r]=i.useState("line");return s?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):t.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-lg text-muted-foreground",children:"No market data available. Please try again later."})}):e.jsxs("div",{children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Price Trends Visualization"}),e.jsxs(Q,{value:a,onValueChange:n=>r(n),children:[e.jsx(W,{className:"w-[180px]",children:e.jsx(J,{placeholder:"Select chart type"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"line",children:"Line Chart"}),e.jsx(T,{value:"bar",children:"Bar Chart"}),e.jsx(T,{value:"area",children:"Area Chart"})]})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:t.map(n=>e.jsxs(w,{className:"overflow-hidden",children:[e.jsxs(q,{children:[e.jsx(L,{children:n.name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:n.county})]}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-6",children:[n.producePrices.map((c,l)=>{const x=Qm(c.price),f=Jm(x);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center py-2 border-b",children:[e.jsx("span",{children:c.produceName}),e.jsxs("span",{className:"font-medium",children:["KES ",c.price," per ",c.unit]})]}),f&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-muted/50 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Price Range"}),e.jsxs("div",{className:"font-medium",children:["KES ",f.priceRange]})]}),e.jsxs("div",{className:"bg-muted/50 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Average Price"}),e.jsxs("div",{className:"font-medium",children:["KES ",f.avg]})]}),e.jsxs("div",{className:"bg-muted/50 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Price Trend"}),e.jsx("div",{className:"font-medium capitalize",children:e.jsx(I,{variant:f.trend==="rising"?"default":"secondary",children:f.trend})})]})]}),e.jsx("div",{className:"h-[200px] mt-2 mb-4",children:e.jsx(Xm,{data:x,type:a})})]},l)}),e.jsxs("div",{className:"text-sm mt-4",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Demand:"})," ",n.demand]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Operating Hours:"})," ",n.operatingHours]})]})]})})]},n.id))})]})},eu=()=>{Ne(),Z();const[s,t]=i.useState("marketplace"),[a,r]=i.useState(""),[n,c]=i.useState(""),[l,x]=i.useState(""),[f,j]=i.useState([]),[N,g]=i.useState([]),[u,d]=i.useState(!1),h=["All Categories","Cereals","Legumes","Cash Crops","Fruits","Vegetables","Dairy","Meat"],v=["All Locations","Nairobi County","Nakuru County","Kiambu County","Meru County","Nyandarua County","Machakos County","Kisumu County"],p=async()=>{d(!0);try{if(s==="marketplace"||s==="orders"){const k=await Xo();j(k)}if(s==="marketplace"||s==="price-trends"){const k=await Jo();g(k)}}catch(k){console.error("Error fetching data:",k)}finally{d(!1)}};i.useEffect(()=>{p()},[s]);const m=k=>{t(k),r(""),c("")},o=k=>{k.preventDefault(),p()},y=f.filter(k=>{const A=a===""||k.name.toLowerCase().includes(a.toLowerCase()),S=n===""||n==="All Categories"||k.category.toLowerCase()===n.toLowerCase();return A&&S});return e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),e.jsxs("main",{className:"py-12 px-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-10 text-center",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-4",children:"Agricultural Commodity Exchange"}),e.jsx("p",{className:"text-muted-foreground max-w-3xl mx-auto",children:"Buy, sell, and barter agricultural commodities directly with farmers, processors, and exporters across Kenya."})]}),e.jsxs(w,{className:"mb-8",children:[e.jsxs(q,{children:[e.jsx(L,{children:"Commodity Exchange Platform"}),e.jsx(G,{children:"Explore available commodities, place orders, barter goods, and track market trends"})]}),e.jsx(_,{children:e.jsxs(ge,{value:s,onValueChange:m,className:"w-full",children:[e.jsxs(pe,{className:"w-full grid grid-cols-1 sm:grid-cols-2 md:grid-cols-5 gap-2 mb-8",children:[e.jsxs(B,{value:"marketplace",className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4"}),e.jsx("span",{children:"Marketplace"})]}),e.jsxs(B,{value:"orders",className:"flex items-center gap-2",children:[e.jsx(Gi,{className:"h-4 w-4"}),e.jsx("span",{children:"Orders"})]}),e.jsxs(B,{value:"my-trades",className:"flex items-center gap-2",children:[e.jsx(rs,{className:"h-4 w-4"}),e.jsx("span",{children:"My Trades"})]}),e.jsxs(B,{value:"barter-exchange",className:"flex items-center gap-2",children:[e.jsx(tc,{className:"h-4 w-4"}),e.jsx("span",{children:"Barter Exchange"})]}),e.jsxs(B,{value:"price-trends",className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),e.jsx("span",{children:"Price Trends"})]})]}),e.jsx("div",{className:"mt-2 mb-6",children:e.jsxs("form",{onSubmit:o,className:"flex flex-col md:flex-row items-end gap-4",children:[e.jsxs("div",{className:"flex-grow",children:[e.jsx(C,{htmlFor:"search",className:"mb-2 block",children:"Search"}),e.jsx(D,{id:"search",placeholder:"Search commodities...",value:a,onChange:k=>r(k.target.value)})]}),e.jsxs("div",{className:"w-full md:w-64",children:[e.jsx(C,{htmlFor:"category",className:"mb-2 block",children:"Category"}),e.jsxs(Q,{value:n,onValueChange:c,children:[e.jsx(W,{id:"category",children:e.jsx(J,{placeholder:"All Categories"})}),e.jsx(Y,{children:h.map(k=>e.jsx(T,{value:k,children:k},k))})]})]}),s==="barter-exchange"&&e.jsxs("div",{className:"w-full md:w-64",children:[e.jsx(C,{htmlFor:"location",className:"mb-2 block",children:"Location"}),e.jsxs(Q,{value:l,onValueChange:x,children:[e.jsx(W,{id:"location",children:e.jsx(J,{placeholder:"All Locations"})}),e.jsx(Y,{children:v.map(k=>e.jsx(T,{value:k,children:k},k))})]})]}),e.jsx(b,{type:"submit",disabled:u,className:"mt-4 md:mt-0",children:u?"Loading...":"Search"})]})}),e.jsx(V,{value:"marketplace",className:"mt-6",children:e.jsx(Vm,{isLoading:u,filteredProduce:y})}),e.jsx(V,{value:"orders",className:"mt-6",children:e.jsx($m,{isLoading:u,searchTerm:a})}),e.jsx(V,{value:"my-trades",className:"mt-6",children:e.jsx(Gm,{isLoading:u,searchTerm:a})}),e.jsx(V,{value:"barter-exchange",children:e.jsx(Ym,{searchTerm:a,selectedCategory:n,selectedLocation:l,isLoading:u})}),e.jsx(V,{value:"price-trends",className:"mt-6",children:e.jsx(Zm,{isLoading:u,markets:N})})]})})]})]})]})},zr=()=>{const[s,t]=i.useState(""),[a,r]=i.useState([]),[n,c]=i.useState(!0),[l,x]=i.useState(!0),[f,j]=i.useState(!1),[N,g]=i.useState(!1),{user:u}=je(),{toast:d}=Z(),[h,v]=i.useState({commodity:"",offering_quantity:"",seeking_commodities:"",seeking_quantity:"",unit:"kg",location:"",county:"",description:""});i.useEffect(()=>{p()},[]);const p=async()=>{try{c(!0);const{data:y,error:k}=await F.from("barter_listings").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(k)throw k;r(y||[])}catch(y){console.error("Error fetching barter listings:",y)}finally{c(!1)}},m=async()=>{if(!u){d({title:"Please login",description:"You must be logged in to create a barter listing",variant:"destructive"});return}g(!0);try{const{error:y}=await F.from("barter_listings").insert({user_id:u.id,commodity:h.commodity,offering_quantity:parseFloat(h.offering_quantity),seeking_commodities:h.seeking_commodities.split(",").map(k=>k.trim()),seeking_quantity:parseFloat(h.seeking_quantity),unit:h.unit,location:h.location,county:h.county,description:h.description,is_active:!0,status:"active",offering_product_id:crypto.randomUUID(),seeking_product_id:crypto.randomUUID()});if(y)throw y;d({title:"Success",description:"Barter listing created!"}),j(!1),v({commodity:"",offering_quantity:"",seeking_commodities:"",seeking_quantity:"",unit:"kg",location:"",county:"",description:""}),p()}catch(y){d({title:"Error",description:y.message||"Failed to create listing",variant:"destructive"})}finally{g(!1)}},o=a.filter(y=>{var k,A,S;return((k=y.commodity)==null?void 0:k.toLowerCase().includes(s.toLowerCase()))||((A=y.location)==null?void 0:A.toLowerCase().includes(s.toLowerCase()))||((S=y.description)==null?void 0:S.toLowerCase().includes(s.toLowerCase()))});return e.jsxs("div",{className:"min-h-screen pb-20 md:pb-0",children:[e.jsx(ne,{}),l&&e.jsx(_s,{marketplaceType:"agricultural",onAccept:()=>x(!1)}),e.jsx("section",{className:"bg-gradient-to-r from-teal-600 to-teal-800 text-white py-16",children:e.jsxs("div",{className:"container mx-auto px-4 text-center",children:[e.jsx(fr,{className:"h-16 w-16 mx-auto mb-4"}),e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-6",children:"Barter Exchange"}),e.jsx("p",{className:"text-xl mb-8 max-w-3xl mx-auto",children:"Trade agricultural goods and services directly with other farmers without using money. A willing buyer-willing seller marketplace."}),e.jsxs(_e,{open:f,onOpenChange:j,children:[e.jsx(Ie,{asChild:!0,children:e.jsxs(b,{size:"lg",variant:"secondary",children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Post Barter Offer"]})}),e.jsxs(we,{className:"max-w-md",children:[e.jsx(Ce,{children:e.jsx(ke,{children:"Create Barter Listing"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"What are you offering?"}),e.jsx(D,{value:h.commodity,onChange:y=>v({...h,commodity:y.target.value}),placeholder:"e.g., Maize, Beans, Tomatoes"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Quantity"}),e.jsx(D,{type:"number",value:h.offering_quantity,onChange:y=>v({...h,offering_quantity:y.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Unit"}),e.jsxs(Q,{value:h.unit,onValueChange:y=>v({...h,unit:y}),children:[e.jsx(W,{children:e.jsx(J,{})}),e.jsxs(Y,{children:[e.jsx(T,{value:"kg",children:"Kilograms"}),e.jsx(T,{value:"bags",children:"Bags"}),e.jsx(T,{value:"tons",children:"Tons"}),e.jsx(T,{value:"crates",children:"Crates"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{children:"What are you looking for? (comma separated)"}),e.jsx(D,{value:h.seeking_commodities,onChange:y=>v({...h,seeking_commodities:y.target.value}),placeholder:"e.g., Fertilizer, Seeds, Transport"})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Desired quantity"}),e.jsx(D,{type:"number",value:h.seeking_quantity,onChange:y=>v({...h,seeking_quantity:y.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Location"}),e.jsx(D,{value:h.location,onChange:y=>v({...h,location:y.target.value}),placeholder:"Town/Area"})]}),e.jsxs("div",{children:[e.jsx(C,{children:"County"}),e.jsx(D,{value:h.county,onChange:y=>v({...h,county:y.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Description"}),e.jsx(le,{value:h.description,onChange:y=>v({...h,description:y.target.value}),placeholder:"Describe your offer..."})]}),e.jsx(b,{onClick:m,disabled:N,className:"w-full",children:N?"Creating...":"Create Listing"})]})]})]})]})}),e.jsxs("main",{className:"py-12 px-4 md:px-6 max-w-7xl mx-auto",children:[e.jsx(w,{className:"mb-6 border-amber-200 bg-amber-50",children:e.jsxs(_,{className:"pt-4 flex items-start gap-3",children:[e.jsx(Se,{className:"h-5 w-5 text-amber-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-amber-800",children:"Marketplace Disclaimer"}),e.jsx("p",{className:"text-sm text-amber-700",children:"This is a willing buyer-willing seller marketplace. SokoConnect facilitates connections but does not guarantee transactions. Please verify all parties and conduct due diligence before trading."})]})]})}),e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Pe,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(D,{placeholder:"Search barter opportunities...",value:s,onChange:y=>t(y.target.value),className:"pl-10"})]})})}),e.jsx("div",{className:"grid gap-6",children:n?e.jsx("div",{className:"text-center py-12",children:"Loading barter listings..."}):o.length>0?o.map(y=>{var k;return e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs(L,{className:"text-xl mb-2",children:["Trade: ",y.commodity]}),e.jsx(I,{variant:"secondary",children:y.status})]}),e.jsx("div",{className:"text-right text-sm text-muted-foreground",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(xe,{className:"h-4 w-4"}),new Date(y.created_at).toLocaleDateString()]})})]})}),e.jsxs(_,{children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg bg-green-50 dark:bg-green-950",children:[e.jsx("h4",{className:"font-semibold text-green-800 dark:text-green-200 mb-2",children:"Offering:"}),e.jsxs("p",{className:"text-green-700 dark:text-green-300",children:[y.offering_quantity," ",y.unit," of ",y.commodity]})]}),e.jsxs("div",{className:"p-4 border rounded-lg bg-blue-50 dark:bg-blue-950",children:[e.jsx("h4",{className:"font-semibold text-blue-800 dark:text-blue-200 mb-2",children:"Looking for:"}),e.jsxs("p",{className:"text-blue-700 dark:text-blue-300",children:[y.seeking_quantity," ",y.unit," of ",(k=y.seeking_commodities)==null?void 0:k.join(", ")]})]})]}),y.description&&e.jsx("p",{className:"text-muted-foreground mb-4",children:y.description}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(ee,{className:"h-4 w-4"}),e.jsxs("span",{children:[y.location,", ",y.county]})]}),e.jsx(b,{children:"Contact Trader"})]})]})]},y.id)}):e.jsx(w,{className:"text-center py-12",children:e.jsxs(_,{children:[e.jsx(fr,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No barter opportunities found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Be the first to post a barter offer!"}),e.jsxs(b,{onClick:()=>j(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Post Your First Barter Offer"]})]})})})]}),e.jsx(Me,{})]})},su=()=>{const[s,t]=i.useState(""),[a,r]=i.useState(""),n=[{id:"1",name:"Premium Maize",category:"Grains",quantity:"50 bags (90kg each)",price:"KES 4,500 per bag",quality:"Grade A",location:"Kitale, Trans Nzoia",farmer:"Samuel Wekesa",contact:"+254 700 111222",rating:4.8,harvestDate:"2024-01-10",description:"Freshly harvested yellow maize, moisture content 13.5%"},{id:"2",name:"Organic Tomatoes",category:"Vegetables",quantity:"200 crates (20kg each)",price:"KES 800 per crate",quality:"Premium",location:"Naivasha, Nakuru",farmer:"Grace Muthoni",contact:"+254 701 222333",rating:4.9,harvestDate:"2024-01-12",description:"Certified organic Roma tomatoes, perfect for processing"},{id:"3",name:"French Beans",category:"Vegetables",quantity:"100 kg",price:"KES 120 per kg",quality:"Export Grade",location:"Meru County",farmer:"John Mwenda",contact:"+254 702 333444",rating:4.7,harvestDate:"2024-01-13",description:"Export quality French beans, ready for immediate delivery"}],c=n.filter(x=>{const f=x.name.toLowerCase().includes(s.toLowerCase())||x.category.toLowerCase().includes(s.toLowerCase()),j=!a||x.category===a;return f&&j}),l=Array.from(new Set(n.map(x=>x.category)));return e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),e.jsxs("main",{className:"py-12 px-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-4",children:"Agricultural Marketplace"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-6",children:"Buy fresh agricultural produce directly from verified farmers"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Pe,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(D,{placeholder:"Search produce...",value:s,onChange:x=>t(x.target.value),className:"pl-10"})]}),e.jsxs(Q,{value:a,onValueChange:r,children:[e.jsx(W,{className:"w-full sm:w-48",children:e.jsx(J,{placeholder:"All Categories"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"",children:"All Categories"}),l.map(x=>e.jsx(T,{value:x,children:x},x))]})]}),e.jsxs(b,{variant:"outline",children:[e.jsx(It,{className:"h-4 w-4 mr-2"}),"More Filters"]})]})]}),e.jsx("div",{className:"grid gap-6",children:c.map(x=>e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-xl mb-2",children:x.name}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(I,{variant:"secondary",children:x.category}),e.jsx(I,{variant:"default",children:x.quality})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-primary mb-1",children:x.price}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Available: ",x.quantity]})]})]})}),e.jsxs(_,{children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:x.description}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:x.location})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:x.farmer})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(es,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsxs("span",{className:"text-sm",children:[x.rating,"/5.0"]})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Harvest Date:"}),e.jsx("div",{className:"text-sm font-medium mb-2",children:new Date(x.harvestDate).toLocaleDateString()}),e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Freshness:"}),e.jsx(I,{variant:"outline",className:"text-green-600 border-green-600",children:"Fresh (2 days)"})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsx(b,{className:"flex-1",children:"Contact Farmer"}),e.jsx(b,{variant:"outline",children:"Add to Cart"}),e.jsx(b,{variant:"outline",children:"Request Quote"})]})]})]},x.id))}),c.length===0&&e.jsx(w,{className:"text-center py-12",children:e.jsxs(_,{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No produce found"}),e.jsx("p",{className:"text-muted-foreground",children:"Try adjusting your search criteria to find what you're looking for."})]})})]})]})},tu=()=>{var N,g;const[s,t]=i.useState("maize"),[a,r]=i.useState("6months"),n={maize:[{month:"Jul 2023",price:4200,market:"Average"},{month:"Aug 2023",price:4350,market:"Average"},{month:"Sep 2023",price:4100,market:"Average"},{month:"Oct 2023",price:4500,market:"Average"},{month:"Nov 2023",price:4800,market:"Average"},{month:"Dec 2023",price:4650,market:"Average"},{month:"Jan 2024",price:4400,market:"Average"}],beans:[{month:"Jul 2023",price:8500,market:"Average"},{month:"Aug 2023",price:9200,market:"Average"},{month:"Sep 2023",price:8800,market:"Average"},{month:"Oct 2023",price:9500,market:"Average"},{month:"Nov 2023",price:10200,market:"Average"},{month:"Dec 2023",price:9800,market:"Average"},{month:"Jan 2024",price:9400,market:"Average"}]},c=n[s]||n.maize,l=((N=c[c.length-1])==null?void 0:N.price)||0,x=((g=c[c.length-2])==null?void 0:g.price)||0,f=l-x,j=x?(f/x*100).toFixed(1):"0";return e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),e.jsxs("main",{className:"py-12 px-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-4",children:"Price Trends Analysis"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-6",children:"Track historical price movements and market trends for agricultural commodities"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsxs(Q,{value:s,onValueChange:t,children:[e.jsx(W,{className:"w-full sm:w-48",children:e.jsx(J,{placeholder:"Select Commodity"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"maize",children:"Maize"}),e.jsx(T,{value:"beans",children:"Beans"}),e.jsx(T,{value:"wheat",children:"Wheat"}),e.jsx(T,{value:"rice",children:"Rice"})]})]}),e.jsxs(Q,{value:a,onValueChange:r,children:[e.jsx(W,{className:"w-full sm:w-48",children:e.jsx(J,{placeholder:"Select Period"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"3months",children:"Last 3 Months"}),e.jsx(T,{value:"6months",children:"Last 6 Months"}),e.jsx(T,{value:"1year",children:"Last Year"}),e.jsx(T,{value:"2years",children:"Last 2 Years"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs(w,{children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-sm font-medium",children:"Current Price"})}),e.jsxs(_,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["KES ",l.toLocaleString()]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"per 90kg bag"})]})]}),e.jsxs(w,{children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-sm font-medium",children:"Price Change"})}),e.jsxs(_,{children:[e.jsxs("div",{className:`text-2xl font-bold flex items-center gap-2 ${f>=0?"text-green-600":"text-red-600"}`,children:[f>=0?e.jsx(ce,{className:"h-5 w-5"}):e.jsx(Fs,{className:"h-5 w-5"}),f>=0?"+":"","KES ",f.toLocaleString()]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[f>=0?"+":"",j,"% from last month"]})]})]}),e.jsxs(w,{children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-sm font-medium",children:"Market Outlook"})}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:"Stable"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Based on seasonal trends"})]})]})]}),e.jsxs(w,{className:"mb-8",children:[e.jsx(q,{children:e.jsx(L,{children:"Price Trend Chart"})}),e.jsx(_,{children:e.jsx(Je,{width:"100%",height:400,children:e.jsxs(ma,{data:c,children:[e.jsx(Ns,{strokeDasharray:"3 3"}),e.jsx(bs,{dataKey:"month"}),e.jsx(ws,{}),e.jsx(Xe,{formatter:u=>[`KES ${u.toLocaleString()}`,"Price"]}),e.jsx(et,{}),e.jsx(Cs,{type:"monotone",dataKey:"price",stroke:"#2563eb",strokeWidth:2,dot:{fill:"#2563eb",strokeWidth:2,r:4},name:"Price (KES per 90kg bag)"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"Market Analysis"})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Key Factors Affecting Prices:"}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsx("li",{children:"â€¢ Seasonal demand patterns"}),e.jsx("li",{children:"â€¢ Weather conditions and rainfall"}),e.jsx("li",{children:"â€¢ Input costs (fertilizer, fuel)"}),e.jsx("li",{children:"â€¢ Regional supply and demand"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Price Forecast:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Prices expected to remain stable over the next month, with potential increase during dry season (March-May)."})]})]})})]}),e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"Regional Price Comparison"})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center p-2 border rounded",children:[e.jsx("span",{className:"text-sm",children:"Nairobi Market"}),e.jsx("span",{className:"font-medium",children:"KES 4,600"})]}),e.jsxs("div",{className:"flex justify-between items-center p-2 border rounded",children:[e.jsx("span",{className:"text-sm",children:"Nakuru Market"}),e.jsx("span",{className:"font-medium",children:"KES 4,200"})]}),e.jsxs("div",{className:"flex justify-between items-center p-2 border rounded",children:[e.jsx("span",{className:"text-sm",children:"Kitale Market"}),e.jsx("span",{className:"font-medium",children:"KES 3,900"})]}),e.jsxs("div",{className:"flex justify-between items-center p-2 border rounded",children:[e.jsx("span",{className:"text-sm",children:"Mombasa Market"}),e.jsx("span",{className:"font-medium",children:"KES 4,800"})]})]})})]})]})]})]})},au=()=>{const{user:s}=je(),{toast:t}=Z(),[a,r]=i.useState("active"),[n,c]=i.useState([]),[l,x]=i.useState(!0);i.useEffect(()=>{s?f():x(!1)},[s]);const f=async()=>{if(s){x(!0);try{const{data:d,error:h}=await F.from("barter_listings").select("*").eq("user_id",s.id);if(h)throw h;const{data:v,error:p}=await F.from("buy_requests").select("*").eq("buyer_id",s.id);if(p)throw p;const m=(d||[]).map(y=>({id:y.id,type:"sale",commodity:y.commodity||"Agricultural Product",quantity:`${y.offering_quantity} ${y.unit||"units"}`,price:"Barter Exchange",counterparty:"Open Market",status:y.status||"active",date:y.created_at,totalValue:"Barter"})),o=(v||[]).map(y=>({id:y.id,type:"purchase",commodity:y.product_name,quantity:`${y.quantity} ${y.unit}`,price:`KES ${y.max_price.toLocaleString()} max`,counterparty:"Seeking Seller",status:y.status,date:y.created_at,totalValue:`KES ${(y.quantity*y.max_price).toLocaleString()}`}));c([...m,...o])}catch(d){console.error("Error fetching trades:",d),t({title:"Error",description:"Failed to load trades",variant:"destructive"})}finally{x(!1)}}},j=n.filter(d=>d.status==="active"||d.status==="pending"||d.status==="confirmed"),N=n.filter(d=>d.status==="completed"||d.status==="fulfilled"),g=d=>{switch(d){case"confirmed":return"default";case"pending":return"secondary";case"active":return"default";case"completed":return"default";case"fulfilled":return"default";case"cancelled":return"destructive";default:return"secondary"}},u=d=>d==="sale"?"text-green-600":"text-blue-600";return s?e.jsxs("div",{className:"min-h-screen pb-20 md:pb-0",children:[e.jsx(ne,{}),e.jsxs("main",{className:"py-12 px-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-4",children:"My Trades"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-6",children:"Track and manage your agricultural trading activities"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs(w,{children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-sm font-medium",children:"Active Trades"})}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold",children:j.length})})]}),e.jsxs(w,{children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-sm font-medium",children:"Completed"})}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold",children:N.length})})]}),e.jsxs(w,{children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-sm font-medium",children:"Total Trades"})}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold",children:n.length})})]}),e.jsxs(w,{children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-sm font-medium",children:"Success Rate"})}),e.jsx(_,{children:e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[n.length>0?Math.round(N.length/n.length*100):0,"%"]})})]})]})]}),e.jsxs(ge,{value:a,onValueChange:r,className:"w-full",children:[e.jsxs(pe,{className:"grid w-full grid-cols-3",children:[e.jsx(B,{value:"active",children:"Active Trades"}),e.jsx(B,{value:"completed",children:"Completed"}),e.jsx(B,{value:"analytics",children:"Analytics"})]}),e.jsx(V,{value:"active",className:"space-y-6",children:l?e.jsx("div",{className:"text-center py-12",children:"Loading trades..."}):j.length===0?e.jsx(w,{className:"text-center py-12",children:e.jsxs(_,{children:[e.jsx(re,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No active trades"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Start trading by browsing the marketplace or posting a buy request."}),e.jsx(b,{onClick:()=>window.location.href="/marketplace",children:"Browse Marketplace"})]})}):j.map(d=>e.jsxs(w,{children:[e.jsx(q,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs(L,{className:"flex items-center gap-2 mb-2",children:[e.jsx(re,{className:"h-5 w-5"}),d.commodity,e.jsx(I,{variant:"outline",className:u(d.type),children:d.type==="sale"?"Selling":"Buying"})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:d.counterparty})]}),e.jsx(I,{variant:g(d.status),children:d.status.charAt(0).toUpperCase()+d.status.slice(1)})]})}),e.jsxs(_,{children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Quantity"}),e.jsx("div",{className:"font-medium",children:d.quantity})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Price"}),e.jsx("div",{className:"font-medium",children:d.price})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Date"}),e.jsxs("div",{className:"font-medium flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4"}),new Date(d.date).toLocaleDateString()]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Value"}),e.jsx("div",{className:"font-medium text-lg",children:d.totalValue})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsxs(b,{size:"sm",children:[e.jsx(qs,{className:"h-4 w-4 mr-2"}),"View Details"]}),e.jsxs(b,{variant:"outline",size:"sm",children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Contact"]})]})]})]},d.id))}),e.jsx(V,{value:"completed",className:"space-y-6",children:l?e.jsx("div",{className:"text-center py-12",children:"Loading trades..."}):N.length===0?e.jsx(w,{className:"text-center py-12",children:e.jsxs(_,{children:[e.jsx(re,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No completed trades yet"}),e.jsx("p",{className:"text-muted-foreground",children:"Your completed trades will appear here."})]})}):N.map(d=>e.jsxs(w,{children:[e.jsx(q,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs(L,{className:"flex items-center gap-2 mb-2",children:[e.jsx(re,{className:"h-5 w-5"}),d.commodity,e.jsx(I,{variant:"outline",className:u(d.type),children:d.type==="sale"?"Sold":"Purchased"})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:d.counterparty})]}),e.jsx(I,{variant:"default",children:"Completed"})]})}),e.jsx(_,{children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Quantity"}),e.jsx("div",{className:"font-medium",children:d.quantity})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Price"}),e.jsx("div",{className:"font-medium",children:d.price})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Completed Date"}),e.jsxs("div",{className:"font-medium flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4"}),new Date(d.date).toLocaleDateString()]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Value"}),e.jsx("div",{className:"font-medium text-lg",children:d.totalValue})]})]})})]},d.id))}),e.jsx(V,{value:"analytics",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(w,{children:[e.jsx(q,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-5 w-5"}),"Trading Summary"]})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Trades"}),e.jsx("span",{className:"font-medium",children:n.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Active Trades"}),e.jsx("span",{className:"font-medium text-blue-600",children:j.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Completed Trades"}),e.jsx("span",{className:"font-medium text-green-600",children:N.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Success Rate"}),e.jsxs("span",{className:"font-medium text-primary",children:[n.length>0?Math.round(N.length/n.length*100):0,"%"]})]})]})})]}),e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"Trade Types"})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Sales"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 bg-muted rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${n.length>0?n.filter(d=>d.type==="sale").length/n.length*100:0}%`}})}),e.jsx("span",{className:"text-sm",children:n.filter(d=>d.type==="sale").length})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Purchases"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 bg-muted rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${n.length>0?n.filter(d=>d.type==="purchase").length/n.length*100:0}%`}})}),e.jsx("span",{className:"text-sm",children:n.filter(d=>d.type==="purchase").length})]})]})]})})]})]})})]})]}),e.jsx(Me,{})]}):e.jsxs("div",{className:"min-h-screen pb-20 md:pb-0",children:[e.jsx(ne,{}),e.jsxs("main",{className:"py-12 px-6 max-w-7xl mx-auto text-center",children:[e.jsx(rs,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Sign In Required"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Please sign in to view your trades."}),e.jsx(b,{onClick:()=>window.location.href="/auth",children:"Sign In"})]}),e.jsx(Me,{})]})},ru=()=>{const{user:s}=je(),{toast:t}=Z(),[a,r]=i.useState(""),[n,c]=i.useState("all"),[l,x]=i.useState([]),[f,j]=i.useState(!0),[N,g]=i.useState(!1),[u,d]=i.useState(!1),[h,v]=i.useState({title:"",content:"",category:"crop-management",tags:""}),p=[{id:"all",name:"All Categories"},{id:"crop-management",name:"Crop Management"},{id:"pest-control",name:"Pest & Disease Control"},{id:"market-prices",name:"Market Prices"},{id:"farming-techniques",name:"Farming Techniques"},{id:"livestock",name:"Livestock"},{id:"general",name:"General Discussion"}];i.useEffect(()=>{m()},[]);const m=async()=>{j(!0);try{const{data:S,error:E}=await F.from("community_posts").select(`
          *,
          profiles:author_id (full_name, avatar_url)
        `).eq("status","active").order("created_at",{ascending:!1});if(E)throw E;const P=(S||[]).map(R=>({...R,author:R.profiles?{full_name:R.profiles.full_name||"Anonymous",avatar_url:R.profiles.avatar_url}:{full_name:"Anonymous"},comment_count:0}));x(P)}catch(S){console.error("Error fetching posts:",S),t({title:"Error",description:"Failed to load discussions",variant:"destructive"})}finally{j(!1)}},o=async()=>{if(!s){t({title:"Please login",description:"You must be logged in to post",variant:"destructive"});return}if(!h.title.trim()||!h.content.trim()){t({title:"Missing fields",description:"Please fill in title and content",variant:"destructive"});return}d(!0);try{const{error:S}=await F.from("community_posts").insert({author_id:s.id,title:h.title,content:h.content,category:h.category,tags:h.tags.split(",").map(E=>E.trim()).filter(Boolean),status:"active"});if(S)throw S;t({title:"Success",description:"Discussion created successfully!"}),g(!1),v({title:"",content:"",category:"crop-management",tags:""}),m()}catch(S){console.error("Error creating post:",S),t({title:"Error",description:"Failed to create discussion",variant:"destructive"})}finally{d(!1)}},y=async S=>{if(!s){t({title:"Please login",description:"You must be logged in to like posts",variant:"destructive"});return}try{const{data:E}=await F.from("community_post_likes").select("id").eq("post_id",S).eq("user_id",s.id).maybeSingle();E?await F.from("community_post_likes").delete().eq("id",E.id):await F.from("community_post_likes").insert({post_id:S,user_id:s.id}),m()}catch(E){console.error("Error toggling like:",E)}},k=l.filter(S=>{const E=S.title.toLowerCase().includes(a.toLowerCase())||S.content.toLowerCase().includes(a.toLowerCase()),P=n==="all"||S.category===n;return E&&P}),A=S=>S==="all"?l.length:l.filter(E=>E.category===S).length;return e.jsxs("div",{className:"min-h-screen pb-20 md:pb-0",children:[e.jsx(ne,{}),e.jsxs("main",{className:"py-12 px-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-4",children:"Community Forums"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-6",children:"Connect with fellow farmers, share knowledge, and get expert advice"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Pe,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(D,{placeholder:"Search discussions...",value:a,onChange:S=>r(S.target.value),className:"pl-10"})]}),e.jsxs(_e,{open:N,onOpenChange:g,children:[e.jsx(Ie,{asChild:!0,children:e.jsxs(b,{children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Start New Discussion"]})}),e.jsxs(we,{className:"max-w-lg",children:[e.jsx(Ce,{children:e.jsx(ke,{children:"Start New Discussion"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Title *"}),e.jsx(D,{value:h.title,onChange:S=>v({...h,title:S.target.value}),placeholder:"What would you like to discuss?"})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Category *"}),e.jsxs(Q,{value:h.category,onValueChange:S=>v({...h,category:S}),children:[e.jsx(W,{children:e.jsx(J,{})}),e.jsx(Y,{children:p.filter(S=>S.id!=="all").map(S=>e.jsx(T,{value:S.id,children:S.name},S.id))})]})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Content *"}),e.jsx(le,{value:h.content,onChange:S=>v({...h,content:S.target.value}),placeholder:"Share your thoughts, questions, or experiences...",rows:5})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Tags (comma-separated)"}),e.jsx(D,{value:h.tags,onChange:S=>v({...h,tags:S.target.value}),placeholder:"maize, irrigation, drought"})]})]}),e.jsxs(Ze,{children:[e.jsx(b,{variant:"outline",onClick:()=>g(!1),children:"Cancel"}),e.jsx(b,{onClick:o,disabled:u,children:u?"Posting...":"Post Discussion"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1",children:[e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"Categories"})}),e.jsx(_,{children:e.jsx("div",{className:"space-y-2",children:p.map(S=>e.jsx("button",{onClick:()=>c(S.id),className:`w-full text-left p-3 rounded-lg transition-colors ${n===S.id?"bg-primary text-primary-foreground":"hover:bg-muted"}`,children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:S.name}),e.jsx(I,{variant:"secondary",className:"text-xs",children:A(S.id)})]})},S.id))})})]}),e.jsxs(w,{className:"mt-6",children:[e.jsx(q,{children:e.jsx(L,{children:"Forum Stats"})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Total Posts"}),e.jsx("span",{className:"font-medium",children:l.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Active Members"}),e.jsx("span",{className:"font-medium",children:"-"})]})]})})]})]}),e.jsx("div",{className:"lg:col-span-3",children:f?e.jsx("div",{className:"text-center py-12",children:"Loading discussions..."}):e.jsxs("div",{className:"space-y-6",children:[k.map(S=>{var E,P,R;return e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(q,{children:e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{className:"flex-1",children:[e.jsx(L,{className:"text-lg mb-2 hover:text-primary cursor-pointer",children:S.title}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(S.tags||[]).map(M=>e.jsx(I,{variant:"outline",className:"text-xs",children:M},M))}),e.jsx("p",{className:"text-muted-foreground text-sm mb-3 line-clamp-2",children:S.content})]})})}),e.jsx(_,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(Us,{className:"h-8 w-8",children:[e.jsx(rt,{src:(E=S.author)==null?void 0:E.avatar_url}),e.jsx(Vs,{children:(((P=S.author)==null?void 0:P.full_name)||"A").split(" ").map(M=>M[0]).join("")})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:((R=S.author)==null?void 0:R.full_name)||"Anonymous"}),e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(xe,{className:"h-3 w-3"}),Hi(new Date(S.created_at),{addSuffix:!0})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(b,{variant:"ghost",size:"sm",onClick:()=>y(S.id),className:"text-muted-foreground hover:text-primary",children:[e.jsx(ac,{className:"h-4 w-4 mr-1"}),S.upvotes||0]}),e.jsxs(b,{variant:"outline",size:"sm",children:[e.jsx(rc,{className:"h-4 w-4 mr-2"}),"Reply"]})]})]})})]},S.id)}),k.length===0&&e.jsx(w,{className:"text-center py-12",children:e.jsxs(_,{children:[e.jsx(Ue,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No discussions found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Try adjusting your search or be the first to start a discussion in this category!"}),e.jsxs(b,{onClick:()=>g(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Start New Discussion"]})]})})]})})]})]}),e.jsx(Me,{})]})},iu=()=>{var h;const{user:s}=je(),{toast:t}=Z(),[a,r]=i.useState({monthlyRevenue:0,totalArea:0,averageYield:0,activeAlerts:0}),[n,c]=i.useState([]),[l,x]=i.useState(null),[f,j]=i.useState(!0);i.useEffect(()=>{s&&N()},[s]);const N=async()=>{try{j(!0);const{data:v,error:p}=await F.from("farm_statistics").select("*").eq("user_id",s==null?void 0:s.id).single();p&&p.code!=="PGRST116"&&console.error("Error fetching farm stats:",p),v&&r({monthlyRevenue:v.monthly_revenue||0,totalArea:v.total_area||0,averageYield:v.average_yield||0,activeAlerts:v.active_alerts||0});const{data:m,error:o}=await F.from("farm_tasks").select("*").eq("user_id",s==null?void 0:s.id).order("created_at",{ascending:!1}).limit(5);o?console.error("Error fetching tasks:",o):c(m||[]);const{data:y,error:k}=await F.from("profiles").select("*").eq("id",s==null?void 0:s.id).single();k&&k.code!=="PGRST116"&&console.error("Error fetching profile:",k),y&&x(y)}catch(v){console.error("Error fetching dashboard data:",v),t({title:"Error",description:"Failed to load dashboard data",variant:"destructive"})}finally{j(!1)}},g=async(v,p)=>{try{const{error:m}=await F.from("farm_tasks").update({status:p}).eq("id",v).eq("user_id",s==null?void 0:s.id);if(m)throw m;c(n.map(o=>o.id===v?{...o,status:p}:o)),t({title:"Success",description:"Task status updated successfully!"})}catch(m){console.error("Error updating task:",m),t({title:"Error",description:"Failed to update task",variant:"destructive"})}},u=v=>{switch(v){case"completed":return e.jsx(fe,{className:"h-4 w-4 text-green-600"});case"in-progress":return e.jsx(is,{className:"h-4 w-4 text-yellow-600"});default:return e.jsx(Se,{className:"h-4 w-4 text-red-600"})}},d=v=>{switch(v){case"high":return"destructive";case"medium":return"secondary";default:return"outline"}};return f?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(4)].map((v,p)=>e.jsx(w,{className:"animate-pulse",children:e.jsxs(_,{className:"p-6",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded"})]})},p))}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold mb-2",children:["Welcome back, ",(l==null?void 0:l.full_name)||((h=s==null?void 0:s.email)==null?void 0:h.split("@")[0])||"Farmer","!"]}),e.jsx("p",{className:"text-muted-foreground",children:"Here's what's happening on your farm today."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(w,{children:[e.jsxs(q,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Monthly Revenue"}),e.jsx(Ae,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["KES ",a.monthlyRevenue.toLocaleString()]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx(ce,{className:"inline h-3 w-3 mr-1"}),"Track your earnings"]})]})]}),e.jsxs(w,{children:[e.jsxs(q,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Total Farm Area"}),e.jsx(ee,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[a.totalArea," acres"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Your farmland"})]})]}),e.jsxs(w,{children:[e.jsxs(q,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Average Yield"}),e.jsx(Ha,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[a.averageYield," kg/acre"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Production efficiency"})]})]}),e.jsxs(w,{children:[e.jsxs(q,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Active Alerts"}),e.jsx(Se,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:a.activeAlerts}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Weather & market alerts"})]})]})]}),e.jsxs(w,{children:[e.jsx(q,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-5 w-5"}),"Recent Farm Tasks"]})}),e.jsx(_,{children:n.length===0?e.jsxs("div",{className:"text-center py-6 text-muted-foreground",children:[e.jsx(xe,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No tasks found. Start by adding your first farm task!"})]}):e.jsx("div",{className:"space-y-4",children:n.map(v=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[u(v.status),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:v.title}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[v.crop," â€¢ ",v.date]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{variant:d(v.priority),children:v.priority}),v.status==="pending"&&e.jsx(b,{size:"sm",variant:"outline",onClick:()=>g(v.id,"completed"),children:"Mark Complete"})]})]},v.id))})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(w,{className:"p-4",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Weather Forecast"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Check today's weather and upcoming conditions"}),e.jsx(b,{variant:"outline",size:"sm",className:"w-full",children:"View Weather"})]}),e.jsxs(w,{className:"p-4",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Market Prices"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Current commodity prices in your region"}),e.jsx(b,{variant:"outline",size:"sm",className:"w-full",children:"Check Prices"})]}),e.jsxs(w,{className:"p-4",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Add New Task"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Schedule upcoming farm activities"}),e.jsx(b,{size:"sm",className:"w-full",children:"Create Task"})]})]})]})},In=nc,Rn=lc,nu=ic,zn=i.forwardRef(({className:s,...t},a)=>e.jsx(Wi,{className:$("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t,ref:a}));zn.displayName=Wi.displayName;const ir=i.forwardRef(({className:s,...t},a)=>e.jsxs(nu,{children:[e.jsx(zn,{}),e.jsx(Yi,{ref:a,className:$("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...t})]}));ir.displayName=Yi.displayName;const nr=({className:s,...t})=>e.jsx("div",{className:$("flex flex-col space-y-2 text-center sm:text-left",s),...t});nr.displayName="AlertDialogHeader";const lr=({className:s,...t})=>e.jsx("div",{className:$("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t});lr.displayName="AlertDialogFooter";const cr=i.forwardRef(({className:s,...t},a)=>e.jsx(Qi,{ref:a,className:$("text-lg font-semibold",s),...t}));cr.displayName=Qi.displayName;const or=i.forwardRef(({className:s,...t},a)=>e.jsx(Ji,{ref:a,className:$("text-sm text-muted-foreground",s),...t}));or.displayName=Ji.displayName;const dr=i.forwardRef(({className:s,...t},a)=>e.jsx(Xi,{ref:a,className:$(qt(),s),...t}));dr.displayName=Xi.displayName;const mr=i.forwardRef(({className:s,...t},a)=>e.jsx(Zi,{ref:a,className:$(qt({variant:"outline"}),"mt-2 sm:mt-0",s),...t}));mr.displayName=Zi.displayName;const lu=({userProduce:s,onDeleteProduce:t,onEditProduce:a})=>{const{toast:r}=Z(),n=l=>{t(l.id),r({title:"Produit supprimÃ©",description:`${l.name} a Ã©tÃ© supprimÃ© de vos annonces.`})},c=l=>{switch(l.toLowerCase()){case"a":return"bg-green-100 text-green-800 border-green-200";case"b":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"c":return"bg-orange-100 text-orange-800 border-orange-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return e.jsxs(w,{children:[e.jsx(q,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-5 w-5 text-green-600"}),"Mes Produits en Vente"]})}),e.jsx(_,{children:s.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(re,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Aucun produit en vente"}),e.jsx(b,{className:"mt-4",children:"Ajouter un produit"})]}):e.jsx("div",{className:"space-y-4",children:s.map(l=>e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[typeof l.image_url=="string"&&l.image_url&&e.jsx("img",{src:l.image_url,alt:l.name,className:"h-16 w-16 object-cover rounded"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:l.name}),e.jsx("p",{className:"text-muted-foreground",children:l.category})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{className:c(l.qualityGrade),children:["Grade ",l.qualityGrade]}),e.jsx(I,{variant:"outline",children:l.county})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"QuantitÃ©"}),e.jsxs("p",{className:"font-medium",children:[l.quantity," ",l.unit]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Disponible dÃ¨s"}),e.jsx("p",{className:"font-medium",children:l.availableFrom})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Agriculteur"}),e.jsx("p",{className:"font-medium",children:l.farmer})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"ID Produit"}),e.jsxs("p",{className:"font-medium text-xs",children:[l.id.slice(0,8),"..."]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(b,{size:"sm",variant:"outline",children:[e.jsx(qs,{className:"h-4 w-4 mr-2"}),"Voir"]}),e.jsxs(b,{size:"sm",variant:"outline",onClick:()=>a(l),children:[e.jsx(tt,{className:"h-4 w-4 mr-2"}),"Modifier"]}),e.jsxs(In,{children:[e.jsx(Rn,{asChild:!0,children:e.jsxs(b,{size:"sm",variant:"destructive",children:[e.jsx(cc,{className:"h-4 w-4 mr-2"}),"Supprimer"]})}),e.jsxs(ir,{children:[e.jsxs(nr,{children:[e.jsx(cr,{children:"Confirmer la suppression"}),e.jsxs(or,{children:['ÃŠtes-vous sÃ»r de vouloir supprimer "',l.name,'" de vos annonces ? Cette action est irrÃ©versible et supprimera dÃ©finitivement votre produit de la marketplace.']})]}),e.jsxs(lr,{children:[e.jsx(mr,{children:"Annuler"}),e.jsx(dr,{onClick:()=>n(l),className:"bg-red-600 hover:bg-red-700",children:"Supprimer dÃ©finitivement"})]})]})]})]})]},l.id))})})]})};delete Qs.Icon.Default.prototype._getIconUrl;Qs.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});const cu=()=>{const{user:s}=je(),{toast:t}=Z(),[a,r]=i.useState([]),[n,c]=i.useState(!0),[l,x]=i.useState(!1),[f,j]=i.useState(null),[N,g]=i.useState(""),[u,d]=i.useState(),[h,v]=i.useState({name:"",size:"",unit:"acres",crop:"",status:"active",soil_type:"",irrigation_type:"",latitude:"",longitude:"",notes:""});i.useEffect(()=>{s&&p()},[s]);const p=async()=>{try{const{data:P,error:R}=await F.from("land_parcels").select("*").eq("user_id",s.id).order("created_at",{ascending:!1});if(R)throw R;r(P||[]),P&&P.length>0&&d(P[0])}catch(P){t({title:"Error",description:P.message,variant:"destructive"})}finally{c(!1)}},m=async P=>{P.preventDefault(),c(!0);try{const R={user_id:s.id,name:h.name,size:parseFloat(h.size),unit:h.unit,crop:h.crop||null,status:h.status,soil_type:h.soil_type||null,irrigation_type:h.irrigation_type||null,latitude:h.latitude?parseFloat(h.latitude):null,longitude:h.longitude?parseFloat(h.longitude):null,notes:h.notes||null};if(f){const{error:M}=await F.from("land_parcels").update(R).eq("id",f.id);if(M)throw M;t({title:"Success",description:"Parcel updated successfully"})}else{const{error:M}=await F.from("land_parcels").insert(R);if(M)throw M;t({title:"Success",description:"Parcel added successfully"})}x(!1),j(null),k(),p()}catch(R){t({title:"Error",description:R.message,variant:"destructive"})}finally{c(!1)}},o=async P=>{if(confirm("Are you sure you want to delete this parcel?"))try{const{error:R}=await F.from("land_parcels").delete().eq("id",P);if(R)throw R;t({title:"Success",description:"Parcel deleted successfully"}),p()}catch(R){t({title:"Error",description:R.message,variant:"destructive"})}},y=P=>{var R,M;j(P),v({name:P.name,size:P.size.toString(),unit:P.unit,crop:P.crop||"",status:P.status,soil_type:P.soil_type||"",irrigation_type:P.irrigation_type||"",latitude:((R=P.latitude)==null?void 0:R.toString())||"",longitude:((M=P.longitude)==null?void 0:M.toString())||"",notes:P.notes||""}),x(!0)},k=()=>{v({name:"",size:"",unit:"acres",crop:"",status:"active",soil_type:"",irrigation_type:"",latitude:"",longitude:"",notes:""})},A=a.filter(P=>P.name.toLowerCase().includes(N.toLowerCase())||P.crop&&P.crop.toLowerCase().includes(N.toLowerCase())),S=[-1.2921,36.8219],E=u!=null&&u.latitude&&(u!=null&&u.longitude)?[u.latitude,u.longitude]:S;return n&&a.length===0?e.jsx("div",{className:"p-6",children:"Loading parcels..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Land & Parcel Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage and monitor all your agricultural parcels across Kenya"})]}),e.jsxs(b,{className:"bg-primary hover:bg-primary/90",onClick:()=>{j(null),k(),x(!0)},children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Add New Parcel"]})]}),e.jsx("div",{className:"flex gap-4",children:e.jsx(D,{placeholder:"Search parcels...",value:N,onChange:P=>g(P.target.value),className:"max-w-sm"})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"space-y-4",children:A.length===0?e.jsx(w,{children:e.jsx(_,{className:"p-6 text-center text-muted-foreground",children:'No parcels yet. Click "Add New Parcel" to get started.'})}):A.map(P=>e.jsxs(w,{className:`border-l-4 border-l-primary cursor-pointer transition-all hover:shadow-md ${(u==null?void 0:u.id)===P.id?"ring-2 ring-primary":""}`,onClick:()=>d(P),children:[e.jsx(q,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-lg",children:P.name}),e.jsx(I,{variant:P.status==="active"?"default":"secondary",className:"mt-1",children:P.status})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{size:"sm",variant:"outline",onClick:R=>{R.stopPropagation(),y(P)},children:e.jsx(tt,{className:"h-4 w-4"})}),e.jsx(b,{size:"sm",variant:"outline",className:"text-destructive hover:text-destructive",onClick:R=>{R.stopPropagation(),o(P.id)},children:e.jsx(at,{className:"h-4 w-4"})})]})]})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Size:"}),e.jsxs("span",{className:"font-medium",children:[P.size," ",P.unit]})]}),P.crop&&e.jsxs("div",{className:"mt-3 p-2 bg-primary/10 rounded",children:[e.jsx("div",{className:"text-sm font-medium",children:P.crop}),P.next_harvest_date&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Next harvest: ",P.next_harvest_date]})]}),P.latitude&&P.longitude&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(ee,{className:"h-3 w-3"}),e.jsxs("span",{children:[P.latitude.toFixed(4),", ",P.longitude.toFixed(4)]})]})]})})]},P.id))}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-5 w-5"}),"Farm Location Map"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Free OpenStreetMap - Click parcels on left to view on map"})]}),e.jsx(_,{className:"p-0",children:e.jsx("div",{className:"h-[500px] w-full rounded-b-lg overflow-hidden",children:e.jsxs(oc,{center:E,zoom:13,style:{height:"100%",width:"100%"},children:[e.jsx(dc,{attribution:'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),A.filter(P=>P.latitude&&P.longitude).map(P=>e.jsx(mc,{position:[P.latitude,P.longitude],eventHandlers:{click:()=>d(P)},children:e.jsx(uc,{children:e.jsxs("div",{className:"p-2",children:[e.jsx("h3",{className:"font-bold",children:P.name}),e.jsxs("p",{className:"text-sm",children:[P.size," ",P.unit]}),P.crop&&e.jsx("p",{className:"text-sm text-muted-foreground",children:P.crop})]})})},P.id))]},(u==null?void 0:u.id)||"default")})})]}),u&&e.jsx(w,{className:"bg-primary/5",children:e.jsxs(_,{className:"p-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Selected Parcel Details"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Name:"})," ",u.name]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Size:"})," ",u.size," ",u.unit]}),u.crop&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Crop:"})," ",u.crop]}),u.soil_type&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Soil:"})," ",u.soil_type]}),u.irrigation_type&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Irrigation:"})," ",u.irrigation_type]})]})]})})]})]}),e.jsx(_e,{open:l,onOpenChange:x,children:e.jsxs(we,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Ce,{children:e.jsx(ke,{children:f?"Edit Parcel":"Add New Parcel"})}),e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"name",children:"Parcel Name*"}),e.jsx(D,{id:"name",value:h.name,onChange:P=>v({...h,name:P.target.value}),placeholder:"e.g., North Field",required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"status",children:"Status"}),e.jsxs(Q,{value:h.status,onValueChange:P=>v({...h,status:P}),children:[e.jsx(W,{children:e.jsx(J,{})}),e.jsxs(Y,{children:[e.jsx(T,{value:"active",children:"Active"}),e.jsx(T,{value:"inactive",children:"Inactive"}),e.jsx(T,{value:"fallow",children:"Fallow"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"size",children:"Size*"}),e.jsx(D,{id:"size",type:"number",step:"0.01",value:h.size,onChange:P=>v({...h,size:P.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"unit",children:"Unit"}),e.jsxs(Q,{value:h.unit,onValueChange:P=>v({...h,unit:P}),children:[e.jsx(W,{children:e.jsx(J,{})}),e.jsxs(Y,{children:[e.jsx(T,{value:"acres",children:"acres"}),e.jsx(T,{value:"hectares",children:"hectares"}),e.jsx(T,{value:"mÂ²",children:"mÂ²"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"crop",children:"Current Crop"}),e.jsx(D,{id:"crop",value:h.crop,onChange:P=>v({...h,crop:P.target.value}),placeholder:"e.g., Maize"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"soil_type",children:"Soil Type"}),e.jsx(D,{id:"soil_type",value:h.soil_type,onChange:P=>v({...h,soil_type:P.target.value}),placeholder:"e.g., Loamy"})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"irrigation_type",children:"Irrigation Type"}),e.jsx(D,{id:"irrigation_type",value:h.irrigation_type,onChange:P=>v({...h,irrigation_type:P.target.value}),placeholder:"e.g., Drip, Sprinkler"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"latitude",children:"Latitude (for map)"}),e.jsx(D,{id:"latitude",type:"number",step:"0.0001",value:h.latitude,onChange:P=>v({...h,latitude:P.target.value}),placeholder:"e.g., -1.2921"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"longitude",children:"Longitude (for map)"}),e.jsx(D,{id:"longitude",type:"number",step:"0.0001",value:h.longitude,onChange:P=>v({...h,longitude:P.target.value}),placeholder:"e.g., 36.8219"})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"notes",children:"Notes"}),e.jsx(D,{id:"notes",value:h.notes,onChange:P=>v({...h,notes:P.target.value}),placeholder:"Additional information"})]}),e.jsxs(Ze,{children:[e.jsx(b,{type:"button",variant:"outline",onClick:()=>x(!1),children:"Cancel"}),e.jsx(b,{type:"submit",disabled:n,children:n?"Saving...":f?"Update Parcel":"Add Parcel"})]})]})]})})]})},ou=()=>{const{user:s}=je(),{toast:t}=Z(),[a,r]=i.useState([]),[n,c]=i.useState(!0),[l,x]=i.useState(!1),[f,j]=i.useState(null),[N,g]=i.useState({name:"",variety:"",area:"",area_unit:"mÂ²",current_yield:"",previous_yield:"",yield_unit:"kg",quality:"Good",status:"growing"});i.useEffect(()=>{s&&u()},[s]);const u=async()=>{try{const{data:y,error:k}=await F.from("crops").select("*").eq("user_id",s.id).order("created_at",{ascending:!1});if(k)throw k;r(y||[])}catch(y){t({title:"Error",description:y.message,variant:"destructive"})}finally{c(!1)}},d=async y=>{y.preventDefault(),c(!0);try{const k={user_id:s.id,name:N.name,variety:N.variety||null,area:parseFloat(N.area),area_unit:N.area_unit,current_yield:N.current_yield?parseFloat(N.current_yield):null,previous_yield:N.previous_yield?parseFloat(N.previous_yield):null,yield_unit:N.yield_unit,quality:N.quality,status:N.status};if(f){const{error:A}=await F.from("crops").update(k).eq("id",f.id);if(A)throw A;t({title:"Success",description:"Crop updated successfully"})}else{const{error:A}=await F.from("crops").insert(k);if(A)throw A;t({title:"Success",description:"Crop added successfully"})}x(!1),j(null),p(),u()}catch(k){t({title:"Error",description:k.message,variant:"destructive"})}finally{c(!1)}},h=async y=>{if(confirm("Are you sure you want to delete this crop?"))try{const{error:k}=await F.from("crops").delete().eq("id",y);if(k)throw k;t({title:"Success",description:"Crop deleted successfully"}),u()}catch(k){t({title:"Error",description:k.message,variant:"destructive"})}},v=y=>{var k,A;j(y),g({name:y.name,variety:y.variety||"",area:y.area.toString(),area_unit:y.area_unit,current_yield:((k=y.current_yield)==null?void 0:k.toString())||"",previous_yield:((A=y.previous_yield)==null?void 0:A.toString())||"",yield_unit:y.yield_unit||"kg",quality:y.quality||"Good",status:y.status}),x(!0)},p=()=>{g({name:"",variety:"",area:"",area_unit:"mÂ²",current_yield:"",previous_yield:"",yield_unit:"kg",quality:"Good",status:"growing"})},m=a.filter(y=>y.current_yield||y.previous_yield).map(y=>({name:y.name,"Current Yield":y.current_yield||0,"Previous Yield":y.previous_yield||0})),o=y=>{switch(y){case"Excellent":return"bg-green-500 text-white";case"Good":return"bg-blue-500 text-white";case"Average":return"bg-yellow-500 text-white";case"Poor":return"bg-red-500 text-white";default:return"bg-muted text-muted-foreground"}};return n&&a.length===0?e.jsx("div",{className:"p-6",children:"Loading crops..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Crop Management & Tracking"}),e.jsx("p",{className:"text-muted-foreground",children:"Track your crop yields and quality for major Kenyan agricultural products"})]}),e.jsxs(b,{className:"bg-primary hover:bg-primary/90",onClick:()=>{j(null),p(),x(!0)},children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Add New Crop"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[m.length>0&&e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(en,{className:"h-5 w-5 text-primary"}),"Yield Tracking for Kenyan Crops"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Monitor yields and quality for major crops grown in Kenya"})]}),e.jsx(_,{children:e.jsx("div",{className:"h-64 w-full",children:e.jsx(Je,{width:"100%",height:"100%",children:e.jsxs(yt,{data:m,children:[e.jsx(Ns,{strokeDasharray:"3 3"}),e.jsx(bs,{dataKey:"name",tick:{fontSize:12}}),e.jsx(ws,{}),e.jsx(Xe,{}),e.jsx(us,{dataKey:"Current Yield",fill:"hsl(var(--primary))"}),e.jsx(us,{dataKey:"Previous Yield",fill:"hsl(var(--muted))"})]})})})})]}),e.jsx("div",{className:"space-y-4",children:a.length===0?e.jsx(w,{children:e.jsx(_,{className:"p-6 text-center text-muted-foreground",children:'No crops yet. Click "Add New Crop" to get started.'})}):a.map(y=>e.jsx(w,{children:e.jsxs(_,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:y.name}),y.variety&&e.jsx("p",{className:"text-sm text-muted-foreground",children:y.variety}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Area: ",y.area," ",y.area_unit]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{size:"sm",variant:"outline",onClick:()=>v(y),children:e.jsx(tt,{className:"h-4 w-4"})}),e.jsx(b,{size:"sm",variant:"outline",className:"text-destructive hover:text-destructive",onClick:()=>h(y.id),children:e.jsx(at,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[y.current_yield&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Current yield"}),e.jsxs("span",{className:"font-medium",children:[y.current_yield," ",y.yield_unit]})]}),y.previous_yield&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Previous yield"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[y.previous_yield," ",y.yield_unit]})]}),y.quality&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Quality"}),e.jsx(I,{className:o(y.quality),children:y.quality})]}),y.current_yield&&y.previous_yield&&y.previous_yield>0&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ce,{className:"h-4 w-4 text-primary"}),e.jsxs("span",{className:"text-primary",children:[((y.current_yield-y.previous_yield)/y.previous_yield*100).toFixed(1),"%"]})]})]})]})},y.id))})]}),e.jsx(_e,{open:l,onOpenChange:x,children:e.jsxs(we,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Ce,{children:e.jsx(ke,{children:f?"Edit Crop":"Add New Crop"})}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"name",children:"Crop Name*"}),e.jsx(D,{id:"name",value:N.name,onChange:y=>g({...N,name:y.target.value}),placeholder:"e.g., Maize, Coffee",required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"variety",children:"Variety"}),e.jsx(D,{id:"variety",value:N.variety,onChange:y=>g({...N,variety:y.target.value}),placeholder:"e.g., H614, Ruiru 11"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"area",children:"Area*"}),e.jsx(D,{id:"area",type:"number",step:"0.01",value:N.area,onChange:y=>g({...N,area:y.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"area_unit",children:"Area Unit"}),e.jsxs(Q,{value:N.area_unit,onValueChange:y=>g({...N,area_unit:y}),children:[e.jsx(W,{children:e.jsx(J,{})}),e.jsxs(Y,{children:[e.jsx(T,{value:"mÂ²",children:"mÂ²"}),e.jsx(T,{value:"acres",children:"acres"}),e.jsx(T,{value:"hectares",children:"hectares"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"current_yield",children:"Current Yield"}),e.jsx(D,{id:"current_yield",type:"number",step:"0.01",value:N.current_yield,onChange:y=>g({...N,current_yield:y.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"previous_yield",children:"Previous Yield"}),e.jsx(D,{id:"previous_yield",type:"number",step:"0.01",value:N.previous_yield,onChange:y=>g({...N,previous_yield:y.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"yield_unit",children:"Yield Unit"}),e.jsx(D,{id:"yield_unit",value:N.yield_unit,onChange:y=>g({...N,yield_unit:y.target.value}),placeholder:"e.g., kg, bags/acre"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"quality",children:"Quality"}),e.jsxs(Q,{value:N.quality,onValueChange:y=>g({...N,quality:y}),children:[e.jsx(W,{children:e.jsx(J,{})}),e.jsxs(Y,{children:[e.jsx(T,{value:"Excellent",children:"Excellent"}),e.jsx(T,{value:"Good",children:"Good"}),e.jsx(T,{value:"Average",children:"Average"}),e.jsx(T,{value:"Poor",children:"Poor"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"status",children:"Status"}),e.jsxs(Q,{value:N.status,onValueChange:y=>g({...N,status:y}),children:[e.jsx(W,{children:e.jsx(J,{})}),e.jsxs(Y,{children:[e.jsx(T,{value:"planning",children:"Planning"}),e.jsx(T,{value:"growing",children:"Growing"}),e.jsx(T,{value:"harvesting",children:"Harvesting"}),e.jsx(T,{value:"harvested",children:"Harvested"}),e.jsx(T,{value:"failed",children:"Failed"})]})]})]}),e.jsxs(Ze,{children:[e.jsx(b,{type:"button",variant:"outline",onClick:()=>x(!1),children:"Cancel"}),e.jsx(b,{type:"submit",disabled:n,children:n?"Saving...":f?"Update Crop":"Add Crop"})]})]})]})})]})},du=()=>{const{user:s}=je(),{toast:t}=Z(),[a,r]=i.useState([]),[n,c]=i.useState(!0),[l,x]=i.useState(""),[f,j]=i.useState("All Categories"),[N,g]=i.useState(!1),[u,d]=i.useState(null),[h,v]=i.useState({name:"",category:"",quantity:"",unit:"",unit_price:"",minimum_quantity:"",location:"",notes:""});i.useEffect(()=>{s&&p()},[s]);const p=async()=>{try{c(!0);const{data:P,error:R}=await F.from("farm_inventory").select("*").eq("user_id",s==null?void 0:s.id).order("created_at",{ascending:!1});if(R)throw R;r(P||[])}catch(P){console.error("Error fetching inventory:",P),t({title:"Error",description:"Failed to load inventory",variant:"destructive"})}finally{c(!1)}},m=async P=>{P.preventDefault();try{const R=parseFloat(h.quantity),M=parseFloat(h.unit_price),O=R*M,te={user_id:s==null?void 0:s.id,name:h.name,category:h.category,quantity:R,unit:h.unit,unit_price:M,total_value:O,minimum_quantity:parseFloat(h.minimum_quantity),location:h.location||null,notes:h.notes||null};if(u){const{error:ue}=await F.from("farm_inventory").update(te).eq("id",u.id);if(ue)throw ue;t({title:"Success",description:"Inventory item updated successfully!"})}else{const{error:ue}=await F.from("farm_inventory").insert([te]);if(ue)throw ue;t({title:"Success",description:"Inventory item added successfully!"})}g(!1),d(null),v({name:"",category:"",quantity:"",unit:"",unit_price:"",minimum_quantity:"",location:"",notes:""}),p()}catch(R){console.error("Error saving inventory:",R),t({title:"Error",description:"Failed to save inventory item",variant:"destructive"})}},o=P=>{d(P),v({name:P.name,category:P.category,quantity:P.quantity.toString(),unit:P.unit,unit_price:P.unit_price.toString(),minimum_quantity:P.minimum_quantity.toString(),location:P.location||"",notes:P.notes||""}),g(!0)},y=async P=>{if(confirm("Are you sure you want to delete this item?"))try{const{error:R}=await F.from("farm_inventory").delete().eq("id",P);if(R)throw R;t({title:"Success",description:"Inventory item deleted successfully!"}),p()}catch(R){console.error("Error deleting inventory:",R),t({title:"Error",description:"Failed to delete inventory item",variant:"destructive"})}},k=["All Categories",...Array.from(new Set(a.map(P=>P.category)))],A=a.filter(P=>{const R=P.name.toLowerCase().includes(l.toLowerCase()),M=f==="All Categories"||P.category===f;return R&&M}),S=a.filter(P=>P.quantity<=P.minimum_quantity),E=P=>P.quantity<=P.minimum_quantity*.5?e.jsx(I,{variant:"destructive",children:"Critical"}):P.quantity<=P.minimum_quantity?e.jsx(I,{className:"bg-yellow-100 text-yellow-800",children:"Warning"}):e.jsx(I,{className:"bg-green-100 text-green-800",children:"Normal"});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Inventory & Stock Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your farm inventory and track stock levels"})]}),e.jsxs(b,{className:"bg-green-600 hover:bg-green-700",onClick:()=>{d(null),v({name:"",category:"",quantity:"",unit:"",unit_price:"",minimum_quantity:"",location:"",notes:""}),g(!0)},children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Add Stock Item"]})]}),S.length>0&&e.jsxs(w,{className:"border-yellow-200 bg-yellow-50",children:[e.jsx(q,{children:e.jsxs(L,{className:"flex items-center gap-2 text-yellow-800",children:[e.jsx(Se,{className:"h-5 w-5"}),"Low Stock Alerts (",S.length,")"]})}),e.jsx(_,{children:e.jsx("div",{className:"space-y-2",children:S.map(P=>e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"font-medium",children:P.name}),e.jsxs("div",{children:[e.jsxs("span",{children:["Current: ",P.quantity," ",P.unit]}),e.jsxs("span",{className:"text-muted-foreground ml-2",children:["Min: ",P.minimum_quantity]})]})]},P.id))})})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(D,{placeholder:"Search inventory...",value:l,onChange:P=>x(P.target.value),className:"max-w-sm"}),e.jsx("select",{value:f,onChange:P=>j(P.target.value),className:"px-3 py-2 border rounded-md",children:k.map(P=>e.jsx("option",{value:P,children:P},P))})]}),e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Stock Management"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Total Items: ",a.length," | Total Value: KES ",a.reduce((P,R)=>P+R.total_value,0).toLocaleString()]})]}),e.jsx(_,{children:n?e.jsx("div",{className:"text-center py-8",children:"Loading..."}):A.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(re,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No inventory items found. Add your first item to get started!"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ls,{children:[e.jsx(Ms,{children:e.jsxs(Oe,{children:[e.jsx(oe,{children:"Item"}),e.jsx(oe,{children:"Category"}),e.jsx(oe,{children:"Quantity"}),e.jsx(oe,{children:"Unit Price"}),e.jsx(oe,{children:"Total Value"}),e.jsx(oe,{children:"Location"}),e.jsx(oe,{children:"Status"}),e.jsx(oe,{children:"Actions"})]})}),e.jsx(Is,{children:A.map(P=>e.jsxs(Oe,{children:[e.jsx(de,{className:"font-medium",children:P.name}),e.jsx(de,{children:P.category}),e.jsxs(de,{children:[P.quantity," ",P.unit]}),e.jsxs(de,{children:["KES ",P.unit_price.toFixed(2)]}),e.jsxs(de,{children:["KES ",P.total_value.toFixed(2)]}),e.jsx(de,{children:P.location||"-"}),e.jsx(de,{children:E(P)}),e.jsx(de,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{size:"sm",variant:"outline",onClick:()=>o(P),children:e.jsx(tt,{className:"h-4 w-4"})}),e.jsx(b,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700",onClick:()=>y(P.id),children:e.jsx(at,{className:"h-4 w-4"})})]})})]},P.id))})]})})})]}),e.jsx(_e,{open:N,onOpenChange:g,children:e.jsxs(we,{className:"max-w-2xl",children:[e.jsx(Ce,{children:e.jsxs(ke,{children:[u?"Edit":"Add"," Inventory Item"]})}),e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"name",children:"Item Name*"}),e.jsx(D,{id:"name",value:h.name,onChange:P=>v({...h,name:P.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"category",children:"Category*"}),e.jsx(D,{id:"category",value:h.category,onChange:P=>v({...h,category:P.target.value}),placeholder:"e.g., Seeds, Fertilizers, Tools",required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"quantity",children:"Quantity*"}),e.jsx(D,{id:"quantity",type:"number",step:"0.01",value:h.quantity,onChange:P=>v({...h,quantity:P.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"unit",children:"Unit*"}),e.jsx(D,{id:"unit",value:h.unit,onChange:P=>v({...h,unit:P.target.value}),placeholder:"e.g., kg, L, bags",required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"unit_price",children:"Unit Price (KES)*"}),e.jsx(D,{id:"unit_price",type:"number",step:"0.01",value:h.unit_price,onChange:P=>v({...h,unit_price:P.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"minimum_quantity",children:"Minimum Quantity*"}),e.jsx(D,{id:"minimum_quantity",type:"number",step:"0.01",value:h.minimum_quantity,onChange:P=>v({...h,minimum_quantity:P.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"location",children:"Storage Location"}),e.jsx(D,{id:"location",value:h.location,onChange:P=>v({...h,location:P.target.value}),placeholder:"e.g., Warehouse A"})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"notes",children:"Notes"}),e.jsx(D,{id:"notes",value:h.notes,onChange:P=>v({...h,notes:P.target.value}),placeholder:"Additional information"})]}),e.jsxs(Ze,{children:[e.jsx(b,{type:"button",variant:"outline",onClick:()=>g(!1),children:"Cancel"}),e.jsxs(b,{type:"submit",className:"bg-green-600 hover:bg-green-700",children:[u?"Update":"Add"," Item"]})]})]})]})})]})},mu=()=>{const[s,t]=i.useState(""),[a,r]=i.useState(""),[n,c]=i.useState(!1),{toast:l}=Z(),x=async()=>{if(!s||!a){l({title:"Missing Information",description:"Please select both report type and period",variant:"destructive"});return}c(!0),setTimeout(()=>{const f={reportType:s,period:a,generatedAt:new Date().toISOString(),data:{totalRevenue:8900,totalExpenses:4720,netProfit:4180,activeParcels:3,totalArea:26,averageYield:2.3}},j=`Report Type,${s}
Period,${a}
Generated At,${new Date().toLocaleString()}

Financial Summary
Total Revenue,KES ${f.data.totalRevenue.toLocaleString()}
Total Expenses,KES ${f.data.totalExpenses.toLocaleString()}
Net Profit,KES ${f.data.netProfit.toLocaleString()}

Farm Summary
Active Parcels,${f.data.activeParcels}
Total Area,${f.data.totalArea} acres
Average Yield,${f.data.averageYield} t/ha`,N=new Blob([j],{type:"text/csv"}),g=window.URL.createObjectURL(N),u=document.createElement("a");u.href=g,u.download=`farm-report-${s}-${a}-${new Date().getTime()}.csv`,u.click(),window.URL.revokeObjectURL(g),c(!1),l({title:"Report Generated",description:"Your farm report has been downloaded successfully"})},2e3)};return e.jsxs(w,{children:[e.jsx(q,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Ds,{className:"h-5 w-5"}),"Generate Reports"]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Report Type"}),e.jsxs(Q,{value:s,onValueChange:t,children:[e.jsx(W,{children:e.jsx(J,{placeholder:"Select report type"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"financial",children:"Financial Report"}),e.jsx(T,{value:"production",children:"Production Report"}),e.jsx(T,{value:"inventory",children:"Inventory Report"}),e.jsx(T,{value:"comprehensive",children:"Comprehensive Report"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Period"}),e.jsxs(Q,{value:a,onValueChange:r,children:[e.jsx(W,{children:e.jsx(J,{placeholder:"Select period"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"current-month",children:"Current Month"}),e.jsx(T,{value:"last-month",children:"Last Month"}),e.jsx(T,{value:"quarter",children:"This Quarter"}),e.jsx(T,{value:"year",children:"This Year"}),e.jsx(T,{value:"custom",children:"Custom Range"})]})]})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(b,{onClick:x,disabled:n||!s||!a,className:"flex-1",children:[n?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2"}):e.jsx(xc,{className:"h-4 w-4 mr-2"}),n?"Generating...":"Generate Report"]})})]})]})},uu=()=>{var z;const{user:s}=je(),[t,a]=i.useState(null),[r,n]=i.useState([]),[c,l]=i.useState([]),[x,f]=i.useState([]),[j,N]=i.useState({year:new Date().getFullYear(),category:"",subcategory:"",planned_amount:"",actual_amount:"",notes:""}),[g,u]=i.useState(!1),[d,h]=i.useState(!0),[v,p]=i.useState(null),[m,o]=i.useState(null),[y,k]=i.useState(null);i.useEffect(()=>{if(!s)return;h(!0),(async()=>{const{data:K}=await F.from("farm_statistics").select("*").eq("user_id",s.id).single();a(K);const{data:ae}=await F.from("market_forecasts").select("*").order("created_at",{ascending:!1}).limit(10);n(ae||[]);const{data:be}=await F.from("farm_budgets").select("*").eq("user_id",s.id).order("year",{ascending:!1});l(be||[]);const{data:ts}=await F.from("payment_transactions").select("*").eq("user_id",s.id).order("created_at",{ascending:!1}).limit(10);f(ts||[]),h(!1)})()},[s]);const A=U=>{const{name:K,value:ae}=U.target;N(be=>({...be,[K]:ae}))},S=async U=>{U.preventDefault(),u(!0),await F.from("farm_budgets").insert({user_id:s.id,year:Number(j.year),category:j.category,subcategory:j.subcategory,planned_amount:Number(j.planned_amount),actual_amount:j.actual_amount?Number(j.actual_amount):null,notes:j.notes}),N({year:new Date().getFullYear(),category:"",subcategory:"",planned_amount:"",actual_amount:"",notes:""}),u(!1);const{data:K}=await F.from("farm_budgets").select("*").eq("user_id",s.id).order("year",{ascending:!1});l(K||[])},E=U=>{p(U),o({...U})},P=U=>{const{name:K,value:ae}=U.target;o(be=>({...be,[K]:ae}))},R=async U=>{U.preventDefault(),await F.from("farm_budgets").update({year:Number(m.year),category:m.category,subcategory:m.subcategory,planned_amount:Number(m.planned_amount),actual_amount:m.actual_amount?Number(m.actual_amount):null,notes:m.notes,updated_at:new Date().toISOString()}).eq("id",v.id),p(null),o(null);const{data:K}=await F.from("farm_budgets").select("*").eq("user_id",s.id).order("year",{ascending:!1});l(K||[])},M=async U=>{k(U),await F.from("farm_budgets").delete().eq("id",U),k(null);const{data:K}=await F.from("farm_budgets").select("*").eq("user_id",s.id).order("year",{ascending:!1});l(K||[])},O=(t==null?void 0:t.monthly_revenue)||0,te=c.reduce((U,K)=>U+(K.actual_amount<0?Math.abs(K.actual_amount):0),0),ue=O-te;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Financial Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Track your farm revenue, expenses, and profitability"})]}),e.jsx(mu,{})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(w,{children:e.jsx(_,{className:"p-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Revenue"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Income"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["KES ",O.toLocaleString()]}),e.jsxs("p",{className:"text-xs text-green-600 flex items-center",children:[e.jsx(ce,{className:"h-3 w-3 mr-1"}),"+6.5%"]})]})})})}),e.jsx(w,{children:e.jsx(_,{className:"p-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Expenses"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Outgoing"}),e.jsxs("p",{className:"text-2xl font-bold text-red-600",children:["KES ",te.toLocaleString()]}),e.jsxs("p",{className:"text-xs text-red-600 flex items-center",children:[e.jsx(Fs,{className:"h-3 w-3 mr-1"}),"+2.1%"]})]})})})}),e.jsx(w,{children:e.jsx(_,{className:"p-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Profit"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Revenue - Expenses"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["KES ",ue.toLocaleString()]}),e.jsxs("p",{className:"text-xs text-green-600 flex items-center",children:[e.jsx(ce,{className:"h-3 w-3 mr-1"}),"+8.3%"]})]})})})})]}),e.jsxs(ge,{defaultValue:"overview",className:"w-full",children:[e.jsxs(pe,{className:"grid w-full grid-cols-5",children:[e.jsx(B,{value:"overview",children:"Overview"}),e.jsx(B,{value:"revenue",children:"Revenue"}),e.jsx(B,{value:"expenses",children:"Expenses"}),e.jsx(B,{value:"forecasts",children:"Forecasts"}),e.jsx(B,{value:"budget",children:"Budget"})]}),e.jsx(V,{value:"overview",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"Monthly Overview"})}),e.jsx(_,{children:e.jsx("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:t?e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsxs("div",{children:["Monthly Revenue: ",e.jsxs("b",{children:["KES ",((z=t.monthly_revenue)==null?void 0:z.toLocaleString())||0]})]}),e.jsxs("div",{children:["Average Yield: ",e.jsxs("b",{children:[t.average_yield||0," tons"]})]}),e.jsxs("div",{children:["Total Area: ",e.jsxs("b",{children:[t.total_area||0," acres"]})]}),e.jsxs("div",{children:["Active Alerts: ",e.jsx("b",{children:t.active_alerts||0})]})]})}):"Loading..."})})]}),e.jsxs(w,{children:[e.jsxs(q,{className:"flex flex-row items-center justify-between",children:[e.jsx(L,{children:"Recent Transactions"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(b,{size:"sm",variant:"outline",children:[e.jsx(ca,{className:"h-4 w-4 mr-2"}),"Export"]}),e.jsxs(b,{size:"sm",variant:"outline",children:[e.jsx(sn,{className:"h-4 w-4 mr-2"}),"Import"]}),e.jsxs(b,{size:"sm",className:"bg-green-600 hover:bg-green-700",children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Add"]})]})]}),e.jsx(_,{children:e.jsx("div",{className:"space-y-3",children:x.length>0?x.slice(0,5).map(U=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:U.payment_provider||U.description}),e.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(U.created_at).toLocaleDateString()})]}),e.jsxs("span",{className:`font-bold ${U.amount>0?"text-green-600":"text-red-600"}`,children:[U.amount>0?"+":"","KES ",Math.abs(U.amount).toLocaleString()]})]},U.id)):e.jsx("div",{className:"text-muted-foreground",children:"No transactions found."})})})]})]})}),e.jsx(V,{value:"revenue",children:e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"Revenue Analysis"})}),e.jsx(_,{children:e.jsx("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:x.length>0?e.jsx("ul",{className:"w-full",children:x.filter(U=>U.amount>0).map(U=>e.jsxs("li",{className:"flex justify-between border-b py-2",children:[e.jsx("span",{children:U.payment_provider||U.description}),e.jsxs("span",{className:"text-green-600 font-bold",children:["+KES ",U.amount.toLocaleString()]})]},U.id))}):"No revenue transactions."})})]})}),e.jsx(V,{value:"expenses",children:e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"Expense Analysis"})}),e.jsx(_,{children:e.jsx("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:x.length>0?e.jsx("ul",{className:"w-full",children:x.filter(U=>U.amount<0).map(U=>e.jsxs("li",{className:"flex justify-between border-b py-2",children:[e.jsx("span",{children:U.payment_provider||U.description}),e.jsxs("span",{className:"text-red-600 font-bold",children:["-KES ",Math.abs(U.amount).toLocaleString()]})]},U.id))}):"No expense transactions."})})]})}),e.jsx(V,{value:"forecasts",children:e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"Financial Forecasts"})}),e.jsx(_,{children:e.jsx("div",{className:"h-64 overflow-y-auto",children:r.length>0?e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left",children:"Commodity"}),e.jsx("th",{className:"text-left",children:"County"}),e.jsx("th",{className:"text-left",children:"Forecast Price"}),e.jsx("th",{className:"text-left",children:"Confidence"}),e.jsx("th",{className:"text-left",children:"Period"})]})}),e.jsx("tbody",{children:r.map(U=>{var K;return e.jsxs("tr",{children:[e.jsx("td",{children:U.commodity_name}),e.jsx("td",{children:U.county}),e.jsxs("td",{children:["KES ",(K=U.forecast_price)==null?void 0:K.toLocaleString()]}),e.jsx("td",{children:U.confidence_level}),e.jsx("td",{children:U.period})]},U.id)})})]}):e.jsx("div",{className:"text-muted-foreground",children:"No forecasts found."})})})]})}),e.jsx(V,{value:"budget",children:e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"Budget Planning"})}),e.jsxs(_,{children:[e.jsx("div",{className:"mb-4",children:e.jsxs("form",{onSubmit:S,className:"grid grid-cols-1 md:grid-cols-6 gap-2 items-end",children:[e.jsx("div",{children:e.jsx(D,{name:"year",type:"number",min:"2020",max:"2100",value:j.year,onChange:A,placeholder:"Year",required:!0})}),e.jsx("div",{children:e.jsx(D,{name:"category",value:j.category,onChange:A,placeholder:"Category (e.g. Seeds)",required:!0})}),e.jsx("div",{children:e.jsx(D,{name:"subcategory",value:j.subcategory,onChange:A,placeholder:"Subcategory (e.g. Maize seed)"})}),e.jsx("div",{children:e.jsx(D,{name:"planned_amount",type:"number",value:j.planned_amount,onChange:A,placeholder:"Planned Amount",required:!0})}),e.jsx("div",{children:e.jsx(D,{name:"actual_amount",type:"number",value:j.actual_amount,onChange:A,placeholder:"Actual Amount"})}),e.jsx("div",{children:e.jsx(b,{type:"submit",disabled:g,children:g?"Adding...":"Add Budget Item"})}),e.jsx("div",{className:"md:col-span-6",children:e.jsx(le,{name:"notes",value:j.notes,onChange:A,placeholder:"Notes"})})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Year"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Subcategory"}),e.jsx("th",{children:"Planned"}),e.jsx("th",{children:"Actual"}),e.jsx("th",{children:"Notes"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:c.length>0?c.map(U=>{var K;return e.jsxs("tr",{children:[e.jsx("td",{children:U.year}),e.jsx("td",{children:U.category}),e.jsx("td",{children:U.subcategory}),e.jsxs("td",{children:["KES ",(K=U.planned_amount)==null?void 0:K.toLocaleString()]}),e.jsx("td",{children:U.actual_amount!==null?`KES ${U.actual_amount.toLocaleString()}`:"-"}),e.jsx("td",{children:U.notes}),e.jsxs("td",{children:[e.jsx(b,{size:"sm",variant:"outline",onClick:()=>E(U),className:"mr-2",children:"Edit"}),e.jsx(b,{size:"sm",variant:"destructive",onClick:()=>M(U.id),disabled:y===U.id,children:"Delete"})]})]},U.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center text-muted-foreground",children:"No budget items found."})})})]})})]})]})})]}),v&&e.jsx(_e,{open:!!v,onOpenChange:()=>p(null),children:e.jsxs(we,{children:[e.jsx(Ce,{children:e.jsx(ke,{children:"Edit Budget Item"})}),e.jsxs("form",{onSubmit:R,className:"space-y-2",children:[e.jsx(D,{name:"year",type:"number",min:"2020",max:"2100",value:m.year,onChange:P,required:!0}),e.jsx(D,{name:"category",value:m.category,onChange:P,required:!0}),e.jsx(D,{name:"subcategory",value:m.subcategory,onChange:P}),e.jsx(D,{name:"planned_amount",type:"number",value:m.planned_amount,onChange:P,required:!0}),e.jsx(D,{name:"actual_amount",type:"number",value:m.actual_amount||"",onChange:P}),e.jsx(le,{name:"notes",value:m.notes,onChange:P}),e.jsxs(Ze,{children:[e.jsx(b,{type:"button",variant:"outline",onClick:()=>p(null),children:"Cancel"}),e.jsx(b,{type:"submit",children:"Update"})]})]})]})})]})},xu=()=>{const[s]=i.useState([{id:"1",name:"Maize Yield",value:85,target:90,unit:"bags/acre",trend:"up",category:"production"},{id:"2",name:"Bean Yield",value:12,target:15,unit:"bags/acre",trend:"down",category:"production"},{id:"3",name:"Profit per Hectare",value:45e3,target:5e4,unit:"KES",trend:"up",category:"financial"},{id:"4",name:"Cost Efficiency",value:78,target:85,unit:"%",trend:"stable",category:"efficiency"},{id:"5",name:"Market Price Advantage",value:12,target:10,unit:"%",trend:"up",category:"financial"},{id:"6",name:"Resource Utilization",value:88,target:90,unit:"%",trend:"up",category:"efficiency"}]),t=[{crop:"Maize",currentYield:85,previousYield:75,efficiency:88},{crop:"Beans",currentYield:12,previousYield:15,efficiency:75},{crop:"Potatoes",currentYield:45,previousYield:40,efficiency:92},{crop:"Tomatoes",currentYield:32,previousYield:28,efficiency:85},{crop:"Onions",currentYield:25,previousYield:22,efficiency:80}],a=[{size:2.5,profit:65e3,efficiency:88},{size:1.8,profit:45e3,efficiency:85},{size:3.2,profit:95e3,efficiency:92},{size:1.2,profit:32e3,efficiency:78},{size:4.1,profit:125e3,efficiency:95}],r=c=>{switch(c){case"up":return e.jsx(ce,{className:"h-4 w-4 text-green-500"});case"down":return e.jsx(Fs,{className:"h-4 w-4 text-red-500"});default:return e.jsx(Re,{className:"h-4 w-4 text-blue-500"})}},n=c=>{switch(c){case"production":return"bg-green-100 text-green-800";case"financial":return"bg-blue-100 text-blue-800";case"efficiency":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Performance Analytics & KPIs"}),e.jsx("p",{className:"text-muted-foreground",children:"Track your farm's key performance indicators and analytics for Kenyan agriculture"})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(c=>e.jsx(w,{children:e.jsxs(_,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:c.name}),e.jsxs("p",{className:"text-2xl font-bold",children:[c.value.toLocaleString()," ",c.unit]})]}),r(c.trend)]}),e.jsxs("div",{className:"flex justify-between items-center mt-3",children:[e.jsx(I,{className:n(c.category),children:c.category}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Target: ",c.target," ",c.unit]})]}),e.jsx("div",{className:"mt-2",children:e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${c.value>=c.target?"bg-green-500":"bg-yellow-500"}`,style:{width:`${Math.min(c.value/c.target*100,100)}%`}})})})]})},c.id))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Re,{className:"h-5 w-5 text-green-500"}),"Crop Performance Analysis"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Compare current vs previous season yields for major Kenyan crops"})]}),e.jsx(_,{children:e.jsx("div",{className:"h-64 w-full",children:e.jsx(Je,{width:"100%",height:"100%",children:e.jsxs(yt,{data:t,children:[e.jsx(Ns,{strokeDasharray:"3 3"}),e.jsx(bs,{dataKey:"crop",tick:{fontSize:12}}),e.jsx(ws,{}),e.jsx(Xe,{}),e.jsx(us,{dataKey:"currentYield",fill:"#22c55e",name:"Current Season"}),e.jsx(us,{dataKey:"previousYield",fill:"#7c2d12",name:"Previous Season"})]})})})})]}),e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(na,{className:"h-5 w-5 text-blue-500"}),"Land Efficiency vs Profitability"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Analyze the relationship between farm size, efficiency, and profit per hectare"})]}),e.jsx(_,{children:e.jsx("div",{className:"h-64 w-full",children:e.jsx(Je,{width:"100%",height:"100%",children:e.jsxs(hc,{data:a,children:[e.jsx(Ns,{strokeDasharray:"3 3"}),e.jsx(bs,{dataKey:"size",name:"Farm Size (Ha)"}),e.jsx(ws,{dataKey:"profit",name:"Profit (KES)"}),e.jsx(Xe,{formatter:(c,l)=>[l==="profit"?`KES ${c.toLocaleString()}`:`${c}%`,l==="profit"?"Annual Profit":"Efficiency"],labelFormatter:c=>`Farm Size: ${c} Ha`}),e.jsx(pc,{dataKey:"profit",fill:"#3b82f6",children:a.map((c,l)=>e.jsx(Rt,{fill:c.efficiency>85?"#22c55e":"#f59e0b"},`cell-${l}`))})]})})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(w,{children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:e.jsx(Ae,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Revenue"}),e.jsx("p",{className:"text-2xl font-bold",children:"KES 2.4M"}),e.jsx("p",{className:"text-sm text-green-600",children:"+15.3% from last season"})]})]})})}),e.jsx(w,{children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(Re,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"EBITDA Margin"}),e.jsx("p",{className:"text-2xl font-bold",children:"32.5%"}),e.jsx("p",{className:"text-sm text-blue-600",children:"Industry avg: 28%"})]})]})})}),e.jsx(w,{children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-full",children:e.jsx(se,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Market Reach"}),e.jsx("p",{className:"text-2xl font-bold",children:"8 Counties"}),e.jsx("p",{className:"text-sm text-purple-600",children:"Expanding to 12"})]})]})})})]})]})},hu=({onSubmit:s})=>{const{toast:t}=Z(),[a,r]=i.useState({name:"",category:"",quantity:"",unit:"kg",quality:"Grade A",isOrganic:!1,certifications:[],harvestDate:"",description:"",handlingPractices:"",storageConditions:"",images:[],price:"",location:"",availableFrom:"",availableTo:""}),[n,c]=i.useState({sizeUniformity:"",colorUniformity:"",defects:"",cleanlinessLevel:"",packagingType:""}),[l,x]=i.useState(null),[f,j]=i.useState(""),N=["Cereals","Legumes","Cash Crops","Fruits","Vegetables","Dairy","Meat"],g=["Grade A (Premium)","Grade B (Standard)","Grade C (Economy)"],u=[{id:"organic",label:"Organic Certified"},{id:"kebs",label:"KEBS Certified"},{id:"export",label:"Export Quality"},{id:"gmp",label:"Good Manufacturing Practices"}],d=o=>{const{name:y,value:k}=o.target;r(A=>({...A,[y]:k}))},h=(o,y)=>{r(k=>({...k,[o]:y}))},v=o=>{r(y=>{const k=y.certifications;return k.includes(o)?{...y,certifications:k.filter(A=>A!==o)}:{...y,certifications:[...k,o]}})},p=async o=>{var P;const y=(P=o.target.files)==null?void 0:P[0];if(!y)return;if(!["image/jpeg","image/png","image/webp"].includes(y.type)){t({title:"Invalid file type",description:"Only JPEG, PNG, or WebP images are allowed."});return}if(y.size>1024*1024){t({title:"File too large",description:"Image must be less than 1MB."});return}x(y);const{supabase:A}=await Ya(async()=>{const{supabase:R}=await Promise.resolve().then(()=>po);return{supabase:R}},void 0),{data:S,error:E}=await A.storage.from("product-images").upload(`products/${Date.now()}_${y.name}`,y);if(S!=null&&S.path){const{data:R}=A.storage.from("product-images").getPublicUrl(S.path);R!=null&&R.publicUrl&&j(R.publicUrl)}},m=o=>{o.preventDefault();const y={...a,qualityDetails:n,imageUrl:f,submittedAt:new Date};s&&s(y),t({title:"Product Added Successfully",description:"Your product has been added to the marketplace."}),r({name:"",category:"",quantity:"",unit:"kg",quality:"Grade A",isOrganic:!1,certifications:[],harvestDate:"",description:"",handlingPractices:"",storageConditions:"",images:[],price:"",location:"",availableFrom:"",availableTo:""}),c({sizeUniformity:"",colorUniformity:"",defects:"",cleanlinessLevel:"",packagingType:""}),x(null),j("")};return e.jsxs(w,{className:"w-full max-w-3xl mx-auto",children:[e.jsxs(q,{children:[e.jsx(L,{children:"Add Your Agricultural Product"}),e.jsx(G,{children:"Provide detailed information about your product to help buyers assess its quality"})]}),e.jsx(_,{children:e.jsxs("form",{onSubmit:m,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"name",children:"Product Name"}),e.jsx(D,{id:"name",name:"name",value:a.name,onChange:d,placeholder:"e.g., Fresh Tomatoes",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"category",children:"Category"}),e.jsxs(Q,{value:a.category,onValueChange:o=>h("category",o),children:[e.jsx(W,{id:"category",children:e.jsx(J,{placeholder:"Select category"})}),e.jsx(Y,{children:N.map(o=>e.jsx(T,{value:o,children:o},o))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"quantity",children:"Quantity"}),e.jsx(D,{id:"quantity",name:"quantity",type:"number",value:a.quantity,onChange:d,placeholder:"Amount",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"unit",children:"Unit"}),e.jsxs(Q,{value:a.unit,onValueChange:o=>h("unit",o),children:[e.jsx(W,{id:"unit",children:e.jsx(J,{placeholder:"Select unit"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"kg",children:"Kilograms (kg)"}),e.jsx(T,{value:"tonnes",children:"Tonnes"}),e.jsx(T,{value:"boxes",children:"Boxes"}),e.jsx(T,{value:"crates",children:"Crates"}),e.jsx(T,{value:"bags",children:"Bags"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"price",children:"Price (KES per unit)"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"product-image",className:"block text-sm font-medium text-gray-700",children:"Product Image (max 1MB, JPEG/PNG/WebP)"}),e.jsx("input",{type:"file",id:"product-image",accept:"image/jpeg,image/png,image/webp",onChange:p}),f&&e.jsx("img",{src:f,alt:"Product",className:"mt-2 h-24 rounded"})]}),e.jsx(D,{id:"price",name:"price",type:"number",value:a.price,onChange:d,placeholder:"e.g., 150",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"harvestDate",children:"Harvest Date"}),e.jsx(D,{id:"harvestDate",name:"harvestDate",type:"date",value:a.harvestDate,onChange:d,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"location",children:"Location"}),e.jsx(D,{id:"location",name:"location",value:a.location,onChange:d,placeholder:"e.g., Nakuru County",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"description",children:"Product Description"}),e.jsx(le,{id:"description",name:"description",value:a.description,onChange:d,placeholder:"Describe your product in detail",rows:3,required:!0})]})]}),e.jsx(qe,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Quality Information"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"quality",children:"Quality Grade"}),e.jsxs(Q,{value:a.quality,onValueChange:o=>h("quality",o),children:[e.jsx(W,{id:"quality",children:e.jsx(J,{placeholder:"Select quality grade"})}),e.jsx(Y,{children:g.map(o=>e.jsx(T,{value:o,children:o},o))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"sizeUniformity",children:"Size Uniformity"}),e.jsxs(Q,{value:n.sizeUniformity,onValueChange:o=>c(y=>({...y,sizeUniformity:o})),children:[e.jsx(W,{id:"sizeUniformity",children:e.jsx(J,{placeholder:"Select uniformity"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"very-uniform",children:"Very Uniform"}),e.jsx(T,{value:"mostly-uniform",children:"Mostly Uniform"}),e.jsx(T,{value:"somewhat-varied",children:"Somewhat Varied"}),e.jsx(T,{value:"mixed-sizes",children:"Mixed Sizes"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"defects",children:"Defects"}),e.jsxs(Q,{value:n.defects,onValueChange:o=>c(y=>({...y,defects:o})),children:[e.jsx(W,{id:"defects",children:e.jsx(J,{placeholder:"Select defect level"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"none",children:"None to Very Few"}),e.jsx(T,{value:"minor",children:"Minor Defects"}),e.jsx(T,{value:"moderate",children:"Moderate Defects"}),e.jsx(T,{value:"significant",children:"Significant Defects"})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(C,{children:"Certifications & Standards"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:u.map(o=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(De,{id:o.id,checked:a.certifications.includes(o.id),onCheckedChange:()=>v(o.id)}),e.jsx(C,{htmlFor:o.id,className:"font-normal",children:o.label})]},o.id))})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"handlingPractices",children:"Post-Harvest Handling Practices"}),e.jsx(le,{id:"handlingPractices",name:"handlingPractices",value:a.handlingPractices,onChange:d,placeholder:"Describe how the produce was handled after harvesting",rows:2})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"storageConditions",children:"Storage Conditions"}),e.jsx(le,{id:"storageConditions",name:"storageConditions",value:a.storageConditions,onChange:d,placeholder:"Describe current storage conditions",rows:2})]})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx(b,{type:"submit",className:"w-full",children:"Submit Product"})})]})})]})},pu=({userId:s})=>{const[t,a]=i.useState([]),[r,n]=i.useState(!1),[c,l]=i.useState({}),[x,f]=i.useState(null),[j,N]=i.useState(""),[g,u]=i.useState(null);i.useEffect(()=>{d()},[s]);async function d(){n(!0);const{data:m,error:o}=await F.from("animals").select("*").eq("user_id",s);o||a(m||[]),n(!1)}async function h(){n(!0);let m=j;if(x){if(!["image/jpeg","image/png","image/webp"].includes(x.type)){alert("Only JPEG, PNG, or WebP images are allowed."),n(!1);return}if(x.size>1024*1024){alert("Image must be less than 1MB."),n(!1);return}const{data:y}=await F.storage.from("animal-images").upload(`animals/${Date.now()}_${x.name}`,x);if(y!=null&&y.path){const{data:k}=F.storage.from("animal-images").getPublicUrl(y.path);m=k.publicUrl}}g?await F.from("animals").update({...c,image_url:m}).eq("id",g):await F.from("animals").insert({...c,user_id:s,image_url:m}),l({}),f(null),N(""),u(null),d()}async function v(m){n(!0),await F.from("animals").delete().eq("id",m),d()}function p(m){l(m),N(m.image_url||""),u(m.id)}return e.jsxs("div",{className:"max-w-2xl mx-auto p-4 bg-white rounded shadow",children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Animal Management"}),e.jsxs("form",{className:"mb-4 grid grid-cols-2 gap-2",onSubmit:m=>{m.preventDefault(),h()},children:[e.jsx("input",{className:"border p-2 rounded",placeholder:"Name",value:c.name||"",onChange:m=>l(o=>({...o,name:m.target.value})),required:!0}),e.jsx("input",{className:"border p-2 rounded",placeholder:"Species",value:c.species||"",onChange:m=>l(o=>({...o,species:m.target.value})),required:!0}),e.jsx("input",{className:"border p-2 rounded",placeholder:"Breed",value:c.breed||"",onChange:m=>l(o=>({...o,breed:m.target.value}))}),e.jsx("input",{className:"border p-2 rounded",type:"date",placeholder:"Birth Date",value:c.birth_date||"",onChange:m=>l(o=>({...o,birth_date:m.target.value}))}),e.jsx("input",{className:"border p-2 rounded",type:"date",placeholder:"Acquisition Date",value:c.acquisition_date||"",onChange:m=>l(o=>({...o,acquisition_date:m.target.value}))}),e.jsxs("select",{className:"border p-2 rounded",value:c.status||"active",onChange:m=>l(o=>({...o,status:m.target.value})),children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"sold",children:"Sold"}),e.jsx("option",{value:"deceased",children:"Deceased"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{htmlFor:"animal-image",className:"block text-sm font-medium text-gray-700",children:"Animal Image (max 1MB, JPEG/PNG/WebP)"}),e.jsx("input",{type:"file",id:"animal-image",accept:"image/jpeg,image/png,image/webp",onChange:m=>{var y;const o=(y=m.target.files)==null?void 0:y[0];o&&(f(o),N(""))}}),j&&e.jsx("img",{src:j,alt:"Animal",className:"mt-2 h-24 rounded"})]}),e.jsxs(b,{type:"submit",className:"col-span-2",children:[g?"Update":"Add"," Animal"]})]}),r&&e.jsx("div",{children:"Loading..."}),e.jsxs("div",{className:"space-y-2",children:[t.map(m=>e.jsxs(w,{className:"p-2 flex justify-between items-center",children:[e.jsxs(_,{children:[e.jsxs("div",{className:"font-bold flex items-center gap-2",children:[m.image_url&&e.jsx("img",{src:m.image_url,alt:"Animal",className:"h-10 w-10 rounded-full object-cover"}),m.name," (",m.species,")"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Breed: ",m.breed||"N/A"," | Status: ",m.status]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Birth: ",m.birth_date||"N/A"," | Acquired: ",m.acquisition_date||"N/A"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{size:"sm",variant:"outline",onClick:()=>p(m),children:"Edit"}),e.jsx(b,{size:"sm",variant:"destructive",onClick:()=>v(m.id),children:"Delete"})]})]},m.id)),t.length===0&&!r&&e.jsx("div",{className:"text-gray-500",children:"No animals found."})]})]})},On=({userId:s,onSubmitted:t})=>{const[a,r]=i.useState({product:"",quantity:"",unit:"kg",description:"",imageFile:null,imageUrl:""}),[n,c]=i.useState(!1),l=j=>{const{name:N,value:g}=j.target;r(u=>({...u,[N]:g}))},x=async j=>{var d;const N=(d=j.target.files)==null?void 0:d[0];if(!N)return;if(!["image/jpeg","image/png","image/webp"].includes(N.type)){alert("Only JPEG, PNG, or WebP images are allowed.");return}if(N.size>1024*1024){alert("Image must be less than 1MB.");return}r(h=>({...h,imageFile:N}));const{data:u}=await F.storage.from("buy-request-images").upload(`buy-requests/${Date.now()}_${N.name}`,N);if(u!=null&&u.path){const{data:h}=F.storage.from("buy-request-images").getPublicUrl(u.path);r(v=>({...v,imageUrl:h.publicUrl}))}},f=async j=>{j.preventDefault(),c(!0),await F.from("buy_requests").insert({user_id:s,product:a.product,quantity:a.quantity,unit:a.unit,description:a.description,image_url:a.imageUrl}),c(!1),r({product:"",quantity:"",unit:"kg",description:"",imageFile:null,imageUrl:""}),t&&t()};return e.jsxs(w,{className:"max-w-xl mx-auto my-4",children:[e.jsx(q,{children:e.jsx(L,{children:"Post a Buy Request"})}),e.jsx(_,{children:e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsx("input",{className:"border p-2 rounded w-full",name:"product",placeholder:"Product",value:a.product,onChange:l,required:!0}),e.jsx("input",{className:"border p-2 rounded w-full",name:"quantity",placeholder:"Quantity",value:a.quantity,onChange:l,required:!0}),e.jsxs("select",{className:"border p-2 rounded w-full",name:"unit",value:a.unit,onChange:j=>r(N=>({...N,unit:j.target.value})),children:[e.jsx("option",{value:"kg",children:"Kilograms (kg)"}),e.jsx("option",{value:"tonnes",children:"Tonnes"}),e.jsx("option",{value:"bags",children:"Bags"})]}),e.jsx("textarea",{className:"border p-2 rounded w-full",name:"description",placeholder:"Describe your request",value:a.description,onChange:l,required:!0}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"buy-request-image",className:"block text-sm font-medium text-gray-700",children:"Image (max 1MB, JPEG/PNG/WebP)"}),e.jsx("input",{type:"file",id:"buy-request-image",accept:"image/jpeg,image/png,image/webp",onChange:x}),a.imageUrl&&e.jsx("img",{src:a.imageUrl,alt:"Request",className:"mt-2 h-24 rounded"})]}),e.jsx(b,{type:"submit",disabled:n,children:n?"Posting...":"Post Buy Request"})]})})]})},gu=()=>{const[s,t]=i.useState([]),[a,r]=i.useState(!1);i.useEffect(()=>{n()},[]);async function n(){r(!0);const{data:c,error:l}=await F.from("buy_requests").select("*").order("created_at",{ascending:!1});l||t(c||[]),r(!1)}return e.jsxs(w,{className:"max-w-2xl mx-auto my-4",children:[e.jsx(q,{children:e.jsx(L,{children:"Buy Requests"})}),e.jsxs(_,{children:[a&&e.jsx("div",{children:"Loading..."}),s.length===0&&!a&&e.jsx("div",{className:"text-gray-500",children:"No buy requests found."}),e.jsx("div",{className:"space-y-4",children:s.map(c=>e.jsxs("div",{className:"p-4 border rounded flex items-center gap-4",children:[c.image_url&&e.jsx("img",{src:c.image_url,alt:"Request",className:"h-16 w-16 object-cover rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-bold",children:[c.product," (",c.quantity," ",c.unit,")"]}),e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:c.description}),e.jsx(b,{size:"sm",variant:"secondary",onClick:()=>window.open(`mailto:${c.user_id}`),children:"Contact Buyer"})]})]},c.id))})]})]})},ju=()=>{const s=Ne(),{user:t}=je(),[a,r]=i.useState([{id:"1",name:"Maize",category:"Grains",county:"Nakuru",quantity:500,unit:"kg",qualityGrade:"A",availableFrom:"2023-10-15",farmer:"John Kariuki",farmerId:"farmer-1"},{id:"2",name:"Tomatoes",category:"Vegetables",county:"Kiambu",quantity:200,unit:"kg",qualityGrade:"B",availableFrom:"2023-10-20",farmer:"John Kariuki",farmerId:"farmer-1"}]),n=l=>{r(x=>x.filter(f=>f.id!==l))},c=l=>{console.log("Editing produce:",l)};return Bs.useEffect(()=>{t||s("/auth")},[t,s]),t?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(ne,{}),e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Farmer Portal"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your farm operations, crops, and animals"})]}),e.jsxs(ge,{defaultValue:"dashboard",className:"w-full",children:[e.jsx("div",{className:"overflow-x-auto scrollbar-hide",children:e.jsxs(pe,{className:"flex w-max min-w-full space-x-2 px-1",children:[e.jsx(B,{value:"dashboard",children:"Dashboard"}),e.jsx(B,{value:"parcels",children:"Land Parcels"}),e.jsx(B,{value:"crops",children:"Crops"}),e.jsx(B,{value:"animals",children:"Animals"}),e.jsx(B,{value:"inventory",children:"Inventory"}),e.jsx(B,{value:"finances",children:"Finances"}),e.jsx(B,{value:"analytics",children:"Analytics"}),e.jsx(B,{value:"products",children:"My Products"}),e.jsx(B,{value:"buy-requests",children:"Buy Requests"}),e.jsx(B,{value:"add-buy-request",children:"Post Buy Request"}),e.jsx(B,{value:"add-product",children:"Add Product"})]})}),e.jsx(V,{value:"dashboard",children:e.jsx(iu,{})}),e.jsx(V,{value:"parcels",children:e.jsx(cu,{})}),e.jsx(V,{value:"crops",children:e.jsx(ou,{})}),e.jsx(V,{value:"animals",children:e.jsx(pu,{userId:t==null?void 0:t.id})}),e.jsx(V,{value:"inventory",children:e.jsx(du,{})}),e.jsx(V,{value:"finances",children:e.jsx(uu,{})}),e.jsx(V,{value:"analytics",children:e.jsx(xu,{})}),e.jsx(V,{value:"products",children:e.jsx(lu,{userProduce:a,onDeleteProduce:n,onEditProduce:c})}),e.jsx(V,{value:"buy-requests",children:e.jsx(gu,{})}),e.jsx(V,{value:"add-buy-request",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsx(On,{userId:t.id})})}),e.jsx(V,{value:"add-product",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsx(hu,{})})})]})]})]}):null},fu=async s=>{try{const{data:{user:t}}=await F.auth.getUser();if(!t)throw new Error("User not authenticated");const{data:a,error:r}=await F.from("farmer_exporter_collaborations").insert({farmer_id:t.id,...s}).select().single();if(r)throw console.error("Error creating farmer collaboration:",r),r;return a}catch(t){throw console.error("Error creating farmer collaboration:",t),t}},vu=async()=>{try{const{data:s,error:t}=await F.from("farmer_exporter_collaborations").select("*").eq("is_active",!0).order("created_at",{ascending:!1});return t?(console.error("Error fetching farmer collaborations:",t),[]):(s||[]).map(r=>({...r,farmer_coordinates:r.farmer_coordinates}))}catch(s){return console.error("Error fetching farmer collaborations:",s),[]}},yu=async s=>{try{const{data:{user:t}}=await F.auth.getUser();if(!t)throw new Error("User not authenticated");const{data:a,error:r}=await F.from("exporter_profiles").insert({user_id:t.id,...s}).select().single();if(r)throw console.error("Error creating exporter profile:",r),r;return a}catch(t){throw console.error("Error creating exporter profile:",t),t}},Kn=async()=>{try{const{data:s,error:t}=await F.from("exporter_profiles").select("*").eq("is_active",!0).order("rating",{ascending:!1});return t?(console.error("Error fetching exporter profiles:",t),[]):(s||[]).map(r=>({...r,office_coordinates:r.office_coordinates}))}catch(s){return console.error("Error fetching exporter profiles:",s),[]}},Nu=()=>{const[s,t]=i.useState("create"),[a,r]=i.useState(!1),[n,c]=i.useState([]),[l,x]=i.useState([]),{toast:f}=Z(),[j,N]=i.useState({farmer_name:"",farmer_phone:"",farmer_email:"",farmer_location:"",farmer_county:"",farm_size_acres:"",commodity_name:"",commodity_variety:"",estimated_quantity:"",unit:"kg",quality_grade:"",harvest_date:"",availability_period:"",farmer_experience_years:"",has_export_documentation:!1,documentation_needs:[],farmer_profile_description:"",collaboration_type:"supply_partnership",target_markets:[],pricing_expectations:"",special_requirements:[],farmer_certifications:[]});i.useEffect(()=>{g()},[]);const g=async()=>{try{const[p,m]=await Promise.all([vu(),Kn()]);c(p),x(m)}catch(p){console.error("Error loading data:",p)}},u=async p=>{if(p.preventDefault(),!j.farmer_name||!j.farmer_phone||!j.commodity_name||!j.estimated_quantity){f({title:"Missing Information",description:"Please fill in all required fields",variant:"destructive"});return}try{r(!0);const m={...j,estimated_quantity:parseFloat(j.estimated_quantity),farm_size_acres:j.farm_size_acres?parseFloat(j.farm_size_acres):void 0,farmer_experience_years:j.farmer_experience_years?parseInt(j.farmer_experience_years):void 0,collaboration_status:"seeking_exporter",is_active:!0};await fu(m),f({title:"Success",description:"Your collaboration request has been created successfully"}),N({farmer_name:"",farmer_phone:"",farmer_email:"",farmer_location:"",farmer_county:"",farm_size_acres:"",commodity_name:"",commodity_variety:"",estimated_quantity:"",unit:"kg",quality_grade:"",harvest_date:"",availability_period:"",farmer_experience_years:"",has_export_documentation:!1,documentation_needs:[],farmer_profile_description:"",collaboration_type:"supply_partnership",target_markets:[],pricing_expectations:"",special_requirements:[],farmer_certifications:[]}),g()}catch(m){console.error("Error creating collaboration:",m),f({title:"Error",description:"Failed to create collaboration request",variant:"destructive"})}finally{r(!1)}},d=["Nairobi","Kiambu","Nakuru","Kisumu","Machakos","Uasin Gishu","Meru","Nyeri","Murang'a","Kakamega","Bungoma","Trans Nzoia","Nandi","Kericho","Bomet"],h=["Maize","Wheat","Rice","Beans","Potatoes","Sweet Potatoes","Tomatoes","Onions","Carrots","Cabbages","Spinach","Bananas","Mangoes","Avocados","Coffee","Tea","Pyrethrum","Cotton","Sunflower","Groundnuts"],v=["Export License","Phytosanitary Certificate","Certificate of Origin","Quality Certificates","Organic Certification","Fair Trade Certification"];return e.jsxs("div",{className:"container py-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Farmer-Exporter Collaboration"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Connect with exporters to access international markets and get help with documentation"})]}),e.jsxs(ge,{value:s,onValueChange:t,className:"w-full",children:[e.jsxs(pe,{className:"w-full flex flex-col sm:flex-row h-auto sm:h-10 p-1 gap-1",children:[e.jsx(B,{value:"create",className:"flex-1 text-xs sm:text-sm py-2 px-3 whitespace-nowrap",children:"Create Request"}),e.jsx(B,{value:"browse",className:"flex-1 text-xs sm:text-sm py-2 px-3 whitespace-nowrap",children:"Browse Requests"}),e.jsx(B,{value:"exporters",className:"flex-1 text-xs sm:text-sm py-2 px-3 whitespace-nowrap",children:"Find Exporters"})]}),e.jsx(V,{value:"create",className:"space-y-6",children:e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Create Collaboration Request"}),e.jsx(G,{children:"Tell exporters about your produce and what kind of collaboration you're looking for"})]}),e.jsx(_,{children:e.jsxs("form",{onSubmit:u,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Farmer Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"farmer_name",children:"Full Name *"}),e.jsx(D,{id:"farmer_name",value:j.farmer_name,onChange:p=>N(m=>({...m,farmer_name:p.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"farmer_phone",children:"Phone Number *"}),e.jsx(D,{id:"farmer_phone",value:j.farmer_phone,onChange:p=>N(m=>({...m,farmer_phone:p.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"farmer_email",children:"Email Address"}),e.jsx(D,{id:"farmer_email",type:"email",value:j.farmer_email,onChange:p=>N(m=>({...m,farmer_email:p.target.value}))})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"farmer_county",children:"County *"}),e.jsxs(Q,{value:j.farmer_county,onValueChange:p=>N(m=>({...m,farmer_county:p})),children:[e.jsx(W,{children:e.jsx(J,{placeholder:"Select county"})}),e.jsx(Y,{children:d.map(p=>e.jsx(T,{value:p,children:p},p))})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(C,{htmlFor:"farmer_location",children:"Specific Location *"}),e.jsx(D,{id:"farmer_location",value:j.farmer_location,onChange:p=>N(m=>({...m,farmer_location:p.target.value})),placeholder:"e.g., Kiambu Town, near ABC Market",required:!0})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Commodity Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"commodity_name",children:"Commodity *"}),e.jsxs(Q,{value:j.commodity_name,onValueChange:p=>N(m=>({...m,commodity_name:p})),children:[e.jsx(W,{children:e.jsx(J,{placeholder:"Select commodity"})}),e.jsx(Y,{children:h.map(p=>e.jsx(T,{value:p,children:p},p))})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"commodity_variety",children:"Variety"}),e.jsx(D,{id:"commodity_variety",value:j.commodity_variety,onChange:p=>N(m=>({...m,commodity_variety:p.target.value})),placeholder:"e.g., H614 for maize"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"estimated_quantity",children:"Estimated Quantity *"}),e.jsx(D,{id:"estimated_quantity",type:"number",value:j.estimated_quantity,onChange:p=>N(m=>({...m,estimated_quantity:p.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"unit",children:"Unit"}),e.jsxs(Q,{value:j.unit,onValueChange:p=>N(m=>({...m,unit:p})),children:[e.jsx(W,{children:e.jsx(J,{})}),e.jsxs(Y,{children:[e.jsx(T,{value:"kg",children:"Kilograms"}),e.jsx(T,{value:"tons",children:"Tons"}),e.jsx(T,{value:"bags",children:"Bags"}),e.jsx(T,{value:"crates",children:"Crates"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Documentation & Requirements"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(De,{id:"has_export_documentation",checked:j.has_export_documentation,onCheckedChange:p=>N(m=>({...m,has_export_documentation:!!p}))}),e.jsx(C,{htmlFor:"has_export_documentation",children:"I already have export documentation"})]}),!j.has_export_documentation&&e.jsxs("div",{children:[e.jsx(C,{children:"What documentation do you need help with?"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 mt-2",children:v.map(p=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(De,{id:p,checked:j.documentation_needs.includes(p),onCheckedChange:m=>{N(m?o=>({...o,documentation_needs:[...o.documentation_needs,p]}):o=>({...o,documentation_needs:o.documentation_needs.filter(y=>y!==p)}))}}),e.jsx(C,{htmlFor:p,className:"text-sm",children:p})]},p))})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"farmer_profile_description",children:"About Your Farm"}),e.jsx(le,{id:"farmer_profile_description",value:j.farmer_profile_description,onChange:p=>N(m=>({...m,farmer_profile_description:p.target.value})),placeholder:"Tell exporters about your farming experience, practices, and what makes your produce special...",rows:4})]}),e.jsx(b,{type:"submit",disabled:a,className:"w-full",children:a?"Creating...":"Create Collaboration Request"})]})})]})}),e.jsx(V,{value:"browse",className:"space-y-6",children:e.jsx("div",{className:"grid gap-6",children:n.map(p=>e.jsxs(w,{children:[e.jsx(q,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-5 w-5"}),p.commodity_name,p.commodity_variety&&` (${p.commodity_variety})`]}),e.jsxs(G,{className:"flex items-center gap-4 mt-2",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(vs,{className:"h-4 w-4"}),p.farmer_name]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ee,{className:"h-4 w-4"}),p.farmer_county]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(re,{className:"h-4 w-4"}),p.estimated_quantity," ",p.unit]})]})]}),e.jsx(I,{variant:p.collaboration_status==="seeking_exporter"?"default":"secondary",children:p.collaboration_status.replace("_"," ")})]})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[p.farmer_profile_description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:p.farmer_profile_description}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("span",{className:"flex items-center gap-1 text-sm",children:[e.jsx(Ee,{className:"h-4 w-4"}),p.farmer_phone]}),p.farmer_email&&e.jsxs("span",{className:"flex items-center gap-1 text-sm",children:[e.jsx(He,{className:"h-4 w-4"}),p.farmer_email]}),p.harvest_date&&e.jsxs("span",{className:"flex items-center gap-1 text-sm",children:[e.jsx(xe,{className:"h-4 w-4"}),"Harvest: ",new Date(p.harvest_date).toLocaleDateString()]})]}),!p.has_export_documentation&&p.documentation_needs&&p.documentation_needs.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Documentation Needs:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:p.documentation_needs.map(m=>e.jsx(I,{variant:"outline",className:"text-xs",children:m},m))})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Posted ",new Date(p.created_at).toLocaleDateString()]}),e.jsx(b,{size:"sm",children:"Contact Farmer"})]})]})})]},p.id))})}),e.jsx(V,{value:"exporters",className:"space-y-6",children:e.jsx("div",{className:"grid gap-6",children:l.map(p=>e.jsxs(w,{children:[e.jsx(q,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Ye,{className:"h-5 w-5"}),p.company_name]}),e.jsxs(G,{className:"flex items-center gap-4 mt-2",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(vs,{className:"h-4 w-4"}),p.contact_person_name]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ee,{className:"h-4 w-4"}),p.office_county]}),p.years_in_business&&e.jsxs("span",{className:"text-sm",children:[p.years_in_business," years in business"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold",children:[p.rating.toFixed(1),"/5"]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[p.total_collaborations," collaborations"]})]})]})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[p.company_description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:p.company_description}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Export Markets:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:p.export_markets.map(m=>e.jsxs(I,{variant:"outline",className:"text-xs",children:[e.jsx(Le,{className:"h-3 w-3 mr-1"}),m]},m))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Commodities Handled:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:p.commodities_handled.map(m=>e.jsx(I,{variant:"secondary",className:"text-xs",children:m},m))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Services Offered:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:p.services_offered.map(m=>e.jsx(I,{variant:"outline",className:"text-xs",children:m},m))})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[e.jsxs("div",{className:"flex gap-2 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ee,{className:"h-4 w-4"}),p.contact_phone]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(He,{className:"h-4 w-4"}),p.contact_email]})]}),e.jsx(b,{size:"sm",children:"Contact Exporter"})]})]})})]},p.id))})})]})]})},bu=()=>{const[s,t]=i.useState(!1),[a,r]=i.useState(null),[n,c]=i.useState(!1),{toast:l}=Z(),{user:x}=je(),[f,j]=i.useState({company_name:"",company_registration_number:"",business_license_number:"",export_license_number:"",company_description:"",contact_person_name:"",contact_phone:"",contact_email:"",office_location:"",office_county:"",website_url:"",years_in_business:"",export_markets:[],commodities_handled:[],services_offered:[],minimum_quantity_tons:"",maximum_quantity_tons:"",certifications:[],documentation_services:!0,logistics_services:!1,quality_assurance_services:!1,financing_services:!1,is_active:!0});i.useEffect(()=>{N()},[]);const N=async()=>{try{const v=await Kn();v.length>0&&r(v[0])}catch(v){console.error("Error checking existing profile:",v)}},g=async v=>{if(v.preventDefault(),!f.company_name||!f.contact_person_name||!f.contact_phone||!f.contact_email){l({title:"Missing Information",description:"Please fill in all required fields",variant:"destructive"});return}try{t(!0);const p={...f,years_in_business:f.years_in_business?parseInt(f.years_in_business):void 0,minimum_quantity_tons:f.minimum_quantity_tons?parseFloat(f.minimum_quantity_tons):void 0,maximum_quantity_tons:f.maximum_quantity_tons?parseFloat(f.maximum_quantity_tons):void 0};await yu(p),l({title:"Success",description:"Your exporter profile has been created successfully"}),N()}catch(p){console.error("Error creating exporter profile:",p),l({title:"Error",description:"Failed to create exporter profile",variant:"destructive"})}finally{t(!1)}},u=["East Africa","Europe","Middle East","Asia","North America","Australia","South Africa","West Africa","South America"],d=["Maize","Wheat","Rice","Beans","Potatoes","Sweet Potatoes","Tomatoes","Onions","Carrots","Cabbages","Spinach","Bananas","Mangoes","Avocados","Coffee","Tea","Pyrethrum","Cotton","Sunflower","Groundnuts"],h=["Documentation Support","Quality Certification","Logistics Coordination","Market Access","Price Negotiation","Payment Processing","Insurance","Storage Services","Transport Arrangement","Customs Clearance"];return a?e.jsxs("div",{className:"container py-6",children:[e.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Exporter Profile"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Your exporter profile is active and visible to farmers"})]}),e.jsxs(b,{onClick:()=>c(!n),variant:n?"default":"outline",children:[e.jsx(mt,{className:"h-4 w-4 mr-2"}),n?"Hide QR Code":"Trust Passport QR"]})]}),n&&x&&e.jsx("div",{className:"mb-6",children:e.jsx(En,{userId:x.id,userType:"service_provider",profileData:{full_name:a.company_name,verification_status:"verified",phone:a.contact_phone}})}),e.jsxs(w,{children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ye,{className:"h-8 w-8"}),e.jsxs("div",{children:[e.jsx(L,{children:a.company_name}),e.jsx(G,{children:a.contact_person_name})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-5 w-5 text-green-500"}),e.jsx("span",{className:"text-green-600 font-medium",children:"Active Profile"})]})]})}),e.jsxs(_,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Export Markets"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:a.export_markets.map(v=>e.jsxs(I,{variant:"outline",children:[e.jsx(Le,{className:"h-3 w-3 mr-1"}),v]},v))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Commodities Handled"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:a.commodities_handled.map(v=>e.jsxs(I,{variant:"secondary",children:[e.jsx(re,{className:"h-3 w-3 mr-1"}),v]},v))})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Services Offered"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:a.services_offered.map(v=>e.jsx(I,{variant:"outline",children:v},v))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:a.rating.toFixed(1)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Rating"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:a.total_collaborations}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Collaborations"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:a.successful_exports}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Successful Exports"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(b,{variant:"outline",children:"Edit Profile"})})]})]})]}):e.jsxs("div",{className:"container py-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Create Exporter Profile"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Create your profile to connect with farmers who need export services"})]}),e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Exporter Information"}),e.jsx(G,{children:"Provide detailed information about your export business to help farmers find you"})]}),e.jsx(_,{children:e.jsxs("form",{onSubmit:g,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Company Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"company_name",children:"Company Name *"}),e.jsx(D,{id:"company_name",value:f.company_name,onChange:v=>j(p=>({...p,company_name:v.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"company_registration_number",children:"Registration Number"}),e.jsx(D,{id:"company_registration_number",value:f.company_registration_number,onChange:v=>j(p=>({...p,company_registration_number:v.target.value}))})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"business_license_number",children:"Business License"}),e.jsx(D,{id:"business_license_number",value:f.business_license_number,onChange:v=>j(p=>({...p,business_license_number:v.target.value}))})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"export_license_number",children:"Export License"}),e.jsx(D,{id:"export_license_number",value:f.export_license_number,onChange:v=>j(p=>({...p,export_license_number:v.target.value}))})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"company_description",children:"Company Description"}),e.jsx(le,{id:"company_description",value:f.company_description,onChange:v=>j(p=>({...p,company_description:v.target.value})),placeholder:"Describe your company, experience, and what sets you apart...",rows:4})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Contact Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"contact_person_name",children:"Contact Person *"}),e.jsx(D,{id:"contact_person_name",value:f.contact_person_name,onChange:v=>j(p=>({...p,contact_person_name:v.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"contact_phone",children:"Phone Number *"}),e.jsx(D,{id:"contact_phone",value:f.contact_phone,onChange:v=>j(p=>({...p,contact_phone:v.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"contact_email",children:"Email Address *"}),e.jsx(D,{id:"contact_email",type:"email",value:f.contact_email,onChange:v=>j(p=>({...p,contact_email:v.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"website_url",children:"Website"}),e.jsx(D,{id:"website_url",type:"url",value:f.website_url,onChange:v=>j(p=>({...p,website_url:v.target.value}))})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Export Markets"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:u.map(v=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(De,{id:v,checked:f.export_markets.includes(v),onCheckedChange:p=>{j(p?m=>({...m,export_markets:[...m.export_markets,v]}):m=>({...m,export_markets:m.export_markets.filter(o=>o!==v)}))}}),e.jsx(C,{htmlFor:v,className:"text-sm",children:v})]},v))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Commodities Handled"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:d.map(v=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(De,{id:v,checked:f.commodities_handled.includes(v),onCheckedChange:p=>{j(p?m=>({...m,commodities_handled:[...m.commodities_handled,v]}):m=>({...m,commodities_handled:m.commodities_handled.filter(o=>o!==v)}))}}),e.jsx(C,{htmlFor:v,className:"text-sm",children:v})]},v))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Services Offered"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:h.map(v=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(De,{id:v,checked:f.services_offered.includes(v),onCheckedChange:p=>{j(p?m=>({...m,services_offered:[...m.services_offered,v]}):m=>({...m,services_offered:m.services_offered.filter(o=>o!==v)}))}}),e.jsx(C,{htmlFor:v,className:"text-sm",children:v})]},v))})]}),e.jsx(b,{type:"submit",disabled:s,className:"w-full",children:s?"Creating Profile...":"Create Exporter Profile"})]})})]})]})},Pa=[{id:"1",farmerName:"John Kimani",farmerLocation:"Nakuru",farmerAvatar:"/placeholder.svg",title:"Doubling My Potato Yield with Modern Farming Techniques",summary:"How I transformed my small farm from producing 5 tons to 12 tons of potatoes per season",content:"When I started farming potatoes five years ago, I was struggling with poor yields and pest problems. After attending a training session organized by the local agricultural office, I learned about proper spacing, quality certified seeds, and integrated pest management. I implemented these practices and saw amazing results within just one season. My yields doubled, and the quality of potatoes improved significantly, allowing me to negotiate better prices with buyers. I also joined a cooperative that helped me access reliable markets and negotiate as a group.",cropType:"Potatoes",tags:["modern techniques","yield improvement","pest management","certified seeds"],likes:128,comments:23,publishedDate:new Date("2025-03-15"),verified:!0},{id:"2",farmerName:"Sarah Wanjiku",farmerLocation:"Kiambu",farmerAvatar:"/placeholder.svg",title:"From Market Frustration to Direct Exports: My Avocado Journey",summary:"How joining a farmer group helped me bypass middlemen and access export markets directly",content:"I used to sell my avocados to middlemen who would offer very low prices, claiming that the market was flooded. After joining a local farmer group, we pooled our resources to meet the volume requirements of exporters. We also invested in Global GAP certification, which opened doors to premium markets in Europe. Today, I receive three times the price I used to get from middlemen, and payments are transparent and timely. This success has allowed me to expand my farm from 1 acre to 5 acres and invest in a drip irrigation system.",cropType:"Avocados",tags:["export market","value addition","farmer group","certification"],likes:236,comments:41,publishedDate:new Date("2025-02-28"),verified:!0},{id:"3",farmerName:"David Ochieng",farmerLocation:"Kisumu",farmerAvatar:"/placeholder.svg",title:"Weather-Proofing My Farm: Success with Climate-Smart Agriculture",summary:"Using water harvesting and drought-resistant varieties to maintain profitability despite climate challenges",content:"After three consecutive seasons of crop failure due to erratic rainfall, I decided to invest in climate-smart agricultural practices. I constructed water pans that harvest rainwater during the rainy season, which I then use for supplemental irrigation during dry spells. I also switched to drought-resistant maize varieties that can withstand water stress. The results were immediate - while my neighbors experienced significant losses during a recent drought, I maintained about 80% of my normal yield. I've now become a demonstration farmer, teaching others in my community about these techniques.",cropType:"Maize",tags:["climate-smart","water harvesting","drought-resistant","adaptation"],likes:157,comments:29,publishedDate:new Date("2025-04-05"),verified:!0},{id:"4",farmerName:"Alice Muthoni",farmerLocation:"Meru",farmerAvatar:"/placeholder.svg",title:"Transforming My Tomato Business with Value Addition",summary:"How I started making tomato paste to reduce post-harvest losses and increase profits",content:"I used to lose about 30% of my tomato harvest due to gluts in the market and transportation challenges. After attending a value addition workshop, I invested in simple processing equipment to make tomato paste. Now, whenever market prices drop below profitable levels, I process the tomatoes into paste and sell it to local schools, restaurants, and individual consumers. This has increased my income by 45% and virtually eliminated post-harvest losses. I've also created employment for three young people from my community who help with processing and marketing.",cropType:"Tomatoes",tags:["value addition","post-harvest","processing","employment creation"],likes:192,comments:37,publishedDate:new Date("2025-03-22"),verified:!0}],Or=()=>{const[s,t]=i.useState("all"),[a,r]=i.useState(""),[n,c]=i.useState(Pa);i.useEffect(()=>{document.title="Farmer Success Stories | Kilimo Connect";let x=[...Pa];s!=="all"&&(x=x.filter(f=>f.cropType.toLowerCase()===s.toLowerCase())),a&&(x=x.filter(f=>f.tags.some(j=>j.toLowerCase().includes(a.toLowerCase())))),c(x)},[s,a]);const l=Array.from(new Set(Pa.flatMap(x=>x.tags)));return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx("header",{className:"sticky top-0 z-30 w-full border-b bg-background",children:e.jsx("div",{className:"container flex h-16 items-center",children:e.jsx($e,{})})}),e.jsxs("main",{className:"flex-1 container py-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Farmer Success Stories"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Learn from the experiences of successful farmers across Kenya"})]}),e.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[e.jsx(ge,{defaultValue:"all",value:s,onValueChange:t,className:"w-full sm:w-auto",children:e.jsxs(pe,{children:[e.jsx(B,{value:"all",children:"All Crops"}),e.jsx(B,{value:"potatoes",children:"Potatoes"}),e.jsx(B,{value:"avocados",children:"Avocados"}),e.jsx(B,{value:"maize",children:"Maize"}),e.jsx(B,{value:"tomatoes",children:"Tomatoes"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{variant:"outline",children:"Filter"}),e.jsx(b,{children:"Share Your Success"})]})]}),e.jsxs("div",{className:"mb-6 flex flex-wrap gap-2",children:[e.jsx(I,{variant:a===""?"default":"outline",className:"cursor-pointer",onClick:()=>r(""),children:"All Tags"}),l.map(x=>e.jsx(I,{variant:a===x?"default":"outline",className:"cursor-pointer",onClick:()=>r(x===a?"":x),children:x},x))]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.map(x=>e.jsxs(w,{children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(Us,{children:[e.jsx(rt,{src:x.farmerAvatar,alt:x.farmerName}),e.jsx(Vs,{children:x.farmerName.substring(0,2).toUpperCase()})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-lg",children:x.farmerName}),e.jsx(G,{children:x.farmerLocation})]})]}),x.verified&&e.jsx(I,{variant:"secondary",children:"Verified Success"})]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-xl",children:x.title}),e.jsx("p",{className:"text-muted-foreground mt-1",children:x.summary})]}),e.jsx("div",{className:"text-sm line-clamp-3",children:x.content}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(I,{variant:"outline",children:x.cropType}),x.tags.slice(0,2).map(f=>e.jsx(I,{variant:"outline",children:f},f)),x.tags.length>2&&e.jsxs(I,{variant:"outline",children:["+",x.tags.length-2," more"]})]})]}),e.jsxs(me,{className:"flex justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(We,{className:"h-4 w-4 mr-1"}),x.likes]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(Ue,{className:"h-4 w-4 mr-1"}),x.comments]}),e.jsx("span",{children:x.publishedDate.toLocaleDateString()})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(b,{variant:"ghost",size:"sm",children:[e.jsx(gc,{className:"h-4 w-4 mr-1"}),"Share"]}),e.jsx(b,{size:"sm",children:"Read More"})]})]})]},x.id)),n.length===0&&e.jsxs("div",{className:"col-span-full text-center p-12",children:[e.jsx("div",{className:"mb-4 text-muted-foreground",children:e.jsx(Ds,{className:"mx-auto h-12 w-12 opacity-50"})}),e.jsx("h3",{className:"text-lg font-medium",children:"No success stories found"}),e.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"Try changing your filters or be the first to share a success story for this category."}),e.jsx(b,{className:"mt-4",children:"Share Your Success"})]})]})]})]})},ur=i.forwardRef(({className:s,...t},a)=>e.jsx(tn,{className:$("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...t,ref:a,children:e.jsx(jc,{className:$("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));ur.displayName=tn.displayName;const wu=({onSubmit:s,onCancel:t})=>{const[a,r]=i.useState(""),[n,c]=i.useState(""),[l,x]=i.useState("general"),[f,j]=i.useState(""),[N,g]=i.useState([]),[u,d]=i.useState(""),[h,v]=i.useState(!1),[p,m]=i.useState(""),[o,y]=i.useState(["",""]),k=()=>{u.trim()&&!N.includes(u.trim())&&(g([...N,u.trim()]),d(""))},A=M=>{g(N.filter(O=>O!==M))},S=()=>{y([...o,""])},E=(M,O)=>{const te=[...o];te[M]=O,y(te)},P=M=>{o.length>2&&y(o.filter((O,te)=>te!==M))},R=M=>{M.preventDefault();const O={title:a,content:n,category:l,location:f||null,tags:N,poll:h?{question:p,options:o.filter(te=>te.trim())}:null};s(O)};return e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"Create New Post"})}),e.jsx(_,{children:e.jsxs("form",{onSubmit:R,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"title",children:"Title"}),e.jsx(D,{id:"title",value:a,onChange:M=>r(M.target.value),placeholder:"What's your post about?",required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"content",children:"Content"}),e.jsx(le,{id:"content",value:n,onChange:M=>c(M.target.value),placeholder:"Share your thoughts, questions, or experiences...",rows:4,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"category",children:"Category"}),e.jsxs(Q,{value:l,onValueChange:x,children:[e.jsx(W,{children:e.jsx(J,{})}),e.jsxs(Y,{children:[e.jsx(T,{value:"general",children:"General Discussion"}),e.jsx(T,{value:"crops",children:"Crops & Farming"}),e.jsx(T,{value:"livestock",children:"Livestock"}),e.jsx(T,{value:"market",children:"Market Information"}),e.jsx(T,{value:"technology",children:"Technology"}),e.jsx(T,{value:"weather",children:"Weather & Climate"}),e.jsx(T,{value:"business",children:"Agribusiness"})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"location",children:"Location (Optional)"}),e.jsx(D,{id:"location",value:f,onChange:M=>j(M.target.value),placeholder:"County or region"})]})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:N.map(M=>e.jsxs(I,{variant:"secondary",className:"flex items-center gap-1",children:[M,e.jsx(Be,{className:"h-3 w-3 cursor-pointer",onClick:()=>A(M)})]},M))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{value:u,onChange:M=>d(M.target.value),placeholder:"Add a tag",onKeyPress:M=>M.key==="Enter"&&(M.preventDefault(),k())}),e.jsx(b,{type:"button",variant:"outline",onClick:k,children:e.jsx(ie,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ur,{id:"poll-toggle",checked:h,onCheckedChange:v}),e.jsxs(C,{htmlFor:"poll-toggle",className:"flex items-center gap-2",children:[e.jsx(Re,{className:"h-4 w-4"}),"Add a poll"]})]}),h&&e.jsx(w,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"poll-question",children:"Poll Question"}),e.jsx(D,{id:"poll-question",value:p,onChange:M=>m(M.target.value),placeholder:"What would you like to ask?",required:h})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Poll Options"}),o.map((M,O)=>e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(D,{value:M,onChange:te=>E(O,te.target.value),placeholder:`Option ${O+1}`,required:h}),o.length>2&&e.jsx(b,{type:"button",variant:"outline",size:"sm",onClick:()=>P(O),children:e.jsx(Be,{className:"h-4 w-4"})})]},O)),e.jsxs(b,{type:"button",variant:"outline",size:"sm",onClick:S,className:"mt-2",children:[e.jsx(ie,{className:"h-4 w-4 mr-1"}),"Add Option"]})]})]})}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(b,{type:"button",variant:"outline",onClick:t,children:"Cancel"}),e.jsx(b,{type:"submit",children:"Create Post"})]})]})})]})},_u=({post:s,onLike:t,onComment:a,onShare:r,onVote:n,onUpdate:c,onDelete:l})=>{const{user:x}=je(),{toast:f}=Z(),[j,N]=i.useState(!1),[g,u]=i.useState(!1),[d,h]=i.useState(!1),[v,p]=i.useState(!1),[m,o]=i.useState(!1),[y,k]=i.useState(s.title),[A,S]=i.useState(s.content),[E,P]=i.useState(""),[R,M]=i.useState(!1),[O,te]=i.useState(s.likes),ue=(x==null?void 0:x.id)===s.author.id,z=async()=>{if(!x){f({title:"Please login",description:"You must be logged in to like posts",variant:"destructive"});return}try{j?(await F.from("community_post_likes").delete().eq("post_id",s.id).eq("user_id",x.id),te(he=>he-1)):(await F.from("community_post_likes").insert({post_id:s.id,user_id:x.id}),te(he=>he+1)),N(!j),t==null||t(s.id)}catch(he){console.error("Error toggling like:",he)}},U=async()=>{if(!(!y.trim()||!A.trim())){M(!0);try{const{error:he}=await F.from("community_posts").update({title:y,content:A,updated_at:new Date().toISOString()}).eq("id",s.id);if(he)throw he;f({title:"Success",description:"Post updated successfully"}),h(!1),c==null||c()}catch{f({title:"Error",description:"Failed to update post",variant:"destructive"})}finally{M(!1)}}},K=async()=>{M(!0);try{const{error:he}=await F.from("community_posts").update({status:"deleted"}).eq("id",s.id);if(he)throw he;f({title:"Success",description:"Post deleted successfully"}),p(!1),l==null||l()}catch{f({title:"Error",description:"Failed to delete post",variant:"destructive"})}finally{M(!1)}},ae=async()=>{if(!(!x||!E.trim())){M(!0);try{const{error:he}=await F.from("community_comments").insert({post_id:s.id,author_id:x.id,content:E});if(he)throw he;f({title:"Success",description:"Comment added"}),P(""),o(!1),a==null||a(s.id)}catch{f({title:"Error",description:"Failed to add comment",variant:"destructive"})}finally{M(!1)}}},be=he=>{s.poll&&s.poll.userVote===void 0&&(n==null||n(s.poll.id,he))},ts=(he,Rs)=>Rs>0?he/Rs*100:0,ls=()=>{u(!g),r==null||r(s.id)};return e.jsxs(e.Fragment,{children:[e.jsxs(w,{className:"w-full",children:[e.jsx(q,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(Us,{children:[e.jsx(rt,{src:s.author.avatar}),e.jsx(Vs,{children:s.author.name.split(" ").map(he=>he[0]).join("").toUpperCase()})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h4",{className:"font-medium truncate",children:s.author.name}),s.author.isVerified&&e.jsx(I,{variant:"secondary",className:"text-xs",children:"Verified"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground flex-wrap",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(xe,{className:"h-3 w-3 flex-shrink-0"}),Hi(new Date(s.createdAt),{addSuffix:!0})]}),s.location&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"â€¢"}),e.jsx(ee,{className:"h-3 w-3 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:s.location})]})]})]})]}),e.jsxs(Ja,{children:[e.jsx(Xa,{asChild:!0,children:e.jsx(b,{variant:"ghost",size:"sm",children:e.jsx(fc,{className:"h-4 w-4"})})}),e.jsxs(ua,{align:"end",children:[ue&&e.jsxs(e.Fragment,{children:[e.jsxs(fs,{onClick:()=>h(!0),children:[e.jsx(tt,{className:"h-4 w-4 mr-2"}),"Edit Post"]}),e.jsxs(fs,{onClick:()=>p(!0),className:"text-destructive",children:[e.jsx(at,{className:"h-4 w-4 mr-2"}),"Delete Post"]})]}),e.jsxs(fs,{onClick:ls,children:[e.jsx(Js,{className:"h-4 w-4 mr-2"}),"Share"]})]})]})]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:s.title}),e.jsx("p",{className:"text-muted-foreground leading-relaxed",children:s.content})]}),s.poll&&e.jsxs(w,{className:"p-4 bg-muted/20",children:[e.jsx("h4",{className:"font-medium mb-3",children:s.poll.question}),e.jsx("div",{className:"space-y-2",children:s.poll.options.map((he,Rs)=>{const Ot=ts(he.votes,s.poll.totalVotes),bt=s.poll.userVote!==void 0,ze=s.poll.userVote===Rs;return e.jsx("div",{className:"space-y-1",children:e.jsxs(b,{variant:ze?"default":"outline",className:"w-full justify-start relative overflow-hidden",onClick:()=>be(Rs),disabled:bt,children:[bt&&e.jsx("div",{className:"absolute left-0 top-0 h-full bg-primary/20 transition-all",style:{width:`${Ot}%`}}),e.jsx("span",{className:"relative z-10",children:he.text}),bt&&e.jsxs("span",{className:"relative z-10 ml-auto text-sm",children:[he.votes," (",Ot.toFixed(1),"%)"]})]})},Rs)})}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:[s.poll.totalVotes," total votes"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(I,{variant:"outline",children:s.category}),s.tags.map(he=>e.jsxs(I,{variant:"secondary",children:["#",he]},he))]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(b,{variant:"ghost",size:"sm",onClick:z,className:j?"text-red-500":"",children:[e.jsx(We,{className:`h-4 w-4 mr-1 ${j?"fill-current":""}`}),O]}),e.jsxs(b,{variant:"ghost",size:"sm",onClick:()=>o(!0),children:[e.jsx(ys,{className:"h-4 w-4 mr-1"}),s.comments]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(b,{variant:"ghost",size:"sm",onClick:ls,children:e.jsx(Js,{className:"h-4 w-4"})})})]}),g&&e.jsx("div",{className:"pt-2 border-t",children:e.jsx(rr,{title:`${s.title} by ${s.author.name}`,text:`${s.content}

Shared from SokoConnect Community Forum`,size:"sm"})})]})]}),e.jsx(_e,{open:d,onOpenChange:h,children:e.jsxs(we,{children:[e.jsx(Ce,{children:e.jsx(ke,{children:"Edit Post"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(D,{value:y,onChange:he=>k(he.target.value),placeholder:"Post title"}),e.jsx(le,{value:A,onChange:he=>S(he.target.value),placeholder:"Post content",rows:4})]}),e.jsxs(Ze,{children:[e.jsx(b,{variant:"outline",onClick:()=>h(!1),children:"Cancel"}),e.jsx(b,{onClick:U,disabled:R,children:R?"Saving...":"Save Changes"})]})]})}),e.jsx(_e,{open:v,onOpenChange:p,children:e.jsxs(we,{children:[e.jsx(Ce,{children:e.jsx(ke,{children:"Delete Post"})}),e.jsx("p",{className:"text-muted-foreground",children:"Are you sure you want to delete this post? This action cannot be undone."}),e.jsxs(Ze,{children:[e.jsx(b,{variant:"outline",onClick:()=>p(!1),children:"Cancel"}),e.jsx(b,{variant:"destructive",onClick:K,disabled:R,children:R?"Deleting...":"Delete"})]})]})}),e.jsx(_e,{open:m,onOpenChange:o,children:e.jsxs(we,{children:[e.jsx(Ce,{children:e.jsx(ke,{children:"Add Comment"})}),e.jsx(le,{value:E,onChange:he=>P(he.target.value),placeholder:"Write your comment...",rows:3}),e.jsxs(Ze,{children:[e.jsx(b,{variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsx(b,{onClick:ae,disabled:R||!E.trim(),children:R?"Posting...":"Post Comment"})]})]})})]})},Cu=({searchTerm:s,onSearchChange:t,category:a,onCategoryChange:r,sortBy:n,onSortChange:c})=>e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Pe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(D,{placeholder:"Search posts, topics, or keywords...",value:s,onChange:l=>t(l.target.value),className:"pl-10"})]}),e.jsxs(Q,{value:a,onValueChange:r,children:[e.jsx(W,{className:"w-full sm:w-48",children:e.jsx(J,{placeholder:"All Categories"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Categories"}),e.jsx(T,{value:"general",children:"General Discussion"}),e.jsx(T,{value:"crops",children:"Crops & Farming"}),e.jsx(T,{value:"livestock",children:"Livestock"}),e.jsx(T,{value:"market",children:"Market Information"}),e.jsx(T,{value:"technology",children:"Technology"}),e.jsx(T,{value:"weather",children:"Weather & Climate"}),e.jsx(T,{value:"business",children:"Agribusiness"})]})]}),e.jsxs(Q,{value:n,onValueChange:c,children:[e.jsx(W,{className:"w-full sm:w-48",children:e.jsx(J,{placeholder:"Sort by"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"recent",children:"Most Recent"}),e.jsx(T,{value:"popular",children:"Most Popular"}),e.jsx(T,{value:"commented",children:"Most Commented"}),e.jsx(T,{value:"oldest",children:"Oldest First"})]})]})]}),ku="/assets/community-hero-bg-B5jXg5Cr.png",Su=()=>{const{user:s}=je(),{toast:t}=Z(),[a,r]=i.useState([]),[n,c]=i.useState(!0),[l,x]=i.useState(!1),[f,j]=i.useState(""),[N,g]=i.useState("all"),[u,d]=i.useState("recent");i.useEffect(()=>{h()},[N,u]);const h=async()=>{try{let m=F.from("community_posts").select(`
          *,
          profiles:author_id (
            full_name,
            avatar_url
          )
        `).eq("status","active");switch(N!=="all"&&(m=m.eq("category",N)),u){case"popular":m=m.order("upvotes",{ascending:!1});break;case"commented":m=m.order("downvotes",{ascending:!1});break;case"oldest":m=m.order("created_at",{ascending:!0});break;default:m=m.order("created_at",{ascending:!1})}const{data:o,error:y}=await m;if(y)throw y;r(o||[])}catch(m){console.error("Error fetching posts:",m),t({title:"Error",description:"Failed to load community posts",variant:"destructive"})}finally{c(!1)}},v=async m=>{if(!s){t({title:"Authentication Required",description:"Please sign in to create a post",variant:"destructive"});return}try{const{data:o,error:y}=await F.from("community_posts").insert({author_id:s.id,title:m.title,content:m.content,category:m.category,tags:m.tags}).select().single();if(y)throw y;t({title:"Success",description:"Your post has been created successfully!"}),x(!1),h()}catch(o){console.error("Error creating post:",o),t({title:"Error",description:"Failed to create post",variant:"destructive"})}},p=a.filter(m=>f===""||m.title.toLowerCase().includes(f.toLowerCase())||m.content.toLowerCase().includes(f.toLowerCase())||m.tags.some(o=>o.toLowerCase().includes(f.toLowerCase())));return n?e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),e.jsx("div",{className:"container mx-auto py-8",children:e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})})})]}):e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),e.jsx("section",{className:"relative py-20 md:py-28",style:{backgroundImage:`linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.7)), url(${ku})`,backgroundSize:"cover",backgroundPosition:"center"},children:e.jsx("div",{className:"container px-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center text-white",children:[e.jsxs(I,{className:"mb-4 bg-green-500/20 text-green-300 border-green-500/30",children:[e.jsx(se,{className:"h-3 w-3 mr-1"}),"SokoConnect Community"]}),e.jsx("h1",{className:"text-4xl md:text-6xl font-bold mb-6 leading-tight",children:"Community Forum"}),e.jsx("p",{className:"text-xl md:text-2xl mb-8 text-gray-200 max-w-2xl mx-auto",children:"Connect with fellow farmers, share knowledge, and grow together. Join Kenya's largest agricultural community."}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-6 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full",children:[e.jsx(ns,{className:"h-5 w-5 text-green-400"}),e.jsx("span",{children:"Expert Advice"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full",children:[e.jsx(Ve,{className:"h-5 w-5 text-green-400"}),e.jsx("span",{children:"Verified Members"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full",children:[e.jsx(gt,{className:"h-5 w-5 text-green-400"}),e.jsx("span",{children:"Real-time Updates"})]})]}),s?e.jsxs(b,{size:"lg",onClick:()=>x(!0),className:"bg-green-600 hover:bg-green-700 text-white px-8 py-6 text-lg",children:[e.jsx(ie,{className:"h-5 w-5 mr-2"}),"Start a Discussion"]}):e.jsx(b,{size:"lg",variant:"secondary",className:"px-8 py-6 text-lg",children:"Sign In to Participate"})]})})}),e.jsxs("main",{className:"container mx-auto py-8 px-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsxs(w,{children:[e.jsx(q,{className:"pb-2",children:e.jsxs(L,{className:"flex items-center gap-2 text-lg",children:[e.jsx(Ue,{className:"h-5 w-5"}),"Active Discussions"]})}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:a.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Posts this month"})]})]}),e.jsxs(w,{children:[e.jsx(q,{className:"pb-2",children:e.jsxs(L,{className:"flex items-center gap-2 text-lg",children:[e.jsx(se,{className:"h-5 w-5"}),"Community Members"]})}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"2,500+"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Active farmers"})]})]}),e.jsxs(w,{children:[e.jsx(q,{className:"pb-2",children:e.jsxs(L,{className:"flex items-center gap-2 text-lg",children:[e.jsx(ce,{className:"h-5 w-5"}),"Popular Topics"]})}),e.jsx(_,{children:e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsx("div",{children:"#maize-farming"}),e.jsx("div",{children:"#weather-alerts"}),e.jsx("div",{children:"#market-prices"})]})})]}),e.jsxs(w,{children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-lg",children:"Quick Actions"})}),e.jsx(_,{children:e.jsxs(b,{onClick:()=>x(!0),className:"w-full",disabled:!s,children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"New Post"]})})]})]}),l&&e.jsx("div",{className:"mb-8",children:e.jsx(wu,{onSubmit:v,onCancel:()=>x(!1)})}),e.jsx(Cu,{searchTerm:f,onSearchChange:j,category:N,onCategoryChange:g,sortBy:u,onSortChange:d}),e.jsx("div",{className:"space-y-6",children:p.length===0?e.jsx(w,{children:e.jsxs(_,{className:"text-center py-12",children:[e.jsx(Ue,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No posts found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:f?"Try adjusting your search terms.":"Be the first to start a discussion!"}),!l&&s&&e.jsxs(b,{onClick:()=>x(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Create First Post"]})]})}):p.map(m=>{var o,y;return e.jsx(_u,{post:{id:m.id,title:m.title,content:m.content,author:{name:((o=m.profiles)==null?void 0:o.full_name)||"Anonymous",avatar:(y=m.profiles)==null?void 0:y.avatar_url,isVerified:!1},category:m.category,tags:m.tags||[],location:m.location,likes:m.upvotes||0,comments:m.downvotes||0,createdAt:m.created_at}},m.id)})})]})]})};async function Pu(s){return F.from("carbon_forum_comments").insert([s])}async function Au(s){return F.from("carbon_forum_comments").select("*").eq("postId",s).order("createdAt",{ascending:!0})}async function Tu(s){return F.from("carbon_forum_comments").delete().eq("id",s)}function Du({postId:s,userId:t,onCommented:a}){const[r,n]=i.useState(""),[c,l]=i.useState(!1),[x,f]=i.useState(""),j=async N=>{N.preventDefault(),l(!0),f("");try{const{error:g}=await Pu({postId:s,userId:t,content:r,createdAt:new Date().toISOString()});g?f(g.message):(n(""),a&&a())}catch{f("Failed to post comment")}l(!1)};return e.jsxs("form",{onSubmit:j,className:"flex flex-col gap-2 mt-2",children:[e.jsx("textarea",{value:r,onChange:N=>n(N.target.value),placeholder:"Add a comment...",className:"textarea textarea-bordered w-full",required:!0}),x&&e.jsx("div",{className:"text-red-500 text-sm",children:x}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:c||!r.trim(),children:c?"Posting...":"Post Comment"})]})}function Eu({postId:s,userId:t}){const[a,r]=i.useState([]),[n,c]=i.useState(!0),[l,x]=i.useState(""),f=async()=>{c(!0),x("");try{const{data:N,error:g}=await Au(s);g?x(g.message):r(N||[])}catch{x("Failed to load comments")}c(!1)};i.useEffect(()=>{f()},[s]);const j=async N=>{await Tu(N),f()};return n?e.jsx("div",{children:"Loading comments..."}):l?e.jsx("div",{className:"text-red-500",children:l}):a.length?e.jsx("ul",{className:"divide-y mt-2",children:a.map(N=>e.jsxs("li",{className:"py-2",children:[e.jsx("div",{className:"text-sm",children:N.content}),e.jsx("div",{className:"text-xs text-gray-500",children:N.createdAt}),t===N.userId&&e.jsx("button",{className:"text-xs text-red-500 ml-2",onClick:()=>j(N.id),children:"Delete"})]},N.id))}):e.jsx("div",{children:"No comments yet."})}async function Fu(s){return F.from("carbon_forum_posts").insert([s])}async function qu(s,t){return F.from("carbon_forum_posts").update(t).eq("id",s)}async function Lu(s){return F.from("carbon_forum_posts").delete().eq("id",s)}async function Vt(s){const t=F.from("carbon_forum_posts").select("*");return s?t.eq("type",s):t}const Mu="/assets/carbon-forum-bg-BW7-N_bB.png",Iu=({userId:s})=>{const[t,a]=i.useState([]),[r,n]=i.useState({title:"",content:"",type:"",event_date:"",org_link:"",success_story:""}),[c,l]=i.useState(null),[x,f]=i.useState(!1);i.useEffect(()=>{Vt().then(({data:d})=>a(d||[]))},[]);const j=async()=>{await Fu({...r,user_id:s}),Vt().then(({data:d})=>a(d||[])),n({title:"",content:"",type:"",event_date:"",org_link:"",success_story:""})},N=d=>{l(d),f(!1)},g=async()=>{c&&(await qu(c.id,c),Vt().then(({data:d})=>a(d||[])),f(!1))},u=async d=>{await Lu(d),Vt().then(({data:h})=>a(h||[])),l(null)};return e.jsxs("div",{className:"flex min-h-screen flex-col pb-20 md:pb-0",children:[e.jsx("header",{className:"sticky top-0 z-30 w-full border-b bg-background",children:e.jsxs("div",{className:"container flex h-16 items-center",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx($e,{})}),e.jsx("div",{className:"md:hidden",children:e.jsx(ss,{})})]})}),e.jsx("section",{className:"relative bg-gradient-to-br from-green-600 to-green-700 text-white py-16",style:{backgroundImage:`linear-gradient(rgba(22, 163, 74, 0.85), rgba(21, 128, 61, 0.85)), url(${Mu})`,backgroundSize:"cover",backgroundPosition:"center"},children:e.jsxs("div",{className:"container mx-auto px-4 text-center relative z-10",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-4",children:"Carbon Credits & Circular Economy Forum"}),e.jsx("p",{className:"text-xl mb-6 max-w-3xl mx-auto",children:"Join the conversation on sustainable agriculture, carbon credits, and circular economy practices"})]})}),e.jsxs("main",{className:"flex-1 container py-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"Create New Post"})}),e.jsxs(_,{className:"space-y-4",children:[e.jsx(D,{type:"text",placeholder:"Title",value:r.title,onChange:d=>n({...r,title:d.target.value}),className:"w-full"}),e.jsx(le,{placeholder:"Content",value:r.content,onChange:d=>n({...r,content:d.target.value}),rows:4}),e.jsx(D,{type:"text",placeholder:"Type (event, opportunity, story)",value:r.type,onChange:d=>n({...r,type:d.target.value})}),e.jsx(D,{type:"date",placeholder:"Event Date",value:r.event_date,onChange:d=>n({...r,event_date:d.target.value})}),e.jsx(D,{type:"text",placeholder:"Organization Link",value:r.org_link,onChange:d=>n({...r,org_link:d.target.value})}),e.jsx(le,{placeholder:"Success Story",value:r.success_story,onChange:d=>n({...r,success_story:d.target.value}),rows:3}),e.jsx(b,{onClick:j,className:"w-full",children:"Create Post"})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-2xl font-semibold mb-4",children:"Forum Posts"}),e.jsx("div",{className:"grid gap-4",children:t.map(d=>e.jsx(w,{className:"cursor-pointer hover:shadow-lg transition-shadow",children:e.jsx(q,{children:e.jsxs(L,{className:"flex justify-between items-start",children:[e.jsxs("span",{children:[d.title," (",d.type,")"]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(b,{variant:"outline",size:"sm",onClick:()=>N(d),children:"View"}),e.jsx(b,{variant:"destructive",size:"sm",onClick:()=>u(d.id),children:"Delete"})]})]})})},d.id))})]}),c&&e.jsxs(w,{className:"mb-6",children:[e.jsx(q,{children:e.jsx(L,{children:"Post Details"})}),e.jsxs(_,{children:[x?e.jsxs("div",{className:"space-y-4",children:[e.jsx(D,{type:"text",value:c.title,onChange:d=>l({...c,title:d.target.value})}),e.jsx(le,{value:c.content,onChange:d=>l({...c,content:d.target.value}),rows:6}),e.jsx(b,{onClick:g,children:"Save"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-xl font-bold",children:c.title}),e.jsx("p",{children:c.content}),e.jsx(b,{onClick:()=>f(!0),children:"Edit"})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Comments"}),e.jsx(Du,{postId:c.id,userId:s,onCommented:()=>{}}),e.jsx(Eu,{postId:c.id,userId:s})]})]})]})]}),e.jsx(Me,{})]})},Ru=()=>{const[s,t]=i.useState(!navigator.onLine);return i.useEffect(()=>{const a=()=>t(!1),r=()=>t(!0);return window.addEventListener("online",a),window.addEventListener("offline",r),()=>{window.removeEventListener("online",a),window.removeEventListener("offline",r)}},[]),s?e.jsx("div",{style:{background:"#fbbf24",color:"#1f2937",padding:"8px",textAlign:"center",position:"fixed",top:0,width:"100%",zIndex:1e3},children:"You are offline. Some features may be limited. Actions will sync when you reconnect."}):null},zu=({formStep:s})=>e.jsx("div",{className:"flex justify-center mb-8",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`rounded-full w-8 h-8 flex items-center justify-center ${s>=1?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"}`,children:"1"}),e.jsx("div",{className:`h-1 w-12 ${s>=2?"bg-primary":"bg-muted"}`}),e.jsx("div",{className:`rounded-full w-8 h-8 flex items-center justify-center ${s>=2?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"}`,children:"2"}),e.jsx("div",{className:`h-1 w-12 ${s>=3?"bg-primary":"bg-muted"}`}),e.jsx("div",{className:`rounded-full w-8 h-8 flex items-center justify-center ${s>=3?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"}`,children:"3"})]})}),Ou=({formErrors:s,businessName:t,setBusinessName:a,phone:r,setPhone:n,email:c,setEmail:l,selectedCounties:x,handleCountySelection:f,businessReg:j,setBusinessReg:N,yearsInBusiness:g,setYearsInBusiness:u,description:d,setDescription:h,handleNextStep:v,user:p,counties:m})=>e.jsxs(e.Fragment,{children:[e.jsxs("form",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"businessName",className:s.businessName?"text-destructive":"",children:"Business Name*"}),e.jsx(D,{id:"businessName",value:t,onChange:o=>a(o.target.value),placeholder:"Your transport company name",className:s.businessName?"border-destructive":""}),s.businessName&&e.jsx("p",{className:"text-xs text-destructive",children:s.businessName})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"phone",className:s.phone?"text-destructive":"",children:"Phone Number*"}),e.jsx(D,{id:"phone",value:r,onChange:o=>n(o.target.value),placeholder:"+254...",className:s.phone?"border-destructive":""}),s.phone&&e.jsx("p",{className:"text-xs text-destructive",children:s.phone})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"email",className:s.email?"text-destructive":"",children:"Email Address*"}),e.jsx(D,{id:"email",type:"email",value:c,onChange:o=>l(o.target.value),placeholder:"contact@yourcompany.com",className:s.email?"border-destructive":""}),s.email&&e.jsx("p",{className:"text-xs text-destructive",children:s.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{className:s.counties?"text-destructive":"",children:"Counties Served*"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:m.map(o=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(De,{id:`county-${o}`,checked:x.includes(o),onCheckedChange:()=>f(o)}),e.jsx("label",{htmlFor:`county-${o}`,className:"text-sm cursor-pointer",children:o})]},o))}),s.counties&&e.jsx("p",{className:"text-xs text-destructive",children:s.counties})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"businessReg",children:"Business Registration Number (Optional)"}),e.jsx(D,{id:"businessReg",value:j,onChange:o=>N(o.target.value),placeholder:"KE12345678"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"yearsInBusiness",className:s.yearsInBusiness?"text-destructive":"",children:"Years in Business*"}),e.jsxs(Q,{value:g,onValueChange:u,children:[e.jsx(W,{className:s.yearsInBusiness?"border-destructive":"",children:e.jsx(J,{placeholder:"Select years"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"<1",children:"Less than 1 year"}),e.jsx(T,{value:"1-3",children:"1-3 years"}),e.jsx(T,{value:"3-5",children:"3-5 years"}),e.jsx(T,{value:"5+",children:"More than 5 years"})]})]}),s.yearsInBusiness&&e.jsx("p",{className:"text-xs text-destructive",children:s.yearsInBusiness})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"description",className:s.description?"text-destructive":"",children:"Business Description*"}),e.jsx(le,{id:"description",value:d,onChange:o=>h(o.target.value),placeholder:"Tell us more about your transport services...",rows:4,className:s.description?"border-destructive":""}),s.description&&e.jsx("p",{className:"text-xs text-destructive",children:s.description})]})]}),!p&&e.jsxs("div",{className:"mt-2 p-3 bg-yellow-50 border border-yellow-200 rounded-md flex items-start",children:[e.jsx(hs,{className:"h-5 w-5 text-yellow-500 mr-2 flex-shrink-0 mt-0.5"}),e.jsxs("p",{className:"text-sm text-yellow-700",children:["You are not logged in. Please ",e.jsx("a",{href:"/login",className:"text-primary font-medium",children:"sign in"})," or",e.jsx("a",{href:"/signup",className:"text-primary font-medium",children:" create an account"})," to register as a transporter."]})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx(b,{onClick:v,disabled:!p,children:"Continue"})})]}),Ku=({formErrors:s,vehicleType:t,setVehicleType:a,vehicleCount:r,setVehicleCount:n,loadCapacity:c,setLoadCapacity:l,rates:x,setRates:f,availableTimes:j,handleAvailableTimeToggle:N,specialFeatures:g,handleSpecialFeatureToggle:u,handleSubmit:d,isSubmitting:h,setFormStep:v})=>e.jsxs(e.Fragment,{children:[e.jsx("form",{onSubmit:d,className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"vehicleType",className:s.vehicleType?"text-destructive":"",children:"Vehicle Type*"}),e.jsxs(Q,{value:t,onValueChange:a,children:[e.jsx(W,{className:s.vehicleType?"border-destructive":"",children:e.jsx(J,{placeholder:"Select vehicle type"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"pickup",children:"Pickup"}),e.jsx(T,{value:"van",children:"Van"}),e.jsx(T,{value:"truck-small",children:"Truck (3-5 tons)"}),e.jsx(T,{value:"truck-medium",children:"Truck (5-10 tons)"}),e.jsx(T,{value:"truck-large",children:"Heavy Truck (10+ tons)"}),e.jsx(T,{value:"motorcycle",children:"Motorcycle"})]})]}),s.vehicleType&&e.jsx("p",{className:"text-xs text-destructive",children:s.vehicleType})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"vehicleCount",className:s.vehicleCount?"text-destructive":"",children:"Number of Vehicles*"}),e.jsxs(Q,{value:r,onValueChange:n,children:[e.jsx(W,{className:s.vehicleCount?"border-destructive":"",children:e.jsx(J,{placeholder:"Select count"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"1",children:"1"}),e.jsx(T,{value:"2-5",children:"2-5"}),e.jsx(T,{value:"6-10",children:"6-10"}),e.jsx(T,{value:"10+",children:"More than 10"})]})]}),s.vehicleCount&&e.jsx("p",{className:"text-xs text-destructive",children:s.vehicleCount})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"loadCapacity",className:s.loadCapacity?"text-destructive":"",children:"Load Capacity*"}),e.jsxs(Q,{value:c,onValueChange:l,children:[e.jsx(W,{className:s.loadCapacity?"border-destructive":"",children:e.jsx(J,{placeholder:"Select capacity"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"<1",children:"Less than 1 ton"}),e.jsx(T,{value:"1-3",children:"1-3 tons"}),e.jsx(T,{value:"3-5",children:"3-5 tons"}),e.jsx(T,{value:"5-10",children:"5-10 tons"}),e.jsx(T,{value:"10+",children:"More than 10 tons"})]})]}),s.loadCapacity&&e.jsx("p",{className:"text-xs text-destructive",children:s.loadCapacity})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"rates",className:s.rates?"text-destructive":"",children:"Average Rates*"}),e.jsx(D,{id:"rates",value:x,onChange:p=>f(p.target.value),placeholder:"e.g., KES 5,000 per trip",className:s.rates?"border-destructive":""}),s.rates&&e.jsx("p",{className:"text-xs text-destructive",children:s.rates})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"availableTimes",className:s.availableTimes?"text-destructive":"",children:"Available Times*"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(De,{id:"morning",checked:j.includes("morning"),onCheckedChange:()=>N("morning")}),e.jsx("label",{htmlFor:"morning",className:"text-sm",children:"Morning (5AM-11AM)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(De,{id:"afternoon",checked:j.includes("afternoon"),onCheckedChange:()=>N("afternoon")}),e.jsx("label",{htmlFor:"afternoon",className:"text-sm",children:"Afternoon (11AM-4PM)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(De,{id:"evening",checked:j.includes("evening"),onCheckedChange:()=>N("evening")}),e.jsx("label",{htmlFor:"evening",className:"text-sm",children:"Evening (4PM-9PM)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(De,{id:"night",checked:j.includes("night"),onCheckedChange:()=>N("night")}),e.jsx("label",{htmlFor:"night",className:"text-sm",children:"Night (9PM-5AM)"})]})]}),s.availableTimes&&e.jsx("p",{className:"text-xs text-destructive",children:s.availableTimes})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Special Features"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(De,{id:"refrigeration",checked:g.includes("refrigeration"),onCheckedChange:()=>u("refrigeration")}),e.jsx("label",{htmlFor:"refrigeration",className:"text-sm",children:"Refrigerated Transport"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(De,{id:"tracking",checked:g.includes("tracking"),onCheckedChange:()=>u("tracking")}),e.jsx("label",{htmlFor:"tracking",className:"text-sm",children:"GPS Tracking"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(De,{id:"insurance",checked:g.includes("insurance"),onCheckedChange:()=>u("insurance")}),e.jsx("label",{htmlFor:"insurance",className:"text-sm",children:"Cargo Insurance"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(De,{id:"loading",checked:g.includes("loading"),onCheckedChange:()=>u("loading")}),e.jsx("label",{htmlFor:"loading",className:"text-sm",children:"Loading/Unloading Service"})]})]})]})]})}),e.jsxs("div",{className:"flex justify-between mt-6",children:[e.jsx(b,{variant:"outline",onClick:()=>v(1),children:"Back"}),e.jsx(b,{onClick:d,disabled:h,children:h?"Registering...":"Complete Registration"})]})]}),Bu=()=>{const s=Ne();return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(Qe,{className:"w-8 h-8 text-primary"})})}),e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{children:"Your account has been successfully created. You will start receiving transport requests from farmers in your area soon."}),e.jsxs("div",{className:"flex flex-col items-center space-y-3 my-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{className:"h-5 w-5 text-primary"}),e.jsx("span",{children:"Access to transport requests in your regions"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ee,{className:"h-5 w-5 text-primary"}),e.jsx("span",{children:"Geographic route planning and optimization"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Qe,{className:"h-5 w-5 text-primary"}),e.jsx("span",{children:"Verified transporter badge on the platform"})]})]})]})}),e.jsx("div",{className:"flex justify-center",children:e.jsx(b,{onClick:()=>s("/"),children:"Go to Dashboard"})})]})},Bn=ve.object({businessName:ve.string().min(3,"Business name must be at least 3 characters"),phone:ve.string().min(10,"Please enter a valid phone number"),email:ve.string().email("Please enter a valid email address"),counties:ve.array(ve.string()).min(1,"Please select at least one county"),businessReg:ve.string().optional(),yearsInBusiness:ve.string().min(1,"Please select years in business"),description:ve.string().min(20,"Description must be at least 20 characters"),vehicleType:ve.string().min(1,"Please select a vehicle type"),vehicleCount:ve.string().min(1,"Please select number of vehicles"),loadCapacity:ve.string().min(1,"Please select load capacity"),rates:ve.string().min(3,"Please provide your rates"),availableTimes:ve.array(ve.string()).min(1,"Please select at least one available time"),specialFeatures:ve.array(ve.string()).optional()}),Uu=(s,t,a,r,n,c,l)=>{try{const x={businessName:s,phone:t,email:a,counties:r,businessReg:n,yearsInBusiness:c,description:l};return Bn.pick({businessName:!0,phone:!0,email:!0,counties:!0,yearsInBusiness:!0,description:!0}).parse(x),{valid:!0,errors:{}}}catch(x){if(x instanceof ve.ZodError){const f={};return x.errors.forEach(j=>{const N=j.path[0];f[N]=j.message}),{valid:!1,errors:f}}return{valid:!1,errors:{form:"Validation failed"}}}},Vu=(s,t,a,r,n,c)=>{try{const l={vehicleType:s,vehicleCount:t,loadCapacity:a,rates:r,availableTimes:n,specialFeatures:c};return Bn.pick({vehicleType:!0,vehicleCount:!0,loadCapacity:!0,rates:!0,availableTimes:!0,specialFeatures:!0}).parse(l),{valid:!0,errors:{}}}catch(l){if(l instanceof ve.ZodError){const x={};return l.errors.forEach(f=>{const j=f.path[0];x[j]=f.message}),{valid:!1,errors:x}}return{valid:!1,errors:{form:"Validation failed"}}}},$u=()=>{const{toast:s}=Z(),[t,a]=i.useState(!1),[r,n]=i.useState(1),[c,l]=i.useState({}),[x,f]=i.useState(null),[j,N]=i.useState(""),[g,u]=i.useState(""),[d,h]=i.useState(""),[v,p]=i.useState([]),[m,o]=i.useState(""),[y,k]=i.useState(""),[A,S]=i.useState(""),[E,P]=i.useState(""),[R,M]=i.useState(""),[O,te]=i.useState(""),[ue,z]=i.useState(""),[U,K]=i.useState([]),[ae,be]=i.useState([]),ts=["Nairobi","Mombasa","Kisumu","Nakuru","Kiambu","Meru","Kakamega","Nyeri","Machakos","Uasin Gishu","Kirinyaga","Bungoma","Bomet"];i.useEffect(()=>{(async()=>{var ps;const{data:Kt}=await F.auth.getSession();f(((ps=Kt.session)==null?void 0:ps.user)||null)})();const{data:cs}=F.auth.onAuthStateChange((Kt,ps)=>{f((ps==null?void 0:ps.user)||null)});return()=>{cs.subscription.unsubscribe()}},[]);const ls=ze=>{v.includes(ze)?p(v.filter(cs=>cs!==ze)):p([...v,ze])},he=ze=>{U.includes(ze)?K(U.filter(cs=>cs!==ze)):K([...U,ze])},Rs=ze=>{ae.includes(ze)?be(ae.filter(cs=>cs!==ze)):be([...ae,ze])},Ot=()=>{const{valid:ze,errors:cs}=Uu(j,g,d,v,m,y,A);ze?(l({}),n(2)):(l(cs),s({title:"Validation Error",description:"Please fix the errors in the form before continuing.",variant:"destructive"}))},bt=async ze=>{ze.preventDefault();const{valid:cs,errors:Kt}=Vu(E,R,O,ue,U,ae);if(!cs){l(Kt),s({title:"Validation Error",description:"Please fix the errors in the form before submitting.",variant:"destructive"});return}if(a(!0),!x){s({title:"Authentication Required",description:"You need to be logged in to register as a transporter.",variant:"destructive"}),a(!1);return}try{const ps={user_id:x.id,name:j,service_type:"transport",counties:v,contact_info:`${g} | ${d}`,capacity:R,load_capacity:parseInt(O.split("-")[0])||1e3,rates:ue,has_refrigeration:ae.includes("refrigeration"),vehicle_type:E},{data:pp,error:pr}=await F.from("transporters").insert(ps).select();if(pr)throw new Error(pr.message);s({title:"Registration Successful",description:"Your transporter account has been created. You'll start receiving transport requests soon."}),n(3)}catch(ps){console.error("Error submitting transporter data:",ps),s({title:"Registration Failed",description:"There was an error creating your account. Please try again.",variant:"destructive"})}finally{a(!1)}};return e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),e.jsxs("main",{className:"py-12 px-6 max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-10 text-center",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-4",children:"Transport Provider Registration"}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-3xl mx-auto",children:"Join our network of transport providers and connect with farmers who need to move their produce to markets"})]}),e.jsx(zu,{formStep:r}),e.jsxs(w,{className:"max-w-4xl mx-auto",children:[r===1&&e.jsxs(e.Fragment,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Business Information"}),e.jsx(G,{children:"Tell us about your transport business"})]}),e.jsx(_,{children:e.jsx(Ou,{formErrors:c,businessName:j,setBusinessName:N,phone:g,setPhone:u,email:d,setEmail:h,selectedCounties:v,handleCountySelection:ls,businessReg:m,setBusinessReg:o,yearsInBusiness:y,setYearsInBusiness:k,description:A,setDescription:S,handleNextStep:Ot,user:x,counties:ts})})]}),r===2&&e.jsxs(e.Fragment,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Vehicle & Service Details"}),e.jsx(G,{children:"Tell us about your transportation capabilities"})]}),e.jsx(_,{children:e.jsx(Ku,{formErrors:c,vehicleType:E,setVehicleType:P,vehicleCount:R,setVehicleCount:M,loadCapacity:O,setLoadCapacity:te,rates:ue,setRates:z,availableTimes:U,handleAvailableTimeToggle:he,specialFeatures:ae,handleSpecialFeatureToggle:Rs,handleSubmit:bt,isSubmitting:t,setFormStep:n})})]}),r===3&&e.jsxs(e.Fragment,{children:[e.jsxs(q,{children:[e.jsx(L,{className:"text-center",children:"Registration Complete!"}),e.jsx(G,{className:"text-center",children:"Thank you for joining our transport provider network"})]}),e.jsx(_,{children:e.jsx(Bu,{})})]})]})]})]})},Gu=()=>{const s=Ne(),{toast:t}=Z(),[a,r]=i.useState(""),[n,c]=i.useState(""),[l,x]=i.useState(""),[f,j]=i.useState(["Storage","Transport","Quality Control","Market Linkage","Training","Input Supplier","Inspector"]),[N,g]=i.useState([]),[u,d]=i.useState(""),[h,v]=i.useState(""),[p,m]=i.useState(""),[o,y]=i.useState(""),[k,A]=i.useState(["Organic","Fair Trade","Affordable","Reliable","Certified"]),[S,E]=i.useState([]),[P,R]=i.useState(!1),M=["Nairobi","Mombasa","Kisumu","Nakuru","Eldoret","Machakos","Kiambu","Nyeri","Kakamega","Kisii","Thika","Garissa","Lamu","Turkana"],O=z=>{g(U=>U.includes(z)?U.filter(K=>K!==z):[...U,z])},te=z=>{E(U=>U.includes(z)?U.filter(K=>K!==z):[...U,z])},ue=z=>{z.preventDefault();const U={name:a,businessType:n,description:l,services:N,location:{county:u,specificLocation:h},contactInfo:p,website:o,tags:S,rates:"Contact for rates",verified:!1,rating:0,reviewCount:0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};console.log("Submitting service provider:",U),t({title:"Service registered",description:"Your service has been submitted for verification."}),R(!0)};return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx("header",{className:"sticky top-0 z-30 w-full border-b bg-background",children:e.jsxs("div",{className:"container flex h-16 items-center",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx($e,{})}),e.jsx("div",{className:"md:hidden",children:e.jsx(ss,{})})]})}),e.jsxs("main",{className:"flex-1 container py-6",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Service Provider Registration"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Register your agricultural service to connect with farmers in need."}),P&&e.jsxs("div",{className:"rounded-md bg-green-50 p-4 mb-4",children:[e.jsx("h3",{className:"text-sm font-medium text-green-800",children:"Registration Successful!"}),e.jsx("div",{className:"mt-2 text-sm text-green-700",children:"Your service has been registered and is awaiting verification."}),e.jsx(b,{variant:"link",onClick:()=>s("/"),children:"Back to Home"})]}),e.jsxs("form",{onSubmit:ue,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"name",children:"Service Name"}),e.jsx(D,{id:"name",type:"text",value:a,onChange:z=>r(z.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"businessType",children:"Business Type"}),e.jsxs(Q,{value:n,onValueChange:c,required:!0,children:[e.jsx(W,{id:"businessType",children:e.jsx(J,{placeholder:"Select a business type"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"storage",children:"Storage"}),e.jsx(T,{value:"transport",children:"Transport"}),e.jsx(T,{value:"quality-control",children:"Quality Control"}),e.jsx(T,{value:"market-linkage",children:"Market Linkage"}),e.jsx(T,{value:"training",children:"Training"}),e.jsx(T,{value:"input-supplier",children:"Input Supplier"}),e.jsx(T,{value:"inspector",children:"Inspector"})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"description",children:"Description"}),e.jsx(le,{id:"description",value:l,onChange:z=>x(z.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Services Offered"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:f.map(z=>e.jsxs("div",{className:"space-x-2",children:[e.jsx(De,{id:`service-${z}`,checked:N.includes(z),onCheckedChange:()=>O(z)}),e.jsx(C,{htmlFor:`service-${z}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:z})]},z))})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"county",children:"County"}),e.jsxs(Q,{value:u,onValueChange:d,required:!0,children:[e.jsx(W,{id:"county",children:e.jsx(J,{placeholder:"Select a county"})}),e.jsx(Y,{children:M.map(z=>e.jsx(T,{value:z,children:z},z))})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"specificLocation",children:"Specific Location"}),e.jsx(D,{id:"specificLocation",type:"text",value:h,onChange:z=>v(z.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"contactInfo",children:"Contact Information"}),e.jsx(D,{id:"contactInfo",type:"text",value:p,onChange:z=>m(z.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"website",children:"Website (optional)"}),e.jsx(D,{id:"website",type:"url",value:o,onChange:z=>y(z.target.value)})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:k.map(z=>e.jsxs("div",{className:"space-x-2",children:[e.jsx(De,{id:`tag-${z}`,checked:S.includes(z),onCheckedChange:()=>te(z)}),e.jsx(C,{htmlFor:`tag-${z}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:z})]},z))})]}),e.jsx(b,{type:"submit",children:"Register Service"})]})]})]})},Kr=({data:s,title:t,type:a})=>{const r=i.useRef(null);i.useEffect(()=>{if(!r.current||!s.length)return;const f=ga(r.current);f.selectAll("*").remove();const j={top:20,right:30,bottom:40,left:40},N=400-j.left-j.right,g=300-j.top-j.bottom,u=f.attr("width",N+j.left+j.right).attr("height",g+j.top+j.bottom).append("g").attr("transform",`translate(${j.left},${j.top})`);switch(a){case"bar":n(u,s,N,g);break;case"pie":c(u,s,N,g);break;case"scatter":l(u,s,N,g);break;case"line":x(u,s,N,g);break}},[s,a]);const n=(f,j,N,g)=>{const u=vc().domain(j.map(h=>h.name)).range([0,N]).padding(.1),d=wt().domain([0,yc(j,h=>h.value)||0]).range([g,0]);f.append("g").attr("transform",`translate(0,${g})`).call(ja(u)),f.append("g").call(fa(d)),f.selectAll(".bar").data(j).enter().append("rect").attr("class","bar").attr("x",h=>u(h.name)||0).attr("width",u.bandwidth()).attr("y",h=>d(h.value)).attr("height",h=>g-d(h.value)).attr("fill","#22c55e").on("mouseover",function(h,v){ga(this).attr("fill","#16a34a")}).on("mouseout",function(h,v){ga(this).attr("fill","#22c55e")})},c=(f,j,N,g)=>{const u=j.filter(A=>A.value>0);if(u.length===0)return;const d=Math.min(N,g)/2-10,h=Nc(bc),v=wc().value(A=>A.value).sort(null),p=vr().innerRadius(0).outerRadius(d),m=vr().innerRadius(d*.6).outerRadius(d*.6),o=v(u),k=f.attr("transform",`translate(${N/2+20},${g/2})`).selectAll(".arc").data(o).enter().append("g").attr("class","arc");k.append("path").attr("d",p).attr("fill",(A,S)=>h(S.toString())).attr("stroke","white").attr("stroke-width",2),k.filter(A=>A.endAngle-A.startAngle>.3).append("text").attr("transform",A=>`translate(${m.centroid(A)})`).attr("text-anchor","middle").attr("font-size","10px").attr("fill","white").text(A=>A.data.name.substring(0,8))},l=(f,j,N,g)=>{const u=wt().domain(Bt(j,(h,v)=>v)).range([0,N]),d=wt().domain(Bt(j,h=>h.value)).range([g,0]);f.append("g").attr("transform",`translate(0,${g})`).call(ja(u)),f.append("g").call(fa(d)),f.selectAll(".dot").data(j).enter().append("circle").attr("class","dot").attr("cx",(h,v)=>u(v)).attr("cy",h=>d(h.value)).attr("r",5).attr("fill","#3b82f6")},x=(f,j,N,g)=>{const u=wt().domain(Bt(j,(v,p)=>p)).range([0,N]),d=wt().domain(Bt(j,v=>v.value)).range([g,0]),h=_c().x((v,p)=>u(p)).y(v=>d(v.value));f.append("g").attr("transform",`translate(0,${g})`).call(ja(u)),f.append("g").call(fa(d)),f.append("path").datum(j).attr("fill","none").attr("stroke","#ef4444").attr("stroke-width",2).attr("d",h)};return e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{className:"text-lg",children:t})}),e.jsx(_,{children:e.jsx("svg",{ref:r})})]})},Br={knbs:"https://www.knbs.or.ke/agricultural-statistics/",kilimo:"https://kilimo.go.ke/",fao:"https://www.fao.org/faostat/en/#country/114",worldBank:"https://data.worldbank.org/country/KE?view=chart",centralBank:"https://www.centralbank.go.ke/"},Un=[{id:"1",name:"Maize Production",category:"Staple Crops",county:"Uasin Gishu",value:"2.1 million bags",unit:"bags (90kg)",source:"KNBS Economic Survey 2023",verified:!0},{id:"2",name:"Tea Production",category:"Cash Crops",county:"Kericho",value:"485,000 tonnes",unit:"tonnes",source:"Tea Board of Kenya 2023",verified:!0},{id:"3",name:"Coffee Production",category:"Cash Crops",county:"Nyeri",value:"45,000 tonnes",unit:"tonnes",source:"Coffee Board of Kenya 2023",verified:!0},{id:"4",name:"Potato Production",category:"Food Crops",county:"Nyandarua",value:"1.8 million tonnes",unit:"tonnes",source:"KNBS Agricultural Census 2023",verified:!0},{id:"5",name:"Dairy Production",category:"Livestock",county:"Kiambu",value:"5.2 billion litres",unit:"litres/year",source:"Kenya Dairy Board 2023",verified:!0}],Ur=["Baringo","Bomet","Bungoma","Busia","Elgeyo-Marakwet","Embu","Garissa","Homa Bay","Isiolo","Kajiado","Kakamega","Kericho","Kiambu","Kilifi","Kirinyaga","Kisii","Kisumu","Kitui","Kwale","Laikipia","Lamu","Machakos","Makueni","Mandera","Marsabit","Meru","Migori","Mombasa","Murang'a","Nairobi","Nakuru","Nandi","Narok","Nyamira","Nyandarua","Nyeri","Samburu","Siaya","Taita-Taveta","Tana River","Tharaka-Nithi","Trans Nzoia","Turkana","Uasin Gishu","Vihiga","Wajir","West Pokot"],Hu=async()=>Promise.resolve(Un),Wu=()=>{const[s,t]=i.useState("real-data"),[a,r]=i.useState(Un),[n,c]=i.useState(""),[l,x]=i.useState("");i.useEffect(()=>{(async()=>{try{const u=await Hu();r(u)}catch(u){console.error("Error loading real data:",u)}})()},[]);const f=[...new Set(a.map(g=>g.category))],j=a.filter(g=>{const u=!n||n==="All Categories"||g.category===n,d=!l||l==="All Counties"||g.county===l;return u&&d}),N=j.slice(0,10).map(g=>({name:g.name,value:parseFloat(g.value.toString().replace(/[^\d.]/g,""))||0,category:g.category}));return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(ne,{}),e.jsxs("main",{className:"py-8 px-4 md:px-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-2",children:"Verified Agricultural Data for Kenya"}),e.jsx("p",{className:"text-muted-foreground max-w-3xl mx-auto mb-4",children:"Real-time integration with verified Kenyan government and institutional data sources"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-4",children:[e.jsx(lt,{className:"h-5 w-5 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-600",children:"All data verified from legitimate sources"})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-3",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Verified data sources:"}),Object.entries(Br).map(([g,u])=>e.jsxs("a",{href:u,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-xs bg-green-50 hover:bg-green-100 px-3 py-1 rounded-full text-green-700 hover:text-green-800 transition-colors border border-green-200",children:[e.jsx(xs,{className:"h-3 w-3 mr-1"}),g==="knbs"?"Kenya National Bureau of Statistics":g==="kilimo"?"Ministry of Agriculture":g==="fao"?"FAO Kenya":g==="worldBank"?"World Bank Kenya":"Central Bank of Kenya"]},g))]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(lt,{className:"h-5 w-5 text-green-600"}),"Verified Kenya Agricultural Data"]}),e.jsx(G,{children:"Explore verified data from Kenya's leading agricultural institutions"})]}),e.jsx(_,{children:e.jsxs(ge,{value:s,onValueChange:t,className:"w-full",children:[e.jsxs(pe,{className:"w-full mb-6",children:[e.jsx(B,{value:"real-data",children:"Verified Data"}),e.jsx(B,{value:"sources",children:"Data Sources"})]}),e.jsxs(V,{value:"real-data",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-end gap-4",children:[e.jsxs("div",{className:"w-full md:w-64",children:[e.jsx(C,{htmlFor:"category",className:"mb-2 block",children:"Category"}),e.jsxs(Q,{value:n,onValueChange:c,children:[e.jsx(W,{id:"category",children:e.jsx(J,{placeholder:"All Categories"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"All Categories",children:"All Categories"}),f.map(g=>e.jsx(T,{value:g,children:g},g))]})]})]}),e.jsxs("div",{className:"w-full md:w-64",children:[e.jsx(C,{htmlFor:"county",className:"mb-2 block",children:"County"}),e.jsxs(Q,{value:l,onValueChange:x,children:[e.jsx(W,{id:"county",children:e.jsx(J,{placeholder:"All Counties"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"All Counties",children:"All Counties"}),Ur.map(g=>e.jsx(T,{value:g,children:g},g))]})]})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left p-2",children:"Commodity"}),e.jsx("th",{className:"text-left p-2",children:"Category"}),e.jsx("th",{className:"text-left p-2",children:"County"}),e.jsx("th",{className:"text-right p-2",children:"Production"}),e.jsx("th",{className:"text-left p-2",children:"Source"}),e.jsx("th",{className:"text-center p-2",children:"Verified"})]})}),e.jsx("tbody",{children:j.map(g=>e.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[e.jsx("td",{className:"p-2 font-medium",children:g.name}),e.jsx("td",{className:"p-2",children:e.jsx(I,{variant:"outline",children:g.category})}),e.jsx("td",{className:"p-2",children:g.county}),e.jsx("td",{className:"p-2 text-right font-medium",children:g.value}),e.jsx("td",{className:"p-2 text-sm text-muted-foreground",children:g.source||"Verified Source"}),e.jsx("td",{className:"p-2 text-center",children:g.verified&&e.jsx(lt,{className:"h-4 w-4 text-green-600 mx-auto"})})]},g.id))})]})})]}),e.jsx(V,{value:"sources",children:e.jsx("div",{className:"space-y-4",children:Object.entries(Br).map(([g,u])=>e.jsx(w,{children:e.jsx(_,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:g==="knbs"?"Kenya National Bureau of Statistics":g==="kilimo"?"Ministry of Agriculture & Livestock Development":g==="fao"?"Food and Agriculture Organization (Kenya)":g==="worldBank"?"World Bank (Kenya Data)":"Central Bank of Kenya"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Official government/institutional source"})]}),e.jsxs("a",{href:u,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-blue-600 hover:text-blue-800",children:["Visit Source ",e.jsx(xs,{className:"h-4 w-4"})]})]})})},g))})})]})})]}),e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Real Data Visualizations"}),e.jsx(G,{children:"Interactive charts based on verified Kenyan agricultural data"})]}),e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(Kr,{data:N,title:"Production by Category",type:"bar"}),e.jsx(Kr,{data:N,title:"County Distribution",type:"pie"})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(w,{children:[e.jsx(q,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-5 w-5 text-amber-600"}),"Data Integrity Notice"]})}),e.jsxs(_,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"All data displayed is sourced from verified Kenyan government and institutional sources. We do not use mock, sample, or fabricated data."}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(lt,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{children:"Government verified"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(lt,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{children:"Real-time updates"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(lt,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{children:"Institutional sources"})]})]})]})]}),e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"Kenya Agricultural Overview"})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-700",children:Ur.length}),e.jsx("div",{className:"text-sm text-green-600",children:"Counties Covered"})]}),e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-700",children:f.length}),e.jsx("div",{className:"text-sm text-blue-600",children:"Crop Categories"})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-700",children:"100%"}),e.jsx("div",{className:"text-sm text-purple-600",children:"Data Verified"})]})]})})]})]})]})]})]})},Yu=()=>e.jsxs(w,{className:"border-green-200",children:[e.jsx(q,{children:e.jsx(L,{children:"Production API Overview"})}),e.jsxs(_,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Base URL"}),e.jsx("code",{className:"bg-muted p-2 rounded-md block",children:"https://cwcduhvwkihpnuaoflps.supabase.co/functions/v1"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Available API Endpoints"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(w,{className:"flex flex-col border-green-200 bg-green-50",children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-lg",children:"Farmers API"})}),e.jsxs(_,{className:"flex-grow",children:[e.jsx("p",{className:"text-sm mb-4",children:"Access farmer data from across Kenya with different access levels based on your subscription tier."}),e.jsx("div",{className:"text-xs bg-white p-2 rounded",children:e.jsx("code",{children:"GET /api-farmers"})})]})]}),e.jsxs(w,{className:"flex flex-col border-green-200 bg-green-50",children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-lg",children:"Markets API"})}),e.jsxs(_,{className:"flex-grow",children:[e.jsx("p",{className:"text-sm mb-4",children:"Get market information with real price data and analytics. Available to Developer and Enterprise tiers."}),e.jsx("div",{className:"text-xs bg-white p-2 rounded",children:e.jsx("code",{children:"GET /api-markets"})})]})]}),e.jsxs(w,{className:"flex flex-col border-green-200 bg-green-50",children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-lg",children:"Commodities API"})}),e.jsxs(_,{className:"flex-grow",children:[e.jsx("p",{className:"text-sm mb-4",children:"Access commodity pricing and trend data with different data depths based on subscription tier."}),e.jsx("div",{className:"text-xs bg-white p-2 rounded",children:e.jsx("code",{children:"GET /api-commodities"})})]})]}),e.jsxs(w,{className:"flex flex-col border-green-200 bg-green-50",children:[e.jsx(q,{className:"pb-2",children:e.jsx(L,{className:"text-lg",children:"Supply Chain API"})}),e.jsxs(_,{className:"flex-grow",children:[e.jsx("p",{className:"text-sm mb-4",children:"Enterprise-tier access to comprehensive supply chain analytics, logistics data, and forecasts."}),e.jsx("div",{className:"text-xs bg-white p-2 rounded",children:e.jsx("code",{children:"GET /api-supply-chain"})})]})]})]})]}),e.jsxs("div",{className:"bg-green-100 p-4 rounded-lg border border-green-200",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Production Features"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Security"}),e.jsxs("ul",{className:"space-y-2 list-disc pl-5 text-sm",children:[e.jsx("li",{children:"API key authentication with SHA-256 hashing"}),e.jsx("li",{children:"Rate limiting by subscription tier"}),e.jsx("li",{children:"Request validation and sanitization"}),e.jsx("li",{children:"Row-level security policies"}),e.jsx("li",{children:"Comprehensive request logging"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Performance"}),e.jsxs("ul",{className:"space-y-2 list-disc pl-5 text-sm",children:[e.jsx("li",{children:"Auto-scaling serverless functions"}),e.jsx("li",{children:"Response time monitoring"}),e.jsx("li",{children:"Traffic-based optimization"}),e.jsx("li",{children:"Global CDN distribution"}),e.jsx("li",{children:"Request caching mechanisms"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Getting Started"}),e.jsxs("ol",{className:"space-y-2 list-decimal pl-5",children:[e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Generate an API key: "}),e.jsxs(X,{to:"/api-docs?tab=keys",className:"text-blue-600 inline-flex items-center hover:underline",children:["Visit the API Keys tab ",e.jsx(xs,{className:"h-3 w-3 ml-1"})]})]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Send requests with your key: "}),"Include your API key in the X-API-Key header"]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Upgrade your subscription: "}),"Purchase a business advertisement to access higher tiers"]})]})]})]})]}),Qu=()=>(Z(),e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"API Authentication"})}),e.jsxs(_,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"API Key Authentication"}),e.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg mb-4",children:[e.jsx("p",{className:"font-medium text-green-800 mb-2",children:"âœ… Production-Ready API Keys"}),e.jsx("p",{className:"text-sm mb-4",children:"You can generate real API keys that work with our endpoints by visiting the API Keys tab."}),e.jsx(X,{to:"/api-docs?tab=keys",children:e.jsxs(b,{className:"flex items-center",children:["Go to API Keys Management",e.jsx(ks,{className:"ml-2 h-4 w-4"})]})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Using Your API Key"}),e.jsxs("p",{className:"mb-4",children:["Include your API key in the ",e.jsx("code",{children:"X-API-Key"})," header of all API requests:"]}),e.jsx("div",{className:"bg-muted p-3 rounded-md",children:e.jsx("pre",{className:"text-xs overflow-auto",children:`// Example: X-API-Key header
X-API-Key: your_api_key_here

// Example curl request
curl -H "X-API-Key: your_api_key_here" https://cwcduhvwkihpnuaoflps.supabase.co/functions/v1/api-farmers`})}),e.jsxs("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:"âš ï¸ API Key Security"}),e.jsxs("ul",{className:"space-y-2 text-sm list-disc pl-5 text-yellow-800",children:[e.jsx("li",{children:"Never expose your API key in client-side code"}),e.jsx("li",{children:"Use environment variables to store keys in your server code"}),e.jsx("li",{children:"Set up proper CORS policies on your server"}),e.jsx("li",{children:"Rotate your API keys periodically for added security"}),e.jsx("li",{children:"Delete inactive API keys to prevent unauthorized access"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Rate Limiting"}),e.jsx("p",{className:"mb-2",children:"Our API enforces the following rate limits based on your subscription tier:"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-muted",children:[e.jsx("th",{className:"border px-4 py-2 text-left",children:"Subscription"}),e.jsx("th",{className:"border px-4 py-2 text-left",children:"Rate Limit"}),e.jsx("th",{className:"border px-4 py-2 text-left",children:"Monthly Requests"}),e.jsx("th",{className:"border px-4 py-2 text-left",children:"Data Access"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"border px-4 py-2",children:"Free"}),e.jsx("td",{className:"border px-4 py-2",children:"100 req/minute"}),e.jsx("td",{className:"border px-4 py-2",children:"1,000"}),e.jsx("td",{className:"border px-4 py-2",children:"Basic (Limited)"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"border px-4 py-2",children:"Developer"}),e.jsx("td",{className:"border px-4 py-2",children:"500 req/minute"}),e.jsx("td",{className:"border px-4 py-2",children:"50,000"}),e.jsx("td",{className:"border px-4 py-2",children:"Standard"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"border px-4 py-2",children:"Enterprise"}),e.jsx("td",{className:"border px-4 py-2",children:"2,000 req/minute"}),e.jsx("td",{className:"border px-4 py-2",children:"500,000"}),e.jsx("td",{className:"border px-4 py-2",children:"Premium (Full)"})]})]})]})}),e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"â„¹ï¸ Rate Limit Response"}),e.jsx("p",{className:"text-sm mb-2 text-blue-700",children:"When rate limited, the API returns a 429 status code with headers:"}),e.jsx("pre",{className:"bg-white p-2 rounded text-xs",children:`{
  "error": "Rate limit exceeded",
  "meta": {
    "limit": 100,
    "remaining": 0,
    "reset_time": "2025-06-11T12:30:00Z"
  }
}`})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Error Handling"}),e.jsx("p",{className:"mb-2",children:"Common API error responses:"}),e.jsxs("ul",{className:"space-y-2",children:[e.jsxs("li",{children:[e.jsx("code",{children:"401 Unauthorized"})," - Invalid or missing API key"]}),e.jsxs("li",{children:[e.jsx("code",{children:"403 Forbidden"})," - Subscription level doesn't allow access"]}),e.jsxs("li",{children:[e.jsx("code",{children:"404 Not Found"})," - Endpoint or resource not found"]}),e.jsxs("li",{children:[e.jsx("code",{children:"429 Too Many Requests"})," - Rate limit exceeded"]}),e.jsxs("li",{children:[e.jsx("code",{children:"500 Internal Server Error"})," - Server-side error"]})]})]})]})]}));class Aa{static async getUserApiKeys(){var t;try{const{data:{session:a}}=await F.auth.getSession();if(!a)throw new Error("Not authenticated");const r=await F.functions.invoke("api-keys-management",{method:"GET",headers:{Authorization:`Bearer ${a.access_token}`}});if(r.error)throw new Error("Failed to fetch API keys");return((t=r.data)==null?void 0:t.data)||[]}catch(a){return console.error("Error fetching API keys:",a),[]}}static async createApiKey(t){try{const{data:{session:a}}=await F.auth.getSession();if(!a)throw new Error("Not authenticated");const r=await F.functions.invoke("api-keys-management",{method:"POST",headers:{Authorization:`Bearer ${a.access_token}`,"Content-Type":"application/json"},body:{name:t}});if(r.error)throw new Error("Failed to create API key");return r.data}catch(a){throw console.error("Error creating API key:",a),a}}static async deleteApiKey(t){try{const{data:{session:a}}=await F.auth.getSession();if(!a)throw new Error("Not authenticated");if((await F.functions.invoke("api-keys-management",{method:"DELETE",headers:{Authorization:`Bearer ${a.access_token}`},body:{id:t}})).error)throw new Error("Failed to delete API key")}catch(a){throw console.error("Error deleting API key:",a),a}}}const Ju=()=>{const[s,t]=i.useState([]),[a,r]=i.useState(!0),[n,c]=i.useState(!1),[l,x]=i.useState(""),[f,j]=i.useState(""),[N,g]=i.useState(!1),{toast:u}=Z();i.useEffect(()=>{d()},[]);const d=async()=>{try{r(!0);const m=await Aa.getUserApiKeys();t(m)}catch{u({title:"Error",description:"Failed to load API keys",variant:"destructive"})}finally{r(!1)}},h=async()=>{if(!l.trim()){u({title:"Error",description:"Please enter a name for the API key",variant:"destructive"});return}try{const m=await Aa.createApiKey(l);j(m.api_key),g(!0),x(""),c(!1),await d(),u({title:"Success",description:"API key created successfully"})}catch{u({title:"Error",description:"Failed to create API key",variant:"destructive"})}},v=async m=>{try{await Aa.deleteApiKey(m),await d(),u({title:"Success",description:"API key deleted successfully"})}catch{u({title:"Error",description:"Failed to delete API key",variant:"destructive"})}},p=m=>{navigator.clipboard.writeText(m),u({title:"Copied!",description:"API key copied to clipboard"})};return a?e.jsx(w,{children:e.jsx(_,{className:"p-6",children:e.jsx("div",{className:"text-center",children:"Loading API keys..."})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(w,{children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(L,{children:"API Key Management"}),e.jsxs(_e,{open:n,onOpenChange:c,children:[e.jsx(Ie,{asChild:!0,children:e.jsxs(b,{children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Create API Key"]})}),e.jsxs(we,{children:[e.jsx(Ce,{children:e.jsx(ke,{children:"Create New API Key"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"keyName",children:"API Key Name"}),e.jsx(D,{id:"keyName",value:l,onChange:m=>x(m.target.value),placeholder:"e.g., Production API Key"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(b,{variant:"outline",onClick:()=>c(!1),children:"Cancel"}),e.jsx(b,{onClick:h,children:"Create Key"})]})]})]})]})]})}),e.jsx(_,{children:s.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"No API keys found"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Create your first API key to start accessing the API"})]}):e.jsx("div",{className:"space-y-4",children:s.map(m=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-medium",children:m.name}),e.jsx(I,{variant:m.is_active?"default":"secondary",children:m.is_active?"Active":"Inactive"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Key: ",m.key_preview]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Created: ",new Date(m.created_at).toLocaleDateString(),m.last_used_at&&e.jsxs("span",{className:"ml-4",children:["Last used: ",new Date(m.last_used_at).toLocaleDateString()]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(In,{children:[e.jsx(Rn,{asChild:!0,children:e.jsx(b,{variant:"outline",size:"sm",children:e.jsx(at,{className:"h-4 w-4"})})}),e.jsxs(ir,{children:[e.jsxs(nr,{children:[e.jsx(cr,{children:"Delete API Key"}),e.jsx(or,{children:"Are you sure you want to delete this API key? This action cannot be undone."})]}),e.jsxs(lr,{children:[e.jsx(mr,{children:"Cancel"}),e.jsx(dr,{onClick:()=>v(m.id),children:"Delete"})]})]})]})})]},m.id))})})]}),f&&e.jsx(_e,{open:N,onOpenChange:g,children:e.jsxs(we,{children:[e.jsx(Ce,{children:e.jsx(ke,{children:"API Key Created Successfully"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Your API Key:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"flex-1 text-sm bg-background p-2 rounded border",children:f}),e.jsx(b,{size:"sm",variant:"outline",onClick:()=>p(f),children:e.jsx(ot,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("p",{className:"font-medium mb-1",children:"Important:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"This is the only time you'll see this key"}),e.jsx("li",{children:"Store it securely in your application"}),e.jsx("li",{children:"Never share your API key publicly"})]})]}),e.jsx(b,{onClick:()=>g(!1),className:"w-full",children:"I've Saved My API Key"})]})]})})]})};class Xu{static async createAdvertisement(t){try{const{data:{user:a}}=await F.auth.getUser();if(!a)return{success:!1,error:"User not authenticated"};const{data:r,error:n}=await F.from("business_advertisements").insert({user_id:a.id,business_name:t.business_name,business_description:t.business_description,business_category:t.business_category,contact_email:t.contact_email,contact_phone:t.contact_phone,location:t.location,website_url:t.website_url,image_url:t.image_url,ad_content:t.ad_content,target_audience:t.target_audience}).select().single();return n?(console.error("Error creating advertisement:",n),{success:!1,error:n.message}):{success:!0,id:r.id}}catch(a){return console.error("Error in createAdvertisement:",a),{success:!1,error:"Failed to create advertisement"}}}static async getActiveAdvertisements(){try{const{data:t,error:a}=await F.from("business_advertisements").select("*").eq("is_active",!0).eq("payment_status","paid").gt("expires_at",new Date().toISOString()).order("created_at",{ascending:!1});return a?(console.error("Error fetching advertisements:",a),[]):(t||[]).map(r=>({...r,payment_status:r.payment_status}))}catch(t){return console.error("Error in getActiveAdvertisements:",t),[]}}static async getUserAdvertisements(){try{const{data:{user:t}}=await F.auth.getUser();if(!t)return[];const{data:a,error:r}=await F.from("business_advertisements").select("*").eq("user_id",t.id).order("created_at",{ascending:!1});return r?(console.error("Error fetching user advertisements:",r),[]):(a||[]).map(n=>({...n,payment_status:n.payment_status}))}catch(t){return console.error("Error in getUserAdvertisements:",t),[]}}static async updatePaymentStatus(t,a,r){try{const n=r==="paid"?new Date(Date.now()+2592e6).toISOString():null,{error:c}=await F.from("business_advertisements").update({payment_status:r,payment_id:a,is_active:r==="paid",expires_at:n,amount_paid:r==="paid"?20:null}).eq("id",t);return c?(console.error("Error updating payment status:",c),{success:!1,error:c.message}):{success:!0}}catch(n){return console.error("Error in updatePaymentStatus:",n),{success:!1,error:"Failed to update payment status"}}}static async recordTransaction(t){try{const{data:{user:a}}=await F.auth.getUser();if(!a)return{success:!1,error:"User not authenticated"};const{error:r}=await F.from("payment_transactions").insert({user_id:a.id,advertisement_id:t.advertisement_id,payment_provider:t.payment_provider,transaction_id:t.transaction_id,amount:t.amount,currency:t.currency,status:t.status,payment_details:t.payment_details});return r?(console.error("Error recording transaction:",r),{success:!1,error:r.message}):{success:!0}}catch(a){return console.error("Error in recordTransaction:",a),{success:!1,error:"Failed to record transaction"}}}static async checkApiAccess(){try{const{data:{user:t}}=await F.auth.getUser();if(!t)return{hasAccess:!1,subscriptionType:null,requestsRemaining:0};const{data:a,error:r}=await F.from("business_advertisements").select("payment_status, expires_at, amount_paid").eq("user_id",t.id).eq("payment_status","paid").gt("expires_at",new Date().toISOString());if(r)return console.error("Error checking API access:",r),{hasAccess:!1,subscriptionType:"free",requestsRemaining:1e3};let n="free",c=1e3,l;if(a&&a.length>0){const x=a.reduce((f,j)=>(j.amount_paid||0)>(f.amount_paid||0)?j:f);x.amount_paid&&(x.amount_paid>=15e3?(n="enterprise",c=5e5):x.amount_paid>=2500&&(n="developer",c=5e4),l=x.expires_at)}return{hasAccess:!0,subscriptionType:n,requestsRemaining:c,expiresAt:l}}catch(t){return console.error("Error in checkApiAccess:",t),{hasAccess:!1,subscriptionType:"free",requestsRemaining:1e3}}}static async incrementViewCount(t){try{const{data:a}=await F.from("business_advertisements").select("views_count").eq("id",t).single();if(a){const r=(a.views_count||0)+1;await F.from("business_advertisements").update({views_count:r}).eq("id",t)}}catch(a){console.error("Error incrementing view count:",a)}}static async incrementClickCount(t){try{const{data:a}=await F.from("business_advertisements").select("clicks_count").eq("id",t).single();if(a){const r=(a.clicks_count||0)+1;await F.from("business_advertisements").update({clicks_count:r}).eq("id",t)}}catch(a){console.error("Error incrementing click count:",a)}}static async getAnalytics(){try{const[t,a]=await Promise.all([F.from("business_advertisements").select("id",{count:"exact"}),F.from("business_advertisements").select("id",{count:"exact"}).eq("is_active",!0)]),{data:r}=await F.from("business_advertisements").select("amount_paid").eq("payment_status","paid"),n=(r==null?void 0:r.reduce((f,j)=>f+(j.amount_paid||0),0))||0,{data:c}=await F.from("business_advertisements").select("business_category"),l={};c==null||c.forEach(f=>{l[f.business_category]=(l[f.business_category]||0)+1});const x=Object.entries(l).map(([f,j])=>({category:f,count:j})).sort((f,j)=>j.count-f.count).slice(0,5);return{totalAds:t.count||0,activeAds:a.count||0,totalRevenue:n,topCategories:x}}catch(t){return console.error("Error in getAnalytics:",t),{totalAds:0,activeAds:0,totalRevenue:0,topCategories:[]}}}static async renewAdvertisement(t){try{const a=new Date(Date.now()+2592e6).toISOString(),{error:r}=await F.from("business_advertisements").update({expires_at:a,is_active:!0,payment_status:"paid"}).eq("id",t);return r?(console.error("Error renewing advertisement:",r),{success:!1,error:r.message}):{success:!0}}catch(a){return console.error("Error in renewAdvertisement:",a),{success:!1,error:"Failed to renew advertisement"}}}}class Zu{static async getPricingTiers(){try{const{data:t,error:a}=await F.from("pricing_tiers").select("*").eq("is_active",!0).order("price",{ascending:!0});return a?(console.error("Error fetching pricing tiers:",a),[{id:"free",name:"Free Tier",price:0,currency:"KES",period:"/month",requests:30,features:["Basic API access","Community support","Standard rate limits","30 API calls per month"],is_popular:!1,is_active:!0},{id:"developer",name:"Developer",price:2500,currency:"KES",period:"/month",requests:1e4,features:["Advanced API access","Email support","Higher rate limits","Analytics dashboard","10,000 API calls per month"],is_popular:!0,is_active:!0},{id:"enterprise",name:"Enterprise",price:15e3,currency:"KES",period:"/month",requests:1e5,features:["Full API access","Priority support","Custom rate limits","Dedicated account manager","Custom integrations","100,000 API calls per month"],is_popular:!1,is_active:!0}]):t||[]}catch(t){return console.error("Error fetching pricing tiers:",t),[]}}static async updatePricingTier(t){try{const{error:a}=await F.from("pricing_tiers").update({name:t.name,price:t.price,currency:t.currency,period:t.period,requests:t.requests,features:t.features,is_popular:t.is_popular,is_active:t.is_active}).eq("id",t.id);return!a}catch(a){return console.error("Error updating pricing tier:",a),!1}}}const ex=()=>{const[s,t]=i.useState(!1),[a,r]=i.useState({hasAccess:!1,subscriptionType:null,requestsRemaining:0}),[n,c]=i.useState([]),[l,x]=i.useState(!0),{toast:f}=Z(),{user:j}=je();i.useEffect(()=>{N(),g()},[]);const N=async()=>{const h=await Xu.checkApiAccess();r(h)},g=async()=>{x(!0);const h=await Zu.getPricingTiers();c(h),x(!1)},u=h=>{navigator.clipboard.writeText(h),t(!0),f({title:"Copied!",description:"API example copied to clipboard"}),setTimeout(()=>t(!1),2e3)},d=h=>{f({title:"Subscription Required",description:`Please purchase a business advertisement to access ${h} tier API features.`})};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"bg-white border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-6",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-2",children:"AgriConnect API Documentation"}),e.jsx("p",{className:"text-muted-foreground max-w-3xl",children:"Production-ready API access to Kenya's agricultural data, market information, and supply chain intelligence"}),e.jsxs("div",{className:"mt-4 flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[a.hasAccess?e.jsx(Cc,{className:"h-4 w-4 text-green-600"}):e.jsx(Ft,{className:"h-4 w-4 text-red-600"}),e.jsxs("span",{className:"text-sm",children:["Current Plan: ",e.jsx(I,{variant:a.subscriptionType==="free"?"outline":"default",children:a.subscriptionType||"None"})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Requests Remaining: ",a.requestsRemaining.toLocaleString()]})]})]}),j&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Welcome, ",j.email]})]})})}),e.jsx("main",{className:"py-8 px-4 md:px-6 max-w-7xl mx-auto",children:e.jsxs(ge,{defaultValue:"overview",className:"space-y-6",children:[e.jsxs(pe,{className:"grid grid-cols-5 w-full max-w-2xl mx-auto",children:[e.jsx(B,{value:"overview",children:"Overview"}),e.jsx(B,{value:"authentication",children:"Auth"}),e.jsx(B,{value:"endpoints",children:"Endpoints"}),e.jsx(B,{value:"keys",children:"API Keys"}),e.jsx(B,{value:"pricing",children:"Pricing"})]}),e.jsx(V,{value:"overview",children:e.jsx(Yu,{})}),e.jsx(V,{value:"authentication",children:e.jsx(Qu,{})}),e.jsx(V,{value:"endpoints",className:"space-y-6",children:e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Production API Endpoints"}),e.jsx("p",{className:"text-muted-foreground",children:"Live API endpoints with authentication and subscription-based access control"})]}),e.jsxs(_,{className:"space-y-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Authentication"}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:["Include your API key in the ",e.jsx("code",{children:"X-API-Key"})," header:"]}),e.jsx("code",{className:"bg-muted p-2 rounded-md block text-sm",children:"X-API-Key: your_api_key_here"})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{variant:"secondary",children:"GET"}),e.jsx("code",{className:"text-sm",children:"/api-farmers"}),e.jsx(I,{variant:"outline",className:"text-xs",children:"All Tiers"})]}),e.jsxs(b,{size:"sm",variant:"outline",onClick:()=>u('curl -H "X-API-Key: YOUR_API_KEY" https://cwcduhvwkihpnuaoflps.supabase.co/functions/v1/api-farmers'),children:[s?e.jsx(Qe,{className:"h-4 w-4"}):e.jsx(ot,{className:"h-4 w-4"}),"Copy"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Get farmer data (limited by subscription tier)"}),e.jsx("div",{className:"bg-muted p-2 rounded text-xs",children:e.jsxs("pre",{children:['curl -H "X-API-Key: YOUR_API_KEY" \\',`
`,"     https://cwcduhvwkihpnuaoflps.supabase.co/functions/v1/api-farmers"]})})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{variant:"secondary",children:"GET"}),e.jsx("code",{className:"text-sm",children:"/api-markets"}),e.jsx(I,{variant:"outline",className:"text-xs",children:"Developer+ Required"})]}),e.jsxs(b,{size:"sm",variant:"outline",onClick:()=>u('curl -H "X-API-Key: YOUR_API_KEY" https://cwcduhvwkihpnuaoflps.supabase.co/functions/v1/api-markets'),children:[s?e.jsx(Qe,{className:"h-4 w-4"}):e.jsx(ot,{className:"h-4 w-4"}),"Copy"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Access real market prices and demand data"}),e.jsx("div",{className:"bg-muted p-2 rounded text-xs",children:e.jsxs("pre",{children:['curl -H "X-API-Key: YOUR_API_KEY" \\',`
`,"     https://cwcduhvwkihpnuaoflps.supabase.co/functions/v1/api-markets"]})})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{variant:"secondary",children:"GET"}),e.jsx("code",{className:"text-sm",children:"/api-supply-chain"}),e.jsx(I,{variant:"destructive",className:"text-xs",children:"Enterprise Only"})]}),e.jsxs(b,{size:"sm",variant:"outline",onClick:()=>u('curl -H "X-API-Key: YOUR_API_KEY" https://cwcduhvwkihpnuaoflps.supabase.co/functions/v1/api-supply-chain'),children:[s?e.jsx(Qe,{className:"h-4 w-4"}):e.jsx(ot,{className:"h-4 w-4"}),"Copy"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Comprehensive supply chain analytics"}),e.jsx("div",{className:"bg-muted p-2 rounded text-xs",children:e.jsxs("pre",{children:['curl -H "X-API-Key: YOUR_API_KEY" \\',`
`,"     https://cwcduhvwkihpnuaoflps.supabase.co/functions/v1/api-supply-chain"]})})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{variant:"secondary",children:"GET"}),e.jsx("code",{className:"text-sm",children:"/api-commodities"}),e.jsx(I,{variant:"outline",className:"text-xs",children:"All Tiers"})]}),e.jsxs(b,{size:"sm",variant:"outline",onClick:()=>u('curl -H "X-API-Key: YOUR_API_KEY" https://cwcduhvwkihpnuaoflps.supabase.co/functions/v1/api-commodities'),children:[s?e.jsx(Qe,{className:"h-4 w-4"}):e.jsx(ot,{className:"h-4 w-4"}),"Copy"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Get commodity prices and market trends"}),e.jsx("div",{className:"bg-muted p-2 rounded text-xs",children:e.jsxs("pre",{children:['curl -H "X-API-Key: YOUR_API_KEY" \\',`
`,"     https://cwcduhvwkihpnuaoflps.supabase.co/functions/v1/api-commodities"]})})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-green-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2 text-green-800",children:"âœ… Production Ready"}),e.jsx("p",{className:"text-sm text-green-700",children:"All endpoints are fully functional with authentication, rate limiting, and subscription-tier access control. Try them with a valid API key!"})]})]})]})}),e.jsx(V,{value:"keys",className:"space-y-6",children:e.jsx(Ju,{})}),e.jsx(V,{value:"pricing",children:e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"API Pricing Plans"}),e.jsx("p",{className:"text-muted-foreground",children:"API access is linked to your business advertisement subscription. Purchase an advertisement to unlock higher API tiers."})]}),e.jsxs(_,{children:[l?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary"})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:n.map((h,v)=>{const p=h.name==="Free Tier"||h.name==="Developer"&&(a.subscriptionType==="developer"||a.subscriptionType==="enterprise")||h.name==="Enterprise"&&a.subscriptionType==="enterprise";return e.jsxs("div",{className:`border rounded-lg p-6 ${h.is_popular?"border-primary shadow-lg":""} ${p?"bg-green-50":"bg-gray-50"}`,children:[h.is_popular&&e.jsx(I,{className:"mb-4",children:"Most Popular"}),p&&e.jsx(I,{variant:"outline",className:"mb-4 bg-green-100 text-green-800",children:"Active"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:h.name}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("span",{className:"text-3xl font-bold",children:[h.currency," ",h.price.toLocaleString()]}),e.jsx("span",{className:"text-muted-foreground",children:h.period})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Up to ",h.requests.toLocaleString()," API requests per month"]}),e.jsx("ul",{className:"space-y-2 mb-6",children:h.features.map((m,o)=>e.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Qe,{className:"h-4 w-4 text-green-500"}),m]},o))}),e.jsx(b,{className:"w-full",variant:h.is_popular?"default":"outline",disabled:p||h.name==="Free Tier",onClick:()=>d(h.name),children:p?"Current Plan":h.name==="Free Tier"?"Active":"Subscribe"})]},h.id)})}),e.jsxs("div",{className:"mt-8 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"How API Access Works:"}),e.jsxs("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[e.jsx("li",{children:"â€¢ Free tier: Available to all registered users"}),e.jsx("li",{children:"â€¢ Developer tier: Unlocked by purchasing business advertisements (KES 2,500+)"}),e.jsx("li",{children:"â€¢ Enterprise tier: Unlocked by purchasing premium advertisements (KES 15,000+)"}),e.jsx("li",{children:"â€¢ API access renews automatically with your advertisement subscription"})]})]})]})]})})]})})]})},sx=()=>{const[s,t]=i.useState(!1),[a,r]=i.useState("developer"),{user:n}=je(),c=j=>{navigator.clipboard.writeText(j),t(!0),setTimeout(()=>t(!1),2e3)},l=[{id:"starter",name:"Free Tier",price:0,currency:"KES",period:"month",requests:"30",features:["Basic market data access","County-level statistics","Standard rate limits","Community support"],popular:!1,buttonText:"Get Started Free"},{id:"developer",name:"Developer",price:2500,currency:"KES",period:"month",requests:"10,000",features:["Full market data access","Real-time price feeds","Supply chain analytics","Priority email support","API analytics dashboard"],popular:!0,buttonText:"Start Developer Plan"},{id:"enterprise",name:"Enterprise",price:15e3,currency:"KES",period:"month",requests:"100,000+",features:["Unlimited API access","Custom integrations","Dedicated account manager","SLA guarantees","Custom data feeds","White-label options"],popular:!1,buttonText:"Contact Sales"}],x=[{method:"GET",endpoint:"/api/v1/supply-chain/farmers",description:"Retrieve farmer data across Kenya with location and crop information",example:'curl -H "Authorization: Bearer YOUR_API_KEY" https://api.agriconnect.co.ke/v1/supply-chain/farmers?county=nakuru'},{method:"GET",endpoint:"/api/v1/supply-chain/markets",description:"Access real-time market prices and demand data for agricultural commodities",example:'curl -H "Authorization: Bearer YOUR_API_KEY" https://api.agriconnect.co.ke/v1/supply-chain/markets?commodity=maize'},{method:"GET",endpoint:"/api/v1/supply-chain/logistics",description:"Transportation and warehouse data for supply chain optimization",example:'curl -H "Authorization: Bearer YOUR_API_KEY" https://api.agriconnect.co.ke/v1/supply-chain/logistics?type=transport'},{method:"GET",endpoint:"/api/v1/supply-chain/analytics",description:"Advanced analytics and forecasting for agricultural supply chains",example:'curl -H "Authorization: Bearer YOUR_API_KEY" https://api.agriconnect.co.ke/v1/supply-chain/analytics?metric=price-forecast'}],f=[{title:"Agribusiness Integration",description:"Integrate real-time market data into your agricultural business applications",icon:e.jsx(Re,{className:"h-8 w-8 text-blue-600"}),revenue:"KES 500K+/month"},{title:"Fintech Agriculture",description:"Build financial products for farmers using our verified agricultural data",icon:e.jsx(Ae,{className:"h-8 w-8 text-green-600"}),revenue:"KES 1M+/month"},{title:"Logistics Optimization",description:"Optimize transportation routes and costs using our supply chain APIs",icon:e.jsx(ye,{className:"h-8 w-8 text-orange-600"}),revenue:"KES 300K+/month"},{title:"Research & Analytics",description:"Access comprehensive datasets for agricultural research and analysis",icon:e.jsx(st,{className:"h-8 w-8 text-purple-600"}),revenue:"KES 200K+/month"}];return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-2",children:"Supply Chain API Platform"}),e.jsx("p",{className:"text-muted-foreground max-w-3xl mx-auto mb-4",children:"Monetized access to Kenya's most comprehensive agricultural supply chain data and analytics"}),e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[e.jsx(I,{className:"bg-green-100 text-green-800",children:"Live API âœ…"}),e.jsx(I,{className:"bg-blue-100 text-blue-800",children:"99.9% Uptime"}),e.jsx(I,{className:"bg-purple-100 text-purple-800",children:"Enterprise Ready"}),e.jsx(I,{className:"bg-orange-100 text-orange-800",children:"Hosted: Supabase Edge Functions"})]}),n&&e.jsxs("div",{className:"text-sm text-muted-foreground mb-4",children:["Signed in as: ",n.email]})]}),e.jsx("div",{className:"mb-8 max-w-4xl mx-auto",children:e.jsx(w,{className:"border-green-200 bg-green-50",children:e.jsxs(_,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(Ve,{className:"h-6 w-6 text-green-600"}),e.jsx("h3",{className:"text-lg font-semibold text-green-800",children:"API Security Status"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-green-700",children:"âœ… Authentication"}),e.jsx("div",{className:"text-green-600",children:"API Key validation active"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-green-700",children:"âœ… Rate Limiting"}),e.jsx("div",{className:"text-green-600",children:"Per-tier limits enforced"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-green-700",children:"âœ… Monitoring"}),e.jsx("div",{className:"text-green-600",children:"Usage tracking enabled"})]})]})]})})}),e.jsxs("main",{className:"py-8 px-4 md:px-6 max-w-7xl mx-auto",children:[e.jsxs(ge,{defaultValue:"overview",className:"space-y-6",children:[e.jsxs(pe,{className:"grid grid-cols-4 w-full max-w-2xl mx-auto",children:[e.jsx(B,{value:"overview",children:"Overview"}),e.jsx(B,{value:"pricing",children:"Pricing"}),e.jsx(B,{value:"endpoints",children:"API Docs"}),e.jsx(B,{value:"examples",children:"Examples"})]}),e.jsxs(V,{value:"overview",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(w,{children:e.jsxs(_,{className:"p-6 text-center",children:[e.jsx(Le,{className:"h-8 w-8 text-blue-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold",children:"47"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Counties Covered"})]})}),e.jsx(w,{children:e.jsxs(_,{className:"p-6 text-center",children:[e.jsx(se,{className:"h-8 w-8 text-green-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold",children:"50K+"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Registered Farmers"})]})}),e.jsx(w,{children:e.jsxs(_,{className:"p-6 text-center",children:[e.jsx(gt,{className:"h-8 w-8 text-yellow-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold",children:"2M+"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"API Calls/Month"})]})}),e.jsx(w,{children:e.jsxs(_,{className:"p-6 text-center",children:[e.jsx(Ae,{className:"h-8 w-8 text-purple-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold",children:"99.9%"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"API Uptime"})]})})]}),e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"Revenue-Generating Use Cases"})}),e.jsx(_,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:f.map((j,N)=>e.jsx("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start gap-4",children:[j.icon,e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:j.title}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:j.description}),e.jsxs(I,{variant:"outline",className:"text-green-600 border-green-200",children:["Revenue Potential: ",j.revenue]})]})]})},N))})})]})]}),e.jsxs(V,{value:"pricing",className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Choose Your API Plan"}),e.jsx("p",{className:"text-muted-foreground",children:"Updated pricing with new request limits"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:l.map(j=>e.jsxs(w,{className:`relative ${j.popular?"border-green-500 shadow-lg":""}`,children:[j.popular&&e.jsx(I,{className:"absolute -top-3 left-1/2 transform -translate-x-1/2 bg-green-600",children:"Most Popular"}),e.jsxs(q,{className:"text-center",children:[e.jsx(L,{children:j.name}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("span",{className:"text-3xl font-bold",children:[j.currency," ",j.price.toLocaleString()]}),e.jsxs("span",{className:"text-muted-foreground",children:["/",j.period]})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Up to ",j.requests," API requests"]})]}),e.jsxs(_,{children:[e.jsx("ul",{className:"space-y-2 mb-6",children:j.features.map((N,g)=>e.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Qe,{className:"h-4 w-4 text-green-500"}),N]},g))}),e.jsx(b,{className:"w-full",variant:j.popular?"default":"outline",onClick:()=>r(j.id),children:j.buttonText})]})]},j.id))})]}),e.jsx(V,{value:"endpoints",className:"space-y-6",children:e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"API Endpoints"}),e.jsx("p",{className:"text-muted-foreground",children:"Complete reference for our supply chain API"})]}),e.jsx(_,{children:e.jsx("div",{className:"space-y-4",children:x.map((j,N)=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(I,{variant:"secondary",className:"bg-green-100 text-green-800",children:j.method}),e.jsx("code",{className:"text-sm font-mono",children:j.endpoint})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:j.description}),e.jsx("div",{className:"bg-muted p-3 rounded text-sm font-mono overflow-x-auto",children:j.example}),e.jsxs(b,{size:"sm",variant:"outline",className:"mt-2",onClick:()=>c(j.example),children:[s?e.jsx(Qe,{className:"h-4 w-4"}):e.jsx(ot,{className:"h-4 w-4"}),"Copy Example"]})]},N))})})]})}),e.jsxs(V,{value:"examples",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"JavaScript/Node.js"})}),e.jsx(_,{children:e.jsx("div",{className:"bg-muted p-4 rounded-md",children:e.jsx("pre",{className:"text-sm overflow-auto",children:`const response = await fetch(
  'https://api.agriconnect.co.ke/v1/supply-chain/farmers',
  {
    headers: {
      'Authorization': 'Bearer YOUR_API_KEY',
      'Content-Type': 'application/json'
    }
  }
);

const farmers = await response.json();
console.log(\`Found \${farmers.length} farmers\`);`})})})]}),e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"Python"})}),e.jsx(_,{children:e.jsx("div",{className:"bg-muted p-4 rounded-md",children:e.jsx("pre",{className:"text-sm overflow-auto",children:`import requests

headers = {
    'Authorization': 'Bearer YOUR_API_KEY',
    'Content-Type': 'application/json'
}

response = requests.get(
    'https://api.agriconnect.co.ke/v1/supply-chain/markets',
    headers=headers
)

markets = response.json()
print(f"Found {len(markets)} markets")`})})})]})]}),e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"Revenue Integration Example"})}),e.jsx(_,{children:e.jsx("div",{className:"bg-muted p-4 rounded-md",children:e.jsx("pre",{className:"text-sm overflow-auto",children:`// Example: Building a profitable agritech app
const buildProfitableApp = async () => {
  // Get market data for price predictions
  const markets = await agriConnectAPI.getMarkets();
  
  // Get farmer data for targeted services
  const farmers = await agriConnectAPI.getFarmers();
  
  // Build premium features with our data
  const premiumInsights = await agriConnectAPI.getAnalytics();
  
  // Monetize with subscription model
  return {
    monthlyRevenue: 'KES 500,000+',
    userBase: farmers.length,
    features: premiumInsights
  };
};`})})})]})]})]}),e.jsx(w,{className:"mt-12 bg-gradient-to-r from-green-50 to-blue-50",children:e.jsxs(_,{className:"p-8 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Ready to Build the Future of Agriculture?"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-2xl mx-auto",children:"Join hundreds of developers building profitable agricultural applications with our comprehensive API platform"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsx(b,{size:"lg",className:"bg-green-600 hover:bg-green-700",children:"Start Building Today"}),e.jsx(b,{size:"lg",variant:"outline",children:"Contact Enterprise Sales"})]})]})})]})]})},Vn=i.createContext(null);function pa(){const s=i.useContext(Vn);if(!s)throw new Error("useCarousel must be used within a <Carousel />");return s}const $n=i.forwardRef(({orientation:s="horizontal",opts:t,setApi:a,plugins:r,className:n,children:c,...l},x)=>{const[f,j]=kc({...t,axis:s==="horizontal"?"x":"y"},r),[N,g]=i.useState(!1),[u,d]=i.useState(!1),h=i.useCallback(o=>{o&&(g(o.canScrollPrev()),d(o.canScrollNext()))},[]),v=i.useCallback(()=>{j==null||j.scrollPrev()},[j]),p=i.useCallback(()=>{j==null||j.scrollNext()},[j]),m=i.useCallback(o=>{o.key==="ArrowLeft"?(o.preventDefault(),v()):o.key==="ArrowRight"&&(o.preventDefault(),p())},[v,p]);return i.useEffect(()=>{!j||!a||a(j)},[j,a]),i.useEffect(()=>{if(j)return h(j),j.on("reInit",h),j.on("select",h),()=>{j==null||j.off("select",h)}},[j,h]),e.jsx(Vn.Provider,{value:{carouselRef:f,api:j,opts:t,orientation:s||((t==null?void 0:t.axis)==="y"?"vertical":"horizontal"),scrollPrev:v,scrollNext:p,canScrollPrev:N,canScrollNext:u},children:e.jsx("div",{ref:x,onKeyDownCapture:m,className:$("relative",n),role:"region","aria-roledescription":"carousel",...l,children:c})})});$n.displayName="Carousel";const Gn=i.forwardRef(({className:s,...t},a)=>{const{carouselRef:r,orientation:n}=pa();return e.jsx("div",{ref:r,className:"overflow-hidden",children:e.jsx("div",{ref:a,className:$("flex",n==="horizontal"?"-ml-4":"-mt-4 flex-col",s),...t})})});Gn.displayName="CarouselContent";const Hn=i.forwardRef(({className:s,...t},a)=>{const{orientation:r}=pa();return e.jsx("div",{ref:a,role:"group","aria-roledescription":"slide",className:$("min-w-0 shrink-0 grow-0 basis-full",r==="horizontal"?"pl-4":"pt-4",s),...t})});Hn.displayName="CarouselItem";const Wn=i.forwardRef(({className:s,variant:t="outline",size:a="icon",...r},n)=>{const{orientation:c,scrollPrev:l,canScrollPrev:x}=pa();return e.jsxs(b,{ref:n,variant:t,size:a,className:$("absolute  h-8 w-8 rounded-full",c==="horizontal"?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!x,onClick:l,...r,children:[e.jsx(Wa,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Previous slide"})]})});Wn.displayName="CarouselPrevious";const Yn=i.forwardRef(({className:s,variant:t="outline",size:a="icon",...r},n)=>{const{orientation:c,scrollNext:l,canScrollNext:x}=pa();return e.jsxs(b,{ref:n,variant:t,size:a,className:$("absolute h-8 w-8 rounded-full",c==="horizontal"?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!x,onClick:l,...r,children:[e.jsx(ks,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Next slide"})]})});Yn.displayName="CarouselNext";const tx=({partners:s})=>{const[t,a]=i.useState([]),r=[{id:"1",company_name:"Kenya Seed Company",logo_url:"https://via.placeholder.com/200x100?text=Kenya+Seed+Co",website:"https://kenyaseed.com",description:"Leading seed supplier in East Africa"},{id:"2",company_name:"Equity Bank",logo_url:"https://via.placeholder.com/200x100?text=Equity+Bank",website:"https://equitybank.co.ke",description:"Agricultural financing partner"},{id:"3",company_name:"Safaricom",logo_url:"https://via.placeholder.com/200x100?text=Safaricom",website:"https://safaricom.co.ke",description:"M-Pesa integration partner"},{id:"4",company_name:"Ministry of Agriculture",logo_url:"https://via.placeholder.com/200x100?text=Ministry+Agric",website:"https://kilimo.go.ke",description:"Government strategic partner"},{id:"5",company_name:"Kenya Agricultural Research",logo_url:"https://via.placeholder.com/200x100?text=KALRO",website:"https://kalro.org",description:"Research and development partner"},{id:"6",company_name:"Twiga Foods",logo_url:"https://via.placeholder.com/200x100?text=Twiga+Foods",website:"https://twiga.com",description:"Distribution network partner"}];i.useEffect(()=>{a(s&&s.length>0?s:r)},[s]);const n=Bs.useRef(Sc({delay:3e3,stopOnInteraction:!0}));return!t||t.length===0?null:e.jsx("section",{className:"py-12 bg-muted/30",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold mb-2",children:"Our Trusted Partners"}),e.jsx("p",{className:"text-muted-foreground",children:"Working together to transform agriculture in Kenya"})]}),e.jsxs($n,{plugins:[n.current],className:"w-full",onMouseEnter:n.current.stop,onMouseLeave:n.current.reset,children:[e.jsx(Gn,{className:"-ml-2 md:-ml-4",children:t.map(c=>e.jsx(Hn,{className:"pl-2 md:pl-4 md:basis-1/2 lg:basis-1/3",children:e.jsx(w,{className:"hover:shadow-lg transition-shadow h-full",children:e.jsxs(_,{className:"p-6 flex flex-col items-center justify-center h-full",children:[c.logo_url?e.jsx("img",{src:c.logo_url,alt:c.company_name,className:"h-20 w-auto object-contain mb-4",onError:l=>{l.currentTarget.src=`https://via.placeholder.com/200x100?text=${encodeURIComponent(c.company_name)}`}}):e.jsx("div",{className:"h-20 w-full bg-muted rounded flex items-center justify-center mb-4",children:e.jsx("span",{className:"text-lg font-bold text-muted-foreground",children:c.company_name})}),e.jsx("h3",{className:"font-semibold text-lg text-center mb-2",children:c.company_name}),c.description&&e.jsx("p",{className:"text-sm text-muted-foreground text-center line-clamp-2",children:c.description}),c.website&&e.jsx("a",{href:c.website,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-primary hover:underline mt-2",children:"Visit Website"})]})})},c.id))}),e.jsx(Wn,{className:"hidden md:flex"}),e.jsx(Yn,{className:"hidden md:flex"})]}),e.jsx("div",{className:"text-center mt-8",children:e.jsx(b,{variant:"outline",onClick:()=>window.location.href="/partner-with-us",children:"Become a Partner"})})]})})},ax="/assets/partners-hero-bg-CPDI1CTr.jpg",rx=()=>{const s=Ne(),[t,a]=i.useState([]),[r,n]=i.useState(!0);i.useEffect(()=>{c()},[]);const c=async()=>{try{const{data:x,error:f}=await F.from("partners").select("*").order("created_at",{ascending:!1});if(f)throw f;a(x||[])}catch(x){console.error("Error fetching partners:",x)}finally{n(!1)}},l=[{label:"Active Partners",value:t.length.toString(),icon:e.jsx(se,{className:"h-5 w-5"})},{label:"Partner Events",value:"50+",icon:e.jsx(Ps,{className:"h-5 w-5"})},{label:"Farmers Reached",value:"50,000+",icon:e.jsx(ce,{className:"h-5 w-5"})}];return e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),e.jsxs("section",{className:"relative py-20 md:py-28 bg-cover bg-center",style:{backgroundImage:`url(${ax})`},children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-green-900/80 via-green-800/60 to-transparent"}),e.jsxs("div",{className:"container mx-auto px-4 text-center relative z-10",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-4 text-white drop-shadow-lg",children:"Our Partners"}),e.jsx("p",{className:"text-xl mb-8 max-w-3xl mx-auto text-white/90 drop-shadow",children:"Together with our partners, we're transforming agriculture and empowering farmers across Kenya"}),e.jsxs(b,{size:"lg",variant:"secondary",onClick:()=>s("/partner-with-us"),children:[e.jsx(He,{className:"h-4 w-4 mr-2"}),"Become a Partner"]})]})]}),e.jsx("section",{className:"py-12 bg-muted/30",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:l.map((x,f)=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx("div",{className:"p-3 bg-primary/10 rounded-full",children:x.icon})}),e.jsx("div",{className:"text-3xl font-bold text-primary mb-2",children:x.value}),e.jsx("div",{className:"text-muted-foreground",children:x.label})]},f))})})}),e.jsx(tx,{partners:t}),e.jsx("section",{className:"py-16",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Meet Our Partners"}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"Our partners provide essential services, funding, and support to help farmers succeed"})]}),r?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading partners..."})}):t.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"No partners yet. Be the first!"}),e.jsx(b,{onClick:()=>s("/partner-with-us"),children:"Become a Partner"})]}):e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(x=>e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(q,{children:[x.logo_url&&e.jsx("div",{className:"mb-4 h-24 flex items-center justify-center",children:e.jsx("img",{src:x.logo_url,alt:x.company_name,className:"max-h-full max-w-full object-contain",onError:f=>{f.currentTarget.style.display="none"}})}),e.jsx(L,{className:"text-xl",children:x.company_name})]}),e.jsxs(_,{children:[x.description&&e.jsx("p",{className:"text-muted-foreground mb-4 line-clamp-3",children:x.description}),e.jsx(qe,{className:"my-4"}),e.jsxs("div",{className:"space-y-2",children:[x.contact_email&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(He,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsx("a",{href:`mailto:${x.contact_email}`,className:"text-primary hover:underline break-all",children:x.contact_email})]}),x.contact_phone&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ee,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsx("a",{href:`tel:${x.contact_phone}`,className:"text-primary hover:underline",children:x.contact_phone})]}),x.website&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Le,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsxs("a",{href:x.website,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline flex items-center gap-1 break-all",children:["Visit Website",e.jsx(xs,{className:"h-3 w-3"})]})]})]})]})]},x.id))})]})}),e.jsx("section",{className:"py-16 bg-primary text-primary-foreground",children:e.jsxs("div",{className:"container mx-auto px-4 text-center",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Interested in Partnering?"}),e.jsx("p",{className:"text-xl mb-8 max-w-2xl mx-auto opacity-90",children:"Join our ecosystem and help transform agriculture in Kenya"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[e.jsxs(b,{size:"lg",variant:"secondary",onClick:()=>s("/partner-with-us"),children:[e.jsx(He,{className:"h-4 w-4 mr-2"}),"Apply Now"]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(He,{className:"h-4 w-4"}),e.jsx("a",{href:"mailto:sokoconnect@tenderzville-portal.co.ke",className:"hover:underline",children:"sokoconnect@tenderzville-portal.co.ke"})]})]})]})}),e.jsx(Nt,{})]})},$t=[{id:"A1",name:"A1 - Nairobi-Mombasa Highway",description:"The busiest highway connecting Nairobi to Mombasa port"},{id:"A2",name:"A2 - Nairobi-Nakuru-Eldoret Highway",description:"Northern corridor to Eldoret and Uganda border"},{id:"A3",name:"A3 - Nairobi-Naivasha-Kisumu Highway",description:"Western route to Kisumu and Lake Victoria"},{id:"A104",name:"A104 - Nairobi-Thika Superhighway",description:"Modern expressway to Central Kenya"},{id:"B3",name:"B3 - Mombasa-Malindi-Lamu Highway",description:"Coastal route connecting major beach towns"},{id:"C77",name:"C77 - Nairobi-Namanga Highway",description:"Route to Tanzania border"}],Ta=()=>{var te,ue;const{toast:s}=Z(),{user:t}=je(),[a,r]=i.useState("markets"),[n,c]=i.useState("all"),[l,x]=i.useState(""),[f,j]=i.useState([]),[N,g]=i.useState([]),[u,d]=i.useState(!0),[h,v]=i.useState(!0),[p,m]=i.useState(!1),[o,y]=i.useState(!0),k=i.useRef(null),A=i.useRef(null),[S,E]=i.useState({name:"",road:"",location:"",county:"",contact_info:"",facilities:""});i.useEffect(()=>{P()},[]),i.useEffect(()=>{if(!k.current||A.current)return;const z=Qs.map(k.current).setView([-1.2921,36.8219],7);Qs.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(z);const U={A1:[[-1.2921,36.8219],[-2.5,37.5],[-4.0435,39.6682]],A2:[[-1.2921,36.8219],[-.3031,36.08],[.5143,35.2698]],A3:[[-1.2921,36.8219],[-.7179,36.4314],[-.0917,34.768]],A104:[[-1.2921,36.8219],[-1.0396,37.0693]],B3:[[-4.0435,39.6682],[-3.2138,40.1169]],C77:[[-1.2921,36.8219],[-2.7333,36.7833]]},K={A1:"#e53935",A2:"#1e88e5",A3:"#43a047",A104:"#fb8c00",B3:"#8e24aa",C77:"#00897b"};return Object.entries(U).forEach(([be,ts])=>{const ls=$t.find(he=>he.id===be);Qs.polyline(ts,{color:K[be]||"#333",weight:4,opacity:.8}).bindPopup(`<strong>${(ls==null?void 0:ls.name)||be}</strong><br/>${(ls==null?void 0:ls.description)||""}`).addTo(z)}),[{lat:-1.5177,lng:37.2634,name:"Machakos Fresh Produce",route:"A1"},{lat:-1.4504,lng:36.957,name:"Athi River Grain Store",route:"A1"},{lat:-.3031,lng:36.08,name:"Nakuru Dairy Hub",route:"A2"},{lat:-1.0396,lng:37.0693,name:"Thika Pineapple Vendors",route:"A104"}].forEach(be=>{const ts=Qs.divIcon({className:"custom-marker",html:'<div style="background:#43a047;color:white;border-radius:50%;width:28px;height:28px;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:bold;border:2px solid white;box-shadow:0 2px 4px rgba(0,0,0,0.3);">ðŸª</div>',iconSize:[28,28],iconAnchor:[14,14]});Qs.marker([be.lat,be.lng],{icon:ts}).bindPopup(`<strong>${be.name}</strong><br/>Route: ${be.route}`).addTo(z)}),A.current=z,()=>{z.remove(),A.current=null}},[]);const P=async()=>{d(!0);try{const{data:z,error:U}=await F.from("road_markets").select("*").eq("is_active",!0);if(U)throw U;j(z||[]),g([{id:"1",name:"Machakos Fresh Produce",route:"A1",location:"Machakos Junction, KM 65",services:["Fresh Produce","Cold Storage","Bulk Orders"],products:["Tomatoes","Onions","Potatoes","Cabbages"],rating:4.5,phone:"+254 712 345 678",verified:!0},{id:"2",name:"Athi River Grain Store",route:"A1",location:"Athi River, KM 25",services:["Grain Trading","Warehousing"],products:["Maize","Beans","Green Grams"],rating:4.8,phone:"+254 723 456 789",verified:!0},{id:"3",name:"Nakuru Dairy Hub",route:"A2",location:"Nakuru Town, KM 160",services:["Dairy Products","Refrigerated Transport"],products:["Milk","Yogurt","Cheese"],rating:4.7,phone:"+254 734 567 890",verified:!0},{id:"4",name:"Thika Pineapple Vendors",route:"A104",location:"Thika, Blue Post Area",services:["Fresh Fruits","Direct Farm Sales"],products:["Pineapples","Avocados","Bananas"],rating:4.3,phone:"+254 745 678 901",verified:!1}])}catch(z){console.error("Error fetching data:",z),s({title:"Error",description:"Failed to load route marketplace data",variant:"destructive"})}finally{d(!1)}},R=async()=>{if(!t){s({title:"Please login",description:"You must be logged in to add markets",variant:"destructive"});return}try{const{error:z}=await F.from("road_markets").insert({name:S.name,road:S.road,location:S.location,county:S.county,contact_info:S.contact_info,facilities:S.facilities.split(",").map(U=>U.trim()),is_active:!0});if(z)throw z;s({title:"Success",description:"Market added successfully!"}),m(!1),E({name:"",road:"",location:"",county:"",contact_info:"",facilities:""}),P()}catch{s({title:"Error",description:"Failed to add market",variant:"destructive"})}},M=f.filter(z=>{const U=n==="all"||z.road.includes(n),K=z.name.toLowerCase().includes(l.toLowerCase())||z.location.toLowerCase().includes(l.toLowerCase());return U&&K}),O=N.filter(z=>{const U=n==="all"||z.route===n,K=z.name.toLowerCase().includes(l.toLowerCase())||z.products.some(ae=>ae.toLowerCase().includes(l.toLowerCase()));return U&&K});return e.jsxs("div",{className:"min-h-screen bg-background pb-20 md:pb-0",children:[e.jsx(ne,{}),h&&e.jsx(_s,{marketplaceType:"agricultural",onAccept:()=>v(!1)}),e.jsx("section",{className:"bg-gradient-to-r from-emerald-600 to-teal-700 text-white py-12",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx(va,{className:"h-10 w-10"}),e.jsx("h1",{className:"text-3xl md:text-4xl font-bold",children:"Major Routes Marketplace"})]}),e.jsx("p",{className:"text-lg mb-6 max-w-2xl opacity-90",children:"Find farmers, traders, and markets along Kenya's major highways. Direct access to quality produce and services on your route."}),e.jsx("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4 max-w-3xl",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(hs,{className:"h-5 w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Willing Buyer â€“ Willing Seller Marketplace"}),e.jsx("p",{className:"text-sm opacity-90",children:"SokoConnect connects buyers and sellers but does not guarantee transactions. Always verify before proceeding."})]})]})})]})}),e.jsx("section",{className:"container mx-auto px-4 py-6",children:e.jsxs(w,{children:[e.jsxs(q,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsxs(L,{className:"text-lg flex items-center gap-2",children:[e.jsx(Pc,{className:"h-5 w-5 text-primary"}),"Route Map - Kenya's Major Highways"]}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>y(!o),children:o?"Hide Map":"Show Map"})]}),o&&e.jsxs(_,{children:[e.jsx("div",{ref:k,className:"w-full h-[400px] rounded-lg border",style:{zIndex:1}}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-3 text-xs",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-1 bg-red-600 inline-block rounded"})," A1 Nairobi-Mombasa"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-1 bg-blue-600 inline-block rounded"})," A2 Nairobi-Eldoret"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-1 bg-green-600 inline-block rounded"})," A3 Nairobi-Kisumu"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-1 bg-orange-500 inline-block rounded"})," A104 Thika Superhighway"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-1 bg-purple-600 inline-block rounded"})," B3 Coastal Highway"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-1 bg-teal-600 inline-block rounded"})," C77 Namanga"]})]})]})]})}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Pe,{className:"absolute left-3 top-3 h-5 w-5 text-muted-foreground"}),e.jsx(D,{placeholder:"Search markets, vendors, products...",value:l,onChange:z=>x(z.target.value),className:"pl-10"})]}),e.jsxs(Q,{value:n,onValueChange:c,children:[e.jsx(W,{className:"w-full md:w-64",children:e.jsx(J,{placeholder:"Select Route"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Routes"}),$t.map(z=>e.jsx(T,{value:z.id,children:z.name},z.id))]})]}),t&&e.jsxs(_e,{open:p,onOpenChange:m,children:[e.jsx(Ie,{asChild:!0,children:e.jsxs(b,{children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Add Market"]})}),e.jsxs(we,{children:[e.jsx(Ce,{children:e.jsx(ke,{children:"Add Road Market"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Market Name *"}),e.jsx(D,{value:S.name,onChange:z=>E({...S,name:z.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Road *"}),e.jsx(D,{value:S.road,onChange:z=>E({...S,road:z.target.value}),placeholder:"e.g., A1 Highway"})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Location *"}),e.jsx(D,{value:S.location,onChange:z=>E({...S,location:z.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{children:"County *"}),e.jsx(D,{value:S.county,onChange:z=>E({...S,county:z.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Contact Info"}),e.jsx(D,{value:S.contact_info,onChange:z=>E({...S,contact_info:z.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Facilities (comma-separated)"}),e.jsx(D,{value:S.facilities,onChange:z=>E({...S,facilities:z.target.value}),placeholder:"Parking, Toilets, Water"})]}),e.jsx(b,{onClick:R,className:"w-full",children:"Add Market"})]})]})]})]}),n!=="all"&&e.jsx(w,{className:"mb-6 bg-primary/5 border-primary/20",children:e.jsx(_,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ee,{className:"h-5 w-5 text-primary mt-1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:(te=$t.find(z=>z.id===n))==null?void 0:te.name}),e.jsx("p",{className:"text-muted-foreground text-sm",children:(ue=$t.find(z=>z.id===n))==null?void 0:ue.description})]})]})})}),e.jsxs(ge,{value:a,onValueChange:r,children:[e.jsxs(pe,{className:"mb-6",children:[e.jsxs(B,{value:"markets",className:"gap-2",children:[e.jsx(Ge,{className:"h-4 w-4"}),"Road Markets (",M.length,")"]}),e.jsxs(B,{value:"vendors",className:"gap-2",children:[e.jsx(se,{className:"h-4 w-4"}),"Vendors (",O.length,")"]})]}),e.jsx(V,{value:"markets",children:u?e.jsx("div",{className:"text-center py-12",children:"Loading markets..."}):M.length===0?e.jsx(w,{className:"text-center py-12",children:e.jsxs(_,{children:[e.jsx(Ge,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No markets found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"No road markets match your search. Try different filters or add a new market."}),t&&e.jsxs(b,{onClick:()=>m(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Add First Market"]})]})}):e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:M.map(z=>e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(q,{children:[e.jsx(L,{className:"text-lg",children:z.name}),e.jsxs(G,{className:"flex items-center gap-1",children:[e.jsx(ee,{className:"h-3 w-3"}),z.location,", ",z.county]})]}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(va,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:z.road})]}),z.market_days&&z.market_days.length>0&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(is,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:z.market_days.join(", ")})]}),z.facilities&&z.facilities.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:z.facilities.slice(0,3).map((U,K)=>e.jsx(I,{variant:"secondary",className:"text-xs",children:U},K))}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[z.contact_info&&e.jsxs(b,{variant:"outline",size:"sm",className:"flex-1",children:[e.jsx(Ee,{className:"h-4 w-4 mr-1"}),"Call"]}),e.jsxs(b,{size:"sm",className:"flex-1",children:[e.jsx(yr,{className:"h-4 w-4 mr-1"}),"Directions"]})]})]})})]},z.id))})}),e.jsx(V,{value:"vendors",children:u?e.jsx("div",{className:"text-center py-12",children:"Loading vendors..."}):O.length===0?e.jsx(w,{className:"text-center py-12",children:e.jsxs(_,{children:[e.jsx(se,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No vendors found"}),e.jsx("p",{className:"text-muted-foreground",children:"No vendors match your search criteria."})]})}):e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:O.map(z=>e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(q,{children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{children:[e.jsxs(L,{className:"text-lg flex items-center gap-2",children:[z.name,z.verified&&e.jsx(I,{variant:"secondary",className:"text-xs",children:"Verified"})]}),e.jsxs(G,{className:"flex items-center gap-1",children:[e.jsx(ee,{className:"h-3 w-3"}),z.location]})]})}),e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(es,{className:"h-4 w-4 fill-yellow-500 text-yellow-500"}),e.jsx("span",{className:"font-semibold",children:z.rating})]})]}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-muted-foreground mb-1",children:"PRODUCTS:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:z.products.slice(0,4).map(U=>e.jsx(I,{variant:"outline",className:"text-xs",children:U},U))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-muted-foreground mb-1",children:"SERVICES:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:z.services.slice(0,3).map(U=>e.jsx(I,{variant:"secondary",className:"text-xs",children:U},U))})]}),e.jsxs(I,{className:"mt-2",children:[e.jsx(va,{className:"h-3 w-3 mr-1"}),"Route ",z.route]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(b,{variant:"outline",size:"sm",className:"flex-1",children:[e.jsx(Ee,{className:"h-4 w-4 mr-1"}),"Call"]}),e.jsxs(b,{size:"sm",className:"flex-1",children:[e.jsx(yr,{className:"h-4 w-4 mr-1"}),"Navigate"]})]})]})})]},z.id))})})]}),e.jsx(w,{className:"mt-12 bg-gradient-to-r from-primary/10 to-secondary/10",children:e.jsxs(_,{className:"pt-6 pb-6 text-center",children:[e.jsx(ye,{className:"h-12 w-12 mx-auto mb-4 text-primary"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"Have a Business Along a Major Route?"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Get discovered by thousands of travelers and traders. List your location, products, and services."}),e.jsx(b,{size:"lg",onClick:()=>t?m(!0):s({title:"Please login",description:"Sign in to add your business"}),children:"Add Your Business"})]})})]}),e.jsx(Me,{})]})},ix=()=>{const{toast:s}=Z(),[t,a]=i.useState([]),[r,n]=i.useState(!0),[c,l]=i.useState(""),[x,f]=i.useState("all"),[j,N]=i.useState("all"),[g,u]=i.useState(!1);i.useEffect(()=>{d()},[]);const d=async()=>{try{n(!0);const{data:o,error:y}=await F.from("export_opportunities").select("*").eq("status","open").order("created_at",{ascending:!1});if(y)throw y;a(o||[])}catch(o){console.error("Error fetching export opportunities:",o),s({title:"Error",description:"Failed to load export opportunities.",variant:"destructive"})}finally{n(!1)}},h=Array.from(new Set(t.map(o=>o.buyer_country))),v=Array.from(new Set(t.map(o=>o.commodity))),p=t.filter(o=>{const y=c===""||o.commodity.toLowerCase().includes(c.toLowerCase())||o.buyer_company.toLowerCase().includes(c.toLowerCase()),k=x==="all"||o.buyer_country===x,A=j==="all"||o.commodity===j;return y&&k&&A}),m=o=>{const y=new Date(o),k=new Date,A=y.getTime()-k.getTime(),S=Math.ceil(A/(1e3*60*60*24));return Math.max(0,S)};return e.jsxs("div",{className:"flex min-h-screen flex-col pb-20 md:pb-0",children:[e.jsx("header",{className:"sticky top-0 z-30 w-full border-b bg-background",children:e.jsxs("div",{className:"container flex h-16 items-center",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx($e,{})}),e.jsx("div",{className:"md:hidden",children:e.jsx(ss,{})})]})}),e.jsxs("main",{className:"flex-1",children:[e.jsx("section",{className:"bg-gradient-to-r from-primary to-primary/80 text-primary-foreground py-16",children:e.jsx("div",{className:"container px-4",children:e.jsxs("div",{className:"max-w-3xl mx-auto text-center",children:[e.jsx(Le,{className:"h-16 w-16 mx-auto mb-4"}),e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-4",children:"Export Opportunities"}),e.jsx("p",{className:"text-xl mb-8",children:"Connect with international buyers and export your produce globally"}),e.jsxs(_e,{open:g,onOpenChange:u,children:[e.jsx(Ie,{asChild:!0,children:e.jsxs(b,{size:"lg",variant:"secondary",children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Post Export Opportunity"]})}),e.jsxs(we,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Ce,{children:[e.jsx(ke,{children:"Post Export Opportunity"}),e.jsx(it,{children:"Create a new export opportunity for farmers to apply"})]}),e.jsx("div",{className:"text-muted-foreground py-8 text-center",children:e.jsx("p",{children:"Form component would go here with all export opportunity fields"})})]})]})]})})}),e.jsxs("div",{className:"container px-4 py-12",children:[e.jsxs("div",{className:"grid md:grid-cols-4 gap-6 mb-12",children:[e.jsx(w,{children:e.jsxs(_,{className:"pt-6 text-center",children:[e.jsx(Le,{className:"h-8 w-8 mx-auto mb-2 text-primary"}),e.jsx("div",{className:"text-3xl font-bold",children:t.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Active Opportunities"})]})}),e.jsx(w,{children:e.jsxs(_,{className:"pt-6 text-center",children:[e.jsx(ee,{className:"h-8 w-8 mx-auto mb-2 text-primary"}),e.jsx("div",{className:"text-3xl font-bold",children:h.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Countries"})]})}),e.jsx(w,{children:e.jsxs(_,{className:"pt-6 text-center",children:[e.jsx(re,{className:"h-8 w-8 mx-auto mb-2 text-primary"}),e.jsx("div",{className:"text-3xl font-bold",children:v.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Commodities"})]})}),e.jsx(w,{children:e.jsxs(_,{className:"pt-6 text-center",children:[e.jsx(ce,{className:"h-8 w-8 mx-auto mb-2 text-primary"}),e.jsx("div",{className:"text-3xl font-bold",children:"$2.5M+"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Value"})]})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-8",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Pe,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(D,{placeholder:"Search opportunities...",value:c,onChange:o=>l(o.target.value),className:"pl-10"})]}),e.jsxs(Q,{value:x,onValueChange:f,children:[e.jsx(W,{className:"w-full md:w-48",children:e.jsx(J,{placeholder:"All Countries"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Countries"}),h.map(o=>e.jsx(T,{value:o,children:o},o))]})]}),e.jsxs(Q,{value:j,onValueChange:N,children:[e.jsx(W,{className:"w-full md:w-48",children:e.jsx(J,{placeholder:"All Commodities"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Commodities"}),v.map(o=>e.jsx(T,{value:o,children:o},o))]})]})]}),r?e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(o=>e.jsxs(w,{className:"animate-pulse",children:[e.jsxs(q,{children:[e.jsx("div",{className:"h-6 bg-muted rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/2"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"h-4 bg-muted rounded w-full mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-5/6"})]})]},o))}):p.length===0?e.jsx(w,{className:"text-center py-12",children:e.jsxs(_,{children:[e.jsx(Le,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No opportunities found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Try adjusting your filters or check back later for new opportunities."})]})}):e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.map(o=>{const y=m(o.application_deadline);return e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(q,{children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(L,{className:"text-lg line-clamp-1",children:o.commodity}),o.variety&&e.jsx("p",{className:"text-sm text-muted-foreground",children:o.variety})]}),e.jsxs(I,{variant:y>7?"secondary":"destructive",children:[y,"d left"]})]}),e.jsx(G,{className:"line-clamp-1",children:o.buyer_company})]}),e.jsxs(_,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ee,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{className:"truncate",children:o.buyer_country})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(re,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsxs("span",{className:"truncate",children:[o.quantity.toLocaleString()," ",o.unit]})]}),o.target_price&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ae,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsxs("span",{className:"truncate font-semibold",children:[o.currency," ",o.target_price.toLocaleString(),"/",o.unit]})]}),o.required_certifications.length>0&&e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(Ps,{className:"h-4 w-4 text-muted-foreground flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[o.required_certifications.slice(0,2).map((k,A)=>e.jsx(I,{variant:"outline",className:"text-xs",children:k},A)),o.required_certifications.length>2&&e.jsxs(I,{variant:"outline",className:"text-xs",children:["+",o.required_certifications.length-2]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(xe,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsxs("span",{className:"truncate",children:["Apply by: ",new Date(o.application_deadline).toLocaleDateString()]})]})]}),e.jsxs(me,{className:"flex gap-2",children:[e.jsx(b,{variant:"outline",size:"sm",className:"flex-1",children:"View Details"}),e.jsx(b,{size:"sm",className:"flex-1",children:"Apply Now"})]})]},o.id)})}),e.jsxs("section",{className:"mt-16 bg-muted/30 rounded-lg p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"How Export Opportunities Work"}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"Simple steps to access global markets"})]}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl font-bold text-primary",children:"1"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Browse Opportunities"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Find export opportunities matching your produce"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl font-bold text-primary",children:"2"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Submit Application"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Apply with your production details and certifications"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl font-bold text-primary",children:"3"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Get Selected"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Buyer reviews and selects suppliers"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl font-bold text-primary",children:"4"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Export & Earn"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Fulfill order and receive payment"})]})]})]})]})]}),e.jsx(Me,{})]})},xr=({src:s,alt:t,className:a="w-full h-40 object-cover",fallbackIcon:r=!0})=>{const[n,c]=i.useState(!1),[l,x]=i.useState(!0);return!s||n?e.jsx("div",{className:`${a} bg-gradient-to-br from-gray-200 to-gray-300 flex items-center justify-center`,children:r&&e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(Ac,{className:"h-8 w-8 text-gray-400"}),e.jsx("span",{className:"text-xs text-gray-500",children:"No Image"})]})}):e.jsxs("div",{className:"relative overflow-hidden",children:[l&&e.jsx("div",{className:`${a} bg-gray-200 animate-pulse absolute inset-0`}),e.jsx("img",{src:s,alt:t,className:a,onLoad:()=>x(!1),onError:f=>{console.error(`Failed to load image: ${s}`),x(!1),c(!0)},loading:"lazy"})]})};async function Oa(s){var t;try{const{data:a,error:r}=await F.functions.invoke("paystack-initialize",{body:{email:s.email,amount:s.amount,metadata:{plan_id:s.plan_id,plan_type:s.plan_type,...s.metadata}}});return r?(console.error("Paystack initialization error:",r),{success:!1,error:r.message}):(a==null?void 0:a.status)===!0&&((t=a==null?void 0:a.data)!=null&&t.authorization_url)?{success:!0,authorization_url:a.data.authorization_url,reference:a.data.reference}:a!=null&&a.authorization_url?{success:!0,authorization_url:a.authorization_url,reference:a.reference}:(console.error("Unexpected Paystack response:",a),{success:!1,error:"Unexpected response from payment gateway"})}catch(a){return console.error("Paystack initialization failed:",a),{success:!1,error:"Failed to initialize payment"}}}const Da={"ad-1month":{id:"ad-1month",name:"1 Month Package",amount:1300,period:"1 month"},"ad-3months":{id:"ad-3months",name:"3 Months Package",amount:2600,period:"3 months"},"ad-1year":{id:"ad-1year",name:"1 Year Package",amount:3900,period:"1 year"}},Gt={id:"f2c-supplier-listing",name:"F2C Supplier Listing Fee",amount:1e3,description:"One-time fee per supplier to list subscription boxes on SokoConnect"};function Ka(s){window.location.href=s}const Vr={title:"SokoConnect Platform Disclaimer",message:"SokoConnect is a marketplace facilitator only. We connect buyers and sellers but are NOT liable for the quality, delivery, or fulfillment of any transaction. All transactions are between willing buyers and willing sellers. Always verify products and sellers before proceeding."},nx="/assets/f2c-hero-bg-Bzp3Bm_n.png",lx=()=>{const{toast:s}=Z(),t=Ne(),[a,r]=i.useState([]),[n,c]=i.useState(!0),[l,x]=i.useState(""),[f,j]=i.useState("all"),[N,g]=i.useState("all"),[u,d]=i.useState(!0),[h,v]=i.useState(null);i.useEffect(()=>{p()},[]);const p=async()=>{try{c(!0);const{data:A,error:S}=await F.from("subscription_boxes").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(S)throw S;r(A||[])}catch(A){console.error("Error fetching subscription boxes:",A),s({title:"Error",description:"Failed to load subscription boxes.",variant:"destructive"})}finally{c(!1)}},m=async A=>{const{data:{user:S}}=await F.auth.getUser();if(!S){s({title:"Sign In Required",description:"Please sign in to subscribe to this box.",variant:"destructive"}),t("/auth");return}v(A.id);try{const E=await Oa({email:S.email||"",amount:A.price,plan_id:`f2c-${A.box_type}`,plan_type:"f2c",metadata:{user_id:S.id,box_id:A.id,box_name:A.box_name,subscription_type:A.box_type,delivery_county:A.county}});E.success&&E.authorization_url?(s({title:"Redirecting to Payment",description:"You'll be redirected to Paystack to complete payment."}),Ka(E.authorization_url)):s({title:"Payment Error",description:E.error||"Failed to initialize payment. Please try again.",variant:"destructive"})}catch(E){console.error("Subscription error:",E),s({title:"Error",description:"Failed to process subscription. Please try again.",variant:"destructive"})}finally{v(null)}},o=Array.from(new Set(a.map(A=>A.county))),y=a.filter(A=>{const S=l===""||A.box_name.toLowerCase().includes(l.toLowerCase())||A.farm_location.toLowerCase().includes(l.toLowerCase()),E=f==="all"||A.box_type===f,P=N==="all"||A.county===N;return S&&E&&P}),k=A=>{switch(A){case"weekly":return"Weekly";case"bi-weekly":return"Bi-Weekly";case"monthly":return"Monthly";default:return A}};return e.jsxs("div",{className:"flex min-h-screen flex-col pb-20 md:pb-0",children:[e.jsx("header",{className:"sticky top-0 z-30 w-full border-b bg-background",children:e.jsxs("div",{className:"container flex h-16 items-center",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx($e,{})}),e.jsx("div",{className:"md:hidden",children:e.jsx(ss,{})})]})}),u&&e.jsx(_s,{marketplaceType:"agricultural",onAccept:()=>d(!1)}),e.jsxs("main",{className:"flex-1",children:[e.jsx("section",{className:"relative py-20 md:py-28",style:{backgroundImage:`linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.7)), url(${nx})`,backgroundSize:"cover",backgroundPosition:"center"},children:e.jsx("div",{className:"container px-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center text-white",children:[e.jsxs(I,{className:"mb-4 bg-green-500/20 text-green-300 border-green-500/30",children:[e.jsx(as,{className:"h-3 w-3 mr-1"}),"Farm Fresh Direct"]}),e.jsxs("h1",{className:"text-4xl md:text-6xl font-bold mb-6 leading-tight",children:["Farm-to-Consumer",e.jsx("br",{}),"Subscription Boxes"]}),e.jsx("p",{className:"text-xl md:text-2xl mb-8 text-gray-200 max-w-2xl mx-auto",children:"Fresh, organic produce delivered directly from Kenyan farms to your doorstep. Support local farmers while enjoying the freshest ingredients."}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-6 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full",children:[e.jsx(ns,{className:"h-5 w-5 text-green-400"}),e.jsx("span",{children:"100% Organic"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full",children:[e.jsx(ye,{className:"h-5 w-5 text-green-400"}),e.jsx("span",{children:"Free Delivery"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full",children:[e.jsx(We,{className:"h-5 w-5 text-green-400"}),e.jsx("span",{children:"Support Farmers"})]})]}),e.jsxs(b,{size:"lg",className:"bg-green-600 hover:bg-green-700 text-white px-8 py-6 text-lg",onClick:async()=>{const{data:{user:A}}=await F.auth.getUser();if(!A){s({title:"Sign In Required",description:"Please sign in to list your subscription box.",variant:"destructive"}),t("/auth");return}const S=await Oa({email:A.email||"",amount:Gt.amount,plan_id:Gt.id,plan_type:"f2c",metadata:{user_id:A.id,fee_type:"supplier_listing"}});S.success&&S.authorization_url?Ka(S.authorization_url):s({title:"Error",description:S.error||"Failed to process payment",variant:"destructive"})},children:[e.jsx(ie,{className:"h-5 w-5 mr-2"}),"List Your Box (KES ",Gt.amount.toLocaleString()," listing fee)"]}),e.jsxs("p",{className:"text-sm text-gray-300 mt-3",children:["Farmers pay a one-time KES ",Gt.amount.toLocaleString()," listing fee. Customers are ",e.jsx("strong",{children:"never"})," charged by SokoConnect."]})]})})}),e.jsx("section",{className:"container px-4 pt-4",children:e.jsxs("div",{className:"bg-amber-50 dark:bg-amber-950/20 border border-amber-200 dark:border-amber-800 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(hs,{className:"h-5 w-5 text-amber-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm text-amber-800 dark:text-amber-300",children:Vr.title}),e.jsx("p",{className:"text-sm text-amber-700 dark:text-amber-400",children:Vr.message})]})]})}),e.jsx("section",{className:"bg-primary/5 py-8 border-b",children:e.jsx("div",{className:"container px-4",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold text-primary",children:"500+"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Active Farmers"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold text-primary",children:"47"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Counties Covered"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold text-primary",children:"2,000+"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Happy Subscribers"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold text-primary",children:"24hrs"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Farm to Door"})]})]})})}),e.jsxs("div",{className:"container px-4 py-12",children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-12",children:[e.jsx(w,{className:"text-center border-2 hover:border-primary/50 transition-colors",children:e.jsxs(_,{className:"pt-6",children:[e.jsx("div",{className:"p-4 bg-gradient-to-br from-green-100 to-green-50 rounded-full w-20 h-20 mx-auto mb-4 flex items-center justify-center",children:e.jsx(re,{className:"h-10 w-10 text-green-600"})}),e.jsx("h3",{className:"font-bold text-xl mb-2",children:"Farm Fresh Produce"}),e.jsx("p",{className:"text-muted-foreground",children:"Harvested and delivered within 24-48 hours for maximum freshness"})]})}),e.jsx(w,{className:"text-center border-2 hover:border-primary/50 transition-colors",children:e.jsxs(_,{className:"pt-6",children:[e.jsx("div",{className:"p-4 bg-gradient-to-br from-blue-100 to-blue-50 rounded-full w-20 h-20 mx-auto mb-4 flex items-center justify-center",children:e.jsx(ye,{className:"h-10 w-10 text-blue-600"})}),e.jsx("h3",{className:"font-bold text-xl mb-2",children:"Doorstep Delivery"}),e.jsx("p",{className:"text-muted-foreground",children:"Convenient scheduled delivery right to your home or office"})]})}),e.jsx(w,{className:"text-center border-2 hover:border-primary/50 transition-colors",children:e.jsxs(_,{className:"pt-6",children:[e.jsx("div",{className:"p-4 bg-gradient-to-br from-amber-100 to-amber-50 rounded-full w-20 h-20 mx-auto mb-4 flex items-center justify-center",children:e.jsx(Ae,{className:"h-10 w-10 text-amber-600"})}),e.jsx("h3",{className:"font-bold text-xl mb-2",children:"Fair Trade Prices"}),e.jsx("p",{className:"text-muted-foreground",children:"No middlemen - farmers get fair pay, you get better prices"})]})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-8",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Pe,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(D,{placeholder:"Search subscription boxes...",value:l,onChange:A=>x(A.target.value),className:"pl-10"})]}),e.jsxs(Q,{value:f,onValueChange:j,children:[e.jsx(W,{className:"w-full md:w-48",children:e.jsx(J,{placeholder:"All Types"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Types"}),e.jsx(T,{value:"weekly",children:"Weekly"}),e.jsx(T,{value:"bi-weekly",children:"Bi-Weekly"}),e.jsx(T,{value:"monthly",children:"Monthly"})]})]}),e.jsxs(Q,{value:N,onValueChange:g,children:[e.jsx(W,{className:"w-full md:w-48",children:e.jsx(J,{placeholder:"All Counties"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Counties"}),o.map(A=>e.jsx(T,{value:A,children:A},A))]})]})]}),n?e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(A=>e.jsxs(w,{className:"animate-pulse",children:[e.jsx("div",{className:"h-48 bg-muted"}),e.jsxs(q,{children:[e.jsx("div",{className:"h-6 bg-muted rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/2"})]})]},A))}):y.length===0?e.jsx(w,{className:"text-center py-12",children:e.jsxs(_,{children:[e.jsx(Tc,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No subscription boxes found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Try adjusting your filters or check back later."})]})}):e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:y.map(A=>{const S=A.max_subscriptions?A.max_subscriptions-A.current_subscriptions:null,E=h===A.id;return e.jsxs(w,{className:"hover:shadow-lg transition-shadow overflow-hidden",children:[e.jsx("div",{className:"h-48 bg-gray-200",children:e.jsx(xr,{src:A.images&&A.images.length>0?A.images[0]:void 0,alt:A.box_name,className:"w-full h-48 object-cover"})}),e.jsxs(q,{children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx(L,{className:"text-lg flex-1",children:A.box_name}),e.jsx(I,{children:k(A.box_type)})]}),e.jsx(G,{className:"line-clamp-2",children:A.description})]}),e.jsxs(_,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ee,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsxs("span",{className:"truncate",children:[A.farm_location,", ",A.county]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ae,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsxs("span",{className:"font-semibold text-lg",children:[A.currency," ",A.price.toLocaleString(),"/",k(A.box_type).toLowerCase()]})]}),A.delivery_areas.length>0&&e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(ye,{className:"h-4 w-4 text-muted-foreground flex-shrink-0 mt-0.5"}),e.jsxs("span",{className:"text-muted-foreground",children:["Delivers to: ",A.delivery_areas.slice(0,3).join(", "),A.delivery_areas.length>3&&` +${A.delivery_areas.length-3} more`]})]}),S!==null&&e.jsx("div",{className:"text-sm text-muted-foreground",children:S>0?e.jsxs("span",{children:[S," slots available"]}):e.jsx(I,{variant:"destructive",children:"Fully Subscribed"})})]}),e.jsxs(me,{className:"flex gap-2",children:[e.jsx(b,{variant:"outline",size:"sm",className:"flex-1",children:"View Details"}),e.jsx(b,{size:"sm",className:"flex-1",disabled:S!==null&&S<=0||E,onClick:()=>m(A),children:E?e.jsxs(e.Fragment,{children:[e.jsx(As,{className:"h-4 w-4 mr-2 animate-spin"}),"Processing..."]}):"Subscribe Now"})]})]},A.id)})})]})]}),e.jsx(Me,{})]})},cx=()=>{const{toast:s}=Z(),[t,a]=i.useState([]),[r,n]=i.useState(!0),[c,l]=i.useState(""),[x,f]=i.useState(null),[j,N]=i.useState(!1);i.useEffect(()=>{g()},[]);const g=async()=>{try{n(!0);const{data:{user:v}}=await F.auth.getUser();if(!v){s({title:"Authentication Required",description:"Please sign in to view your batches.",variant:"destructive"});return}const{data:p,error:m}=await F.from("batch_tracking").select("*").eq("farmer_id",v.id).order("created_at",{ascending:!1});if(m)throw m;a(p||[])}catch(v){console.error("Error fetching batches:",v),s({title:"Error",description:"Failed to load batch tracking data.",variant:"destructive"})}finally{n(!1)}},u=t.filter(v=>v.batch_id.toLowerCase().includes(c.toLowerCase())||v.product_type.toLowerCase().includes(c.toLowerCase())),d=v=>({harvested:"bg-green-500",in_transit:"bg-blue-500",at_processor:"bg-yellow-500",processed:"bg-purple-500",at_warehouse:"bg-orange-500",in_export:"bg-cyan-500",delivered:"bg-emerald-500"})[v]||"bg-gray-500",h=v=>v.split("_").map(p=>p.charAt(0).toUpperCase()+p.slice(1)).join(" ");return e.jsxs("div",{className:"flex min-h-screen flex-col pb-20 md:pb-0",children:[e.jsx("header",{className:"sticky top-0 z-30 w-full border-b bg-background",children:e.jsxs("div",{className:"container flex h-16 items-center",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx($e,{})}),e.jsx("div",{className:"md:hidden",children:e.jsx(ss,{})})]})}),e.jsxs("main",{className:"flex-1",children:[e.jsx("section",{className:"bg-gradient-to-r from-primary to-primary/80 text-primary-foreground py-16",children:e.jsx("div",{className:"container px-4",children:e.jsxs("div",{className:"max-w-3xl mx-auto text-center",children:[e.jsx(mt,{className:"h-16 w-16 mx-auto mb-4"}),e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-4",children:"Batch Tracking & Traceability"}),e.jsx("p",{className:"text-xl mb-8",children:"Track your produce from farm to market with complete transparency"}),e.jsxs(_e,{open:j,onOpenChange:N,children:[e.jsx(Ie,{asChild:!0,children:e.jsxs(b,{size:"lg",variant:"secondary",children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Create New Batch"]})}),e.jsxs(we,{className:"sm:max-w-[550px]",children:[e.jsxs(Ce,{children:[e.jsx(ke,{children:"Create New Batch"}),e.jsx(it,{children:"Register a new batch for tracking and traceability"})]}),e.jsx("div",{className:"text-muted-foreground py-8 text-center",children:e.jsx("p",{children:"Batch creation form would go here"})})]})]})]})})}),e.jsxs("div",{className:"container px-4 py-12",children:[e.jsxs("div",{className:"grid md:grid-cols-4 gap-6 mb-12",children:[e.jsx(w,{children:e.jsxs(_,{className:"pt-6 text-center",children:[e.jsx(re,{className:"h-8 w-8 mx-auto mb-2 text-primary"}),e.jsx("div",{className:"text-3xl font-bold",children:t.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Batches"})]})}),e.jsx(w,{children:e.jsxs(_,{className:"pt-6 text-center",children:[e.jsx(ce,{className:"h-8 w-8 mx-auto mb-2 text-primary"}),e.jsx("div",{className:"text-3xl font-bold",children:t.filter(v=>v.status==="in_transit"||v.status==="at_processor").length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"In Transit"})]})}),e.jsx(w,{children:e.jsxs(_,{className:"pt-6 text-center",children:[e.jsx(ns,{className:"h-8 w-8 mx-auto mb-2 text-primary"}),e.jsx("div",{className:"text-3xl font-bold",children:t.filter(v=>v.status==="delivered").length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Delivered"})]})}),e.jsx(w,{children:e.jsxs(_,{className:"pt-6 text-center",children:[e.jsx(mt,{className:"h-8 w-8 mx-auto mb-2 text-primary"}),e.jsx("div",{className:"text-3xl font-bold",children:t.filter(v=>v.qr_code).length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"With QR Codes"})]})})]}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"relative",children:[e.jsx(Pe,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(D,{placeholder:"Search by batch ID or product...",value:c,onChange:v=>l(v.target.value),className:"pl-10"})]})}),r?e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(v=>e.jsxs(w,{className:"animate-pulse",children:[e.jsxs(q,{children:[e.jsx("div",{className:"h-6 bg-muted rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/2"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"h-4 bg-muted rounded w-full mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-5/6"})]})]},v))}):u.length===0?e.jsx(w,{className:"text-center py-12",children:e.jsxs(_,{children:[e.jsx(re,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No batches found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Create your first batch to start tracking your produce."}),e.jsxs(b,{onClick:()=>N(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Create Batch"]})]})}):e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.map(v=>e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(L,{className:"text-lg font-mono",children:v.batch_id}),e.jsx(G,{children:v.product_type})]}),e.jsx(I,{className:d(v.status),children:h(v.status)})]})}),e.jsxs(_,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(re,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsxs("span",{children:[v.quantity.toLocaleString()," ",v.unit]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ee,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{className:"truncate",children:v.origin})]}),v.harvest_date&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(xe,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsxs("span",{children:["Harvested: ",new Date(v.harvest_date).toLocaleDateString()]})]}),v.certifications.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:v.certifications.map((p,m)=>e.jsx(I,{variant:"outline",className:"text-xs",children:p},m))}),e.jsxs("div",{className:"pt-3 border-t",children:[e.jsxs("div",{className:"text-xs text-muted-foreground mb-2",children:[v.events.length," events â€¢ ",v.quality_checkpoints.length," checkpoints"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>f(v),children:"View Journey"}),v.qr_code&&e.jsx(b,{size:"sm",variant:"secondary",children:e.jsx(mt,{className:"h-4 w-4"})})]})]})]})]},v.id))}),e.jsxs("section",{className:"mt-16 bg-muted/30 rounded-lg p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"How Batch Tracking Works"}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"Complete transparency from farm to consumer"})]}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl font-bold text-primary",children:"1"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Register Batch"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Create unique batch ID at harvest"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl font-bold text-primary",children:"2"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Track Movement"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Record each step in supply chain"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl font-bold text-primary",children:"3"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Quality Control"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Document quality checkpoints"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl font-bold text-primary",children:"4"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Share Information"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Buyers scan QR to view history"})]})]})]})]})]}),e.jsx(Me,{})]})},ox="/assets/carbon-forum-bg-BW7-N_bB.png",dx=()=>{const{toast:s}=Z(),[t,a]=i.useState([]),[r,n]=i.useState([]),[c,l]=i.useState(!0),[x,f]=i.useState("tracking");i.useEffect(()=>{j()},[]);const j=async()=>{try{l(!0);const{data:{user:u}}=await F.auth.getUser();if(!u){s({title:"Authentication Required",description:"Please sign in to view carbon tracking.",variant:"destructive"});return}const{data:d,error:h}=await F.from("carbon_emissions").select("*").eq("user_id",u.id).order("date_recorded",{ascending:!1});if(h)throw h;const{data:v,error:p}=await F.from("carbon_offset_projects").select("*").eq("status","active").order("created_at",{ascending:!1});if(p)throw p;a(d||[]),n(v||[])}catch(u){console.error("Error fetching carbon data:",u),s({title:"Error",description:"Failed to load carbon tracking data.",variant:"destructive"})}finally{l(!1)}},N=t.reduce((u,d)=>u+d.co2_equivalent,0),g=t.filter(u=>u.verified).length;return e.jsxs("div",{className:"flex min-h-screen flex-col pb-20 md:pb-0",children:[e.jsx("header",{className:"sticky top-0 z-30 w-full border-b bg-background",children:e.jsxs("div",{className:"container flex h-16 items-center",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx($e,{})}),e.jsx("div",{className:"md:hidden",children:e.jsx(ss,{})})]})}),e.jsxs("main",{className:"flex-1",children:[e.jsxs("section",{className:"relative text-white py-16 bg-cover bg-center",style:{backgroundImage:`url(${ox})`,backgroundAttachment:"fixed"},children:[e.jsx("div",{className:"absolute inset-0 bg-black/40"}),e.jsx("div",{className:"relative container px-4",children:e.jsxs("div",{className:"max-w-3xl mx-auto text-center",children:[e.jsx(as,{className:"h-16 w-16 mx-auto mb-4"}),e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-4",children:"Carbon Footprint Tracking"}),e.jsx("p",{className:"text-xl mb-8",children:"Measure, reduce, and offset your agricultural carbon emissions"}),e.jsxs(b,{size:"lg",variant:"secondary",children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Record Emissions"]})]})})]}),e.jsxs("div",{className:"container px-4 py-12",children:[e.jsxs("div",{className:"grid md:grid-cols-4 gap-6 mb-12",children:[e.jsx(w,{children:e.jsxs(_,{className:"pt-6 text-center",children:[e.jsx(as,{className:"h-8 w-8 mx-auto mb-2 text-primary"}),e.jsx("div",{className:"text-3xl font-bold",children:N.toFixed(1)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total COâ‚‚e (tonnes)"})]})}),e.jsx(w,{children:e.jsxs(_,{className:"pt-6 text-center",children:[e.jsx(Fs,{className:"h-8 w-8 mx-auto mb-2 text-primary"}),e.jsx("div",{className:"text-3xl font-bold",children:t.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Emission Records"})]})}),e.jsx(w,{children:e.jsxs(_,{className:"pt-6 text-center",children:[e.jsx(Ps,{className:"h-8 w-8 mx-auto mb-2 text-primary"}),e.jsx("div",{className:"text-3xl font-bold",children:g}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Verified"})]})}),e.jsx(w,{children:e.jsxs(_,{className:"pt-6 text-center",children:[e.jsx(Re,{className:"h-8 w-8 mx-auto mb-2 text-primary"}),e.jsx("div",{className:"text-3xl font-bold",children:r.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Offset Projects"})]})})]}),e.jsxs(ge,{value:x,onValueChange:f,className:"mb-8",children:[e.jsxs(pe,{className:"grid w-full grid-cols-3",children:[e.jsx(B,{value:"tracking",children:"Emission Tracking"}),e.jsx(B,{value:"offsets",children:"Carbon Offsets"}),e.jsx(B,{value:"insights",children:"Insights"})]}),e.jsx(V,{value:"tracking",className:"mt-6",children:c?e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:[1,2,3,4].map(u=>e.jsx(w,{className:"animate-pulse",children:e.jsxs(q,{children:[e.jsx("div",{className:"h-6 bg-muted rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/2"})]})},u))}):t.length===0?e.jsx(w,{className:"text-center py-12",children:e.jsxs(_,{children:[e.jsx(as,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No emissions recorded"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Start tracking your carbon emissions to understand your environmental impact."}),e.jsxs(b,{children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Record First Emission"]})]})}):e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:t.map(u=>e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(L,{className:"text-lg",children:u.activity_type}),e.jsx(G,{children:u.emission_source})]}),u.verified&&e.jsxs(I,{variant:"secondary",className:"bg-green-100 text-green-800",children:[e.jsx(Ps,{className:"h-3 w-3 mr-1"}),"Verified"]})]})}),e.jsxs(_,{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"COâ‚‚ Equivalent"}),e.jsxs("span",{className:"font-semibold text-lg",children:[u.co2_equivalent.toFixed(2)," tonnes"]})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Quantity"}),e.jsxs("span",{children:[u.quantity," ",u.unit]})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Entity Type"}),e.jsx(I,{variant:"outline",children:u.entity_type})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground pt-2 border-t",children:[e.jsx(xe,{className:"h-4 w-4"}),e.jsx("span",{children:new Date(u.date_recorded).toLocaleDateString()})]})]})]},u.id))})}),e.jsx(V,{value:"offsets",className:"mt-6",children:c?e.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:[1,2,3].map(u=>e.jsx(w,{className:"animate-pulse",children:e.jsxs(q,{children:[e.jsx("div",{className:"h-6 bg-muted rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/2"})]})},u))}):r.length===0?e.jsx(w,{className:"text-center py-12",children:e.jsxs(_,{children:[e.jsx(as,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No offset projects available"}),e.jsx("p",{className:"text-muted-foreground",children:"Check back soon for carbon offset opportunities."})]})}):e.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:r.map(u=>e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(q,{children:[e.jsx(L,{className:"text-lg line-clamp-2",children:u.project_name}),e.jsx(G,{children:e.jsx(I,{variant:"outline",children:u.project_type})})]}),e.jsxs(_,{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-3",children:u.description}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Offset Potential"}),e.jsxs("span",{className:"font-semibold",children:[u.carbon_offset_potential," tonnes/year"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Cost per Tonne"}),e.jsxs("span",{className:"font-semibold",children:[u.currency," ",u.cost_per_tonne]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Location"}),e.jsx("span",{children:u.county})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Participants"}),e.jsx("span",{children:u.participants_count})]})]}),e.jsx(b,{className:"w-full mt-4",children:"Purchase Offsets"})]})]},u.id))})}),e.jsx(V,{value:"insights",className:"mt-6",children:e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Carbon Insights & Analytics"}),e.jsx(G,{children:"Detailed breakdown and trends of your carbon emissions"})]}),e.jsxs(_,{className:"text-center py-12 text-muted-foreground",children:[e.jsx(Re,{className:"h-16 w-16 mx-auto mb-4"}),e.jsx("p",{children:"Carbon analytics and visualization coming soon"})]})]})})]})]})]}),e.jsx(Me,{})]})},mx=()=>{var ue,z,U;const[s,t]=i.useState([]),[a,r]=i.useState(!0),[n,c]=i.useState(!1),[l,x]=i.useState(null),[f,j]=i.useState([]),[N,g]=i.useState([]),[u,d]=i.useState([]),{toast:h}=Z(),{user:v}=je(),[p,m]=i.useState({name:"",description:"",group_type:"cooperative",location:"",county:"",contact_person:"",contact_phone:"",contact_email:"",membership_fee:"",share_value:"",services_offered:"",crops_traded:""}),[o,y]=i.useState({title:"",description:"",vote_type:"general",options:"",end_date:""}),[k,A]=i.useState({loan_amount:"",interest_rate:"",loan_purpose:"",repayment_period:""});i.useState({user_id:"",role:"member",shares_owned:"1"}),i.useEffect(()=>{S()},[]),i.useEffect(()=>{l&&(E(l.id),P(l.id),R(l.id))},[l]);const S=async()=>{try{const{data:K,error:ae}=await F.from("cooperative_groups").select("*").order("created_at",{ascending:!1});if(ae)throw ae;t(K||[]),K&&K.length>0&&!l&&x(K[0])}catch(K){console.error("Error:",K)}finally{r(!1)}},E=async K=>{const{data:ae}=await F.from("cooperative_votes").select("*").eq("group_id",K).order("created_at",{ascending:!1});j(ae||[])},P=async K=>{const{data:ae}=await F.from("cooperative_loans").select("*").eq("group_id",K).order("created_at",{ascending:!1});g(ae||[])},R=async K=>{const{data:ae}=await F.from("cooperative_dividends").select("*").eq("group_id",K).order("created_at",{ascending:!1});d(ae||[])},M=async K=>{if(K.preventDefault(),!v){h({title:"Please sign in",variant:"destructive"});return}try{const{error:ae}=await F.from("cooperative_groups").insert({name:p.name,description:p.description,group_type:p.group_type,location:p.location,county:p.county,contact_person:p.contact_person,contact_phone:p.contact_phone,contact_email:p.contact_email,membership_fee:p.membership_fee?parseFloat(p.membership_fee):null,share_value:p.share_value?parseFloat(p.share_value):null,services_offered:p.services_offered?p.services_offered.split(",").map(be=>be.trim()):[],crops_traded:p.crops_traded?p.crops_traded.split(",").map(be=>be.trim()):[],group_leader_id:v.id});if(ae)throw ae;h({title:"Cooperative created!"}),c(!1),S()}catch(ae){h({title:"Error",description:ae.message,variant:"destructive"})}},O=async K=>{if(K.preventDefault(),!(!l||!v))try{const ae=o.options.split(",").map(ts=>({label:ts.trim(),votes:0})),{error:be}=await F.from("cooperative_votes").insert({group_id:l.id,title:o.title,description:o.description,vote_type:o.vote_type,options:ae,end_date:o.end_date,created_by:v.id});if(be)throw be;h({title:"Vote created!"}),y({title:"",description:"",vote_type:"general",options:"",end_date:""}),E(l.id)}catch(ae){h({title:"Error",description:ae.message,variant:"destructive"})}},te=async K=>{if(K.preventDefault(),!(!l||!v))try{const{error:ae}=await F.from("cooperative_loans").insert({group_id:l.id,borrower_id:v.id,loan_amount:parseFloat(k.loan_amount),interest_rate:parseFloat(k.interest_rate),loan_purpose:k.loan_purpose,repayment_period:parseInt(k.repayment_period)});if(ae)throw ae;h({title:"Loan application submitted!"}),A({loan_amount:"",interest_rate:"",loan_purpose:"",repayment_period:""}),P(l.id)}catch(ae){h({title:"Error",description:ae.message,variant:"destructive"})}};return e.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[e.jsx(ne,{}),e.jsx("section",{className:"bg-gradient-to-r from-primary to-primary/80 text-primary-foreground py-16",children:e.jsxs("div",{className:"container px-4 text-center",children:[e.jsx(se,{className:"h-16 w-16 mx-auto mb-4"}),e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-4",children:"Cooperative Management"}),e.jsx("p",{className:"text-xl",children:"Register your cooperative, manage members, voting, dividends & loans"})]})}),e.jsxs("main",{className:"container px-4 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Your Cooperatives"}),e.jsxs(b,{onClick:()=>c(!n),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"})," Register Cooperative"]})]}),n&&e.jsxs(w,{className:"mb-8 border-primary/20",children:[e.jsxs(q,{children:[e.jsx(L,{children:"Register New Cooperative / Group"}),e.jsx(G,{children:"Bring your cooperative online â€” add members, sell products, manage finances"})]}),e.jsx(_,{children:e.jsxs("form",{onSubmit:M,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Group Name *"}),e.jsx(D,{value:p.name,onChange:K=>m({...p,name:K.target.value}),placeholder:"e.g. Nakuru Dairy Cooperative",required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Group Type *"}),e.jsxs(Q,{value:p.group_type,onValueChange:K=>m({...p,group_type:K}),children:[e.jsx(W,{children:e.jsx(J,{})}),e.jsxs(Y,{children:[e.jsx(T,{value:"cooperative",children:"Cooperative"}),e.jsx(T,{value:"farmers_group",children:"Farmers Group"}),e.jsx(T,{value:"savings_group",children:"Savings Group (Chama)"}),e.jsx(T,{value:"marketing_group",children:"Marketing Group"}),e.jsx(T,{value:"women_group",children:"Women Group"}),e.jsx(T,{value:"youth_group",children:"Youth Group"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Description *"}),e.jsx(le,{value:p.description,onChange:K=>m({...p,description:K.target.value}),placeholder:"Describe your group's purpose, activities, and what you trade",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Location *"}),e.jsx(D,{value:p.location,onChange:K=>m({...p,location:K.target.value}),required:!0,placeholder:"Town/Village"})]}),e.jsxs("div",{children:[e.jsx(C,{children:"County *"}),e.jsx(D,{value:p.county,onChange:K=>m({...p,county:K.target.value}),required:!0,placeholder:"County"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Contact Person *"}),e.jsx(D,{value:p.contact_person,onChange:K=>m({...p,contact_person:K.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Phone *"}),e.jsx(D,{value:p.contact_phone,onChange:K=>m({...p,contact_phone:K.target.value}),required:!0,placeholder:"+254..."})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Email"}),e.jsx(D,{type:"email",value:p.contact_email,onChange:K=>m({...p,contact_email:K.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Membership Fee (KES)"}),e.jsx(D,{type:"number",value:p.membership_fee,onChange:K=>m({...p,membership_fee:K.target.value}),placeholder:"e.g. 500"})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Share Value (KES)"}),e.jsx(D,{type:"number",value:p.share_value,onChange:K=>m({...p,share_value:K.target.value}),placeholder:"e.g. 1000"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Services Offered (comma-separated)"}),e.jsx(D,{value:p.services_offered,onChange:K=>m({...p,services_offered:K.target.value}),placeholder:"e.g. Marketing, Storage, Transport"})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Crops/Products Traded (comma-separated)"}),e.jsx(D,{value:p.crops_traded,onChange:K=>m({...p,crops_traded:K.target.value}),placeholder:"e.g. Maize, Beans, Milk"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{type:"submit",children:"Register Cooperative"}),e.jsx(b,{type:"button",variant:"outline",onClick:()=>c(!1),children:"Cancel"})]})]})})]}),a?e.jsx("p",{className:"text-center py-12",children:"Loading cooperatives..."}):e.jsxs(e.Fragment,{children:[s.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:s.map(K=>e.jsx(b,{variant:(l==null?void 0:l.id)===K.id?"default":"outline",size:"sm",onClick:()=>x(K),children:K.name},K.id))}),l?e.jsxs("div",{children:[e.jsxs(w,{className:"mb-6",children:[e.jsx(q,{children:e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{children:[e.jsx(L,{className:"text-2xl",children:l.name}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(I,{children:(ue=l.group_type)==null?void 0:ue.replace("_"," ")}),e.jsxs(I,{variant:"outline",children:[e.jsx(ee,{className:"h-3 w-3 mr-1"}),l.location,", ",l.county]}),e.jsxs(I,{variant:"secondary",children:[e.jsx(se,{className:"h-3 w-3 mr-1"}),l.member_count||0," members"]})]})]})})}),e.jsxs(_,{children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:l.description}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx(Ee,{className:"h-4 w-4 inline mr-1"}),l.contact_phone]}),l.membership_fee&&e.jsxs("div",{children:[e.jsx(Nr,{className:"h-4 w-4 inline mr-1"}),"Fee: KES ",l.membership_fee]}),l.share_value&&e.jsxs("div",{children:[e.jsx(Ae,{className:"h-4 w-4 inline mr-1"}),"Share: KES ",l.share_value]}),((z=l.crops_traded)==null?void 0:z.length)>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:l.crops_traded.map((K,ae)=>e.jsx(I,{variant:"secondary",className:"text-xs",children:K},ae))})]}),((U=l.services_offered)==null?void 0:U.length)>0&&e.jsxs("div",{className:"mt-3 flex flex-wrap gap-1",children:[e.jsx("span",{className:"text-sm font-medium mr-2",children:"Services:"}),l.services_offered.map((K,ae)=>e.jsx(I,{variant:"outline",className:"text-xs",children:K},ae))]})]})]}),e.jsxs(ge,{defaultValue:"members",children:[e.jsxs(pe,{className:"grid w-full grid-cols-4",children:[e.jsxs(B,{value:"members",children:[e.jsx(br,{className:"h-4 w-4 mr-1 hidden sm:inline"}),"Members"]}),e.jsxs(B,{value:"voting",children:[e.jsx(Dc,{className:"h-4 w-4 mr-1 hidden sm:inline"}),"Voting"]}),e.jsxs(B,{value:"loans",children:[e.jsx(Nr,{className:"h-4 w-4 mr-1 hidden sm:inline"}),"Loans"]}),e.jsxs(B,{value:"dividends",children:[e.jsx(Ae,{className:"h-4 w-4 mr-1 hidden sm:inline"}),"Dividends"]})]}),e.jsx(V,{value:"members",children:e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Group Members"}),e.jsx(G,{children:"Members can list products and access group services"})]}),e.jsxs(_,{children:[e.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["To join this cooperative, contact ",l.contact_person," at ",l.contact_phone,". Members can sell products through the group's profile and access loans & dividends."]}),e.jsxs(b,{variant:"outline",children:[e.jsx(br,{className:"h-4 w-4 mr-2"})," Request to Join"]})]})]})}),e.jsx(V,{value:"voting",children:e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Voting"}),e.jsx(G,{children:"Create and participate in group votes"})]}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("form",{onSubmit:O,className:"space-y-3 p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-semibold",children:"Create New Vote"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Title *"}),e.jsx(D,{value:o.title,onChange:K=>y({...o,title:K.target.value}),required:!0,placeholder:"Vote topic"})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Type"}),e.jsxs(Q,{value:o.vote_type,onValueChange:K=>y({...o,vote_type:K}),children:[e.jsx(W,{children:e.jsx(J,{})}),e.jsxs(Y,{children:[e.jsx(T,{value:"general",children:"General"}),e.jsx(T,{value:"election",children:"Election"}),e.jsx(T,{value:"budget",children:"Budget Approval"}),e.jsx(T,{value:"policy",children:"Policy Change"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Description"}),e.jsx(le,{value:o.description,onChange:K=>y({...o,description:K.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Options (comma-separated) *"}),e.jsx(D,{value:o.options,onChange:K=>y({...o,options:K.target.value}),required:!0,placeholder:"Yes, No, Abstain"})]}),e.jsxs("div",{children:[e.jsx(C,{children:"End Date *"}),e.jsx(D,{type:"date",value:o.end_date,onChange:K=>y({...o,end_date:K.target.value}),required:!0})]})]}),e.jsx(b,{type:"submit",size:"sm",children:"Create Vote"})]}),f.length>0?f.map(K=>{var ae;return e.jsx(w,{className:"border-l-4 border-l-primary",children:e.jsxs(_,{className:"pt-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:K.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:K.description}),e.jsx(I,{className:"mt-2",children:K.status||"active"})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Ends: ",new Date(K.end_date).toLocaleDateString()]})]}),e.jsx("div",{className:"flex gap-2 mt-3",children:(ae=K.options)==null?void 0:ae.map((be,ts)=>e.jsxs(b,{variant:"outline",size:"sm",children:[be.label," (",be.votes||0,")"]},ts))})]})},K.id)}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No votes yet. Create one above."})]})]})}),e.jsx(V,{value:"loans",children:e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Loan Management"}),e.jsx(G,{children:"Apply for and track cooperative loans"})]}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("form",{onSubmit:te,className:"space-y-3 p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-semibold",children:"Apply for a Loan"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Loan Amount (KES) *"}),e.jsx(D,{type:"number",value:k.loan_amount,onChange:K=>A({...k,loan_amount:K.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Interest Rate (%) *"}),e.jsx(D,{type:"number",step:"0.1",value:k.interest_rate,onChange:K=>A({...k,interest_rate:K.target.value}),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Purpose *"}),e.jsx(D,{value:k.loan_purpose,onChange:K=>A({...k,loan_purpose:K.target.value}),required:!0,placeholder:"e.g. Buy seeds"})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Repayment Period (months) *"}),e.jsx(D,{type:"number",value:k.repayment_period,onChange:K=>A({...k,repayment_period:K.target.value}),required:!0})]})]}),e.jsx(b,{type:"submit",size:"sm",children:"Submit Application"})]}),N.length>0?N.map(K=>{var ae;return e.jsx(w,{children:e.jsxs(_,{className:"pt-4 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["KES ",(ae=K.loan_amount)==null?void 0:ae.toLocaleString()]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[K.loan_purpose," â€¢ ",K.interest_rate,"% interest â€¢ ",K.repayment_period," months"]})]}),e.jsx(I,{variant:K.status==="approved"?"default":"secondary",children:K.status||"pending"})]})},K.id)}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No loan applications yet."})]})]})}),e.jsx(V,{value:"dividends",children:e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Dividends"}),e.jsx(G,{children:"View dividend declarations and payouts"})]}),e.jsx(_,{children:u.length>0?u.map(K=>{var ae,be;return e.jsx(w,{className:"mb-3",children:e.jsx(_,{className:"pt-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["FY ",K.financial_year]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Total Profit: KES ",(ae=K.total_profit)==null?void 0:ae.toLocaleString()," â€¢ Per Share: KES ",(be=K.dividend_per_share)==null?void 0:be.toLocaleString()]})]}),e.jsx(I,{variant:K.status==="paid"?"default":"secondary",children:K.status||"declared"})]})})},K.id)}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No dividends declared yet. Dividends are declared by group leadership."})})]})})]})]}):e.jsx(w,{children:e.jsxs(_,{className:"text-center py-12",children:[e.jsx(se,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"No cooperatives registered yet. Be the first!"}),e.jsxs(b,{onClick:()=>c(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"})," Register Cooperative"]})]})})]})]})]})},ux=()=>e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"container mx-auto py-8 px-4",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-4",children:"Data Management & Integration Strategy"}),e.jsx("p",{className:"text-muted-foreground max-w-3xl mx-auto",children:"Comprehensive overview of how AgriTender Connect handles, stores, and secures agricultural data"})]}),e.jsxs(ge,{defaultValue:"overview",className:"w-full",children:[e.jsxs(pe,{className:"grid w-full grid-cols-5",children:[e.jsx(B,{value:"overview",children:"Overview"}),e.jsx(B,{value:"sources",children:"Data Sources"}),e.jsx(B,{value:"storage",children:"Storage"}),e.jsx(B,{value:"security",children:"Security"}),e.jsx(B,{value:"apis",children:"API Integration"})]}),e.jsx(V,{value:"overview",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(st,{className:"h-5 w-5 text-blue-600"}),"Real-Time Data"]}),e.jsx(G,{children:"Live integration with government and institutional sources"})]}),e.jsx(_,{children:e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4 text-green-600"}),"Market prices updated hourly"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4 text-green-600"}),"Production statistics from KNBS"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4 text-green-600"}),"Weather data integration"]})]})})]}),e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"h-5 w-5 text-green-600"}),"Data Integrity"]}),e.jsx(G,{children:"100% verified sources with transparency badges"})]}),e.jsx(_,{children:e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4 text-green-600"}),"Government source verification"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4 text-green-600"}),"No fake or sample data"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4 text-green-600"}),"Source attribution required"]})]})})]}),e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(gt,{className:"h-5 w-5 text-yellow-600"}),"Performance"]}),e.jsx(G,{children:"Optimized for field operations and mobile use"})]}),e.jsx(_,{children:e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4 text-green-600"}),"Sub-second response times"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4 text-green-600"}),"Offline capability"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4 text-green-600"}),"Mobile-first design"]})]})})]})]})}),e.jsx(V,{value:"sources",className:"space-y-6",children:e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Verified Data Sources"}),e.jsx(G,{children:"All data is sourced from legitimate Kenyan government and institutional sources"})]}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold",children:"Kenya National Bureau of Statistics (KNBS)"}),e.jsx(I,{variant:"outline",className:"text-green-600 border-green-600",children:"Verified"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Official agricultural census, production statistics, and economic surveys"}),e.jsxs("a",{href:"https://www.knbs.or.ke/agricultural-statistics/",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-blue-600 hover:text-blue-800 text-sm",children:[e.jsx(xs,{className:"h-4 w-4 mr-1"}),"knbs.or.ke/agricultural-statistics"]})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold",children:"Ministry of Agriculture & Livestock Development"}),e.jsx(I,{variant:"outline",className:"text-green-600 border-green-600",children:"Verified"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Policy updates, crop forecasts, and agricultural development programs"}),e.jsxs("a",{href:"https://kilimo.go.ke/",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-blue-600 hover:text-blue-800 text-sm",children:[e.jsx(xs,{className:"h-4 w-4 mr-1"}),"kilimo.go.ke"]})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold",children:"Nairobi Grain Exchange"}),e.jsx(I,{variant:"outline",className:"text-green-600 border-green-600",children:"Verified"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Real-time commodity prices and trading data"})]})]})})]})}),e.jsx(V,{value:"storage",className:"space-y-6",children:e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Ec,{className:"h-5 w-5"}),"Data Storage Architecture"]}),e.jsx(G,{children:"Enterprise-grade storage with Supabase PostgreSQL backend"})]}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold mb-2 flex items-center gap-2",children:[e.jsx(_t,{className:"h-4 w-4 text-blue-600"}),"Primary Storage"]}),e.jsxs("ul",{className:"space-y-1 text-sm text-muted-foreground",children:[e.jsx("li",{children:"â€¢ Supabase PostgreSQL database"}),e.jsx("li",{children:"â€¢ Row Level Security (RLS) enabled"}),e.jsx("li",{children:"â€¢ Automatic backups every 6 hours"}),e.jsx("li",{children:"â€¢ 99.9% uptime guarantee"})]})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold mb-2 flex items-center gap-2",children:[e.jsx(gt,{className:"h-4 w-4 text-yellow-600"}),"Caching Layer"]}),e.jsxs("ul",{className:"space-y-1 text-sm text-muted-foreground",children:[e.jsx("li",{children:"â€¢ Redis for real-time data"}),e.jsx("li",{children:"â€¢ CDN for static assets"}),e.jsx("li",{children:"â€¢ Browser caching optimization"}),e.jsx("li",{children:"â€¢ Smart cache invalidation"})]})]})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Data Retention Policy"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Market Prices:"}),e.jsx("br",{}),e.jsx("span",{className:"text-muted-foreground",children:"5 years historical data"})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Production Data:"}),e.jsx("br",{}),e.jsx("span",{className:"text-muted-foreground",children:"10 years for analysis"})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"User Data:"}),e.jsx("br",{}),e.jsx("span",{className:"text-muted-foreground",children:"As per user preferences"})]})]})]})]})})]})}),e.jsx(V,{value:"security",className:"space-y-6",children:e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Ft,{className:"h-5 w-5 text-red-600"}),"Data Security & Privacy"]}),e.jsx(G,{children:"Enterprise-grade security protecting farmer and market data"})]}),e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"Encryption & Access Control"}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4 text-green-600"}),"AES-256 encryption at rest"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4 text-green-600"}),"TLS 1.3 for data in transit"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4 text-green-600"}),"Row Level Security (RLS)"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4 text-green-600"}),"Multi-factor authentication"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"Compliance & Auditing"}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4 text-green-600"}),"Kenya Data Protection Act compliance"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4 text-green-600"}),"Regular security audits"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4 text-green-600"}),"Activity logging and monitoring"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4 text-green-600"}),"Incident response procedures"]})]})]})]})})]})}),e.jsx(V,{value:"apis",className:"space-y-6",children:e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"API Data Integration"}),e.jsx(G,{children:"How external data is integrated, validated, and used throughout the platform"})]}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Data Integration Pipeline"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 font-semibold text-sm",children:"1"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Data Ingestion"}),e.jsx("br",{}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Automated fetching from verified sources every hour"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center text-green-600 font-semibold text-sm",children:"2"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Validation & Cleaning"}),e.jsx("br",{}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Data quality checks and format standardization"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center text-yellow-600 font-semibold text-sm",children:"3"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Storage & Indexing"}),e.jsx("br",{}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Optimized storage for fast retrieval and analysis"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center text-purple-600 font-semibold text-sm",children:"4"}),e.jsxs("div",{children:[e.jsx("strong",{children:"API Distribution"}),e.jsx("br",{}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Real-time access through our monetized API platform"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Real-Time Updates"}),e.jsxs("ul",{className:"space-y-1 text-sm text-muted-foreground",children:[e.jsx("li",{children:"â€¢ Market prices: Every 30 minutes"}),e.jsx("li",{children:"â€¢ Weather data: Every 15 minutes"}),e.jsx("li",{children:"â€¢ Production stats: Daily"}),e.jsx("li",{children:"â€¢ Policy updates: As announced"})]})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Data Quality Assurance"}),e.jsxs("ul",{className:"space-y-1 text-sm text-muted-foreground",children:[e.jsx("li",{children:"â€¢ Source verification checks"}),e.jsx("li",{children:"â€¢ Anomaly detection algorithms"}),e.jsx("li",{children:"â€¢ Historical trend validation"}),e.jsx("li",{children:"â€¢ Manual review for critical data"})]})]})]})]})})]})})]})]})});class Ht{static async getAllStats(t){try{let a=F.from("kilimo_statistics").select("*").order("created_at",{ascending:!1});t!=null&&t.category&&(a=a.eq("category",t.category)),t!=null&&t.county&&(a=a.eq("county",t.county)),t!=null&&t.fetch_date&&(a=a.eq("fetch_date",t.fetch_date));const{data:r,error:n}=await a;return n?(console.error("Error fetching Kilimo stats:",n),[]):r||[]}catch(a){return console.error("Error in getAllStats:",a),[]}}static async getLatestStats(t=50){try{const{data:a,error:r}=await F.from("kilimo_statistics").select("*").order("fetch_date",{ascending:!1}).order("created_at",{ascending:!1}).limit(t);return r?(console.error("Error fetching latest stats:",r),[]):a||[]}catch(a){return console.error("Error in getLatestStats:",a),[]}}static async getFetchLogs(t=20){try{const{data:a,error:r}=await F.from("data_fetch_logs").select("*").order("created_at",{ascending:!1}).limit(t);return r?(console.error("Error fetching logs:",r),[]):a||[]}catch(a){return console.error("Error in getFetchLogs:",a),[]}}static async triggerManualFetch(){try{const t=await F.functions.invoke("fetch-kilimo-data",{body:{manual:!0}});return t.error?(console.error("Error invoking function:",t.error),{success:!1,message:t.error.message||"Failed to trigger manual fetch"}):t.data||{success:!0,message:"Data fetch triggered successfully"}}catch(t){return console.error("Error triggering manual fetch:",t),{success:!1,message:"Failed to trigger manual fetch"}}}static async getAnalytics(){try{const[t,a]=await Promise.all([this.getAllStats(),this.getFetchLogs(5)]),r=new Set(t.map(l=>l.category)),n=new Set(t.map(l=>l.county)),c=t.length>0?t[0].fetch_date:"Never";return{totalRecords:t.length,categoriesCount:r.size,countiesCount:n.size,lastUpdateDate:c,recentActivity:a}}catch(t){return console.error("Error in getAnalytics:",t),{totalRecords:0,categoriesCount:0,countiesCount:0,lastUpdateDate:"Never",recentActivity:[]}}}}const xx=()=>{const[s,t]=i.useState(!0),[a,r]=i.useState(null),[n,c]=i.useState([]),[l,x]=i.useState(null),[f,j]=i.useState([]),{toast:N}=Z();i.useEffect(()=>{g()},[]);const g=async()=>{var d;t(!0);try{console.log("Testing Kilimo API...");const h=await fetch("https://statistics.kilimo.go.ke/en/api/apputils/",{method:"GET",headers:{Accept:"application/json"}});if(h.ok){const v=await h.json();r({status:"success",message:`API working. Counties: ${((d=v.county)==null?void 0:d.length)||0}`,data:v}),console.log("API Response:",v)}else r({status:"error",message:`API returned ${h.status}`,data:null})}catch(h){console.error("API Test Error:",h),r({status:"error",message:"Failed to connect to API",data:null})}try{const[h,v,p]=await Promise.all([Ht.getLatestStats(20),Ht.getAnalytics(),Ht.getFetchLogs(10)]);c(h),x(v),j(p),console.log("Database Data:",{data:h.length,analytics:v})}catch(h){console.error("Database Error:",h)}t(!1)},u=async()=>{try{N({title:"Triggering data fetch...",description:"Please wait while we fetch new data"});const d=await Ht.triggerManualFetch();d.success?(N({title:"Success",description:d.message}),setTimeout(()=>g(),2e3)):N({title:"Error",description:d.message||"Failed to fetch data",variant:"destructive"})}catch(d){console.error("Manual fetch error:",d),N({title:"Error",description:"Failed to trigger data fetch",variant:"destructive"})}};return s?e.jsx("div",{className:"min-h-screen bg-background p-8",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})})})}):e.jsx("div",{className:"min-h-screen bg-background p-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:"System Data Status Check"}),e.jsx("p",{className:"text-muted-foreground",children:"Real-time verification of API connectivity and data collection"}),e.jsxs(b,{onClick:g,className:"mt-4 mr-4",children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Refresh Status"]}),e.jsxs(b,{onClick:u,variant:"outline",children:[e.jsx(st,{className:"h-4 w-4 mr-2"}),"Trigger Data Fetch"]})]}),e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[(a==null?void 0:a.status)==="success"?e.jsx(fe,{className:"h-5 w-5 text-green-600"}):e.jsx(pt,{className:"h-5 w-5 text-red-600"}),"Kilimo API Status"]}),e.jsx(G,{children:"Direct connection to https://statistics.kilimo.go.ke/"})]}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Status:"}),e.jsx(I,{variant:(a==null?void 0:a.status)==="success"?"default":"destructive",children:(a==null?void 0:a.status)||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Message:"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:a==null?void 0:a.message})]}),(a==null?void 0:a.data)&&e.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"API Response Sample:"}),e.jsxs("pre",{className:"text-xs overflow-x-auto",children:[JSON.stringify(a.data,null,2).slice(0,500),"..."]})]}),e.jsxs("a",{href:"https://statistics.kilimo.go.ke/en/api/apputils/",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-blue-600 hover:text-blue-800 text-sm",children:["Test API Directly ",e.jsx(xs,{className:"h-4 w-4"})]})]})})]}),e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(st,{className:"h-5 w-5 text-blue-600"}),"Database Storage Status"]}),e.jsx(G,{children:"Stored data from automatic and manual fetches"})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:(l==null?void 0:l.totalRecords)||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Records"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:(l==null?void 0:l.categoriesCount)||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Categories"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:(l==null?void 0:l.countiesCount)||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Counties"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:(l==null?void 0:l.lastUpdateDate)!=="Never"?new Date(l.lastUpdateDate).toLocaleDateString():"Never"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Last Update"})]})]}),n.length>0?e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Recent Data Sample:"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left p-2",children:"Name"}),e.jsx("th",{className:"text-left p-2",children:"Category"}),e.jsx("th",{className:"text-left p-2",children:"County"}),e.jsx("th",{className:"text-left p-2",children:"Value"}),e.jsx("th",{className:"text-left p-2",children:"Date"})]})}),e.jsx("tbody",{children:n.slice(0,5).map((d,h)=>e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"p-2",children:d.name}),e.jsx("td",{className:"p-2",children:e.jsx(I,{variant:"outline",children:d.category})}),e.jsx("td",{className:"p-2",children:d.county}),e.jsx("td",{className:"p-2",children:d.value}),e.jsx("td",{className:"p-2",children:new Date(d.fetch_date).toLocaleDateString()})]},h))})]})})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No data found in database. Try triggering a manual fetch."})]})]}),e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Recent Fetch Logs"}),e.jsx(G,{children:"History of data collection attempts"})]}),e.jsx(_,{children:f.length>0?e.jsx("div",{className:"space-y-3",children:f.map((d,h)=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{variant:d.status==="success"?"default":"destructive",children:d.status}),e.jsx("span",{className:"font-medium",children:d.source})]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:new Date(d.created_at).toLocaleString()})]}),e.jsxs("div",{className:"text-sm",children:["Records: ",d.records_count," | Time: ",d.execution_time_ms,"ms",d.error_message&&e.jsxs("div",{className:"text-red-600 mt-1",children:["Error: ",d.error_message]})]})]},h))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No fetch logs found"})})]})]})})},hx=()=>{const[s,t]=i.useState({daily:!1,weekly:!1,monthly:!1,all:!1,test:!1}),[a,r]=i.useState({}),n=async f=>{t(j=>({...j,[f]:!0}));try{let j;switch(f){case"daily":j=await vn();break;case"weekly":j=await yn();break;case"monthly":j=await Nn();break;case"all":j=await sd();break;case"test":j=await td();break}r(N=>({...N,[f]:j})),j.success!==!1?Te.success(`${f.charAt(0).toUpperCase()+f.slice(1)} job completed successfully`):Te.error(`${f.charAt(0).toUpperCase()+f.slice(1)} job failed: ${j.message}`)}catch(j){console.error(`Error running ${f} job:`,j),Te.error(`Error running ${f} job: ${j}`)}finally{t(j=>({...j,[f]:!1}))}},c=f=>new Date(f).toLocaleString(),l=f=>f?e.jsx("div",{className:"bg-muted p-4 rounded-md overflow-auto max-h-[400px]",children:e.jsx("pre",{className:"text-xs",children:JSON.stringify(f,null,2)})}):null,x=f=>{const j=a[f];if(!j||!j.data)return null;let N=[];return Array.isArray(j.data)&&(N=j.data.slice(0,3).map((g,u)=>e.jsxs("div",{className:"flex justify-between items-center py-2 border-b",children:[e.jsx("span",{className:"font-medium",children:g.commodity}),e.jsxs("span",{className:"text-right",children:["KES ",g.price," per ",g.unit]})]},u))),N.length>0?e.jsxs("div",{className:"mt-4 border rounded-md p-3 bg-muted/30",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Latest Prices:"}),N]}):null};return e.jsxs("div",{className:"container py-10",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Data Jobs & API Integration"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage and test automated data jobs for AMIS Kenya and Kilimo statistics integration"})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Daily AMIS Kenya Updates"}),e.jsx(G,{children:"Fetch latest prices from AMIS Kenya (daily updates)"})]}),e.jsxs(_,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Run this job to fetch the most recent commodity prices from AMIS Kenya markets."}),x("daily")]}),e.jsx(me,{children:e.jsx(b,{onClick:()=>n("daily"),disabled:s.daily,className:"w-full",children:s.daily?"Running...":"Run Daily Job"})})]}),e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Weekly Kilimo Stats"}),e.jsx(G,{children:"Update agricultural statistics from Kilimo (weekly)"})]}),e.jsx(_,{children:e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Run this job to update agricultural statistics from the Kilimo platform."})}),e.jsx(me,{children:e.jsx(b,{onClick:()=>n("weekly"),disabled:s.weekly,className:"w-full",children:s.weekly?"Running...":"Run Weekly Job"})})]}),e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Monthly Data Archive"}),e.jsx(G,{children:"Archive historical data for trend analysis"})]}),e.jsx(_,{children:e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Run this job to archive current data snapshots for long-term trend analysis."})}),e.jsx(me,{children:e.jsx(b,{onClick:()=>n("monthly"),disabled:s.monthly,className:"w-full",children:s.monthly?"Running...":"Run Monthly Job"})})]})]}),e.jsxs("div",{className:"mt-8 grid gap-6 md:grid-cols-2",children:[e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Run All Jobs"}),e.jsx(G,{children:"Execute all scheduled jobs at once"})]}),e.jsxs(_,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"This will run all automated jobs in sequence and report results."}),e.jsx(b,{onClick:()=>n("all"),disabled:s.all,className:"w-full",children:s.all?"Running All Jobs...":"Run All Jobs"})]})]}),e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Test Data Extraction"}),e.jsx(G,{children:"Test API connectivity and data extraction"})]}),e.jsxs(_,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"This will test connectivity to the APIs and extract sample data to verify integration."}),e.jsx(b,{onClick:()=>n("test"),disabled:s.test,className:"w-full",variant:"secondary",children:s.test?"Testing...":"Run Extraction Test"})]})]})]}),e.jsxs(w,{className:"mt-8",children:[e.jsxs(q,{children:[e.jsx(L,{children:"Job Results"}),e.jsx(G,{children:"View the results of your most recent job runs"})]}),e.jsx(_,{children:e.jsxs(ge,{defaultValue:"daily",children:[e.jsxs(pe,{className:"grid grid-cols-5 mb-4",children:[e.jsx(B,{value:"daily",children:"Daily"}),e.jsx(B,{value:"weekly",children:"Weekly"}),e.jsx(B,{value:"monthly",children:"Monthly"}),e.jsx(B,{value:"all",children:"All Jobs"}),e.jsx(B,{value:"test",children:"Test"})]}),e.jsx(V,{value:"daily",children:a.daily?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(I,{variant:a.daily.success!==!1?"default":"destructive",children:a.daily.success!==!1?"Success":"Failed"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:a.daily.timestamp&&c(a.daily.timestamp)})]}),l(a.daily)]}):e.jsx("p",{className:"text-center py-6 text-muted-foreground",children:"No results yet. Run the daily job to see data here."})}),e.jsx(V,{value:"weekly",children:a.weekly?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(I,{variant:a.weekly.success!==!1?"default":"destructive",children:a.weekly.success!==!1?"Success":"Failed"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:a.weekly.timestamp&&c(a.weekly.timestamp)})]}),l(a.weekly)]}):e.jsx("p",{className:"text-center py-6 text-muted-foreground",children:"No results yet. Run the weekly job to see data here."})}),e.jsx(V,{value:"monthly",children:a.monthly?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(I,{variant:a.monthly.success!==!1?"default":"destructive",children:a.monthly.success!==!1?"Success":"Failed"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:a.monthly.timestamp&&c(a.monthly.timestamp)})]}),l(a.monthly)]}):e.jsx("p",{className:"text-center py-6 text-muted-foreground",children:"No results yet. Run the monthly job to see data here."})}),e.jsx(V,{value:"all",children:a.all?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(I,{variant:"outline",children:"Combined Results"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:a.all.timestamp&&c(a.all.timestamp)})]}),l(a.all)]}):e.jsx("p",{className:"text-center py-6 text-muted-foreground",children:"No results yet. Run all jobs to see combined data here."})}),e.jsx(V,{value:"test",children:a.test?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(I,{variant:a.test.success!==!1?"default":"destructive",children:a.test.success!==!1?"Success":"Failed"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:a.test.timestamp&&c(a.test.timestamp)})]}),l(a.test)]}):e.jsx("p",{className:"text-center py-6 text-muted-foreground",children:"No results yet. Run the test to see extraction results here."})})]})})]})]})},Ea={name:"AgriTender Connect",version:"2.0.0",description:"Comprehensive Agricultural Platform for Kenya",api:{baseUrl:"https://api.agritender.co.ke/v1",timeout:1e4,retryAttempts:3,rateLimit:{requests:100,window:6e4}},database:{maxConnections:100,connectionTimeout:3e4,queryTimeout:15e3,retryAttempts:3},cache:{defaultTTL:3e5,maxSize:1e3,enableCompression:!0},performance:{enableLazyLoading:!0,chunkSize:50,prefetchDistance:2,virtualScrolling:!0},security:{enableCSP:!0,enableHSTS:!0,maxFileSize:10*1024*1024,allowedFileTypes:["jpg","jpeg","png","pdf","doc","docx"],sessionTimeout:24*60*60*1e3},features:{realTimeUpdates:!0,advancedAnalytics:!0,mobileApp:!0,offlineMode:!1,betaFeatures:!1},services:{amis:{baseUrl:"https://amis.kilimo.go.ke/en/api",timeout:5e3,retryAttempts:2},weather:{enabled:!0,provider:"openweather"},maps:{enabled:!0,provider:"mapbox"}}};class px{constructor(){Fe(this,"startTime",Date.now())}async checkDatabase(){const t=Date.now();try{const{data:a,error:r}=await F.from("profiles").select("count").limit(1),n=Date.now()-t;return r?{service:"database",status:"unhealthy",responseTime:n,details:r.message,timestamp:new Date}:{service:"database",status:n>1e3?"degraded":"healthy",responseTime:n,timestamp:new Date}}catch(a){return{service:"database",status:"unhealthy",responseTime:Date.now()-t,details:a instanceof Error?a.message:"Unknown error",timestamp:new Date}}}async checkExternalAPI(){const t=Date.now();try{const a=await fetch(Ea.services.amis.baseUrl,{method:"HEAD",signal:AbortSignal.timeout(Ea.services.amis.timeout)}),r=Date.now()-t;return{service:"external_api",status:a.ok?r>2e3?"degraded":"healthy":"unhealthy",responseTime:r,details:a.ok?void 0:`HTTP ${a.status}`,timestamp:new Date}}catch(a){return{service:"external_api",status:"unhealthy",responseTime:Date.now()-t,details:a instanceof Error?a.message:"Connection failed",timestamp:new Date}}}async checkMemoryUsage(){const t=Date.now();try{const a=performance.memory;if(!a)return{service:"memory",status:"healthy",responseTime:Date.now()-t,details:"Memory API not available",timestamp:new Date};const r=a.usedJSHeapSize/1024/1024,n=a.totalJSHeapSize/1024/1024,c=r/n*100;let l="healthy";return c>90?l="unhealthy":c>75&&(l="degraded"),{service:"memory",status:l,responseTime:Date.now()-t,details:`${r.toFixed(1)}MB / ${n.toFixed(1)}MB (${c.toFixed(1)}%)`,timestamp:new Date}}catch(a){return{service:"memory",status:"unhealthy",responseTime:Date.now()-t,details:a instanceof Error?a.message:"Memory check failed",timestamp:new Date}}}async performHealthCheck(){const t=await Promise.all([this.checkDatabase(),this.checkExternalAPI(),this.checkMemoryUsage()]),a=t.filter(c=>c.status==="healthy").length,r=t.filter(c=>c.status==="unhealthy").length;let n="healthy";return r>0?n="unhealthy":a<t.length&&(n="degraded"),{overall:n,services:t,uptime:Date.now()-this.startTime,version:Ea.version}}}const gx=new px,jx=({size:s="md",className:t,text:a})=>{const r={sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"};return e.jsxs("div",{className:$("flex flex-col items-center justify-center",t),children:[e.jsx(As,{className:$("animate-spin text-primary",r[s])}),a&&e.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:a})]})},fx=()=>{const[s,t]=i.useState(null),[a,r]=i.useState(!0),[n,c]=i.useState(null),l=async()=>{r(!0);try{const N=await gx.performHealthCheck();t(N),c(new Date)}catch(N){console.error("Health check failed:",N)}finally{r(!1)}};i.useEffect(()=>{l();const N=setInterval(l,3e4);return()=>clearInterval(N)},[]);const x=N=>{switch(N){case"healthy":return e.jsx(fe,{className:"h-4 w-4 text-green-500"});case"degraded":return e.jsx(hs,{className:"h-4 w-4 text-yellow-500"});case"unhealthy":return e.jsx(pt,{className:"h-4 w-4 text-red-500"});default:return e.jsx(hs,{className:"h-4 w-4 text-gray-500"})}},f=N=>{switch(N){case"healthy":return"bg-green-100 text-green-800";case"degraded":return"bg-yellow-100 text-yellow-800";case"unhealthy":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},j=N=>{const g=Math.floor(N/1e3),u=Math.floor(g/60),d=Math.floor(u/60),h=Math.floor(d/24);return h>0?`${h}d ${d%24}h ${u%60}m`:d>0?`${d}h ${u%60}m`:u>0?`${u}m ${g%60}s`:`${g}s`};return a&&!s?e.jsx(w,{children:e.jsx(_,{className:"p-6",children:e.jsx(jx,{text:"Performing health check..."})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(w,{children:[e.jsxs(q,{className:"flex flex-row items-center justify-between",children:[e.jsx(L,{children:"System Health Dashboard"}),e.jsxs(b,{variant:"outline",size:"sm",onClick:l,disabled:a,children:[e.jsx(Ss,{className:`h-4 w-4 mr-2 ${a?"animate-spin":""}`}),"Refresh"]})]}),e.jsx(_,{children:s&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[x(s.overall),e.jsx("span",{className:"font-medium",children:"Overall Status"})]}),e.jsx(I,{className:f(s.overall),children:s.overall.toUpperCase()})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Version"}),e.jsx("p",{className:"font-mono text-lg",children:s.version})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Uptime"}),e.jsx("p",{className:"font-mono text-lg",children:j(s.uptime)})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Last Updated"}),e.jsx("p",{className:"font-mono text-lg",children:n?n.toLocaleTimeString():"Never"})]})]})]})})]}),s&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.services.map(N=>e.jsxs(w,{children:[e.jsx(q,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(L,{className:"text-base capitalize",children:N.service.replace("_"," ")}),x(N.status)]})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Status:"}),e.jsx(I,{className:f(N.status),variant:"outline",children:N.status})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Response Time:"}),e.jsxs("span",{className:"text-sm font-mono",children:[N.responseTime,"ms"]})]}),N.details&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Details:"}),e.jsx("p",{className:"text-xs font-mono bg-muted p-1 rounded",children:N.details})]})]})})]},N.service))})]})},vx=()=>{const[s,t]=i.useState({isConnected:!1,isHealthy:!1,latency:0,lastChecked:new Date,retryCount:0}),a=i.useCallback(async()=>{const n=Date.now();try{const{data:c,error:l}=await F.from("profiles").select("count").limit(1),x=Date.now()-n;if(l)throw l;return t(f=>({...f,isConnected:!0,isHealthy:x<1e3,latency:x,lastChecked:new Date,retryCount:0})),!0}catch(c){return console.error("Supabase connection check failed:",c),t(l=>({...l,isConnected:!1,isHealthy:!1,latency:Date.now()-n,lastChecked:new Date,retryCount:l.retryCount+1})),!1}},[]),r=i.useCallback(async(n=3)=>{for(let c=0;c<n;c++){if(await a())return!0;const x=Math.min(1e3*Math.pow(2,c),1e4);await new Promise(f=>setTimeout(f,x))}return!1},[a]);return i.useEffect(()=>{a();const n=setInterval(a,3e4);return()=>clearInterval(n)},[a]),{status:s,checkConnection:a,reconnect:r}},yx=(s={enableMonitoring:!0,sampleRate:.1,reportingInterval:3e4})=>{const[t,a]=i.useState({loadTime:0,renderTime:0,memoryUsage:0,networkLatency:0}),[r,n]=i.useState(!1),c=i.useCallback(()=>{if(!s.enableMonitoring||Math.random()>s.sampleRate)return;const f=performance.getEntriesByType("navigation")[0],j=performance.memory,N={loadTime:f?f.loadEventEnd-f.loadEventStart:0,renderTime:f?f.domContentLoadedEventEnd-f.domContentLoadedEventStart:0,memoryUsage:j?j.usedJSHeapSize/1024/1024:0,networkLatency:f?f.responseEnd-f.requestStart:0};a(N),n(N.loadTime<3e3&&N.renderTime<1e3&&N.memoryUsage<100&&N.networkLatency<2e3)},[s]),l=i.useCallback(()=>{s.enableMonitoring&&console.log("Performance Metrics:",t)},[t,s.enableMonitoring]);i.useEffect(()=>{c();const f=setInterval(l,s.reportingInterval);return()=>clearInterval(f)},[c,l,s.reportingInterval]);const x=i.useCallback(()=>{"caches"in window&&caches.keys().then(f=>{f.forEach(j=>{(j.includes("old")||j.includes("v1"))&&caches.delete(j)})}),window.gc&&window.gc(),setTimeout(c,1e3)},[c]);return{metrics:t,isOptimized:r,optimizePerformance:x,measurePerformance:c}};class Nx{constructor(){Fe(this,"sessionId");Fe(this,"isProduction");Fe(this,"logs",[]);Fe(this,"maxLogs",1e3);this.sessionId=crypto.randomUUID(),this.isProduction=!0}createLogEntry(t,a,r){return{level:t,message:a,timestamp:new Date,context:r,sessionId:this.sessionId}}debug(t,a){const r=this.createLogEntry("DEBUG",t,a);this.isProduction||console.debug(`[${r.timestamp.toISOString()}] DEBUG: ${t}`,a),this.addToBuffer(r)}info(t,a){const r=this.createLogEntry("INFO",t,a);console.info(`[${r.timestamp.toISOString()}] INFO: ${t}`,a),this.addToBuffer(r)}warn(t,a){const r=this.createLogEntry("WARN",t,a);console.warn(`[${r.timestamp.toISOString()}] WARN: ${t}`,a),this.addToBuffer(r),this.isProduction&&this.sendToExternalService(r)}error(t,a,r){const n={...r,error:a?{name:a.name,message:a.message,stack:a.stack}:void 0},c=this.createLogEntry("ERROR",t,n);console.error(`[${c.timestamp.toISOString()}] ERROR: ${t}`,a,r),this.addToBuffer(c),this.isProduction&&this.sendToExternalService(c)}addToBuffer(t){this.logs.push(t),this.logs.length>this.maxLogs&&this.logs.shift()}async sendToExternalService(t){try{await fetch("/api/logs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}catch(a){console.error("Failed to send log to external service:",a)}}startTimer(t){const a=performance.now();return()=>{const r=performance.now()-a;this.info(`Performance: ${t}`,{duration:`${r.toFixed(2)}ms`})}}trackUserAction(t,a){this.info(`User Action: ${t}`,{action:t,properties:a,url:window.location.href,userAgent:navigator.userAgent})}trackApiCall(t,a,r,n){const c=r>=400?"ERROR":r>=300?"WARN":"INFO";this[c.toLowerCase()](`API Call: ${t} ${a}`,{method:t,url:a,status:r,duration:`${n}ms`})}getRecentLogs(t=50){return this.logs.slice(-t)}clearLogs(){this.logs=[]}}const bx=new Nx,wx=()=>{const{status:s}=vx(),{metrics:t,isOptimized:a}=yx(),[r,n]=i.useState({totalUsers:0,activeUsers:0,totalTrades:0,systemUptime:0});i.useEffect(()=>{n({totalUsers:1250,activeUsers:89,totalTrades:3420,systemUptime:Date.now()-new Date("2025-01-01").getTime()})},[]);const c=x=>{const f=Math.floor(x/864e5),j=Math.floor(x%(1e3*60*60*24)/(1e3*60*60));return`${f}d ${j}h`},l=x=>e.jsx(I,{variant:x?"default":"destructive",children:x?"Good":"Issues"});return e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"System Status Dashboard"}),e.jsx(b,{variant:"outline",onClick:()=>window.location.reload(),children:"Refresh"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(w,{children:e.jsxs(_,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(st,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{className:"font-medium",children:"Database"})]}),l(s.isHealthy)]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Latency: ",s.latency,"ms"]})]})}),e.jsx(w,{children:e.jsxs(_,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(gt,{className:"h-5 w-5 text-yellow-500"}),e.jsx("span",{className:"font-medium",children:"Performance"})]}),l(a)]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Memory: ",t.memoryUsage.toFixed(1),"MB"]})]})}),e.jsx(w,{children:e.jsxs(_,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(se,{className:"h-5 w-5 text-green-500"}),e.jsx("span",{className:"font-medium",children:"Users"})]}),e.jsx("span",{className:"font-bold",children:r.activeUsers})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Total: ",r.totalUsers.toLocaleString()]})]})}),e.jsx(w,{children:e.jsxs(_,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ce,{className:"h-5 w-5 text-purple-500"}),e.jsx("span",{className:"font-medium",children:"Uptime"})]}),e.jsx("span",{className:"font-bold",children:c(r.systemUptime)})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Trades: ",r.totalTrades.toLocaleString()]})]})})]}),e.jsxs(ge,{defaultValue:"health",className:"w-full",children:[e.jsxs(pe,{className:"grid w-full grid-cols-4",children:[e.jsx(B,{value:"health",children:"Health Check"}),e.jsx(B,{value:"performance",children:"Performance"}),e.jsx(B,{value:"logs",children:"System Logs"}),e.jsx(B,{value:"analytics",children:"Analytics"})]}),e.jsx(V,{value:"health",children:e.jsx(fx,{})}),e.jsx(V,{value:"performance",children:e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"Performance Metrics"})}),e.jsx(_,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Load Times"}),e.jsxs("p",{className:"text-sm",children:["Page Load: ",t.loadTime,"ms"]}),e.jsxs("p",{className:"text-sm",children:["Render Time: ",t.renderTime,"ms"]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Network"}),e.jsxs("p",{className:"text-sm",children:["Latency: ",t.networkLatency,"ms"]}),e.jsxs("p",{className:"text-sm",children:["Status: ",a?"Optimized":"Needs Attention"]})]})]})})]})}),e.jsx(V,{value:"logs",children:e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"Recent System Logs"})}),e.jsx(_,{children:e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:bx.getRecentLogs(20).map((x,f)=>e.jsxs("div",{className:"flex items-start space-x-2 text-sm",children:[e.jsx(I,{variant:x.level==="ERROR"?"destructive":x.level==="WARN"?"secondary":"outline",className:"text-xs",children:x.level}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{children:x.message}),e.jsx("p",{className:"text-xs text-muted-foreground",children:x.timestamp.toLocaleString()})]})]},f))})})]})}),e.jsx(V,{value:"analytics",children:e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"System Analytics"})}),e.jsx(_,{children:e.jsx("p",{className:"text-muted-foreground",children:"Detailed analytics and monitoring coming soon. This will include user behavior, API usage, and performance trends."})})]})})]})]})};class _x extends i.Component{constructor(a){super(a);Fe(this,"handleRetry",()=>{this.setState({hasError:!1,error:null,errorId:""})});Fe(this,"handleGoHome",()=>{window.location.href="/"});this.state={hasError:!1,error:null,errorId:""}}static getDerivedStateFromError(a){const r=`error_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return{hasError:!0,error:a,errorId:r}}componentDidCatch(a,r){console.error("Error Boundary Caught:",{error:a.message,stack:a.stack,componentStack:r.componentStack,errorId:this.state.errorId}),fetch("/api/errors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({errorId:this.state.errorId,message:a.message,stack:a.stack,componentStack:r.componentStack,url:window.location.href,userAgent:navigator.userAgent,timestamp:new Date().toISOString()})}).catch(()=>{})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gray-50",children:e.jsxs(w,{className:"w-full max-w-md",children:[e.jsxs(q,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 h-12 w-12 text-red-500",children:e.jsx(Se,{className:"h-full w-full"})}),e.jsx(L,{className:"text-xl font-semibold text-gray-900",children:"Something went wrong"})]}),e.jsxs(_,{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 text-center",children:"We're sorry! An unexpected error occurred. Our team has been notified."}),!1,e.jsxs("div",{className:"text-xs text-gray-500 text-center",children:["Error ID: ",this.state.errorId]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs(b,{onClick:this.handleRetry,className:"flex-1",variant:"outline",children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Try Again"]}),e.jsxs(b,{onClick:this.handleGoHome,className:"flex-1",children:[e.jsx(vt,{className:"h-4 w-4 mr-2"}),"Go Home"]})]})]})]})}):this.props.children}}const Cx=()=>e.jsx(_x,{children:e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(ne,{}),e.jsx("main",{children:e.jsx(wx,{})})]})}),kx=Lc,Ct=i.forwardRef(({className:s,...t},a)=>e.jsx(Fc,{ref:a,className:$("border-b",s),...t}));Ct.displayName="AccordionItem";const kt=i.forwardRef(({className:s,children:t,...a},r)=>e.jsx(qc,{className:"flex",children:e.jsxs(an,{ref:r,className:$("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",s),...a,children:[t,e.jsx(Lt,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));kt.displayName=an.displayName;const St=i.forwardRef(({className:s,children:t,...a},r)=>e.jsx(rn,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...a,children:e.jsx("div",{className:$("pb-4 pt-0",s),children:t})}));St.displayName=rn.displayName;const Sx=()=>e.jsx("div",{className:"container mx-auto py-8",children:e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"Frequently Asked Questions"})}),e.jsx(_,{children:e.jsxs(kx,{type:"single",collapsible:!0,children:[e.jsxs(Ct,{value:"item-1",children:[e.jsx(kt,{children:"How do I register as a farmer?"}),e.jsx(St,{children:'You can register by clicking the sign-up button and selecting "Farmer" as your account type.'})]}),e.jsxs(Ct,{value:"item-2",children:[e.jsx(kt,{children:"How do I list my products for sale?"}),e.jsx(St,{children:'Go to your Farmer Portal and use the "Add Product" tab to list your agricultural products.'})]}),e.jsxs(Ct,{value:"item-3",children:[e.jsx(kt,{children:"Is there a mobile app available?"}),e.jsx(St,{children:"Yes, AgriConnect is available as a mobile app for both Android and iOS devices."})]}),e.jsxs(Ct,{value:"item-4",children:[e.jsx(kt,{children:"How do I contact customer support?"}),e.jsx(St,{children:"You can contact our support team through the Contact page or email support@agriconnect.com"})]})]})})]})}),Px=()=>e.jsx("div",{className:"container mx-auto py-8 max-w-4xl",children:e.jsxs(w,{children:[e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{className:"h-8 w-8 text-green-600"}),e.jsx(L,{className:"text-3xl",children:"Privacy Policy - AgriConnect"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(I,{variant:"outline",children:"Effective: January 1, 2024"}),e.jsxs(I,{variant:"outline",children:["Last Updated: ",new Date().toLocaleDateString()]}),e.jsx(I,{variant:"outline",children:"Version 2.1"})]}),e.jsx("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(Ua,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900",children:"Important Notice"}),e.jsx("p",{className:"text-sm text-blue-800",children:"This Privacy Policy complies with Kenya's Data Protection Act (2019) and international standards. By using AgriConnect, you agree to these terms and the collection and use of your information as described."})]})]})})]}),e.jsxs(_,{className:"space-y-8",children:[e.jsxs("section",{children:[e.jsxs("h2",{className:"text-2xl font-semibold mb-4 flex items-center",children:[e.jsx(qs,{className:"mr-2 h-6 w-6 text-green-600"}),"1. Information We Collect"]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Personal Information"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-sm",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Account Data:"})," Full name, email address, phone number, location (county/region)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Profile Information:"})," Farm type, farm size, experience years, specialization, bio"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Contact Details:"})," Business information for service providers, contact preferences"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Authentication Data:"})," Login credentials, session information, authentication tokens"]})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Agricultural Data"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-sm",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Crop Information:"})," Types of crops, planting schedules, harvest data, yield records"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Production Data:"})," Quantities, quality grades, organic certifications, storage conditions"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Market Activity:"})," Pricing information, trade history, market preferences"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Farm Management:"})," Task tracking, inventory management, financial records"]})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Usage and Technical Data"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-sm",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Device Information:"})," Browser type, operating system, device identifiers"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Usage Analytics:"})," Pages visited, features used, time spent, interaction patterns"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Location Data:"})," GPS coordinates (with permission), county/regional data for market matching"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"API Usage:"})," Request logs, response times, error rates for service optimization"]})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg bg-amber-50",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-3 flex items-center",children:[e.jsx(Se,{className:"mr-2 h-5 w-5 text-amber-600"}),"External Data Sources"]}),e.jsx("p",{className:"text-sm mb-2",children:"We collect agricultural data from legitimate Kenyan government sources:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Kilimo Statistics API:"})," County agricultural data, crop statistics"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Kenya National Bureau of Statistics:"})," Market prices, production data"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Weather Services:"})," Climate data, weather alerts for farming decisions"]})]})]})]})]}),e.jsx(qe,{}),e.jsxs("section",{children:[e.jsxs("h2",{className:"text-2xl font-semibold mb-4 flex items-center",children:[e.jsx(Qa,{className:"mr-2 h-6 w-6 text-green-600"}),"2. How We Use Your Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(w,{children:[e.jsx(q,{className:"pb-3",children:e.jsx(L,{className:"text-lg",children:"Platform Services"})}),e.jsxs(_,{className:"space-y-2 text-sm",children:[e.jsx("p",{children:"â€¢ Connect farmers with buyers and service providers"}),e.jsx("p",{children:"â€¢ Provide real-time market prices and forecasts"}),e.jsx("p",{children:"â€¢ Facilitate transportation and logistics matching"}),e.jsx("p",{children:"â€¢ Enable warehouse booking and storage solutions"}),e.jsx("p",{children:"â€¢ Support quality control and certification tracking"})]})]}),e.jsxs(w,{children:[e.jsx(q,{className:"pb-3",children:e.jsx(L,{className:"text-lg",children:"AI-Powered Features"})}),e.jsxs(_,{className:"space-y-2 text-sm",children:[e.jsx("p",{children:"â€¢ Provide personalized crop recommendations"}),e.jsx("p",{children:"â€¢ Analyze market trends and price predictions"}),e.jsx("p",{children:"â€¢ Offer farming advice and best practices"}),e.jsx("p",{children:"â€¢ Support pest and disease identification"}),e.jsx("p",{children:"â€¢ Optimize supply chain operations"})]})]}),e.jsxs(w,{children:[e.jsx(q,{className:"pb-3",children:e.jsx(L,{className:"text-lg",children:"Communication"})}),e.jsxs(_,{className:"space-y-2 text-sm",children:[e.jsx("p",{children:"â€¢ Send market opportunity notifications"}),e.jsx("p",{children:"â€¢ Provide weather alerts and farming tips"}),e.jsx("p",{children:"â€¢ Deliver customer support and assistance"}),e.jsx("p",{children:"â€¢ Share platform updates and new features"}),e.jsx("p",{children:"â€¢ Facilitate user-to-user communications"})]})]}),e.jsxs(w,{children:[e.jsx(q,{className:"pb-3",children:e.jsx(L,{className:"text-lg",children:"Legal Compliance"})}),e.jsxs(_,{className:"space-y-2 text-sm",children:[e.jsx("p",{children:"â€¢ Comply with Kenyan agricultural regulations"}),e.jsx("p",{children:"â€¢ Maintain transaction records as required by law"}),e.jsx("p",{children:"â€¢ Support tax reporting and business compliance"}),e.jsx("p",{children:"â€¢ Respond to legal requests and court orders"}),e.jsx("p",{children:"â€¢ Prevent fraud and ensure platform security"})]})]})]})]}),e.jsx(qe,{}),e.jsxs("section",{children:[e.jsxs("h2",{className:"text-2xl font-semibold mb-4 flex items-center",children:[e.jsx(Ft,{className:"mr-2 h-6 w-6 text-green-600"}),"3. Data Sharing and Disclosure"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-red-900 mb-2",children:"WE DO NOT SELL YOUR PERSONAL DATA"}),e.jsx("p",{className:"text-sm text-red-800",children:"AgriConnect never sells, trades, or rents your personal information to third parties for marketing purposes. Your data is used solely to improve our agricultural platform and connect you with legitimate opportunities."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Limited Sharing Scenarios:"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 border rounded",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Service Providers"}),e.jsx("p",{className:"text-sm",children:"Trusted partners who help operate our platform (Supabase for data storage, SMS providers, payment processors)"})]}),e.jsxs("div",{className:"p-3 border rounded",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Platform Users"}),e.jsx("p",{className:"text-sm",children:"Basic profile information visible to other users for legitimate agricultural business purposes"})]}),e.jsxs("div",{className:"p-3 border rounded",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Legal Requirements"}),e.jsx("p",{className:"text-sm",children:"When required by Kenyan law, court orders, or regulatory authorities (KNBS, Ministry of Agriculture)"})]}),e.jsxs("div",{className:"p-3 border rounded",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Aggregated Data"}),e.jsx("p",{className:"text-sm",children:"Anonymous, aggregated agricultural trends shared with research institutions for farming improvements"})]})]})]})]})]}),e.jsx(qe,{}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"4. Data Security Measures"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(w,{children:[e.jsx(q,{className:"pb-3",children:e.jsx(L,{className:"text-lg",children:"Technical Safeguards"})}),e.jsxs(_,{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:["â€¢ ",e.jsx("strong",{children:"Encryption:"})," AES-256 for sensitive data at rest"]}),e.jsxs("p",{children:["â€¢ ",e.jsx("strong",{children:"Transmission:"})," TLS 1.3 for all communications"]}),e.jsxs("p",{children:["â€¢ ",e.jsx("strong",{children:"Authentication:"})," Multi-factor authentication (SMS/Email)"]}),e.jsxs("p",{children:["â€¢ ",e.jsx("strong",{children:"Access Control:"})," Role-based permissions and audit logs"]}),e.jsxs("p",{children:["â€¢ ",e.jsx("strong",{children:"Database Security:"})," Row-level security and SQL injection protection"]})]})]}),e.jsxs(w,{children:[e.jsx(q,{className:"pb-3",children:e.jsx(L,{className:"text-lg",children:"Operational Security"})}),e.jsxs(_,{className:"space-y-2 text-sm",children:[e.jsx("p",{children:"â€¢ Regular security audits and vulnerability assessments"}),e.jsx("p",{children:"â€¢ Employee access controls and security training"}),e.jsx("p",{children:"â€¢ Incident response and breach notification procedures"}),e.jsx("p",{children:"â€¢ Compliance with ISO 27001 security standards"}),e.jsx("p",{children:"â€¢ Regular backups and disaster recovery procedures"})]})]})]})]}),e.jsx(qe,{}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"5. Your Rights and Choices"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Data Protection Rights (Kenya Data Protection Act 2019)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Access Rights"}),e.jsx("p",{className:"text-sm",children:"Request a copy of all personal data we hold about you"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Correction Rights"}),e.jsx("p",{className:"text-sm",children:"Update or correct any inaccurate information"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Deletion Rights"}),e.jsx("p",{className:"text-sm",children:"Request deletion of your account and associated data"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Portability Rights"}),e.jsx("p",{className:"text-sm",children:"Export your data in a machine-readable format"})]})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Communication Preferences"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsx("li",{children:"Manage notification settings in your account preferences"}),e.jsx("li",{children:"Opt-out of marketing communications via email or SMS"}),e.jsx("li",{children:"Control weather alerts and price notifications"}),e.jsx("li",{children:"Customize AI assistant interaction preferences"})]})]})]})]}),e.jsx(qe,{}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"6. Data Retention Policy"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 border rounded",children:[e.jsx("h4",{className:"font-medium",children:"Active Accounts"}),e.jsx("p",{className:"text-sm",children:"Data retained while account is active and for 2 years after last login"})]}),e.jsxs("div",{className:"p-3 border rounded",children:[e.jsx("h4",{className:"font-medium",children:"Transaction Records"}),e.jsx("p",{className:"text-sm",children:"Kept for 7 years for tax compliance and agricultural business records"})]}),e.jsxs("div",{className:"p-3 border rounded",children:[e.jsx("h4",{className:"font-medium",children:"Communication Logs"}),e.jsx("p",{className:"text-sm",children:"Retained for 1 year for customer support and dispute resolution"})]}),e.jsxs("div",{className:"p-3 border rounded",children:[e.jsx("h4",{className:"font-medium",children:"Aggregated Analytics"}),e.jsx("p",{className:"text-sm",children:"Anonymous data may be retained indefinitely for agricultural research"})]})]})]}),e.jsx(qe,{}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"7. Contact Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(w,{children:[e.jsx(q,{className:"pb-3",children:e.jsx(L,{className:"text-lg",children:"Data Protection Officer"})}),e.jsxs(_,{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," privacy@agriconnect.co.ke"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," +254 700 000 000"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," Nairobi, Kenya"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Response Time:"})," 48-72 hours"]})]})]}),e.jsxs(w,{children:[e.jsx(q,{className:"pb-3",children:e.jsx(L,{className:"text-lg",children:"Regulatory Authority"})}),e.jsxs(_,{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Office:"})," Data Protection Commissioner"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," P.O. Box 66156 â€“ 00800, Nairobi"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," info@odpc.go.ke"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Website:"})," www.odpc.go.ke"]})]})]})]})]}),e.jsx("div",{className:"mt-8 p-4 bg-green-50 border border-green-200 rounded-lg text-center",children:e.jsx("p",{className:"text-sm font-medium text-green-900",children:"By using AgriConnect, you acknowledge that you have read, understood, and agree to this Privacy Policy. This policy is governed by Kenyan data protection laws and international best practices."})})]})]})}),Ax=()=>e.jsx("div",{className:"container mx-auto py-8 max-w-4xl",children:e.jsxs(w,{children:[e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Mc,{className:"h-8 w-8 text-blue-600"}),e.jsx(L,{className:"text-3xl",children:"Terms of Service - SokoConnect"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(I,{variant:"outline",children:"Effective: January 1, 2024"}),e.jsxs(I,{variant:"outline",children:["Last Updated: ",new Date().toLocaleDateString()]}),e.jsx(I,{variant:"outline",children:"Version 2.2"})]}),e.jsx("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-1",children:"Share Our Terms"}),e.jsx("p",{className:"text-sm text-blue-800",children:"Help other farmers understand SokoConnect's commitment to transparency and data protection."})]}),e.jsx(rr,{title:"SokoConnect Terms of Service",text:"SokoConnect is committed to transparent agricultural technology. Our Terms of Service outline our commitment to farmers, data protection, and open agriculture policies in Kenya.",size:"sm"})]})}),e.jsx("div",{className:"p-4 bg-red-50 rounded-lg border border-red-200",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(Se,{className:"h-5 w-5 text-red-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-red-900",children:"Legal Agreement"}),e.jsx("p",{className:"text-sm text-red-800",children:"These Terms of Service constitute a legally binding agreement between you and SokoConnect. By accessing or using our platform, you agree to be bound by these terms and all applicable laws."})]})]})})]}),e.jsxs(_,{className:"space-y-8",children:[e.jsxs("section",{children:[e.jsxs("h2",{className:"text-2xl font-semibold mb-4 flex items-center",children:[e.jsx(Ds,{className:"mr-2 h-6 w-6 text-blue-600"}),"1. Acceptance of Terms"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm leading-relaxed",children:"By accessing, browsing, or using the SokoConnect platform (website, mobile application, or API services), you acknowledge that you have read, understood, and agree to be bound by these Terms of Service and our Privacy Policy."}),e.jsxs("div",{className:"p-4 border rounded-lg bg-blue-50",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Platform Scope"}),e.jsx("p",{className:"text-sm",children:"SokoConnect is an agricultural technology platform that connects farmers, buyers, service providers, and other stakeholders in Kenya's agricultural ecosystem. We facilitate connections but do not control or guarantee the quality, legality, or availability of products or services offered by users."})]}),e.jsxs("div",{className:"p-4 border rounded-lg bg-amber-50",children:[e.jsxs("h3",{className:"font-semibold mb-2 flex items-center",children:[e.jsx(Se,{className:"mr-2 h-4 w-4 text-amber-600"}),"User Eligibility"]}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsx("li",{children:"You must be at least 18 years old to use SokoConnect"}),e.jsx("li",{children:"You must have legal capacity to enter into binding agreements"}),e.jsx("li",{children:"You must comply with all applicable laws in Kenya and your jurisdiction"}),e.jsx("li",{children:"Business users must have proper registration and licensing as required by law"})]})]})]})]}),e.jsx(qe,{}),e.jsxs("section",{children:[e.jsxs("h2",{className:"text-2xl font-semibold mb-4 flex items-center",children:[e.jsx(st,{className:"mr-2 h-6 w-6 text-blue-600"}),"2. Open Data Policy Compliance"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg bg-green-50",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Kenya Ministry of Agriculture Open Data Adherence"}),e.jsx("p",{className:"text-sm mb-3",children:"SokoConnect fully adheres to the Kenya Ministry of Agriculture and Livestock Development's Open Data Policy, ensuring transparent, accessible, and responsible agricultural data sharing."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-green-700 mb-2",children:"Data Quality Standards"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsx("li",{children:"Complete data without privacy violations"}),e.jsx("li",{children:"Primary data traceable to source"}),e.jsx("li",{children:"Timely updates preserving data value"}),e.jsx("li",{children:"Accessible to widest user range"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-green-700 mb-2",children:"Technical Standards"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsx("li",{children:"Machine-processable structured data"}),e.jsx("li",{children:"Non-discriminatory access policies"}),e.jsx("li",{children:"License-free, non-proprietary formats"}),e.jsx("li",{children:"Reviewable with designated contacts"})]})]})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Our Data Commitments"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Open by Default:"})," Non-sensitive agricultural data freely available"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"High-Quality APIs:"})," Free, reliable application programming interfaces"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Government Partnerships:"})," Collaboration with MoA&LD and counties"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Security Standards:"})," Highest privacy and security protections"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Systematic Renewal:"})," Regular data updates and historical preservation"]})]})]})]})]}),e.jsx(qe,{}),e.jsxs("section",{children:[e.jsxs("h2",{className:"text-2xl font-semibold mb-4 flex items-center",children:[e.jsx(se,{className:"mr-2 h-6 w-6 text-blue-600"}),"3. User Responsibilities and Conduct"]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Account Security"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-sm",children:[e.jsx("li",{children:"Maintain the confidentiality of your account credentials"}),e.jsx("li",{children:"Notify us immediately of any unauthorized access to your account"}),e.jsx("li",{children:"Provide accurate, current, and complete information during registration"}),e.jsx("li",{children:"Update your information promptly when changes occur"}),e.jsx("li",{children:"You are responsible for all activities that occur under your account"})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Acceptable Use"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-green-700 mb-2",children:"âœ“ Permitted Activities"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsx("li",{children:"Legitimate agricultural trading and business"}),e.jsx("li",{children:"Seeking or providing agricultural services"}),e.jsx("li",{children:"Sharing educational farming content"}),e.jsx("li",{children:"Participating in community discussions"}),e.jsx("li",{children:"Using APIs for business integration"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-red-700 mb-2",children:"âœ— Prohibited Activities"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsx("li",{children:"Fraudulent or deceptive practices"}),e.jsx("li",{children:"Selling illegal or harmful products"}),e.jsx("li",{children:"Harassment or abusive behavior"}),e.jsx("li",{children:"Spam or unsolicited communications"}),e.jsx("li",{children:"Unauthorized data scraping or API abuse"})]})]})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg bg-red-50",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-3 flex items-center",children:[e.jsx(Se,{className:"mr-2 h-5 w-5 text-red-600"}),"Strictly Prohibited Activities"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsx("li",{children:"Money laundering or financial crimes"}),e.jsx("li",{children:"Tax evasion or fraudulent reporting"}),e.jsx("li",{children:"Selling counterfeit agricultural products"}),e.jsx("li",{children:"Misrepresenting crop quality or certifications"})]}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsx("li",{children:"Violating intellectual property rights"}),e.jsx("li",{children:"Distributing malware or viruses"}),e.jsx("li",{children:"Attempting to hack or compromise the platform"}),e.jsx("li",{children:"Creating multiple accounts to circumvent restrictions"})]})]})]})]})]}),e.jsx(qe,{}),e.jsxs("section",{children:[e.jsxs("h2",{className:"text-2xl font-semibold mb-4 flex items-center",children:[e.jsx(Ve,{className:"mr-2 h-6 w-6 text-blue-600"}),"4. Platform Disclaimers and Limitations"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg bg-yellow-50",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Platform Role Disclaimer"}),e.jsxs("p",{className:"text-sm mb-2",children:[e.jsx("strong",{children:"SokoConnect is a technology platform that facilitates connections."})," We do not:"]}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsx("li",{children:"Own, sell, or directly control any agricultural products or services"}),e.jsx("li",{children:"Guarantee the quality, safety, legality, or availability of user offerings"}),e.jsx("li",{children:"Manage farming operations or provide direct agricultural services"}),e.jsx("li",{children:"Act as a financial institution or provide banking services"}),e.jsx("li",{children:"Assume responsibility for user transactions or business relationships"})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Data and Information Disclaimer"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Market Prices:"})," Provided for informational purposes only; not investment advice"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Weather Data:"})," Based on third-party sources; users should verify independently"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Agricultural Advice:"})," AI-generated suggestions are not professional consultations"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"External APIs:"})," We integrate with Kilimo Statistics API and other government sources but cannot guarantee their accuracy"]})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg bg-red-50",children:[e.jsxs("h3",{className:"font-semibold mb-2 flex items-center",children:[e.jsx(Se,{className:"mr-2 h-4 w-4 text-red-600"}),"Service Availability"]}),e.jsx("p",{className:"text-sm",children:"While we strive for 99.9% uptime, we cannot guarantee uninterrupted service. The platform may be temporarily unavailable due to maintenance, updates, or technical issues. We are not liable for losses resulting from service interruptions."})]})]})]}),e.jsx(qe,{}),e.jsxs("section",{children:[e.jsxs("h2",{className:"text-2xl font-semibold mb-4 flex items-center",children:[e.jsx(Ai,{className:"mr-2 h-6 w-6 text-blue-600"}),"5. Limitation of Liability"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg bg-red-50",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Maximum Liability Cap"}),e.jsx("p",{className:"text-sm",children:e.jsx("strong",{children:"SokoConnect's total liability to you for any claims arising from your use of the platform shall not exceed KES 50,000 or the amount you paid us in the 12 months preceding the claim, whichever is lower."})})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Excluded Damages"}),e.jsx("p",{className:"text-sm mb-2",children:"We are not liable for:"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsx("li",{children:"Crop losses or agricultural failures"}),e.jsx("li",{children:"Business losses or lost profits"}),e.jsx("li",{children:"Failed transactions between users"}),e.jsx("li",{children:"Data loss or corruption"})]}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsx("li",{children:"Third-party service failures"}),e.jsx("li",{children:"Consequential or indirect damages"}),e.jsx("li",{children:"User negligence or misuse"}),e.jsx("li",{children:"Force majeure events"})]})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg bg-blue-50",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"User Indemnification"}),e.jsx("p",{className:"text-sm",children:"You agree to indemnify and hold SokoConnect harmless from any claims, damages, or expenses arising from your use of the platform, violation of these terms, or infringement of third-party rights."})]})]})]}),e.jsx(qe,{}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"6. Intellectual Property Rights"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"SokoConnect Intellectual Property"}),e.jsx("p",{className:"text-sm mb-2",children:"All platform content, features, and functionality are owned by SokoConnect, including:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsx("li",{children:"Software code, algorithms, and AI models"}),e.jsx("li",{children:"Trademarks, logos, and brand elements"}),e.jsx("li",{children:"Database structures and aggregated data"}),e.jsx("li",{children:"User interface designs and documentation"})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"User Content Rights"}),e.jsx("p",{className:"text-sm mb-2",children:"You retain ownership of content you submit but grant us a license to:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsx("li",{children:"Display your content on the platform"}),e.jsx("li",{children:"Use aggregated data for agricultural research"}),e.jsx("li",{children:"Moderate and remove inappropriate content"}),e.jsx("li",{children:"Create anonymized analytics and insights"})]})]})]})]}),e.jsx(qe,{}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"7. Payment and Financial Terms"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Platform Fees"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Basic Services:"})," Free for farmers and basic users"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Premium Features:"})," API access, advanced analytics (fees apply)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Business Services:"})," Advertising, premium listings (KES 2,500-15,000/month)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Transaction Fees:"})," May apply to facilitated payments (clearly disclosed)"]})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg bg-amber-50",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Tax Responsibilities"}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Users are solely responsible for their tax obligations."})," This includes: income tax on sales, VAT where applicable, and proper record-keeping for tax authorities. SokoConnect provides transaction records but does not provide tax advice."]})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Payment Processing"}),e.jsx("p",{className:"text-sm",children:"Payments are processed through secure third-party providers (PayPal, M-Pesa). We do not store payment card information. Refunds are subject to our refund policy and the terms of the specific service purchased."})]})]})]}),e.jsx(qe,{}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"8. Dispute Resolution"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Internal Resolution Process"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Direct Communication:"})," Users should first attempt to resolve disputes directly"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Platform Mediation:"})," SokoConnect can facilitate discussions if requested"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Documentation:"})," Keep records of all communications and transactions"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Support Escalation:"})," Contact support@sokoconnect.co.ke for assistance"]})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg bg-blue-50",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Legal Jurisdiction"}),e.jsx("p",{className:"text-sm",children:"These terms are governed by Kenyan law. Any legal disputes will be resolved in Kenyan courts, specifically in Nairobi. Users agree to submit to the jurisdiction of these courts."})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Alternative Dispute Resolution"}),e.jsx("p",{className:"text-sm",children:"Before initiating legal proceedings, parties agree to attempt resolution through the Nairobi Centre for International Arbitration or another mutually agreed arbitration service."})]})]})]}),e.jsx(qe,{}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"9. Termination"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"User Termination Rights"}),e.jsx("p",{className:"text-sm mb-2",children:"You may terminate your account at any time by:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsx("li",{children:"Using the account deletion feature in your profile settings"}),e.jsx("li",{children:"Contacting our support team at support@sokoconnect.co.ke"}),e.jsx("li",{children:"Data will be deleted according to our Privacy Policy retention schedule"})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg bg-red-50",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"SokoConnect Termination Rights"}),e.jsx("p",{className:"text-sm mb-2",children:"We may suspend or terminate accounts for:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsx("li",{children:"Violation of these Terms of Service"}),e.jsx("li",{children:"Fraudulent or illegal activities"}),e.jsx("li",{children:"Abuse of platform features or other users"}),e.jsx("li",{children:"Extended inactivity (12+ months with notice)"})]})]})]})]}),e.jsx(qe,{}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"10. Contact Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(w,{children:[e.jsx(q,{className:"pb-3",children:e.jsx(L,{className:"text-lg",children:"Legal Department"})}),e.jsxs(_,{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," legal@sokoconnect.co.ke"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," +254 700 000 001"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," Nairobi, Kenya"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Response Time:"})," 5-7 business days"]})]})]}),e.jsxs(w,{children:[e.jsx(q,{className:"pb-3",children:e.jsx(L,{className:"text-lg",children:"Customer Support"})}),e.jsxs(_,{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," support@sokoconnect.co.ke"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," +254 700 000 002"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Hours:"})," 8 AM - 6 PM EAT, Mon-Fri"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Emergency:"})," 24/7 for critical issues"]})]})]})]})]}),e.jsxs("div",{className:"mt-8 p-4 bg-blue-50 border border-blue-200 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900",children:"By using SokoConnect, you acknowledge that you have read, understood, and agree to be bound by these Terms of Service. These terms constitute the entire agreement between you and SokoConnect regarding the use of our platform."}),e.jsx("p",{className:"text-xs text-blue-700 mt-2",children:"For questions about these terms, please contact our legal department at legal@sokoconnect.co.ke"})]})]})]})});async function Tx(s){return F.from("partners").insert([s]).select()}async function Dx(s){const t=F.from("partner_events").select("*");return s?t.eq("partner_id",s):t}const Ex=()=>{const{toast:s}=Z(),[t,a]=i.useState({company_name:"",contact_email:"",contact_phone:"",website:"",description:"",logo_url:""}),[r,n]=i.useState(!1),[c,l]=i.useState(null),x=j=>{const{name:N,value:g}=j.target;a(u=>({...u,[N]:g}))},f=async j=>{j.preventDefault(),n(!0),l(null);try{const{error:N}=await Tx(t);N?l(N.message):(s({title:"Application Submitted",description:"We will contact you soon."}),a({company_name:"",contact_email:"",contact_phone:"",website:"",description:"",logo_url:""}))}catch(N){l(N.message||"Submission failed")}n(!1)};return e.jsxs(w,{className:"max-w-xl mx-auto mb-8",children:[e.jsx(q,{children:e.jsx(L,{children:"Become a Partner"})}),e.jsx(_,{children:e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsx(D,{name:"company_name",value:t.company_name,onChange:x,placeholder:"Company Name",required:!0}),e.jsx(D,{name:"contact_email",value:t.contact_email,onChange:x,placeholder:"Contact Email",type:"email",required:!0}),e.jsx(D,{name:"contact_phone",value:t.contact_phone,onChange:x,placeholder:"Contact Phone"}),e.jsx(D,{name:"website",value:t.website,onChange:x,placeholder:"Website"}),e.jsx(le,{name:"description",value:t.description,onChange:x,placeholder:"Describe your organization and partnership goals",rows:3,required:!0}),e.jsx(D,{name:"logo_url",value:t.logo_url,onChange:x,placeholder:"Logo URL (optional)"}),e.jsx(b,{type:"submit",className:"w-full",disabled:r,children:r?"Submitting...":"Submit"}),c&&e.jsx("div",{className:"text-red-500 text-sm mt-2",children:c})]})})]})},Qn=()=>{const[s,t]=i.useState([]);return i.useEffect(()=>{Dx().then(({data:a})=>{Array.isArray(a)?t((a||[]).map(n=>({id:n.id,title:n.title??n.name??"Partner Event",description:n.description??"",event_date:n.event_date??n.date??n.created_at??"",location:n.location??n.venue??"",image_url:n.image_url??n.featured_image_url??void 0,partner_id:n.partner_id??n.user_id??""}))):t([])})},[]),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(a=>e.jsxs("div",{className:"border rounded-lg p-4 bg-white shadow",children:[e.jsx("h3",{className:"font-bold text-lg mb-1",children:a.title}),e.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:[a.event_date," â€¢ ",a.location]}),e.jsx("p",{className:"mb-2",children:a.description}),a.image_url&&e.jsx("img",{src:a.image_url,alt:a.title,className:"h-32 object-cover rounded"})]},a.id))})},Fx=()=>e.jsxs("div",{className:"container mx-auto py-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Partner With Us"}),e.jsxs("p",{className:"mb-6 text-muted-foreground",children:["Submit your organization to collaborate, host events, and reach the agri-community. For inquiries, contact us at"," ",e.jsx("a",{href:"mailto:sokoconnect@tenderzville-portal.co.ke",className:"text-primary hover:underline",children:"sokoconnect@tenderzville-portal.co.ke"})]}),e.jsx(Ex,{}),e.jsxs("div",{className:"mt-10",children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Upcoming & Past Partner Events"}),e.jsx(Qn,{})]})]}),qx=()=>e.jsxs("div",{className:"container mx-auto py-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Partner Dashboard"}),e.jsx("p",{className:"mb-6 text-muted-foreground",children:"Manage your company profile and events."}),e.jsxs("div",{className:"mt-10",children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Your Events"}),e.jsx(Qn,{})]})]}),Lx=()=>{const[s,t]=i.useState(""),[a,r]=i.useState("all"),[n,c]=i.useState([]),[l,x]=i.useState([]),[f,j]=i.useState(!0),{toast:N}=Z();i.useEffect(()=>{g()},[]);const g=async()=>{try{j(!0);const{data:p,error:m}=await F.from("farm_input_products").select(`
          *,
          supplier:farm_input_suppliers (
            id,
            supplier_name,
            contact_phone
          )
        `).eq("is_active",!0);if(m)throw m;c(p||[])}catch(p){console.error("Error fetching products:",p),N({title:"Error",description:"Failed to load products. Please try again.",variant:"destructive"})}finally{j(!1)}},u=n.filter(p=>{var y;const m=p.product_name.toLowerCase().includes(s.toLowerCase())||((y=p.product_description)==null?void 0:y.toLowerCase().includes(s.toLowerCase())),o=a==="all"||!a||p.product_category===a;return m&&o}),d=Array.from(new Set(n.map(p=>p.product_category))),h=(p,m)=>{const o={id:p.id,product_name:p.product_name,quantity:m,price_per_unit:p.price_per_unit,supplier:{id:p.supplier.id,supplier_name:p.supplier.supplier_name,contact_phone:p.supplier.contact_phone}};x(y=>y.find(A=>A.id===p.id)?y.map(A=>A.id===p.id?{...A,quantity:A.quantity+m}:A):[...y,o]),N({title:"Added to Cart",description:`${m} ${p.unit_of_measure} of ${p.product_name} added to cart`})},v=async()=>{var p,m;if(l.length!==0)try{j(!0);const{data:{user:o}}=await F.auth.getUser();if(!o){N({title:"Authentication Required",description:"Please log in to place orders.",variant:"destructive"});return}const y=l.reduce((k,A)=>{const S=A.supplier.id;return k[S]||(k[S]={supplier:A.supplier,items:[],total:0}),k[S].items.push(A),k[S].total+=A.quantity*A.price_per_unit,k},{});for(const[k,A]of Object.entries(y)){const{data:S,error:E}=await F.from("farm_input_orders").insert({buyer_id:o.id,supplier_id:k,total_amount:A.total,delivery_method:"pickup",buyer_name:((p=o.user_metadata)==null?void 0:p.full_name)||"John Farmer",buyer_phone:((m=o.user_metadata)==null?void 0:m.phone)||"+254700000000",delivery_county:"Nairobi"}).select().single();if(E)throw E;const P=A.items.map(M=>({order_id:S.id,product_id:M.id,quantity:M.quantity,unit_price:M.price_per_unit,total_price:M.quantity*M.price_per_unit})),{error:R}=await F.from("farm_input_order_items").insert(P);if(R)throw R}x([]),N({title:"Orders Placed Successfully",description:`${Object.keys(y).length} order(s) have been placed with different suppliers.`})}catch(o){console.error("Error placing order:",o),N({title:"Error",description:"Failed to place order. Please try again.",variant:"destructive"})}finally{j(!1)}};return f?e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),e.jsx("main",{className:"py-12 px-6 max-w-7xl mx-auto",children:e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-lg",children:"Loading farm inputs..."})})})]}):e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),e.jsxs("main",{className:"py-12 px-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-4",children:"Farm Input Marketplace"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-6",children:"Source quality agricultural inputs from verified suppliers"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Pe,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(D,{placeholder:"Search products...",value:s,onChange:p=>t(p.target.value),className:"pl-10"})]}),e.jsxs(Q,{value:a,onValueChange:r,children:[e.jsx(W,{className:"w-full sm:w-48",children:e.jsx(J,{placeholder:"All Categories"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Categories"}),d.map(p=>e.jsx(T,{value:p,children:p},p))]})]}),e.jsxs(b,{variant:"outline",children:[e.jsx(It,{className:"h-4 w-4 mr-2"}),"More Filters"]})]})]}),e.jsx("div",{className:"grid gap-6",children:u.map(p=>e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-xl mb-2",children:p.product_name}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(I,{variant:"secondary",children:p.product_category}),e.jsxs(I,{variant:"default",children:[p.price_per_unit," KES / ",p.unit_of_measure]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-primary mb-1",children:p.supplier.supplier_name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:p.supplier.contact_phone})]})]})}),e.jsxs(_,{children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:p.product_description}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Available Stock:"}),e.jsx("div",{className:"text-sm font-medium",children:p.stock_quantity})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Brand:"}),e.jsx("div",{className:"text-sm font-medium",children:p.brand_name||"N/A"})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsx(D,{type:"number",placeholder:"Quantity",defaultValue:1,className:"w-24"}),e.jsxs(b,{onClick:()=>h(p,1),className:"flex-1",children:[e.jsx(Ic,{className:"h-4 w-4 mr-2"}),"Add to Cart"]})]})]})]},p.id))}),u.length===0&&e.jsx(w,{className:"text-center py-12",children:e.jsxs(_,{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No products found"}),e.jsx("p",{className:"text-muted-foreground",children:"Try adjusting your search criteria to find what you're looking for."})]})})]}),e.jsx("div",{className:"fixed bottom-0 left-0 w-full bg-white border-t p-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(rs,{className:"h-5 w-5"}),e.jsxs("span",{className:"font-medium",children:[l.length," items in cart"]})]}),e.jsx("div",{children:e.jsx(b,{onClick:v,disabled:l.length===0||f,children:f?e.jsx(e.Fragment,{children:"Placing Order..."}):e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),"Place Order"]})})})]})})]})},Mx="/assets/marikiti-market-bg-D20wpahJ.jpg",Ix=()=>{const[s,t]=i.useState([]),[a,r]=i.useState(""),[n,c]=i.useState("all"),[l,x]=i.useState("all"),[f,j]=i.useState(!0),[N,g]=i.useState(!0),{toast:u}=Z();i.useEffect(()=>{d()},[]);const d=async()=>{try{j(!0);const{data:m,error:o}=await F.from("city_markets").select("*").eq("status","active").order("name");if(o)throw o;t(m||[])}catch(m){console.error("Error fetching markets:",m),u({title:"Error",description:"Failed to load city markets. Please try again.",variant:"destructive"})}finally{j(!1)}},h=s.filter(m=>{const o=m.name.toLowerCase().includes(a.toLowerCase())||m.location.toLowerCase().includes(a.toLowerCase()),y=n==="all"||m.market_type===n,k=l==="all"||m.location.includes(l);return o&&y&&k}),v=Array.from(new Set(s.map(m=>m.market_type).filter(Boolean))),p=Array.from(new Set(s.map(m=>m.location.split(",")[0]).filter(Boolean)));return f?e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),e.jsx("main",{className:"py-12 px-6 max-w-7xl mx-auto",children:e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-lg",children:"Loading city markets..."})})})]}):e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),N&&e.jsx(_s,{marketplaceType:"city-markets",onAccept:()=>g(!1)}),e.jsxs("section",{className:"relative text-white py-16 bg-cover bg-center",style:{backgroundImage:`url(${Mx})`,backgroundAttachment:"fixed"},children:[e.jsx("div",{className:"absolute inset-0 bg-black/40"}),e.jsxs("div",{className:"relative container mx-auto px-4 text-center",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-6",children:"City Markets Directory"}),e.jsx("p",{className:"text-xl mb-8 max-w-3xl mx-auto",children:"Discover local markets across Kenya. Find the best places to buy and sell agricultural products in your county."})]})]}),e.jsxs("div",{className:"container mx-auto px-4 py-16",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"grid md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Pe,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(D,{placeholder:"Search markets...",value:a,onChange:m=>r(m.target.value),className:"pl-10"})]}),e.jsxs(Q,{value:n,onValueChange:c,children:[e.jsx(W,{children:e.jsx(J,{placeholder:"Market Type"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Types"}),v.map(m=>e.jsx(T,{value:m,children:m},m))]})]}),e.jsxs(Q,{value:l,onValueChange:x,children:[e.jsx(W,{children:e.jsx(J,{placeholder:"Location"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Locations"}),p.map(m=>e.jsx(T,{value:m,children:m},m))]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground flex items-center",children:[h.length," markets found"]})]})}),e.jsx("div",{className:"grid lg:grid-cols-2 xl:grid-cols-3 gap-6",children:h.map(m=>{var o;return e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-xl mb-2",children:m.name}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:m.location})]})]}),e.jsx(I,{variant:"secondary",children:m.market_type})]})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[m.operating_hours&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(is,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:m.operating_hours})]}),((o=m.contact_info)==null?void 0:o.phone)&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:m.contact_info.phone})]}),m.facilities&&m.facilities.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold mb-2",children:"Facilities"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[m.facilities.slice(0,3).map((y,k)=>e.jsx(I,{variant:"outline",className:"text-xs",children:y},k)),m.facilities.length>3&&e.jsxs(I,{variant:"outline",className:"text-xs",children:["+",m.facilities.length-3," more"]})]})]}),e.jsxs("div",{className:"pt-4 border-t flex gap-2",children:[e.jsxs(b,{variant:"outline",size:"sm",className:"flex-1",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Get Directions"]}),e.jsxs(b,{size:"sm",className:"flex-1",children:[e.jsx(Ge,{className:"h-4 w-4 mr-2"}),"View Details"]})]})]})})]},m.id)})}),h.length===0&&!f&&e.jsx(w,{className:"text-center py-12",children:e.jsxs(_,{children:[e.jsx(Ge,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No markets found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Try adjusting your search criteria or check back later for new markets."}),e.jsx(b,{variant:"outline",onClick:()=>{alert("Market suggestion feature coming soon! Please contact us directly for now.")},children:"Suggest a Market"})]})}),e.jsxs("section",{className:"mt-16 bg-muted/30 rounded-lg p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Market Information"}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"Everything you need to know about trading in city markets"})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(xe,{className:"h-8 w-8 text-primary"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Operating Hours"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Most markets operate 6 AM - 6 PM daily"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(ye,{className:"h-8 w-8 text-primary"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Transport Access"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Good road access and parking facilities"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(se,{className:"h-8 w-8 text-primary"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Market Community"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Connect with local traders and farmers"})]})]})]})]})]})},Rx="/assets/equipment-hero-bg-DtEiGYGX.png",zx=()=>{const[s,t]=i.useState([]),[a,r]=i.useState(!0),[n,c]=i.useState(""),[l,x]=i.useState("all"),[f,j]=i.useState("all"),[N,g]=i.useState(!1),[u,d]=i.useState(!0),{toast:h}=Z(),{user:v}=je(),p=Ne(),[m,o]=i.useState({equipment_name:"",equipment_type:"tractor",brand:"",model:"",condition:"used",year_manufactured:new Date().getFullYear(),price:"",rental_option:!1,rental_price_per_day:"",location:"",county:"",description:"",contact_phone:"",contact_email:""});i.useEffect(()=>{y()},[]);async function y(){r(!0);try{const{data:P,error:R}=await F.from("equipment_marketplace").select("*").eq("availability_status","available").order("created_at",{ascending:!1});if(R)throw R;t(P||[])}catch(P){console.error("Error fetching equipment:",P),h({title:"Error",description:"Failed to load equipment listings",variant:"destructive"})}finally{r(!1)}}const k=async()=>{if(!v){h({title:"Authentication Required",description:"Please sign in to add equipment",variant:"destructive"}),g(!1),p("/auth");return}try{const{error:P}=await F.from("equipment_marketplace").insert([{seller_id:v.id,equipment_name:m.equipment_name,equipment_type:m.equipment_type,brand:m.brand,model:m.model,condition:m.condition,year_manufactured:m.year_manufactured,price:parseFloat(m.price),rental_option:m.rental_option,rental_price_per_day:m.rental_price_per_day?parseFloat(m.rental_price_per_day):null,location:m.location,county:m.county,description:m.description,contact_phone:m.contact_phone,contact_email:m.contact_email}]);if(P)throw P;h({title:"Success",description:"Equipment listed successfully"}),g(!1),y()}catch(P){h({title:"Error",description:P.message||"Failed to add equipment",variant:"destructive"})}},A=["tractor","harvester","planter","sprayer","irrigation","storage","transport","processing","other"],S=["new","like-new","used","refurbished"];Array.from(new Set(s.map(P=>P.county).filter(Boolean)));const E=s.filter(P=>{var te,ue,z;const R=((te=P.equipment_name)==null?void 0:te.toLowerCase().includes(n.toLowerCase()))||((ue=P.brand)==null?void 0:ue.toLowerCase().includes(n.toLowerCase()))||((z=P.description)==null?void 0:z.toLowerCase().includes(n.toLowerCase())),M=l==="all"||P.equipment_type===l,O=f==="all"||f==="rental"&&P.rental_option||f==="sale"&&!P.rental_option;return R&&M&&O});return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(ne,{}),u&&e.jsx(_s,{marketplaceType:"equipment",onAccept:()=>d(!1)}),e.jsx("section",{className:"relative py-20 md:py-28",style:{backgroundImage:`linear-gradient(rgba(0, 0, 0, 0.65), rgba(0, 0, 0, 0.75)), url(${Rx})`,backgroundSize:"cover",backgroundPosition:"center"},children:e.jsx("div",{className:"container mx-auto px-4 text-white",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[e.jsxs(I,{className:"mb-4 bg-amber-500/20 text-amber-300 border-amber-500/30",children:[e.jsx(dt,{className:"h-3 w-3 mr-1"}),"Farm Equipment Hub"]}),e.jsxs("h1",{className:"text-4xl md:text-6xl font-bold mb-6",children:["Agricultural Equipment",e.jsx("br",{}),"Marketplace"]}),e.jsx("p",{className:"text-xl md:text-2xl mb-8 text-gray-200 max-w-2xl mx-auto",children:"Buy, sell, rent, or lease tractors, harvesters, irrigation systems, and all farming equipment across Kenya."}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-6 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full",children:[e.jsx(ns,{className:"h-5 w-5 text-green-400"}),e.jsx("span",{children:"Verified Sellers"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full",children:[e.jsx(Rc,{className:"h-5 w-5 text-green-400"}),e.jsx("span",{children:"Quality Assured"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full",children:[e.jsx(Dt,{className:"h-5 w-5 text-green-400"}),e.jsx("span",{children:"Best Prices"})]})]}),e.jsxs(_e,{open:N,onOpenChange:g,children:[e.jsx(Ie,{asChild:!0,children:e.jsxs(b,{size:"lg",className:"bg-amber-600 hover:bg-amber-700 text-white px-8 py-6 text-lg",children:[e.jsx(ie,{className:"h-5 w-5 mr-2"}),"List Your Equipment"]})}),e.jsxs(we,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Ce,{children:e.jsx(ke,{children:"List Equipment for Sale or Rent"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"equipment_name",children:"Equipment Name *"}),e.jsx(D,{id:"equipment_name",value:m.equipment_name,onChange:P=>o({...m,equipment_name:P.target.value}),placeholder:"e.g., John Deere 5075E Tractor"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"equipment_type",children:"Type *"}),e.jsxs(Q,{value:m.equipment_type,onValueChange:P=>o({...m,equipment_type:P}),children:[e.jsx(W,{children:e.jsx(J,{})}),e.jsx(Y,{children:A.map(P=>e.jsx(T,{value:P,children:P.charAt(0).toUpperCase()+P.slice(1)},P))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"brand",children:"Brand"}),e.jsx(D,{id:"brand",value:m.brand,onChange:P=>o({...m,brand:P.target.value}),placeholder:"e.g., John Deere"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"model",children:"Model"}),e.jsx(D,{id:"model",value:m.model,onChange:P=>o({...m,model:P.target.value}),placeholder:"e.g., 5075E"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"year",children:"Year"}),e.jsx(D,{id:"year",type:"number",value:m.year_manufactured,onChange:P=>o({...m,year_manufactured:parseInt(P.target.value)})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"condition",children:"Condition *"}),e.jsxs(Q,{value:m.condition,onValueChange:P=>o({...m,condition:P}),children:[e.jsx(W,{children:e.jsx(J,{})}),e.jsx(Y,{children:S.map(P=>e.jsx(T,{value:P,children:P.charAt(0).toUpperCase()+P.slice(1)},P))})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"price",children:"Sale Price (KES) *"}),e.jsx(D,{id:"price",type:"number",value:m.price,onChange:P=>o({...m,price:P.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"location",children:"Location *"}),e.jsx(D,{id:"location",value:m.location,onChange:P=>o({...m,location:P.target.value}),placeholder:"e.g., Nakuru Town"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"county",children:"County *"}),e.jsx(D,{id:"county",value:m.county,onChange:P=>o({...m,county:P.target.value}),placeholder:"e.g., Nakuru"})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"description",children:"Description *"}),e.jsx(le,{id:"description",value:m.description,onChange:P=>o({...m,description:P.target.value}),placeholder:"Describe the equipment, hours used, any modifications, etc."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"contact_phone",children:"Contact Phone *"}),e.jsx(D,{id:"contact_phone",value:m.contact_phone,onChange:P=>o({...m,contact_phone:P.target.value}),placeholder:"+254..."})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"contact_email",children:"Contact Email"}),e.jsx(D,{id:"contact_email",type:"email",value:m.contact_email,onChange:P=>o({...m,contact_email:P.target.value})})]})]}),e.jsx(b,{onClick:k,className:"w-full",children:"List Equipment"})]})]})]})]})})}),e.jsx("section",{className:"bg-amber-50 dark:bg-amber-950/20 py-8 border-b",children:e.jsx("div",{className:"container px-4",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 text-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-3xl font-bold text-amber-600",children:[s.length||"100","+"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Equipment Listed"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold text-amber-600",children:"47"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Counties Covered"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold text-amber-600",children:"50+"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Verified Sellers"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold text-amber-600",children:"24/7"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Support"})]})]})})}),e.jsxs("main",{className:"py-12 px-4 md:px-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-8",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Pe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(D,{placeholder:"Search equipment...",value:n,onChange:P=>c(P.target.value),className:"pl-10"})]}),e.jsxs(Q,{value:l,onValueChange:x,children:[e.jsx(W,{className:"w-full sm:w-48",children:e.jsx(J,{placeholder:"All Categories"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Categories"}),A.map(P=>e.jsx(T,{value:P,children:P.charAt(0).toUpperCase()+P.slice(1)},P))]})]}),e.jsxs(Q,{value:f,onValueChange:j,children:[e.jsx(W,{className:"w-full sm:w-48",children:e.jsx(J,{placeholder:"Sale / Rental"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Types"}),e.jsx(T,{value:"sale",children:"For Sale"}),e.jsx(T,{value:"rental",children:"For Rent"})]})]})]}),a?e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(P=>e.jsxs(w,{className:"animate-pulse",children:[e.jsx("div",{className:"h-48 bg-muted"}),e.jsxs(q,{children:[e.jsx("div",{className:"h-6 bg-muted rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/2"})]})]},P))}):E.length===0?e.jsx(w,{className:"text-center py-12",children:e.jsxs(_,{children:[e.jsx(dt,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No equipment found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Try adjusting your filters or be the first to list equipment!"}),v&&e.jsxs(b,{onClick:()=>g(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"List Equipment"]})]})}):e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:E.map(P=>{var R,M;return e.jsxs(w,{className:"overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsx("div",{className:"h-48 bg-gradient-to-br from-amber-100 to-amber-50 flex items-center justify-center",children:e.jsx(dt,{className:"h-24 w-24 text-amber-300"})}),e.jsxs(q,{children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(L,{className:"text-lg",children:P.equipment_name}),e.jsx(I,{variant:P.rental_option?"secondary":"default",children:P.rental_option?"Rental":"Sale"})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(I,{variant:"outline",children:P.equipment_type}),P.brand&&e.jsx(I,{variant:"secondary",children:P.brand}),e.jsx(I,{variant:P.condition==="new"?"default":"outline",children:P.condition})]})]}),e.jsxs(_,{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:P.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1 text-2xl font-bold text-primary",children:[e.jsx(Ae,{className:"h-5 w-5"}),"KES ",(R=P.price)==null?void 0:R.toLocaleString()]}),P.rental_option&&P.rental_price_per_day&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["KES ",(M=P.rental_price_per_day)==null?void 0:M.toLocaleString(),"/day"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(ee,{className:"h-4 w-4"}),e.jsxs("span",{children:[P.location,", ",P.county]})]}),P.year_manufactured&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(xe,{className:"h-4 w-4"}),e.jsxs("span",{children:["Year: ",P.year_manufactured]})]})]}),e.jsxs(me,{className:"flex gap-2",children:[P.contact_phone&&e.jsx(b,{variant:"outline",size:"sm",className:"flex-1",asChild:!0,children:e.jsxs("a",{href:`tel:${P.contact_phone}`,children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Call"]})}),e.jsx(b,{size:"sm",className:"flex-1",children:"View Details"})]})]},P.id)})})]})]})},Ox=()=>{const[s,t]=i.useState([]),[a,r]=i.useState(!0),[n,c]=i.useState(!1),[l,x]=i.useState(!1),{user:f}=je(),{toast:j}=Z(),[N,g]=i.useState({product_name:"",quantity:"",unit:"Kg",expiry_date:"",pickup_location:"",transport_provided:"no",transport_details:"",pickup_deadline:"",description:""});i.useEffect(()=>{u()},[]);const u=async()=>{try{r(!0);const{data:v,error:p}=await F.from("food_rescue_listings").select("*").eq("status","available").order("created_at",{ascending:!1});if(p)throw p;t(v||[])}catch(v){console.error("Error fetching food listings:",v)}finally{r(!1)}},d=async()=>{if(!f){j({title:"Please login",description:"You must be logged in to list surplus food",variant:"destructive"});return}x(!0);try{const{error:v}=await F.from("food_rescue_listings").insert({donor_id:f.id,product_name:N.product_name,quantity:parseFloat(N.quantity),unit:N.unit,expiry_date:N.expiry_date,pickup_location:N.pickup_location,transport_provided:N.transport_provided==="yes",transport_details:N.transport_provided==="yes"?N.transport_details:null,pickup_deadline:N.pickup_deadline||null,description:N.description,status:"available",available_until:N.expiry_date});if(v)throw v;j({title:"Success",description:"Surplus food listed successfully!"}),c(!1),g({product_name:"",quantity:"",unit:"Kg",expiry_date:"",pickup_location:"",transport_provided:"no",transport_details:"",pickup_deadline:"",description:""}),u()}catch(v){j({title:"Error",description:v.message||"Failed to list food",variant:"destructive"})}finally{x(!1)}},h={availableListings:s.length,verifiedRecipients:0,organizations:0};return e.jsxs("div",{className:"min-h-screen pb-20 md:pb-0",children:[e.jsx(ne,{}),e.jsx("section",{className:"bg-gradient-to-r from-red-500 to-red-700 text-white py-16",children:e.jsxs("div",{className:"container mx-auto px-4 text-center",children:[e.jsx(We,{className:"h-16 w-16 mx-auto mb-4"}),e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-4",children:"Food Rescue Network"}),e.jsx("p",{className:"text-xl mb-8 max-w-3xl mx-auto",children:"Connecting surplus food with those in need - Zero waste, Maximum impact"})]})}),e.jsxs("main",{className:"container mx-auto py-8 px-4",children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-8",children:[e.jsx(w,{className:"border-l-4 border-l-teal-500",children:e.jsxs(_,{className:"pt-6 text-center",children:[e.jsx("div",{className:"p-3 bg-teal-100 rounded-full w-12 h-12 mx-auto mb-3 flex items-center justify-center",children:e.jsx(re,{className:"h-6 w-6 text-teal-600"})}),e.jsx("h3",{className:"font-semibold mb-2",children:"For Farmers"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Donate surplus produce, reduce waste, get tax benefits"})]})}),e.jsx(w,{className:"border-l-4 border-l-blue-500",children:e.jsxs(_,{className:"pt-6 text-center",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-full w-12 h-12 mx-auto mb-3 flex items-center justify-center",children:e.jsx(se,{className:"h-6 w-6 text-blue-600"})}),e.jsx("h3",{className:"font-semibold mb-2",children:"For Organizations"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Access fresh food for schools, hospitals, and communities"})]})}),e.jsx(w,{className:"border-l-4 border-l-amber-500",children:e.jsxs(_,{className:"pt-6 text-center",children:[e.jsx("div",{className:"p-3 bg-amber-100 rounded-full w-12 h-12 mx-auto mb-3 flex items-center justify-center",children:e.jsx(We,{className:"h-6 w-6 text-amber-600"})}),e.jsx("h3",{className:"font-semibold mb-2",children:"Impact"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Combat hunger, reduce environmental impact"})]})})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 mb-8",children:[e.jsx(w,{children:e.jsxs(_,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(re,{className:"h-5 w-5 text-muted-foreground"}),e.jsx("span",{children:"Available Listings"})]}),e.jsx("p",{className:"text-3xl font-bold mt-2",children:h.availableListings})]})}),e.jsx(w,{children:e.jsxs(_,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(se,{className:"h-5 w-5 text-muted-foreground"}),e.jsx("span",{children:"Verified Recipients"})]}),e.jsx("p",{className:"text-3xl font-bold mt-2",children:h.verifiedRecipients})]})}),e.jsx(w,{children:e.jsxs(_,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ye,{className:"h-5 w-5 text-muted-foreground"}),e.jsx("span",{children:"Organizations"})]}),e.jsx("p",{className:"text-3xl font-bold mt-2",children:h.organizations})]})})]}),e.jsxs(ge,{defaultValue:"available",className:"mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs(pe,{children:[e.jsx(B,{value:"available",children:"Available Food"}),e.jsx(B,{value:"recipients",children:"Recipients"}),e.jsx(B,{value:"organizations",children:"Organizations"})]}),e.jsxs(_e,{open:n,onOpenChange:c,children:[e.jsx(Ie,{asChild:!0,children:e.jsxs(b,{className:"bg-teal-600 hover:bg-teal-700",children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"List Surplus Food"]})}),e.jsxs(we,{className:"max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsx(Ce,{children:e.jsx(ke,{children:"List Surplus Food"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Product Name*"}),e.jsx(D,{value:N.product_name,onChange:v=>g({...N,product_name:v.target.value}),placeholder:"e.g., Tomatoes"})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Quantity*"}),e.jsx(D,{type:"number",value:N.quantity,onChange:v=>g({...N,quantity:v.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Unit*"}),e.jsxs(Q,{value:N.unit,onValueChange:v=>g({...N,unit:v}),children:[e.jsx(W,{children:e.jsx(J,{})}),e.jsxs(Y,{children:[e.jsx(T,{value:"Kg",children:"Kg"}),e.jsx(T,{value:"Bags",children:"Bags"}),e.jsx(T,{value:"Crates",children:"Crates"}),e.jsx(T,{value:"Tons",children:"Tons"})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Expiry Date*"}),e.jsx(D,{type:"date",value:N.expiry_date,onChange:v=>g({...N,expiry_date:v.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Pickup Location*"}),e.jsx(D,{value:N.pickup_location,onChange:v=>g({...N,pickup_location:v.target.value}),placeholder:"Address or location details"})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Transport Provided?*"}),e.jsxs(Q,{value:N.transport_provided,onValueChange:v=>g({...N,transport_provided:v}),children:[e.jsx(W,{children:e.jsx(J,{})}),e.jsxs(Y,{children:[e.jsx(T,{value:"no",children:"No - Recipient arranges transport"}),e.jsx(T,{value:"yes",children:"Yes - I will deliver"})]})]})]}),N.transport_provided==="yes"&&e.jsxs("div",{children:[e.jsx(C,{children:"Transport Details (optional)"}),e.jsx(le,{value:N.transport_details,onChange:v=>g({...N,transport_details:v.target.value}),placeholder:"Delivery radius, conditions, etc."})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Pickup Deadline (optional)"}),e.jsx(D,{type:"datetime-local",value:N.pickup_deadline,onChange:v=>g({...N,pickup_deadline:v.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Description"}),e.jsx(le,{value:N.description,onChange:v=>g({...N,description:v.target.value}),placeholder:"Additional details about the food..."})]}),e.jsx(b,{onClick:d,disabled:l,className:"w-full",children:l?"Creating...":"Create Listing"})]})]})]})]}),e.jsx(V,{value:"available",children:a?e.jsx("div",{className:"text-center py-12",children:"Loading listings..."}):s.length>0?e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(v=>e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(q,{children:[e.jsx(L,{className:"text-lg",children:v.product_name}),e.jsx(I,{variant:v.transport_provided?"default":"secondary",children:v.transport_provided?"Delivery Available":"Pickup Only"})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{children:[v.quantity," ",v.unit]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:v.pickup_location})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(is,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{children:["Expires: ",new Date(v.expiry_date).toLocaleDateString()]})]}),v.description&&e.jsx("p",{className:"text-muted-foreground",children:v.description})]}),e.jsx(b,{className:"w-full mt-4",children:"Claim This Food"})]})]},v.id))}):e.jsx(w,{className:"text-center py-12",children:e.jsxs(_,{children:[e.jsx(re,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No surplus food available"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Be the first to list surplus food for donation!"}),e.jsxs(b,{onClick:()=>c(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"List Surplus Food"]})]})})}),e.jsx(V,{value:"recipients",children:e.jsx(w,{className:"text-center py-12",children:e.jsxs(_,{children:[e.jsx(se,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No verified recipients yet"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Organizations can register to receive food donations."}),e.jsx(b,{children:"Register as Recipient"})]})})}),e.jsx(V,{value:"organizations",children:e.jsx(w,{className:"text-center py-12",children:e.jsxs(_,{children:[e.jsx(Ye,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No organizations registered"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"NGOs and community organizations can partner with us."}),e.jsx(b,{children:"Partner With Us"})]})})})]})]}),e.jsx(Me,{})]})},Kx=()=>{const[s,t]=i.useState([]),[a,r]=i.useState(!0),[n,c]=i.useState(""),[l,x]=i.useState(!1),[f,j]=i.useState(!1),{user:N}=je(),{toast:g}=Z(),[u,d]=i.useState({product_name:"",quantity:"",unit:"kg",discount_percentage:"30",reason:"cosmetic",location:"",price_per_unit:"",description:"",available_until:""});i.useEffect(()=>{h()},[]);const h=async()=>{try{r(!0);const{data:o,error:y}=await F.from("imperfect_surplus_produce").select("*").eq("status","available").order("created_at",{ascending:!1});if(y)throw y;t(o||[])}catch(o){console.error("Error fetching imperfect produce:",o)}finally{r(!1)}},v=async()=>{if(!N){g({title:"Please login",description:"You must be logged in to list produce",variant:"destructive"});return}j(!0);try{const{error:o}=await F.from("imperfect_surplus_produce").insert({seller_id:N.id,product_name:u.product_name,quantity:parseFloat(u.quantity),unit:u.unit,discount_percentage:parseFloat(u.discount_percentage),reason:u.reason,location:u.location,price_per_unit:parseFloat(u.price_per_unit),description:u.description,available_until:u.available_until,status:"available"});if(o)throw o;g({title:"Success",description:"Imperfect produce listed successfully!"}),x(!1),d({product_name:"",quantity:"",unit:"kg",discount_percentage:"30",reason:"cosmetic",location:"",price_per_unit:"",description:"",available_until:""}),h()}catch(o){g({title:"Error",description:o.message||"Failed to list produce",variant:"destructive"})}finally{j(!1)}},p=s.filter(o=>{var y,k;return((y=o.product_name)==null?void 0:y.toLowerCase().includes(n.toLowerCase()))||((k=o.location)==null?void 0:k.toLowerCase().includes(n.toLowerCase()))}),m=o=>({cosmetic:{label:"Cosmetic Imperfection",variant:"secondary"},size:{label:"Size Variation",variant:"outline"},surplus:{label:"Surplus Stock",variant:"default"},near_expiry:{label:"Near Expiry",variant:"secondary"}})[o]||{label:o,variant:"outline"};return e.jsxs("div",{className:"min-h-screen pb-20 md:pb-0",children:[e.jsx(ne,{}),e.jsx("section",{className:"bg-gradient-to-r from-amber-500 to-orange-600 text-white py-16",children:e.jsxs("div",{className:"container mx-auto px-4 text-center",children:[e.jsx(qa,{className:"h-16 w-16 mx-auto mb-4"}),e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-4",children:"Imperfect Produce Market"}),e.jsx("p",{className:"text-xl mb-8 max-w-3xl mx-auto",children:"Quality produce at discounted prices. Reduce food waste, save money. Perfectly good food that just looks different."}),e.jsxs(_e,{open:l,onOpenChange:x,children:[e.jsx(Ie,{asChild:!0,children:e.jsxs(b,{size:"lg",variant:"secondary",children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"List Imperfect Produce"]})}),e.jsxs(we,{className:"max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsx(Ce,{children:e.jsx(ke,{children:"List Imperfect Produce"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Product Name*"}),e.jsx(D,{value:u.product_name,onChange:o=>d({...u,product_name:o.target.value}),placeholder:"e.g., Tomatoes, Carrots"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Quantity*"}),e.jsx(D,{type:"number",value:u.quantity,onChange:o=>d({...u,quantity:o.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Unit*"}),e.jsxs(Q,{value:u.unit,onValueChange:o=>d({...u,unit:o}),children:[e.jsx(W,{children:e.jsx(J,{})}),e.jsxs(Y,{children:[e.jsx(T,{value:"kg",children:"Kilograms"}),e.jsx(T,{value:"bags",children:"Bags"}),e.jsx(T,{value:"crates",children:"Crates"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Price per Unit (KES)*"}),e.jsx(D,{type:"number",value:u.price_per_unit,onChange:o=>d({...u,price_per_unit:o.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Discount %*"}),e.jsx(D,{type:"number",value:u.discount_percentage,onChange:o=>d({...u,discount_percentage:o.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Reason for Discount*"}),e.jsxs(Q,{value:u.reason,onValueChange:o=>d({...u,reason:o}),children:[e.jsx(W,{children:e.jsx(J,{})}),e.jsxs(Y,{children:[e.jsx(T,{value:"cosmetic",children:"Cosmetic Imperfection"}),e.jsx(T,{value:"size",children:"Size Variation"}),e.jsx(T,{value:"surplus",children:"Surplus Stock"}),e.jsx(T,{value:"near_expiry",children:"Near Expiry"})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Location*"}),e.jsx(D,{value:u.location,onChange:o=>d({...u,location:o.target.value}),placeholder:"Town/County"})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Available Until*"}),e.jsx(D,{type:"date",value:u.available_until,onChange:o=>d({...u,available_until:o.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Description"}),e.jsx(le,{value:u.description,onChange:o=>d({...u,description:o.target.value}),placeholder:"Describe the produce..."})]}),e.jsx(b,{onClick:v,disabled:f,className:"w-full",children:f?"Creating...":"List Produce"})]})]})]})]})}),e.jsxs("main",{className:"container mx-auto py-8 px-4",children:[e.jsx(w,{className:"mb-6 border-amber-200 bg-amber-50",children:e.jsxs(_,{className:"pt-4 flex items-start gap-3",children:[e.jsx(Se,{className:"h-5 w-5 text-amber-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-amber-800",children:"About Imperfect Produce"}),e.jsx("p",{className:"text-sm text-amber-700",children:"These are perfectly safe, nutritious fruits and vegetables that may have cosmetic imperfections, unusual sizes, or are surplus stock. Save money while reducing food waste!"})]})]})}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-4 mb-8",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Pe,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(D,{placeholder:"Search imperfect produce...",value:n,onChange:o=>c(o.target.value),className:"pl-10"})]})}),a?e.jsx("div",{className:"text-center py-12",children:"Loading listings..."}):p.length>0?e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.map(o=>{const y=m(o.reason);return e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(q,{children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(L,{className:"text-lg",children:o.product_name}),e.jsxs(I,{className:"bg-green-500 text-white",children:[o.discount_percentage,"% OFF"]})]}),e.jsx(I,{variant:y.variant,children:y.label})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{children:[o.quantity," ",o.unit," available"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{children:["KES ",o.price_per_unit,"/",o.unit]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:o.location})]}),o.description&&e.jsx("p",{className:"text-muted-foreground",children:o.description})]}),e.jsx(b,{className:"w-full mt-4",children:"Contact Seller"})]})]},o.id)})}):e.jsx(w,{className:"text-center py-12",children:e.jsxs(_,{children:[e.jsx(qa,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No imperfect produce available"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Be the first to list imperfect produce for sale!"}),e.jsxs(b,{onClick:()=>x(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"List Imperfect Produce"]})]})})]}),e.jsx(Me,{})]})};async function Bx(s){return F.from("bulk_orders").insert(s).select()}async function Ux(s){return F.from("processing_matches").insert(s).select()}async function Vx(s={}){return F.from("processing_matches").select("*").match(s)}const $r={product_type:"",quantity:"",unit:""};function $x({onCreated:s}){const[t,a]=i.useState($r),[r,n]=i.useState(!1),[c,l]=i.useState(""),x=j=>{a({...t,[j.target.name]:j.target.value})},f=async j=>{j.preventDefault(),n(!0),l("");try{const{data:N,error:g}=await Bx(t);g?l(g.message):(a($r),s&&s(N))}catch{l("Failed to create order")}n(!1)};return e.jsxs("form",{className:"bg-white rounded shadow p-4 max-w-md mx-auto",onSubmit:f,children:[e.jsx("h2",{className:"text-lg font-bold mb-2",children:"Create Bulk Order"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Product Type"}),e.jsx("input",{name:"product_type",value:t.product_type,onChange:x,className:"input input-bordered w-full",required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Quantity"}),e.jsx("input",{name:"quantity",type:"number",value:t.quantity,onChange:x,className:"input input-bordered w-full",required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Unit"}),e.jsx("input",{name:"unit",value:t.unit,onChange:x,className:"input input-bordered w-full",required:!0})]}),c&&e.jsx("div",{className:"text-red-500 text-sm mb-2",children:c}),e.jsx("button",{type:"submit",className:"btn btn-primary w-full",disabled:r,children:r?"Submitting...":"Submit"})]})}const Gx=({onSelect:s})=>{const[t,a]=Bs.useState([]);return Bs.useEffect(()=>{(async()=>{const{data:n}=await F.from("bulk_orders").select("id, product_type, quantity, unit, location, status, deadline").order("created_at",{ascending:!1});n&&a(n)})()},[]),e.jsxs("section",{"aria-labelledby":"bulk-orders-heading",children:[e.jsx("h1",{id:"bulk-orders-heading",children:"Bulk Orders"}),e.jsx("ul",{children:t.map(r=>e.jsxs("li",{onClick:()=>s==null?void 0:s(r),style:{cursor:s?"pointer":"default"},children:[r.product_type," - ",r.quantity," ",r.unit," - ",r.location," - ",r.status]},r.id))})]})},Gr={offer_price:""};function Hx({bulkOrderId:s,farmerId:t,onCreated:a}){const[r,n]=i.useState(Gr),[c,l]=i.useState(!1),[x,f]=i.useState(""),j=g=>{n({...r,[g.target.name]:g.target.value})},N=async g=>{g.preventDefault(),l(!0),f("");try{const u={bulk_order_id:s,farmer_id:t,offer_price:r.offer_price,status:"pending",negotiation_log:[]},{data:d,error:h}=await Ux(u);h?f(h.message):(n(Gr),a&&a(d))}catch{f("Failed to submit match")}l(!1)};return e.jsxs("form",{className:"bg-white rounded shadow p-4 max-w-md mx-auto mt-4",onSubmit:N,children:[e.jsx("h2",{className:"text-lg font-bold mb-2",children:"Submit Offer"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Offer Price"}),e.jsx("input",{name:"offer_price",type:"number",value:r.offer_price,onChange:j,className:"input input-bordered w-full",required:!0})]}),x&&e.jsx("div",{className:"text-red-500 text-sm mb-2",children:x}),e.jsx("button",{type:"submit",className:"btn btn-primary w-full",disabled:c,children:c?"Submitting...":"Submit"})]})}function Ba({type:s,title:t,description:a}){const{toast:r}=Z();r({title:t,description:a})}function Wx({bulkOrderId:s}){const[t,a]=i.useState([]),[r,n]=i.useState(!0),[c,l]=i.useState([]);return i.useEffect(()=>{let x;const f=async()=>{n(!0);const{data:j}=await Vx({bulk_order_id:s});a(j||[]),n(!1),c.length>0&&j&&j.forEach(N=>{const g=c.find(h=>h.id===N.id),u=(N==null?void 0:N.offer_price)??(N==null?void 0:N.price)??"",d=(N==null?void 0:N.status)??"";g?g.status!==d&&Ba({type:"match_status",title:"Offer Status Updated",description:`Offer: ${u}, Status: ${d}`}):Ba({type:"match_new",title:"New Offer Received",description:`Offer: ${u}`})}),l(j||[])};return s&&(f(),x=setInterval(f,5e3)),()=>x&&clearInterval(x)},[s]),s?e.jsxs("div",{className:"bg-white rounded shadow p-4 max-w-2xl mx-auto mt-4",children:[e.jsx("h2",{className:"text-lg font-bold mb-2",children:"Processing Matches"}),r?e.jsx("div",{children:"Loading..."}):t.length===0?e.jsx("div",{className:"text-gray-500",children:"No matches found."}):e.jsx("ul",{className:"divide-y divide-gray-200",children:t.map(x=>e.jsx("li",{className:"py-2 flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Offer:"})," ",(x==null?void 0:x.offer_price)??(x==null?void 0:x.price)??"N/A",e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["Status: ",(x==null?void 0:x.status)??"pending"]})]})},x.id))})]}):null}function Yx({log:s}){return!s||s.length===0?e.jsx("div",{className:"text-gray-500",children:"No negotiation history."}):e.jsxs("div",{className:"bg-white rounded shadow p-4 max-w-2xl mx-auto mt-4",children:[e.jsx("h2",{className:"text-lg font-bold mb-2",children:"Negotiation Log"}),e.jsx("ul",{className:"divide-y divide-gray-200",children:s.map((t,a)=>e.jsxs("li",{className:"py-2",children:[e.jsxs("span",{className:"font-semibold",children:[t.actor,":"]})," ",t.message,e.jsx("span",{className:"ml-2 text-xs text-gray-500",children:t.timestamp})]},a))})]})}function Qx({user:s}){const[t,a]=i.useState(null),[r,n]=i.useState(!1),[c,l]=i.useState([]);return e.jsxs("div",{className:"container mx-auto py-8",children:[e.jsx($x,{onCreated:()=>window.location.reload()}),e.jsx(Gx,{onSelect:x=>{a(x),n(!0)}}),r&&t&&e.jsx(Hx,{bulkOrderId:t.id,farmerId:s==null?void 0:s.id,onCreated:()=>window.location.reload()}),t&&e.jsx(Wx,{bulkOrderId:t.id}),c&&e.jsx(Yx,{log:c})]})}const Hr={product_id:"",recipient_type:"",recipient_id:"",agent_id:"",feedback:"",feedback_rating:""};function Jx({onDonated:s}){const[t,a]=i.useState(Hr),[r,n]=i.useState(!1),[c,l]=i.useState(""),x=j=>{a({...t,[j.target.name]:j.target.value})},f=async j=>{j.preventDefault(),n(!0),l("");try{a(Hr),Ba({type:"donation_new",title:"Donation Submitted",description:`Product: ${t.product_id}, Recipient: ${t.recipient_type} (${t.recipient_id}), Agent: ${t.agent_id}`}),s&&s(t)}catch{l("Failed to submit donation")}n(!1)};return e.jsxs("form",{className:"bg-white rounded shadow p-4 max-w-md mx-auto",onSubmit:f,children:[e.jsx("h2",{className:"text-lg font-bold mb-2",children:"Submit Donation"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Product ID"}),e.jsx("input",{name:"product_id",value:t.product_id,onChange:x,className:"input input-bordered w-full",required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Recipient Type"}),e.jsxs("select",{name:"recipient_type",value:t.recipient_type,onChange:x,className:"input input-bordered w-full",required:!0,children:[e.jsx("option",{value:"",children:"Select..."}),e.jsx("option",{value:"school",children:"School"}),e.jsx("option",{value:"CBO",children:"CBO"}),e.jsx("option",{value:"hospital",children:"Hospital"}),e.jsx("option",{value:"church",children:"Church"}),e.jsx("option",{value:"hospice",children:"Hospice"})]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Recipient ID"}),e.jsx("input",{name:"recipient_id",value:t.recipient_id,onChange:x,className:"input input-bordered w-full",required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Agent ID"}),e.jsx("input",{name:"agent_id",value:t.agent_id,onChange:x,className:"input input-bordered w-full",required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Feedback (optional)"}),e.jsx("input",{name:"feedback",value:t.feedback,onChange:x,className:"input input-bordered w-full"})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Feedback Rating (1-5, optional)"}),e.jsx("input",{name:"feedback_rating",type:"number",min:"1",max:"5",value:t.feedback_rating,onChange:x,className:"input input-bordered w-full"})]}),c&&e.jsx("div",{className:"text-red-500 text-sm mb-2",children:c}),e.jsx("button",{type:"submit",className:"btn btn-primary w-full",disabled:r,children:r?"Submitting...":"Submit"})]})}const Xx=()=>e.jsx("div",{className:"container mx-auto py-8",children:e.jsx(Jx,{onDonated:()=>{}})}),Jn=i.forwardRef(({className:s,...t},a)=>e.jsx(nn,{className:$("grid gap-2",s),...t,ref:a}));Jn.displayName=nn.displayName;const Xn=i.forwardRef(({className:s,...t},a)=>e.jsx(ln,{ref:a,className:$("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),...t,children:e.jsx(zc,{className:"flex items-center justify-center",children:e.jsx(oi,{className:"h-2.5 w-2.5 fill-current text-current"})})}));Xn.displayName=ln.displayName;const Wr=[{value:"school",label:"Schools",icon:Ye,description:"Primary, secondary schools & universities"},{value:"hospital",label:"Hospitals",icon:se,description:"Hospitals & health centers"},{value:"orphanage",label:"Orphanages",icon:We,description:"Children's homes & orphanages"},{value:"elderly_home",label:"Elderly Homes",icon:se,description:"Senior care facilities"},{value:"church",label:"Religious Organizations",icon:Ye,description:"Churches, mosques, temples"},{value:"cbo",label:"Community Groups",icon:se,description:"CBOs, youth groups, women groups"},{value:"refugee_camp",label:"Refugee Camps",icon:se,description:"IDP & refugee settlements"},{value:"any",label:"Any Recipient",icon:La,description:"Open to any verified recipient"}],Zx=["Nairobi","Mombasa","Kisumu","Nakuru","Kiambu","Machakos","Meru","Kakamega","Uasin Gishu","Nyeri","Kilifi","Turkana","Bungoma","Kisii","Migori","Homa Bay","Trans Nzoia","Nandi","Kericho","Bomet","Laikipia","Embu","Tharaka Nithi","Kitui","Makueni"],eh=()=>{const{user:s}=je(),{toast:t}=Z(),[a,r]=i.useState("donate"),[n,c]=i.useState([]),[l,x]=i.useState(!0),[f,j]=i.useState(!1),[N,g]=i.useState(!1),[u,d]=i.useState(""),[h,v]=i.useState({product_name:"",quantity:"",unit:"kg",location:"",county:"",description:"",expiry_date:"",transport_available:!1,pickup_available:!0,contact_phone:"",contact_email:"",recipient_preference:"any",donor_name:"",donor_organization:""});i.useEffect(()=>{p()},[]);const p=async()=>{try{x(!0);const{data:o,error:y}=await F.from("donations").select("*").eq("status","available").order("created_at",{ascending:!1});if(y)throw y;c(o||[])}catch(o){console.error("Error fetching donations:",o)}finally{x(!1)}},m=async()=>{if(!h.product_name||!h.quantity||!h.location||!h.contact_phone){t({title:"Missing Information",description:"Please fill in all required fields",variant:"destructive"});return}g(!0);try{const o={donor_id:(s==null?void 0:s.id)||"anonymous",donation_type:"produce",items_description:`${h.product_name} - ${h.quantity} ${h.unit}`,amount:parseFloat(h.quantity)||0,notes:JSON.stringify({product_name:h.product_name,location:h.location,county:h.county,description:h.description,expiry_date:h.expiry_date,transport_available:h.transport_available,pickup_available:h.pickup_available,contact_phone:h.contact_phone,contact_email:h.contact_email,recipient_preference:h.recipient_preference,donor_name:h.donor_name,donor_organization:h.donor_organization}),status:"pending"},{error:y}=await F.from("donations").insert(o);if(y)throw y;t({title:"Success!",description:"Your donation has been listed successfully."}),j(!1),v({product_name:"",quantity:"",unit:"kg",location:"",county:"",description:"",expiry_date:"",transport_available:!1,pickup_available:!0,contact_phone:"",contact_email:"",recipient_preference:"any",donor_name:"",donor_organization:""}),p()}catch(o){console.error("Error creating donation:",o),t({title:"Error",description:o.message||"Failed to create donation",variant:"destructive"})}finally{g(!1)}};return e.jsxs("div",{className:"min-h-screen pb-20 md:pb-0",children:[e.jsx(ne,{}),e.jsx("section",{className:"bg-gradient-to-r from-rose-500 to-pink-600 text-white py-16",children:e.jsxs("div",{className:"container mx-auto px-4 text-center",children:[e.jsx(We,{className:"h-16 w-16 mx-auto mb-4"}),e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-4",children:"Food Donation Platform"}),e.jsx("p",{className:"text-xl mb-8 max-w-3xl mx-auto",children:"Connect surplus food with those in need. Reduce food waste and make a difference in your community. Every donation helps feed families, schools, and communities across Kenya."}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-6 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full",children:[e.jsx(ns,{className:"h-5 w-5 text-green-300"}),e.jsx("span",{children:"Verified Recipients"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full",children:[e.jsx(ye,{className:"h-5 w-5 text-green-300"}),e.jsx("span",{children:"Pickup & Delivery Options"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full",children:[e.jsx(We,{className:"h-5 w-5 text-green-300"}),e.jsx("span",{children:"Impact Tracking"})]})]}),e.jsxs(_e,{open:f,onOpenChange:j,children:[e.jsx(Ie,{asChild:!0,children:e.jsxs(b,{size:"lg",variant:"secondary",className:"font-semibold",children:[e.jsx(ie,{className:"h-5 w-5 mr-2"}),"Donate Food Now"]})}),e.jsxs(we,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Ce,{children:e.jsxs(ke,{className:"flex items-center gap-2",children:[e.jsx(La,{className:"h-5 w-5 text-rose-500"}),"Create Food Donation Listing"]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg space-y-4",children:[e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4"}),"Donor Information (Optional)"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Your Name / Contact Person"}),e.jsx(D,{value:h.donor_name,onChange:o=>v({...h,donor_name:o.target.value}),placeholder:"John Doe"})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Organization (if applicable)"}),e.jsx(D,{value:h.donor_organization,onChange:o=>v({...h,donor_organization:o.target.value}),placeholder:"Company/Farm name"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4"}),"Food Details"]}),e.jsxs("div",{children:[e.jsx(C,{children:"Product Name / Type*"}),e.jsx(D,{value:h.product_name,onChange:o=>v({...h,product_name:o.target.value}),placeholder:"e.g., Rice, Vegetables, Cooked meals, Bread"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Quantity*"}),e.jsx(D,{type:"number",value:h.quantity,onChange:o=>v({...h,quantity:o.target.value}),placeholder:"Amount"})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Unit*"}),e.jsxs(Q,{value:h.unit,onValueChange:o=>v({...h,unit:o}),children:[e.jsx(W,{children:e.jsx(J,{})}),e.jsxs(Y,{children:[e.jsx(T,{value:"kg",children:"Kilograms (kg)"}),e.jsx(T,{value:"bags",children:"Bags (90kg)"}),e.jsx(T,{value:"crates",children:"Crates"}),e.jsx(T,{value:"pieces",children:"Pieces"}),e.jsx(T,{value:"cartons",children:"Cartons"}),e.jsx(T,{value:"servings",children:"Servings (cooked food)"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Description"}),e.jsx(le,{value:h.description,onChange:o=>v({...h,description:o.target.value}),placeholder:"Describe the food items, condition, packaging, etc.",rows:3})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Best Before / Expiry Date"}),e.jsx(D,{type:"date",value:h.expiry_date,onChange:o=>v({...h,expiry_date:o.target.value})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Leave blank if not applicable (e.g., fresh produce)"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),"Location & Collection"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"County*"}),e.jsxs(Q,{value:h.county,onValueChange:o=>v({...h,county:o}),children:[e.jsx(W,{children:e.jsx(J,{placeholder:"Select county"})}),e.jsx(Y,{children:Zx.map(o=>e.jsx(T,{value:o,children:o},o))})]})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Specific Location*"}),e.jsx(D,{value:h.location,onChange:o=>v({...h,location:o.target.value}),placeholder:"Town, area, landmark"})]})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(C,{children:"Collection Options*"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(De,{id:"pickup",checked:h.pickup_available,onCheckedChange:o=>v({...h,pickup_available:!!o})}),e.jsx("label",{htmlFor:"pickup",className:"text-sm",children:"Pickup available - Recipient can come and collect"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(De,{id:"transport",checked:h.transport_available,onCheckedChange:o=>v({...h,transport_available:!!o})}),e.jsx("label",{htmlFor:"transport",className:"text-sm",children:"Transport available - I can deliver to recipient"})]}),!h.pickup_available&&!h.transport_available&&e.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[e.jsx(hs,{className:"h-4 w-4"}),"Please select at least one collection option"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(Ee,{className:"h-4 w-4"}),"Contact Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Phone Number*"}),e.jsx(D,{type:"tel",value:h.contact_phone,onChange:o=>v({...h,contact_phone:o.target.value}),placeholder:"0712 345 678"})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Email (Optional)"}),e.jsx(D,{type:"email",value:h.contact_email,onChange:o=>v({...h,contact_email:o.target.value}),placeholder:"email@example.com"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(We,{className:"h-4 w-4"}),"Preferred Recipient Type"]}),e.jsx(Jn,{value:h.recipient_preference,onValueChange:o=>v({...h,recipient_preference:o}),className:"grid grid-cols-2 gap-3",children:Wr.map(o=>e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(Xn,{value:o.value,id:o.value,className:"mt-1"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:o.value,className:"text-sm font-medium cursor-pointer",children:o.label}),e.jsx("p",{className:"text-xs text-muted-foreground",children:o.description})]})]},o.value))})]}),e.jsx(b,{onClick:m,disabled:N||!h.pickup_available&&!h.transport_available,className:"w-full bg-rose-600 hover:bg-rose-700",size:"lg",children:N?"Submitting...":"Submit Donation"})]})]})]})]})}),e.jsxs("main",{className:"container mx-auto py-8 px-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[e.jsx(w,{className:"text-center",children:e.jsxs(_,{className:"pt-6",children:[e.jsx("div",{className:"text-3xl font-bold text-rose-600",children:"1,500+"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Donations Made"})]})}),e.jsx(w,{className:"text-center",children:e.jsxs(_,{className:"pt-6",children:[e.jsx("div",{className:"text-3xl font-bold text-rose-600",children:"250+"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Recipients Served"})]})}),e.jsx(w,{className:"text-center",children:e.jsxs(_,{className:"pt-6",children:[e.jsx("div",{className:"text-3xl font-bold text-rose-600",children:"47"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Counties Covered"})]})}),e.jsx(w,{className:"text-center",children:e.jsxs(_,{className:"pt-6",children:[e.jsx("div",{className:"text-3xl font-bold text-rose-600",children:"50,000+"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Meals Distributed"})]})})]}),e.jsx(w,{className:"mb-6 border-rose-200 bg-rose-50",children:e.jsxs(_,{className:"pt-4 flex items-start gap-3",children:[e.jsx(hs,{className:"h-5 w-5 text-rose-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-rose-800",children:"How It Works"}),e.jsxs("p",{className:"text-sm text-rose-700",children:["1. List your available food donation with details and photos.",e.jsx("br",{}),"2. Verified recipients in your area will be notified.",e.jsx("br",{}),"3. Coordinate pickup or delivery directly with the recipient.",e.jsx("br",{}),"4. Track your donation's impact on the community."]})]})]})}),e.jsxs(ge,{value:a,onValueChange:r,children:[e.jsxs(pe,{className:"mb-6",children:[e.jsx(B,{value:"donate",children:"Available Donations"}),e.jsx(B,{value:"recipients",children:"Find Recipients"}),e.jsx(B,{value:"my-donations",children:"My Donations"})]}),e.jsxs(V,{value:"donate",children:[e.jsx("div",{className:"flex flex-col sm:flex-row gap-4 mb-8",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Pe,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(D,{placeholder:"Search donations...",value:u,onChange:o=>d(o.target.value),className:"pl-10"})]})}),l?e.jsx("div",{className:"text-center py-12",children:"Loading available donations..."}):n.length>0?e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(o=>e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(L,{className:"text-lg",children:o.items_description||"Food Donation"}),e.jsx(I,{className:"bg-green-500 text-white",children:"Available"})]})}),e.jsxs(_,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(is,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{children:["Listed ",new Date(o.created_at).toLocaleDateString()]})]}),e.jsx(b,{className:"w-full",children:"Contact Donor"})]})]},o.id))}):e.jsx(w,{className:"text-center py-12",children:e.jsxs(_,{children:[e.jsx(We,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No donations available yet"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Be the first to donate food to those in need!"}),e.jsxs(b,{onClick:()=>j(!0),className:"bg-rose-600 hover:bg-rose-700",children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Donate Food Now"]})]})})]}),e.jsx(V,{value:"recipients",children:e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Verified Recipients"}),e.jsx(G,{children:"Organizations registered to receive food donations"})]}),e.jsx(_,{children:e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:Wr.slice(0,-1).map(o=>e.jsx(w,{className:"cursor-pointer hover:shadow-md transition-shadow",children:e.jsxs(_,{className:"pt-4 flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-rose-100 rounded-lg",children:e.jsx(o.icon,{className:"h-5 w-5 text-rose-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:o.label}),e.jsx("p",{className:"text-sm text-muted-foreground",children:o.description})]})]})},o.value))})})]})}),e.jsx(V,{value:"my-donations",children:e.jsx(w,{className:"text-center py-12",children:e.jsxs(_,{children:[e.jsx(La,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Track Your Donations"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Sign in to view and manage your donation history."}),!s&&e.jsx(b,{onClick:()=>window.location.href="/auth",children:"Sign In to Continue"})]})})})]})]}),e.jsx(Nt,{}),e.jsx(Me,{})]})},sh=()=>{const[s,t]=i.useState([]),[a,r]=i.useState(""),[n,c]=i.useState(!0),[l,x]=i.useState(!1),{toast:f}=Z();i.useEffect(()=>{j()},[]);const j=async()=>{try{c(!0);const{data:u,error:d}=await F.from("buy_requests").select("*").eq("status","active").order("created_at",{ascending:!1});if(d)throw d;t(u||[])}catch(u){console.error("Error fetching buy requests:",u),f({title:"Error",description:"Failed to load buy requests. Please try again.",variant:"destructive"})}finally{c(!1)}},N=s.filter(u=>u.product_name.toLowerCase().includes(a.toLowerCase())||u.location.toLowerCase().includes(a.toLowerCase())),g=u=>{const d=new Date(u),h=new Date,v=d.getTime()-h.getTime(),p=Math.ceil(v/(1e3*60*60*24));return Math.max(0,p)};return n?e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),e.jsx("main",{className:"py-12 px-6 max-w-7xl mx-auto",children:e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-lg",children:"Loading buy requests..."})})})]}):e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ne,{}),e.jsx("section",{className:"bg-gradient-to-r from-primary to-primary-foreground text-primary-foreground py-16",children:e.jsxs("div",{className:"container mx-auto px-4 text-center",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-6",children:"Buy Requests"}),e.jsx("p",{className:"text-xl mb-8 max-w-3xl mx-auto",children:"Connect with buyers looking for agricultural products. Post what you're selling or find buyers for your produce."}),e.jsxs(b,{size:"lg",variant:"secondary",onClick:()=>x(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Create Buy Request"]})]})}),e.jsxs("div",{className:"container mx-auto px-4 py-16",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-8",children:[e.jsxs("div",{className:"relative mb-4 md:mb-0",children:[e.jsx(Pe,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(D,{placeholder:"Search buy requests...",value:a,onChange:u=>r(u.target.value),className:"pl-10 md:w-64"})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[N.length," active buy requests"]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-12",children:[e.jsx(w,{className:"text-center",children:e.jsxs(_,{className:"pt-6",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(se,{className:"h-8 w-8 text-primary"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Direct Connection"}),e.jsx("p",{className:"text-muted-foreground",children:"Connect directly with verified buyers"})]})}),e.jsx(w,{className:"text-center",children:e.jsxs(_,{className:"pt-6",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(re,{className:"h-8 w-8 text-primary"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Quality Assured"}),e.jsx("p",{className:"text-muted-foreground",children:"Pre-negotiated quality standards"})]})}),e.jsx(w,{className:"text-center",children:e.jsxs(_,{className:"pt-6",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(ee,{className:"h-8 w-8 text-primary"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Local Markets"}),e.jsx("p",{className:"text-muted-foreground",children:"Find buyers in your area"})]})})]}),e.jsx("div",{className:"grid lg:grid-cols-2 gap-6",children:N.map(u=>{const d=g(u.deadline);return e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-xl mb-2",children:u.product_name}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:u.location})]})]}),e.jsxs(I,{variant:d>7?"default":"destructive",children:[d," days left"]})]})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-muted-foreground",children:u.description}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Quantity Needed"}),e.jsxs("div",{className:"font-medium",children:[u.quantity," ",u.unit]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Max Price"}),e.jsxs("div",{className:"font-medium",children:["KES ",u.max_price,"/",u.unit]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(xe,{className:"h-4 w-4"}),e.jsxs("span",{children:["Deadline: ",new Date(u.deadline).toLocaleDateString()]})]}),e.jsxs("div",{className:"pt-4 border-t flex gap-2",children:[e.jsx(b,{variant:"outline",size:"sm",className:"flex-1",children:"View Details"}),e.jsxs(b,{size:"sm",className:"flex-1",children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),"Contact Buyer"]})]})]})})]},u.id)})}),N.length===0&&!n&&e.jsx(w,{className:"text-center py-12",children:e.jsxs(_,{children:[e.jsx(re,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No buy requests found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Be the first to create a buy request in your area."}),e.jsxs(b,{onClick:()=>x(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Create Buy Request"]})]})})]}),l&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-background rounded-lg p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Create Buy Request"}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>x(!1),children:"Close"})]}),e.jsx(On,{userId:"temp-user-id",onSubmitted:()=>{x(!1),j()}})]})})]})},th=()=>{const{user:s}=je();return{user:s}},ah=()=>{const[s,t]=i.useState([]),[a,r]=i.useState(!0),[n,c]=i.useState(""),[l,x]=i.useState("all"),[f,j]=i.useState("all"),{user:N}=th(),[g,u]=i.useState(null),[d,h]=i.useState([]);i.useState(!1);const[v,p]=i.useState([]),[m,o]=i.useState(null);i.useEffect(()=>{y()},[]);async function y(){r(!0);const{data:O}=await F.from("export_opportunities").select("*");O&&t(O),r(!1)}const k=Array.from(new Set(s.map(O=>O.crop_type))),A=Array.from(new Set(s.map(O=>O.destination_country))),S=s.filter(O=>{const te=O.buyer_name.toLowerCase().includes(n.toLowerCase()),ue=l==="all"||O.crop_type===l,z=f==="all"||O.destination_country===f;return te&&ue&&z});async function E(O){if(!window.confirm("Are you sure you want to delete this order?"))return;const{error:te}=await F.from("export_orders").delete().eq("id",O);te||(t(s.filter(ue=>ue.id!==O)),u(null))}async function P(O){const{data:te}=await F.from("timeline_events").select("*").eq("export_order_id",O).order("event_time");h(te||[])}async function R(O){const{data:te}=await F.from("export_documentation").select("*").eq("export_opportunity_id",O);p(te||[])}async function M(O,te){const{data:ue}=await F.from("price_comparisons").select("*").eq("commodity_name",O).eq("export_opportunity_id",te).single();o(ue)}return e.jsx("div",{className:"min-h-screen",children:e.jsxs("main",{className:"py-12 px-6 max-w-7xl mx-auto",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-4",children:"Export Market Opportunities"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-6",children:"Connect with international buyers and access global markets"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsx(D,{placeholder:"Search buyers...",value:n,onChange:O=>c(O.target.value),className:"sm:w-64"}),e.jsxs(Q,{value:l,onValueChange:x,children:[e.jsx(W,{className:"w-full sm:w-48",children:e.jsx(J,{placeholder:"All Crops"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Crops"}),k.map(O=>e.jsx(T,{value:O,children:O},O))]})]}),e.jsxs(Q,{value:f,onValueChange:j,children:[e.jsx(W,{className:"w-full sm:w-48",children:e.jsx(J,{placeholder:"All Countries"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Countries"}),A.map(O=>e.jsx(T,{value:O,children:O},O))]})]})]}),e.jsx("div",{className:"grid gap-6",children:a?e.jsx("div",{children:"Loading opportunities..."}):S.length>0?S.map(O=>e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(q,{children:e.jsxs(L,{className:"text-xl mb-2 flex items-center justify-between",children:[e.jsx("span",{children:O.buyer_name}),e.jsxs(I,{variant:"secondary",children:[e.jsx(Le,{className:"mr-2 h-4 w-4"}),O.destination_country]})]})}),e.jsxs(_,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx(dt,{className:"mr-2 h-4 w-4 inline-block"}),"Crop: ",O.crop_type]}),e.jsxs("div",{children:[e.jsx(Oc,{className:"mr-2 h-4 w-4 inline-block"}),"Quantity: ",O.quantity_tons," tons"]}),e.jsxs("div",{children:["Price: KES ",O.price_per_ton,"/ton"]}),e.jsxs("div",{children:["Min Order: ",O.min_order_quantity," tons"]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"font-semibold",children:"Requirements:"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:O.required_certifications.map(te=>e.jsx(I,{variant:"outline",children:te},te))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{onClick:()=>{u(O),P(O.id),R(O.id),M(O.crop_type,O.id)},children:"View Details"}),e.jsx(b,{variant:"outline",children:"Express Interest"}),e.jsx(b,{variant:"outline",children:"Form Consolidation"})]})]})]},O.id)):e.jsx("div",{children:"No export opportunities found."})}),g&&e.jsxs(w,{className:"mb-6",children:[e.jsx(q,{children:e.jsx(L,{children:"Order Timeline"})}),e.jsxs(_,{children:[e.jsx("ul",{className:"timeline-list",children:d.map(O=>e.jsxs("li",{className:"mb-2",children:[e.jsx("span",{className:"font-semibold",children:O.event_type}),": ",O.event_description," ",e.jsxs("span",{className:"text-muted-foreground",children:["(",new Date(O.event_time).toLocaleString(),")"]})]},O.id))}),((N==null?void 0:N.id)===g.created_by||(N==null?void 0:N.role)==="admin")&&e.jsx(b,{variant:"destructive",onClick:()=>E(g.id),children:"Delete Order"}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Export Documentation Checklist"}),e.jsx("ul",{children:v.map(O=>e.jsxs("li",{className:"mb-1",children:[O.document_type," - ",O.status,O.file_url?e.jsx("a",{href:O.file_url,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-blue-600 underline",children:"View"}):e.jsx("span",{className:"ml-2 text-red-600",children:"Not uploaded"})]},O.id))})]}),m&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Price Comparison"}),e.jsxs("div",{children:["Domestic: KES ",m.domestic_price," | Export: KES ",m.export_price]})]})]})]})]})})},rh=()=>{const{user:s}=je(),{toast:t}=Z(),[a,r]=i.useState([]),[n,c]=i.useState(!0),[l,x]=i.useState(""),[f,j]=i.useState("all"),[N,g]=i.useState("all"),[u,d]=i.useState(!1),[h,v]=i.useState({title:"",description:"",crops_involved:"",counties:"",requirements:"",benefits:"",contact_info:"",application_deadline:"",start_date:"",duration_months:"",minimum_quantity:"",price_range:"",max_participants:""});i.useEffect(()=>{p()},[]);async function p(){c(!0);try{const S=await wn({linkage_type:"export_opportunity",activeOnly:!0});r(S||[])}catch(S){console.error("Error fetching export opportunities:",S),t({title:"Error",description:"Failed to load export opportunities",variant:"destructive"})}finally{c(!1)}}const m=Array.from(new Set(a.flatMap(S=>S.crops_involved||[]))),o=Array.from(new Set(a.flatMap(S=>S.counties||[]))),y=a.filter(S=>{const E=S.title.toLowerCase().includes(l.toLowerCase())||S.description.toLowerCase().includes(l.toLowerCase()),P=f==="all"||S.crops_involved&&S.crops_involved.includes(f),R=N==="all"||S.counties&&S.counties.includes(N);return E&&P&&R}),k=async()=>{if(!s){t({title:"Authentication Required",description:"Please sign in to create export opportunities",variant:"destructive"});return}try{await bn({title:h.title,description:h.description,linkage_type:"export_opportunity",crops_involved:h.crops_involved.split(",").map(S=>S.trim()),counties:h.counties.split(",").map(S=>S.trim()),requirements:h.requirements.split(",").map(S=>S.trim()),benefits:h.benefits.split(",").map(S=>S.trim()),contact_info:h.contact_info,application_deadline:h.application_deadline||void 0,start_date:h.start_date||void 0,duration_months:h.duration_months?parseInt(h.duration_months):void 0,minimum_quantity:h.minimum_quantity?parseFloat(h.minimum_quantity):void 0,price_range:h.price_range||void 0,max_participants:h.max_participants?parseInt(h.max_participants):void 0}),t({title:"Success",description:"Export opportunity created successfully"}),d(!1),v({title:"",description:"",crops_involved:"",counties:"",requirements:"",benefits:"",contact_info:"",application_deadline:"",start_date:"",duration_months:"",minimum_quantity:"",price_range:"",max_participants:""}),p()}catch{t({title:"Error",description:"Failed to create export opportunity",variant:"destructive"})}},A=async S=>{if(!s){t({title:"Authentication Required",description:"Please sign in to apply",variant:"destructive"});return}try{await ad(S),t({title:"Success",description:"Application submitted successfully"}),p()}catch{t({title:"Error",description:"Failed to submit application",variant:"destructive"})}};return e.jsx(er,{title:"Export Opportunities",children:e.jsxs("div",{className:"container mx-auto px-4 py-6 max-w-7xl pb-24",children:[e.jsxs(w,{className:"mb-6 border-primary/20 bg-gradient-to-br from-primary/5 to-primary/10",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Le,{className:"h-6 w-6 text-primary mt-1"}),e.jsxs("div",{children:[e.jsx(L,{className:"text-2xl",children:"Export Market Opportunities"}),e.jsx(G,{className:"mt-2 text-base",children:"Connect with international buyers and grow your export business"})]})]})}),e.jsxs(_,{children:[e.jsx("p",{className:"text-muted-foreground leading-relaxed mb-4",children:"Access verified export opportunities from international markets. Get fair prices, technical support, and quality certification assistance to meet global standards."}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-background rounded-lg p-4 border",children:[e.jsx(Le,{className:"h-8 w-8 text-primary mb-2"}),e.jsx("h4",{className:"font-semibold mb-1",children:"Global Markets"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Access to EU, US, Asian markets"})]}),e.jsxs("div",{className:"bg-background rounded-lg p-4 border",children:[e.jsx(ce,{className:"h-8 w-8 text-primary mb-2"}),e.jsx("h4",{className:"font-semibold mb-1",children:"Premium Prices"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Higher returns for quality produce"})]}),e.jsxs("div",{className:"bg-background rounded-lg p-4 border",children:[e.jsx(se,{className:"h-8 w-8 text-primary mb-2"}),e.jsx("h4",{className:"font-semibold mb-1",children:"Full Support"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Training, certification, logistics help"})]})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-4 mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx(D,{placeholder:"Search opportunities...",value:l,onChange:S=>x(S.target.value),className:"sm:w-64"}),e.jsxs(Q,{value:f,onValueChange:j,children:[e.jsx(W,{className:"w-full sm:w-48",children:e.jsx(J,{placeholder:"All Crops"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Crops"}),m.map(S=>e.jsx(T,{value:S,children:S},S))]})]}),e.jsxs(Q,{value:N,onValueChange:g,children:[e.jsx(W,{className:"w-full sm:w-48",children:e.jsx(J,{placeholder:"All Counties"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Counties"}),o.map(S=>e.jsx(T,{value:S,children:S},S))]})]})]}),e.jsxs(_e,{open:u,onOpenChange:d,children:[e.jsx(Ie,{asChild:!0,children:e.jsxs(b,{className:"w-full sm:w-auto",children:[e.jsx(Le,{className:"mr-2 h-4 w-4"}),"Post Export Opportunity"]})}),e.jsxs(we,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Ce,{children:e.jsx(ke,{children:"Create Export Opportunity"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"title",children:"Title *"}),e.jsx(D,{id:"title",value:h.title,onChange:S=>v({...h,title:S.target.value}),placeholder:"e.g., Avocado Export to Europe"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"description",children:"Description *"}),e.jsx(le,{id:"description",value:h.description,onChange:S=>v({...h,description:S.target.value}),placeholder:"Describe the export opportunity...",rows:4})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"crops",children:"Crops (comma separated) *"}),e.jsx(D,{id:"crops",value:h.crops_involved,onChange:S=>v({...h,crops_involved:S.target.value}),placeholder:"Avocado, Mango, Pineapple"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"counties",children:"Counties (comma separated) *"}),e.jsx(D,{id:"counties",value:h.counties,onChange:S=>v({...h,counties:S.target.value}),placeholder:"Murang'a, Kiambu, Nairobi"})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"requirements",children:"Requirements (comma separated) *"}),e.jsx(D,{id:"requirements",value:h.requirements,onChange:S=>v({...h,requirements:S.target.value}),placeholder:"GlobalGAP, Organic certification"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"benefits",children:"Benefits (comma separated) *"}),e.jsx(D,{id:"benefits",value:h.benefits,onChange:S=>v({...h,benefits:S.target.value}),placeholder:"Premium prices, Training, Logistics support"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"minQuantity",children:"Minimum Quantity (kg)"}),e.jsx(D,{id:"minQuantity",type:"number",value:h.minimum_quantity,onChange:S=>v({...h,minimum_quantity:S.target.value}),placeholder:"1000"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"priceRange",children:"Price Range (KES)"}),e.jsx(D,{id:"priceRange",value:h.price_range,onChange:S=>v({...h,price_range:S.target.value}),placeholder:"80-120 per kg"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"duration",children:"Duration (months)"}),e.jsx(D,{id:"duration",type:"number",value:h.duration_months,onChange:S=>v({...h,duration_months:S.target.value}),placeholder:"12"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"maxParticipants",children:"Max Participants"}),e.jsx(D,{id:"maxParticipants",type:"number",value:h.max_participants,onChange:S=>v({...h,max_participants:S.target.value}),placeholder:"50"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"startDate",children:"Start Date"}),e.jsx(D,{id:"startDate",type:"date",value:h.start_date,onChange:S=>v({...h,start_date:S.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"deadline",children:"Application Deadline"}),e.jsx(D,{id:"deadline",type:"date",value:h.application_deadline,onChange:S=>v({...h,application_deadline:S.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"contact",children:"Contact Information *"}),e.jsx(D,{id:"contact",value:h.contact_info,onChange:S=>v({...h,contact_info:S.target.value}),placeholder:"Email and phone number"})]})]}),e.jsx(Ze,{children:e.jsx(b,{onClick:k,className:"w-full",children:"Create Opportunity"})})]})]})]}),e.jsx("div",{className:"grid gap-6",children:n?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"Loading opportunities..."})]}):y.length>0?y.map(S=>{var E,P,R,M;return e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-start justify-between flex-wrap gap-2",children:[e.jsx(L,{className:"text-xl",children:S.title}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[S.application_deadline&&e.jsxs(I,{variant:"outline",children:[e.jsx(xe,{className:"mr-1 h-3 w-3"}),"Deadline: ",new Date(S.application_deadline).toLocaleDateString()]}),e.jsxs(I,{variant:"default",children:[S.participants_count||0," / ",S.max_participants||"âˆž"," Applied"]})]})]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsx("p",{className:"text-muted-foreground",children:S.description}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(re,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:"Crops:"}),e.jsx("span",{className:"text-muted-foreground",children:(E=S.crops_involved)==null?void 0:E.join(", ")})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:"Counties:"}),e.jsx("span",{className:"text-muted-foreground",children:(P=S.counties)==null?void 0:P.join(", ")})]}),S.price_range&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ce,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:"Price Range:"}),e.jsxs("span",{className:"text-muted-foreground",children:["KES ",S.price_range]})]})]}),e.jsxs("div",{className:"space-y-2",children:[S.minimum_quantity&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(re,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:"Min Quantity:"}),e.jsxs("span",{className:"text-muted-foreground",children:[S.minimum_quantity," kg"]})]}),S.duration_months&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(xe,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:"Duration:"}),e.jsxs("span",{className:"text-muted-foreground",children:[S.duration_months," months"]})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 pt-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2 text-sm",children:"Requirements"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:(R=S.requirements)==null?void 0:R.map((O,te)=>e.jsx(I,{variant:"outline",className:"text-xs",children:O},te))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2 text-sm",children:"Benefits"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:(M=S.benefits)==null?void 0:M.map((O,te)=>e.jsx(I,{variant:"secondary",className:"text-xs",children:O},te))})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(b,{onClick:()=>A(S.id),className:"flex-1",disabled:S.max_participants&&S.participants_count>=S.max_participants,children:S.max_participants&&S.participants_count>=S.max_participants?"Closed":"Apply Now"}),e.jsx(b,{variant:"outline",children:"Contact"})]})]})]},S.id)}):e.jsx(w,{children:e.jsxs(_,{className:"text-center py-12",children:[e.jsx(Le,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground mb-2",children:"No export opportunities found"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:l||f!=="all"||N!=="all"?"Try adjusting your filters":"Be the first to post an opportunity!"})]})})})]})})},ih=()=>{const[s,t]=i.useState([]),[a,r]=i.useState(!0),[n,c]=i.useState(""),[l,x]=i.useState("all"),[f,j]=i.useState("all"),[N,g]=i.useState(!1),{toast:u}=Z(),[d,h]=i.useState({title:"",company_name:"",crop_type:"",contract_duration:"",price_per_unit:"",minimum_area:"",location:"",requirements:"",benefits:"",description:"",application_deadline:""});i.useEffect(()=>{v()},[]);async function v(){r(!0);try{const k=[{id:"1",title:"Premium Avocado Contract",company_name:"Fresh Exports Ltd",crop_type:"Avocado",contract_duration:24,price_per_unit:80,minimum_area:2,location:"Murang'a County",requirements:["GAP Certification","Irrigation system","Minimum 100 trees"],benefits:["Guaranteed market","Technical support","Input supply"],description:"Looking for avocado farmers for export market. Full support provided.",status:"active",created_at:new Date().toISOString(),application_deadline:"2024-12-31"},{id:"2",title:"Organic Coffee Contract",company_name:"Kenya Coffee Coop",crop_type:"Coffee",contract_duration:36,price_per_unit:120,minimum_area:1,location:"Kiambu County",requirements:["Organic certification","Altitude above 1500m"],benefits:["Premium pricing","Training provided","Equipment loans"],description:"Seeking organic coffee farmers for specialty market.",status:"active",created_at:new Date().toISOString(),application_deadline:"2024-11-30"}];t(k)}catch(k){console.error("Error fetching opportunities:",k),u({title:"Error",description:"Failed to load contract farming opportunities",variant:"destructive"})}finally{r(!1)}}const p=Array.from(new Set(s.map(k=>k.crop_type))),m=Array.from(new Set(s.map(k=>k.location))),o=s.filter(k=>{const A=k.title.toLowerCase().includes(n.toLowerCase())||k.company_name.toLowerCase().includes(n.toLowerCase()),S=l==="all"||k.crop_type===l,E=f==="all"||k.location===f;return A&&S&&E}),y=async()=>{try{u({title:"Success",description:"Contract farming opportunity created successfully"}),g(!1),h({title:"",company_name:"",crop_type:"",contract_duration:"",price_per_unit:"",minimum_area:"",location:"",requirements:"",benefits:"",description:"",application_deadline:""})}catch{u({title:"Error",description:"Failed to create opportunity",variant:"destructive"})}};return e.jsxs("div",{className:"min-h-screen pb-20 lg:pb-0",children:[e.jsx(Dn,{title:"Contract Farming"}),e.jsxs("main",{className:"py-6 px-4 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-2",children:"Contract Farming Opportunities"}),e.jsx("p",{className:"text-muted-foreground",children:"Secure farming contracts with guaranteed markets and support"})]}),e.jsxs("div",{className:"flex flex-col gap-4 mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx(D,{placeholder:"Search opportunities...",value:n,onChange:k=>c(k.target.value),className:"sm:w-64"}),e.jsxs(Q,{value:l,onValueChange:x,children:[e.jsx(W,{className:"w-full sm:w-48",children:e.jsx(J,{placeholder:"All Crops"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Crops"}),p.map(k=>e.jsx(T,{value:k,children:k},k))]})]}),e.jsxs(Q,{value:f,onValueChange:j,children:[e.jsx(W,{className:"w-full sm:w-48",children:e.jsx(J,{placeholder:"All Locations"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Locations"}),m.map(k=>e.jsx(T,{value:k,children:k},k))]})]})]}),e.jsxs(_e,{open:N,onOpenChange:g,children:[e.jsx(Ie,{asChild:!0,children:e.jsxs(b,{className:"w-full sm:w-auto",children:[e.jsx(Ds,{className:"mr-2 h-4 w-4"}),"Create Contract Opportunity"]})}),e.jsxs(we,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Ce,{children:e.jsx(ke,{children:"Create Contract Farming Opportunity"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"title",children:"Title"}),e.jsx(D,{id:"title",value:d.title,onChange:k=>h({...d,title:k.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"company",children:"Company Name"}),e.jsx(D,{id:"company",value:d.company_name,onChange:k=>h({...d,company_name:k.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"crop",children:"Crop Type"}),e.jsx(D,{id:"crop",value:d.crop_type,onChange:k=>h({...d,crop_type:k.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"location",children:"Location"}),e.jsx(D,{id:"location",value:d.location,onChange:k=>h({...d,location:k.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"duration",children:"Duration (months)"}),e.jsx(D,{id:"duration",type:"number",value:d.contract_duration,onChange:k=>h({...d,contract_duration:k.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"price",children:"Price per Unit (KES)"}),e.jsx(D,{id:"price",type:"number",value:d.price_per_unit,onChange:k=>h({...d,price_per_unit:k.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"area",children:"Min Area (acres)"}),e.jsx(D,{id:"area",type:"number",value:d.minimum_area,onChange:k=>h({...d,minimum_area:k.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"requirements",children:"Requirements (comma separated)"}),e.jsx(D,{id:"requirements",value:d.requirements,onChange:k=>h({...d,requirements:k.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"benefits",children:"Benefits (comma separated)"}),e.jsx(D,{id:"benefits",value:d.benefits,onChange:k=>h({...d,benefits:k.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"description",children:"Description"}),e.jsx(le,{id:"description",value:d.description,onChange:k=>h({...d,description:k.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"deadline",children:"Application Deadline"}),e.jsx(D,{id:"deadline",type:"date",value:d.application_deadline,onChange:k=>h({...d,application_deadline:k.target.value})})]}),e.jsx(b,{onClick:y,className:"w-full",children:"Create Opportunity"})]})]})]})]}),e.jsx("div",{className:"grid gap-6",children:a?e.jsx("div",{className:"text-center py-12",children:"Loading opportunities..."}):o.length>0?o.map(k=>e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(q,{children:[e.jsxs(L,{className:"flex items-center justify-between",children:[e.jsx("span",{children:k.title}),e.jsxs(I,{variant:"outline",children:[e.jsx(xe,{className:"mr-1 h-3 w-3"}),k.contract_duration," months"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(se,{className:"h-4 w-4"}),k.company_name]})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Crop:"})," ",k.crop_type]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),k.location]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"h-4 w-4"}),"KES ",k.price_per_unit,"/unit"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Min:"})," ",k.minimum_area," acres"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:k.description}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium mb-2 flex items-center gap-2",children:[e.jsx(Ve,{className:"h-4 w-4"}),"Requirements"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:k.requirements.map((A,S)=>e.jsx(I,{variant:"outline",className:"text-xs",children:A},S))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium mb-2 flex items-center gap-2",children:[e.jsx(es,{className:"h-4 w-4"}),"Benefits"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:k.benefits.map((A,S)=>e.jsx(I,{variant:"secondary",className:"text-xs",children:A},S))})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{className:"flex-1",children:"Apply Now"}),e.jsx(b,{variant:"outline",children:"Learn More"})]})]})]},k.id)):e.jsx("div",{className:"text-center py-12",children:"No contract farming opportunities found."})})]}),e.jsx(Tn,{})]})},nh=()=>{const[s,t]=i.useState(null),[a,r]=i.useState(!0);return i.useEffect(()=>{(async()=>{try{const{data:{session:c}}=await F.auth.getSession();if(!c){t(!1),r(!1);return}const{data:l,error:x}=await F.functions.invoke("check-admin-role");x?(console.error("Error checking admin role:",x),t(!1)):t((l==null?void 0:l.isAdmin)||!1)}catch(c){console.error("Failed to check admin role:",c),t(!1)}finally{r(!1)}})()},[]),{isAdmin:s,loading:a}},Zn=async()=>F.from("farm_input_categories").select("*"),lh=async s=>F.from("farm_input_categories").insert([s]),hr=async()=>F.from("farm_input_suppliers").select("*"),ch=async s=>F.from("farm_input_products").insert([s]),oh=async s=>F.from("farm_input_products").select("*"),dh=async s=>F.from("farm_input_orders").select("*"),mh=async(s,t)=>F.from("farm_input_orders").update(t).eq("id",s),uh=async s=>{const{data:{user:t}}=await F.auth.getUser();if(!t)throw new Error("User not authenticated");return F.from("farm_input_product_likes").insert([{user_id:t.id,product_id:s}])},xh=async(s,t,a)=>{const{data:{user:r}}=await F.auth.getUser();if(!r)throw new Error("User not authenticated");return F.from("farm_input_product_ratings").upsert([{user_id:r.id,product_id:s,rating:t,comment:a}])},hh=async s=>{const{data:{user:t}}=await F.auth.getUser();if(!t)throw new Error("User not authenticated");return F.from("farm_input_supplier_likes").insert([{user_id:t.id,supplier_id:s}])},ph=async(s,t,a)=>{const{data:{user:r}}=await F.auth.getUser();if(!r)throw new Error("User not authenticated");return F.from("farm_input_supplier_ratings").upsert([{user_id:r.id,supplier_id:s,rating:t,comment:a}])},gh=async s=>{const{data:{user:t}}=await F.auth.getUser();if(!t)throw new Error("User not authenticated");return F.from("farm_input_product_bookmarks").insert([{user_id:t.id,product_id:s}])},jh=async(s,t,a,r)=>{const{data:{user:n}}=await F.auth.getUser();if(!n)throw new Error("User not authenticated");return F.from("farm_input_entity_flags").insert([{reporter_id:n.id,entity_type:s,entity_id:t,reason:a,description:r}])},fh=async(s,t,a,r)=>{const{data:{user:n}}=await F.auth.getUser();if(!n)throw new Error("User not authenticated");return F.from("farm_input_ban_recommendations").insert([{reporter_id:n.id,entity_type:s,entity_id:t,reason:a,evidence:r}])},vh=()=>{const[s,t]=i.useState([]),[a,r]=i.useState(""),[n,c]=i.useState(""),[l,x]=i.useState(!1),[f,j]=i.useState(""),N=async()=>{x(!0);const{data:u,error:d}=await Zn();d?j(d.message):t(u||[]),x(!1)};i.useEffect(()=>{N()},[]);const g=async u=>{u.preventDefault(),x(!0),j("");const{error:d}=await lh({name:a,description:n});d?j(d.message):(r(""),c(""),N()),x(!1)};return e.jsxs("div",{className:"max-w-xl mx-auto p-4",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Manage Farm Input Categories"}),e.jsxs("form",{onSubmit:g,className:"mb-6",children:[e.jsx("input",{className:"border rounded px-2 py-1 mr-2",placeholder:"Category name",value:a,onChange:u=>r(u.target.value),required:!0}),e.jsx("input",{className:"border rounded px-2 py-1 mr-2",placeholder:"Description (optional)",value:n,onChange:u=>c(u.target.value)}),e.jsx("button",{type:"submit",className:"bg-green-700 text-white px-4 py-1 rounded",disabled:l,children:"Add"})]}),f&&e.jsx("div",{className:"text-red-600 mb-2",children:f}),e.jsx("ul",{className:"divide-y",children:s.map(u=>e.jsxs("li",{className:"py-2",children:[e.jsx("span",{className:"font-semibold",children:u.name})," - ",u.description]},u.id))})]})},yh=()=>{const[s,t]=i.useState([]);i.useState({supplier_name:"",contact_phone:"",contact_email:"",contact_person:"",county:"",physical_address:"",specialization:"",user_id:"",is_active:!0});const[a,r]=i.useState(!1),[n,c]=i.useState(""),[l,x]=i.useState(null),[f,j]=i.useState(null),[N,g]=i.useState(null),[u,d]=i.useState(""),[h,v]=i.useState(""),[p,m]=i.useState(null),[o,y]=i.useState(null),k=async()=>{r(!0);const{data:M,error:O}=await hr();O?c(O.message):t(M||[]),r(!1)};i.useEffect(()=>{k()},[]);const A=async M=>{x(M),await hh(M),await k(),x(null)},S=async(M,O)=>{j(M),await ph(M,O,u),d(""),await k(),j(null)},E=async M=>{m(M),await jh("supplier",M,h),v(""),m(null)},P=async M=>{y(M),await fh("supplier",M,"Recommended for ban"),y(null)},R=async M=>{g(M),await gh(M),g(null)};return e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Supplier Manager"}),n&&e.jsx("div",{className:"text-red-500 mb-4",children:n}),a?e.jsx("div",{children:"Loading suppliers..."}):e.jsx("div",{children:s.map(M=>e.jsxs("div",{className:"border rounded p-4 mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:M.supplier_name}),e.jsxs("div",{className:"text-gray-700",children:[M.contact_person," | ",M.contact_phone," | ",M.contact_email]}),e.jsxs("div",{className:"text-gray-500 text-sm",children:[M.physical_address,", ",M.county]}),e.jsxs("div",{className:"flex flex-col gap-2 mt-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"text-red-600 border rounded px-2 py-1",onClick:()=>A(M.id),disabled:l===M.id,children:"â¤ï¸ Like"}),e.jsx("button",{className:"text-yellow-600 border rounded px-2 py-1",onClick:()=>S(M.id,5),disabled:f===M.id,children:"â­ 5-Star"}),M.products&&M.products.length>0&&e.jsx("button",{className:"text-blue-600 border rounded px-2 py-1",onClick:()=>R(M.products[0].id),disabled:N===M.products[0].id,children:"ðŸ”– Bookmark Product"})]}),e.jsxs("div",{className:"flex gap-2 items-center mt-1",children:[e.jsx("input",{className:"border rounded px-2 py-1",placeholder:"Add a comment to your rating",value:u,onChange:O=>d(O.target.value),style:{minWidth:180}}),e.jsx("button",{className:"text-yellow-700 border rounded px-2 py-1",onClick:()=>S(M.id,5),disabled:f===M.id||!u,children:"Submit Comment"})]}),e.jsxs("div",{className:"flex gap-2 items-center mt-1",children:[e.jsx("input",{className:"border rounded px-2 py-1",placeholder:"Flag reason",value:h,onChange:O=>v(O.target.value),style:{minWidth:180}}),e.jsx("button",{className:"text-orange-700 border rounded px-2 py-1",onClick:()=>E(M.id),disabled:p===M.id||!h,children:"ðŸš© Flag Supplier"}),e.jsx("button",{className:"text-red-800 border rounded px-2 py-1",onClick:()=>P(M.id),disabled:o===M.id,children:"â›” Recommend Ban"})]})]})]},M.id))})]})},Nh=()=>{const[s,t]=i.useState([]),[a,r]=i.useState(null),[n,c]=i.useState(null);i.useState(null);const l=async A=>{r(A),await uh(A),o(),r(null)},x=async(A,S)=>{c(A),await xh(A,S),o(),c(null)},[f,j]=i.useState([]),[N,g]=i.useState([]),[u,d]=i.useState({product_name:"",product_description:"",supplier_id:"",category_id:"",price_per_unit:"",unit_of_measure:"",product_category:"",is_available:!0}),[h,v]=i.useState(!1),[p,m]=i.useState(""),o=async()=>{v(!0);const[{data:A},{data:S},{data:E}]=await Promise.all([oh(),Zn(),hr()]);t(A||[]),j(S||[]),g(E||[]),v(!1)};i.useEffect(()=>{o()},[]);const y=A=>{d({...u,[A.target.name]:A.target.value})},k=async A=>{A.preventDefault(),v(!0),m("");const S={product_name:u.product_name,product_description:u.product_description,supplier_id:u.supplier_id,category_id:u.category_id,price_per_unit:Number(u.price_per_unit),unit_of_measure:u.unit_of_measure,product_category:u.product_category,is_available:u.is_available},{error:E}=await ch(S);E?m(E.message):(d({product_name:"",product_description:"",supplier_id:"",category_id:"",price_per_unit:"",unit_of_measure:"",product_category:"",is_available:!0}),o()),v(!1)};return e.jsxs("div",{className:"max-w-xl mx-auto p-4",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Manage Farm Input Products"}),e.jsxs("form",{onSubmit:k,className:"mb-6",children:[e.jsx("input",{className:"border rounded px-2 py-1 mr-2 mb-2",placeholder:"Product name",name:"product_name",value:u.product_name,onChange:y,required:!0}),e.jsx("input",{className:"border rounded px-2 py-1 mr-2 mb-2",placeholder:"Description",name:"product_description",value:u.product_description,onChange:y}),e.jsxs("select",{className:"border rounded px-2 py-1 mr-2 mb-2",name:"category_id",value:u.category_id,onChange:y,required:!0,children:[e.jsx("option",{value:"",children:"Select Category"}),f.map(A=>e.jsx("option",{value:A.id,children:A.name},A.id))]}),e.jsxs("select",{className:"border rounded px-2 py-1 mr-2 mb-2",name:"supplier_id",value:u.supplier_id,onChange:y,required:!0,children:[e.jsx("option",{value:"",children:"Select Supplier"}),N.map(A=>e.jsx("option",{value:A.id,children:A.supplier_name},A.id))]}),e.jsx("input",{className:"border rounded px-2 py-1 mr-2 mb-2",placeholder:"Price per unit",name:"price_per_unit",type:"number",value:u.price_per_unit,onChange:y,required:!0}),e.jsx("input",{className:"border rounded px-2 py-1 mr-2 mb-2",placeholder:"Unit of measure (e.g. kg, L, pcs)",name:"unit_of_measure",value:u.unit_of_measure,onChange:y,required:!0}),e.jsx("input",{className:"border rounded px-2 py-1 mr-2 mb-2",placeholder:"Product category (e.g. Fertilizer, Seed)",name:"product_category",value:u.product_category,onChange:y,required:!0}),e.jsx("button",{type:"submit",className:"bg-green-700 text-white px-4 py-1 rounded",disabled:h,children:"Add"})]}),p&&e.jsx("div",{className:"text-red-600 mb-2",children:p}),e.jsx("ul",{className:"divide-y",children:s.map(A=>{var S,E;return e.jsxs("li",{className:"py-2 flex flex-col gap-1",children:[e.jsx("span",{className:"font-semibold",children:A.product_name})," - ",A.product_description," | Category: ",(S=A.category)==null?void 0:S.name," | Supplier: ",(E=A.supplier)==null?void 0:E.supplier_name," | Price: ",A.price_per_unit,e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx("button",{className:"text-red-600 border rounded px-2 py-1",onClick:()=>l(A.id),disabled:a===A.id,children:"â¤ï¸ Like"}),e.jsx("button",{className:"text-yellow-600 border rounded px-2 py-1",onClick:()=>x(A.id,5),disabled:n===A.id,children:"â­ 5-Star"})]})]},A.id)})})]})},bh=()=>{const[s,t]=i.useState([]),[a,r]=i.useState([]),[n,c]=i.useState(!1),[l,x]=i.useState(""),f=async()=>{c(!0);const[{data:N},{data:g}]=await Promise.all([dh(),hr()]);t(N||[]),r(g||[]),c(!1)};i.useEffect(()=>{f()},[]);const j=async(N,g)=>{c(!0),x("");const{error:u}=await mh(N,{status:g});u&&x(u.message),f(),c(!1)};return e.jsxs("div",{className:"max-w-xl mx-auto p-4",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Manage Farm Input Orders"}),l&&e.jsx("div",{className:"text-red-600 mb-2",children:l}),e.jsx("ul",{className:"divide-y",children:s.map(N=>{var g;return e.jsxs("li",{className:"py-2",children:[e.jsxs("div",{className:"font-semibold",children:["Order #",N.id]}),e.jsxs("div",{children:["Supplier: ",((g=a.find(u=>u.id===N.supplier_id))==null?void 0:g.supplier_name)||N.supplier_id]}),e.jsxs("div",{children:["Buyer: ",N.buyer_id]}),e.jsxs("div",{children:["Status: ",N.status||"N/A"]}),e.jsxs("div",{children:["Created: ",N.created_at]}),e.jsxs("div",{children:[e.jsx("button",{className:"bg-green-700 text-white px-2 py-1 rounded mr-2",onClick:()=>j(N.id,"approved"),disabled:n,children:"Approve"}),e.jsx("button",{className:"bg-gray-500 text-white px-2 py-1 rounded",onClick:()=>j(N.id,"rejected"),disabled:n,children:"Reject"})]}),e.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:["Items:",e.jsx("ul",{className:"list-disc ml-6",children:(N.items||[]).map(u=>e.jsxs("li",{children:[u.product_id," x ",u.quantity]},u.id))})]})]},N.id)})})]})},wh=()=>{const[s,t]=i.useState([]),[a,r]=i.useState({}),[n,c]=i.useState([]),[l,x]=i.useState(""),[f,j]=i.useState(""),[N,g]=i.useState(!0),{toast:u}=Z();i.useEffect(()=>{d()},[]);const d=async()=>{try{const{data:m}=await F.from("ad_placements").select("*").order("page_route");m&&t(m);const{data:o}=await F.from("business_advertisements").select("id, title, business_name, payment_status, is_active").eq("payment_status","paid").eq("is_active",!0);if(o&&c(o),m){const y={};for(const k of m){const{data:A}=await F.from("ad_slot_assignments").select("*").eq("slot_id",k.id).order("display_order");if(A){const S=await Promise.all(A.map(async E=>{const{data:P}=await F.from("business_advertisements").select("title, business_name").eq("id",E.advertisement_id).single();return{...E,ad_title:(P==null?void 0:P.title)||"Unknown",ad_business:(P==null?void 0:P.business_name)||"Unknown"}}));y[k.id]=S}}r(y)}}catch(m){console.error("Error loading ad placements:",m)}finally{g(!1)}},h=async(m,o)=>{const{error:y}=await F.from("ad_placements").update({is_active:o}).eq("id",m);y?u({title:"Error",description:"Failed to update slot",variant:"destructive"}):(t(k=>k.map(A=>A.id===m?{...A,is_active:o}:A)),u({title:"Updated",description:`Slot ${o?"activated":"deactivated"}`}))},v=async()=>{if(!l||!f)return;const m=a[l]||[],o=s.find(k=>k.id===l);if(o&&m.length>=o.max_ads){u({title:"Slot Full",description:`This slot can hold max ${o.max_ads} ads`,variant:"destructive"});return}const{error:y}=await F.from("ad_slot_assignments").insert({slot_id:l,advertisement_id:f,display_order:m.length,is_active:!0});y?u({title:"Error",description:"Failed to assign ad",variant:"destructive"}):(u({title:"Ad Assigned",description:"Advertisement added to slot"}),j(""),d())},p=async m=>{const{error:o}=await F.from("ad_slot_assignments").delete().eq("id",m);o?u({title:"Error",description:"Failed to remove ad",variant:"destructive"}):(u({title:"Removed",description:"Ad removed from slot"}),d())};return N?e.jsx("div",{className:"animate-pulse p-4",children:"Loading ad placements..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(Kc,{className:"h-6 w-6"}),"Ad Placement Management"]}),e.jsx("p",{className:"text-muted-foreground",children:"Choose where paid business ads appear across the platform"})]})}),e.jsxs(w,{children:[e.jsx(q,{children:e.jsxs(L,{className:"text-lg flex items-center gap-2",children:[e.jsx(ie,{className:"h-5 w-5"}),"Assign Ad to Slot"]})}),e.jsx(_,{children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs(Q,{value:l,onValueChange:x,children:[e.jsx(W,{className:"flex-1",children:e.jsx(J,{placeholder:"Choose ad slot..."})}),e.jsx(Y,{children:s.map(m=>e.jsxs(T,{value:m.id,children:[m.slot_label," (",m.page_route,")"]},m.id))})]}),e.jsxs(Q,{value:f,onValueChange:j,children:[e.jsx(W,{className:"flex-1",children:e.jsx(J,{placeholder:"Choose advertisement..."})}),e.jsx(Y,{children:n.map(m=>e.jsxs(T,{value:m.id,children:[m.title," - ",m.business_name]},m.id))})]}),e.jsxs(b,{onClick:v,disabled:!l||!f,children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Assign"]})]})})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:s.map(m=>e.jsxs(w,{className:m.is_active?"":"opacity-60",children:[e.jsx(q,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(L,{className:"text-base flex items-center gap-2",children:[e.jsx(Xs,{className:"h-4 w-4 text-primary"}),m.slot_label]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Route: ",m.page_route," â€¢ Position: ",m.position," â€¢ Max: ",m.max_ads]})]}),e.jsx(ur,{checked:m.is_active,onCheckedChange:o=>h(m.id,o)})]})}),e.jsx(_,{children:e.jsx("div",{className:"space-y-2",children:(a[m.id]||[]).length===0?e.jsx("p",{className:"text-sm text-muted-foreground italic",children:"No ads assigned"}):(a[m.id]||[]).map(o=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted/50 rounded-md",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Gi,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:o.ad_title}),e.jsx("p",{className:"text-xs text-muted-foreground",children:o.ad_business})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{variant:o.is_active?"default":"secondary",className:"text-xs",children:o.is_active?"Active":"Paused"}),e.jsx(b,{size:"icon",variant:"ghost",className:"h-7 w-7",onClick:()=>p(o.id),children:e.jsx(at,{className:"h-3.5 w-3.5 text-destructive"})})]})]},o.id))})})]},m.id))})]})},_h=()=>{const{isAdmin:s,loading:t}=nh();return t?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-background",children:e.jsx(As,{className:"h-8 w-8 animate-spin text-primary"})}):s?e.jsxs("div",{className:"max-w-6xl mx-auto p-4",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Admin Panel"}),e.jsxs(ge,{defaultValue:"farm-inputs",className:"w-full",children:[e.jsxs(pe,{className:"mb-6 flex-wrap h-auto gap-1",children:[e.jsx(B,{value:"farm-inputs",children:"Farm Inputs"}),e.jsx(B,{value:"ad-placements",children:"Ad Placements"})]}),e.jsx(V,{value:"farm-inputs",children:e.jsxs("div",{className:"space-y-8",children:[e.jsx(vh,{}),e.jsx(yh,{}),e.jsx(Nh,{}),e.jsx(bh,{})]})}),e.jsx(V,{value:"ad-placements",children:e.jsx(wh,{})})]})]}):e.jsx(Bc,{to:"/",replace:!0})},Ch=()=>{const s=Es();return i.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",s.pathname)},[s.pathname]),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center p-6",children:[e.jsx("h1",{className:"text-6xl font-bold mb-4 text-gray-800",children:"404"}),e.jsx("p",{className:"text-xl text-gray-600 mb-6",children:"Oops! Page not found"}),e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsx("p",{className:"text-gray-500 mb-6",children:"The page you're looking for doesn't exist or may have been moved."}),e.jsx(X,{to:"/",className:"text-blue-500 hover:text-blue-700 underline block mb-4",children:"Return to Home"}),e.jsxs("div",{className:"border-t border-gray-200 pt-6 mt-6",children:[e.jsx("h2",{className:"text-lg font-medium mb-4",children:"You might be interested in:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(X,{to:"/sentiment-analysis",children:e.jsx(b,{variant:"outline",className:"w-full",children:"Sentiment Analysis"})}),e.jsx(X,{to:"/market-demand-hotspot",children:e.jsx(b,{variant:"outline",className:"w-full",children:"Market Demand Hotspots"})}),e.jsx(X,{to:"/farmer-success-stories",children:e.jsx(b,{variant:"outline",className:"w-full",children:"Farmer Success Stories"})}),e.jsx(X,{to:"/commodity-trading",children:e.jsx(b,{variant:"outline",className:"w-full",children:"Commodity Trading"})})]})]})]})]})})},kh=()=>{const{pathname:s}=Es();return i.useEffect(()=>{window.scrollTo(0,0)},[s]),null},el=()=>{const[s,t]=i.useState(!1);i.useEffect(()=>{const r=()=>{window.pageYOffset>300?t(!0):t(!1)};return window.addEventListener("scroll",r),()=>window.removeEventListener("scroll",r)},[]);const a=()=>{window.scrollTo({top:0,behavior:"smooth"})};return s?e.jsx(b,{onClick:a,size:"icon",className:"fixed bottom-24 md:bottom-8 right-4 z-[60] rounded-full shadow-lg bg-primary hover:bg-primary/90 h-10 w-10","aria-label":"Scroll to top",children:e.jsx(Fi,{className:"h-5 w-5"})}):null};class Sh{constructor(){Fe(this,"isInitialized",!1);Fe(this,"connectedDevices",new Map);Fe(this,"messageQueue",[]);Fe(this,"messageHandlers",[]);Fe(this,"SERVICE_UUID","12345678-1234-1234-1234-123456789abc");Fe(this,"MESSAGE_CHARACTERISTIC_UUID","87654321-4321-4321-4321-cba987654321");Fe(this,"DEVICE_INFO_CHARACTERISTIC_UUID","11111111-2222-3333-4444-555555555555")}async initialize(){if(!Uc.isNativePlatform())return console.warn("Bluetooth messaging is only available on mobile devices"),!1;try{return await Hs.initialize(),this.isInitialized=!0,await this.startAdvertising(),await this.startScanning(),console.log("Bluetooth mesh messaging initialized"),!0}catch(t){return console.error("Failed to initialize Bluetooth mesh messaging:",t),!1}}async startAdvertising(){console.log("Starting BLE advertising for mesh messaging")}async startScanning(){try{await Hs.requestLEScan({services:[this.SERVICE_UUID]},t=>{this.handleDeviceDiscovered(t.device)}),setTimeout(()=>{Hs.stopLEScan(),setTimeout(()=>this.startScanning(),5e3)},3e4)}catch(t){console.error("Error starting BLE scan:",t)}}async handleDeviceDiscovered(t){this.connectedDevices.has(t.deviceId)||(console.log("Discovered device:",t.name||t.deviceId),await this.connectToDevice(t))}async connectToDevice(t){try{await Hs.connect(t.deviceId),this.connectedDevices.set(t.deviceId,t),console.log("Connected to device:",t.name||t.deviceId),await Hs.startNotifications(t.deviceId,this.SERVICE_UUID,this.MESSAGE_CHARACTERISTIC_UUID,a=>{this.handleReceivedMessage(a)}),await this.processMessageQueue()}catch(a){console.error("Failed to connect to device:",a)}}handleReceivedMessage(t){try{const a=Vc(t),r=String.fromCharCode(...a),n=JSON.parse(r);console.log("Received message:",n),this.messageHandlers.forEach(c=>c(n)),this.forwardMessage(n)}catch(a){console.error("Error processing received message:",a)}}async forwardMessage(t){`${t.sender}${t.timestamp}`;for(const[a,r]of this.connectedDevices)a!==t.sender&&await this.sendMessageToDevice(r,t)}async sendMessage(t,a){const r={id:`${Date.now()}-${Math.random()}`,content:t,timestamp:Date.now(),sender:await this.getDeviceId(),recipient:a,encrypted:!1};if(a){const n=Array.from(this.connectedDevices.values()).find(c=>c.deviceId===a);return n?await this.sendMessageToDevice(n,r):(this.messageQueue.push(r),console.log("Recipient not connected, message queued"),!1)}else{let n=!0;for(const c of this.connectedDevices.values()){const l=await this.sendMessageToDevice(c,r);n=n&&l}return n}}async sendMessageToDevice(t,a){try{const r=JSON.stringify(a),n=Array.from(r).map(l=>l.charCodeAt(0)),c=$c(n);return await Hs.writeWithoutResponse(t.deviceId,this.SERVICE_UUID,this.MESSAGE_CHARACTERISTIC_UUID,c),console.log("Message sent to device:",t.name||t.deviceId),!0}catch(r){return console.error("Failed to send message to device:",r),!1}}async processMessageQueue(){const t=[];for(const a of this.messageQueue)if(a.recipient){const r=Array.from(this.connectedDevices.values()).find(n=>n.deviceId===a.recipient);r&&(await this.sendMessageToDevice(r,a),t.push(a))}this.messageQueue=this.messageQueue.filter(a=>!t.includes(a))}onMessage(t){this.messageHandlers.push(t)}removeMessageHandler(t){const a=this.messageHandlers.indexOf(t);a>-1&&this.messageHandlers.splice(a,1)}getConnectedDevices(){return Array.from(this.connectedDevices.values()).map(t=>({id:t.deviceId,name:t.name||"Unknown Device",rssi:0,lastSeen:Date.now()}))}async getDeviceId(){return"device-"+Math.random().toString(36).substr(2,9)}async disconnect(){for(const t of this.connectedDevices.keys())try{await Hs.disconnect(t)}catch(a){console.error("Error disconnecting from device:",a)}this.connectedDevices.clear(),this.isInitialized=!1}}const Wt=new Sh;class Ph{constructor(){Fe(this,"prices",new Map);Fe(this,"alerts",new Map);Fe(this,"traders",new Map);Fe(this,"priceListeners",[]);Fe(this,"alertListeners",[]);Fe(this,"traderListeners",[]);Fe(this,"isInitialized",!1)}async initialize(){return this.isInitialized?!0:await Wt.initialize()?(Wt.onMessage(this.handleMarketplaceMessage.bind(this)),this.startPeriodicDiscovery(),this.startPeriodicDataShare(),this.isInitialized=!0,console.log("Bluetooth Marketplace initialized"),!0):!1}async broadcastPrice(t){const a={...t,id:`price-${Date.now()}-${Math.random()}`,timestamp:Date.now()};this.prices.set(a.id,a),await this.broadcastMessage("price_update",a),this.notifyPriceListeners()}async requestPrices(t,a){const r={type:"price_request",commodity:t,location:a,timestamp:Date.now(),requester_id:await this.getDeviceId()};await this.broadcastMessage("price_request",r)}getPricesNearby(t,a){return Array.from(this.prices.values()).filter(n=>t&&!n.commodity.toLowerCase().includes(t.toLowerCase())||a&&!n.location.toLowerCase().includes(a.toLowerCase())&&!n.county.toLowerCase().includes(a.toLowerCase())?!1:Date.now()-n.timestamp<24*60*60*1e3).sort((n,c)=>c.timestamp-n.timestamp)}async broadcastAlert(t){const a={...t,id:`alert-${Date.now()}-${Math.random()}`,timestamp:Date.now()};this.alerts.set(a.id,a),await this.broadcastMessage("marketplace_alert",a),this.notifyAlertListeners()}getAlertsNearby(t,a){return Array.from(this.alerts.values()).filter(n=>t&&!n.commodity.toLowerCase().includes(t.toLowerCase())||a&&!n.location.toLowerCase().includes(a.toLowerCase())&&!n.county.toLowerCase().includes(a.toLowerCase())?!1:Date.now()-n.timestamp<6*60*60*1e3).sort((n,c)=>c.timestamp-n.timestamp)}async announceTrader(t){const a={...t,id:`trader-${Date.now()}-${Math.random()}`,last_seen:Date.now(),device_id:await this.getDeviceId()};this.traders.set(a.device_id,a),await this.broadcastMessage("trader_announcement",a),this.notifyTraderListeners()}findTraders(t,a,r){return Array.from(this.traders.values()).filter(c=>t&&c.type!==t||a&&!c.commodities.some(l=>l.toLowerCase().includes(a.toLowerCase()))||r&&!c.location.toLowerCase().includes(r.toLowerCase())&&!c.county.toLowerCase().includes(r.toLowerCase())?!1:Date.now()-c.last_seen<30*60*1e3).sort((c,l)=>l.last_seen-c.last_seen)}async broadcastMessage(t,a){const r={type:"marketplace",subtype:t,data:a,timestamp:Date.now(),sender:await this.getDeviceId()};await Wt.sendMessage(JSON.stringify(r))}handleMarketplaceMessage(t){try{const a=JSON.parse(t.content);if(a.type!=="marketplace")return;switch(a.subtype){case"price_update":this.handlePriceUpdate(a.data);break;case"price_request":this.handlePriceRequest(a.data);break;case"marketplace_alert":this.handleMarketplaceAlert(a.data);break;case"trader_announcement":this.handleTraderAnnouncement(a.data);break}}catch(a){console.error("Error processing marketplace message:",a)}}handlePriceUpdate(t){this.validatePriceData(t)&&(this.prices.set(t.id,t),this.notifyPriceListeners())}async handlePriceRequest(t){const a=this.getPricesNearby(t.commodity,t.location);if(a.length>0)for(const r of a.slice(0,5))await this.broadcastMessage("price_update",r)}handleMarketplaceAlert(t){this.validateAlertData(t)&&(this.alerts.set(t.id,t),this.notifyAlertListeners())}handleTraderAnnouncement(t){this.validateTraderData(t)&&(this.traders.set(t.device_id,t),this.notifyTraderListeners())}startPeriodicDiscovery(){setInterval(async()=>{const t=await this.getUserTraderProfile();t&&await this.announceTrader(t)},5*60*1e3)}startPeriodicDataShare(){setInterval(async()=>{const t=Array.from(this.prices.values()).filter(a=>Date.now()-a.timestamp<36e5).slice(0,3);for(const a of t)await this.broadcastMessage("price_update",a)},10*60*1e3)}validatePriceData(t){return!!(t.commodity&&t.price>0&&t.unit&&t.location)}validateAlertData(t){return!!(t.commodity&&t.message&&t.location&&t.type)}validateTraderData(t){var a;return!!(t.name&&t.type&&t.location&&((a=t.commodities)!=null&&a.length))}onPricesUpdate(t){this.priceListeners.push(t)}onAlertsUpdate(t){this.alertListeners.push(t)}onTradersUpdate(t){this.traderListeners.push(t)}notifyPriceListeners(){const t=Array.from(this.prices.values());this.priceListeners.forEach(a=>a(t))}notifyAlertListeners(){const t=Array.from(this.alerts.values());this.alertListeners.forEach(a=>a(t))}notifyTraderListeners(){const t=Array.from(this.traders.values());this.traderListeners.forEach(a=>a(t))}async getDeviceId(){return"device-"+Math.random().toString(36).substr(2,9)}async getUserTraderProfile(){return{name:"John Farmer",type:"seller",location:"Nakuru",county:"Nakuru",commodities:["maize","beans","potatoes"],contact:"+254700000000",rating:4.5}}async disconnect(){await Wt.disconnect(),this.prices.clear(),this.alerts.clear(),this.traders.clear(),this.isInitialized=!1}}const Ks=new Ph;function Ah(){const[s,t]=i.useState(!1),[a,r]=i.useState([]),[n,c]=i.useState([]),[l,x]=i.useState([]),[f,j]=i.useState(""),[N,g]=i.useState(!1);i.useEffect(()=>(u(),()=>{Ks.disconnect()}),[]);const u=async()=>{g(!0);try{const y=await Ks.initialize();t(y),y?(Ks.onPricesUpdate(r),Ks.onAlertsUpdate(c),Ks.onTradersUpdate(x),Te.success("Bluetooth marketplace connected!")):Te.error("Failed to connect to Bluetooth marketplace")}catch(y){console.error("Bluetooth initialization error:",y),Te.error("Bluetooth not available on this device")}finally{g(!1)}},d=async y=>{s&&(await Ks.requestPrices(y),Te.info(`Requesting ${y} prices from nearby farmers...`))},h=async()=>{s&&(await Ks.broadcastPrice({commodity:"Maize",price:45,unit:"kg",location:"Nakuru Market",county:"Nakuru",market:"Nakuru Municipal Market",source:"user",quality:"Grade 1",contact:"+254700000000"}),Te.success("Price shared with nearby devices!"))},v=async()=>{s&&(await Ks.broadcastAlert({type:"high_demand",commodity:"Beans",location:"Nakuru",county:"Nakuru",message:"High demand for quality beans - good prices available!",user_id:"user123",contact:"+254700000000"}),Te.success("Alert sent to nearby traders!"))},p=a.filter(y=>y.commodity.toLowerCase().includes(f.toLowerCase())||y.location.toLowerCase().includes(f.toLowerCase())),m=n.filter(y=>y.commodity.toLowerCase().includes(f.toLowerCase())||y.location.toLowerCase().includes(f.toLowerCase())),o=l.filter(y=>y.name.toLowerCase().includes(f.toLowerCase())||y.commodities.some(k=>k.toLowerCase().includes(f.toLowerCase()))||y.location.toLowerCase().includes(f.toLowerCase()));return e.jsxs("div",{className:"container mx-auto p-4 space-y-6",children:[e.jsx(w,{className:"border-yellow-500/50 bg-yellow-50 dark:bg-yellow-900/20",children:e.jsx(_,{className:"pt-6",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(Se,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-500 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-yellow-900 dark:text-yellow-100 mb-1",children:"âš ï¸ Beta Feature - Development in Progress"}),e.jsxs("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:["The Bluetooth offline marketplace requires a ",e.jsx("strong",{children:"physical Android or iOS device"})," to function. This feature is currently in active development and ",e.jsx("strong",{children:"not production-ready"}),". Some features may not work as expected. Bluetooth communication is not yet encrypted."]})]})]})})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Bluetooth Marketplace"}),e.jsx("p",{className:"text-muted-foreground",children:"Discover prices, find traders, and share alerts offline via Bluetooth"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s?e.jsx(Gc,{className:"h-6 w-6 text-blue-500"}):e.jsx(Mt,{className:"h-6 w-6 text-gray-400"}),e.jsx(I,{variant:s?"default":"secondary",children:s?"Connected":"Disconnected"})]})]}),!s&&e.jsx(w,{className:"border-yellow-200 bg-yellow-50",children:e.jsxs(_,{className:"flex items-center gap-3 pt-6",children:[e.jsx(Hc,{className:"h-5 w-5 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-yellow-800",children:"Bluetooth marketplace offline"}),e.jsx("p",{className:"text-sm text-yellow-600",children:"Enable Bluetooth to discover nearby farmers, prices, and trading opportunities"})]}),e.jsx(b,{onClick:u,disabled:N,className:"ml-auto",children:N?"Connecting...":"Connect"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(w,{children:e.jsxs(_,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-2xl font-bold",children:a.length})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Live Prices Nearby"})]})}),e.jsx(w,{children:e.jsxs(_,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-4 w-4 text-orange-500"}),e.jsx("span",{className:"text-2xl font-bold",children:n.length})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Active Alerts"})]})}),e.jsx(w,{children:e.jsxs(_,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{className:"text-2xl font-bold",children:l.length})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Traders Online"})]})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{placeholder:"Search commodities, locations, or traders...",value:f,onChange:y=>j(y.target.value),className:"flex-1"}),e.jsx(b,{onClick:h,disabled:!s,children:"Share Price"}),e.jsx(b,{onClick:v,disabled:!s,variant:"outline",children:"Send Alert"})]}),e.jsxs(ge,{defaultValue:"prices",className:"w-full",children:[e.jsxs(pe,{className:"grid w-full grid-cols-3",children:[e.jsxs(B,{value:"prices",children:["Live Prices (",a.length,")"]}),e.jsxs(B,{value:"alerts",children:["Alerts (",n.length,")"]}),e.jsxs(B,{value:"traders",children:["Traders (",l.length,")"]})]}),e.jsxs(V,{value:"prices",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Commodity Prices Nearby"}),e.jsx(b,{size:"sm",onClick:()=>d(f||"maize"),disabled:!s,children:"Request Latest Prices"})]}),e.jsx(ut,{className:"h-96",children:e.jsx("div",{className:"space-y-3",children:p.length===0?e.jsx(w,{children:e.jsxs(_,{className:"pt-6 text-center",children:[e.jsx(ce,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-muted-foreground",children:"No prices available. Connect to Bluetooth to discover nearby prices."})]})}):p.map(y=>e.jsx(w,{children:e.jsx(_,{className:"pt-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-lg",children:y.commodity}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["KES ",y.price,"/",y.unit]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground mt-1",children:[e.jsx(ee,{className:"h-3 w-3"}),y.market,", ",y.location]}),y.quality&&e.jsx(I,{variant:"secondary",className:"mt-1",children:y.quality})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(I,{variant:y.source==="verified"?"default":"secondary",children:y.source}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:new Date(y.timestamp).toLocaleTimeString()}),y.contact&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-blue-600 mt-1",children:[e.jsx(Ee,{className:"h-3 w-3"}),"Contact available"]})]})]})})},y.id))})})]}),e.jsxs(V,{value:"alerts",className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Market Alerts"}),e.jsx(ut,{className:"h-96",children:e.jsx("div",{className:"space-y-3",children:m.length===0?e.jsx(w,{children:e.jsxs(_,{className:"pt-6 text-center",children:[e.jsx(Se,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-muted-foreground",children:"No active alerts. Connect to Bluetooth to receive market alerts."})]})}):m.map(y=>e.jsx(w,{children:e.jsx(_,{className:"pt-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:"flex-shrink-0",children:[y.type==="high_demand"&&e.jsx(ce,{className:"h-5 w-5 text-green-500"}),y.type==="price_drop"&&e.jsx(Fs,{className:"h-5 w-5 text-red-500"}),y.type==="price_rise"&&e.jsx(ce,{className:"h-5 w-5 text-green-500"}),y.type==="buyer_request"&&e.jsx(se,{className:"h-5 w-5 text-blue-500"}),y.type==="seller_offer"&&e.jsx(se,{className:"h-5 w-5 text-purple-500"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-semibold",children:y.commodity}),e.jsx(I,{variant:"outline",className:"text-xs",children:y.type.replace("_"," ")})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:y.message}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground mt-2",children:[e.jsx(ee,{className:"h-3 w-3"}),y.location,", ",y.county]})]}),e.jsx("div",{className:"text-right text-xs text-muted-foreground",children:new Date(y.timestamp).toLocaleTimeString()})]})})},y.id))})})]}),e.jsxs(V,{value:"traders",className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Active Traders Nearby"}),e.jsx(ut,{className:"h-96",children:e.jsx("div",{className:"space-y-3",children:o.length===0?e.jsx(w,{children:e.jsxs(_,{className:"pt-6 text-center",children:[e.jsx(se,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-muted-foreground",children:"No traders found nearby. Connect to Bluetooth to discover traders."})]})}):o.map(y=>e.jsx(w,{children:e.jsx(_,{className:"pt-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-semibold",children:y.name}),e.jsx(I,{variant:"outline",children:y.type}),y.rating&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(es,{className:"h-3 w-3 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"text-xs",children:y.rating})]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground mt-1",children:[e.jsx(ee,{className:"h-3 w-3"}),y.location,", ",y.county]}),e.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[y.commodities.slice(0,3).map(k=>e.jsx(I,{variant:"secondary",className:"text-xs",children:k},k)),y.commodities.length>3&&e.jsxs(I,{variant:"secondary",className:"text-xs",children:["+",y.commodities.length-3," more"]})]}),y.services&&y.services.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:y.services.slice(0,2).map(k=>e.jsx(I,{variant:"outline",className:"text-xs",children:k},k))})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-600",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Online"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:new Date(y.last_seen).toLocaleTimeString()}),y.contact&&e.jsx(b,{size:"sm",variant:"outline",className:"mt-2",children:"Contact"})]})]})})},y.id))})})]})]})]})}const Th=()=>e.jsx("div",{className:"space-y-6",children:e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Mt,{className:"h-6 w-6 text-blue-600"}),"How to Use Bluetooth Marketplace"]}),e.jsx(G,{children:"Connect with nearby farmers, traders, and service providers even without internet"})]}),e.jsxs(_,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 font-semibold",children:"1"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Enable Bluetooth"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Turn on Bluetooth in your device settings and allow AgriConnect to access Bluetooth"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 font-semibold",children:"2"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Start Discovery"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"The app automatically scans for nearby AgriConnect users within Bluetooth range (up to 100 meters)"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 font-semibold",children:"3"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Share & Discover"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Share prices, send alerts, and find traders. Data spreads through the mesh network automatically"})]})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Features Available Offline"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm",children:"Price Discovery"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm",children:"Trader Discovery"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Wc,{className:"h-4 w-4 text-purple-600"}),e.jsx("span",{className:"text-sm",children:"Market Alerts"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{className:"text-sm",children:"Secure Messaging"})]})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Security & Privacy"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{variant:"secondary",children:"End-to-End Encryption"}),e.jsx("span",{className:"text-sm",children:"All Bluetooth communications are encrypted"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{variant:"secondary",children:"Anonymous by Default"}),e.jsx("span",{className:"text-sm",children:"Personal data is protected in the mesh network"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{variant:"secondary",children:"Device Verification"}),e.jsx("span",{className:"text-sm",children:"Only verified AgriConnect devices can connect"})]})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Mesh Network Benefits"}),e.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground",children:[e.jsx("li",{children:"â€¢ Messages relay through other devices to extend range"}),e.jsx("li",{children:"â€¢ Network becomes stronger with more participants"}),e.jsx("li",{children:"â€¢ Works completely offline - no internet required"}),e.jsx("li",{children:"â€¢ Automatic data synchronization when online"}),e.jsx("li",{children:"â€¢ Self-healing network adapts to device availability"})]})]})]})]})});function Dh(){return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Bluetooth Marketplace"}),e.jsx("p",{className:"text-muted-foreground",children:"Connect with nearby traders even without internet"})]}),e.jsxs(ge,{defaultValue:"marketplace",className:"w-full",children:[e.jsxs(pe,{className:"grid w-full grid-cols-2",children:[e.jsx(B,{value:"marketplace",children:"Marketplace"}),e.jsx(B,{value:"guide",children:"How to Use"})]}),e.jsx(V,{value:"marketplace",className:"space-y-4",children:e.jsx(Ah,{})}),e.jsx(V,{value:"guide",className:"space-y-4",children:e.jsx(Th,{})})]})]}),e.jsx("div",{className:"pb-20 md:pb-0"}),e.jsx(Gs,{})]})}const Eh=[{title:"Supply Chain Solutions",items:[{icon:ye,label:"Logistics Solutions Map",href:"/logistics-solutions-map",badge:"A1-A9"},{icon:re,label:"Bulk Orders",href:"/bulk-orders"},{icon:Se,label:"Supply Chain Problems",href:"/supply-chain-problems"},{icon:ce,label:"Market Demand Hotspot",href:"/market-demand-hotspot"}]},{title:"Trading & Commerce",items:[{icon:Tt,label:"Barter Exchange",href:"/barter-exchange"},{icon:Le,label:"Export Opportunities",href:"/export-market-opportunities",badge:"A1-A9"},{icon:Ye,label:"Contract Farming",href:"/contract-farming"},{icon:ee,label:"Road Markets",href:"/road-markets"}]},{title:"Community & Learning",items:[{icon:Vi,label:"Training Events",href:"/training-events"},{icon:ys,label:"Quality Control Discussions",href:"/quality-control-discussions"},{icon:se,label:"Farmer Success Stories",href:"/farmer-success-stories"},{icon:ys,label:"Community Forum",href:"/community-forum"}]},{title:"Specialized Markets",items:[{icon:Ye,label:"City Markets",href:"/city-markets"},{icon:re,label:"Equipment Marketplace",href:"/equipment-marketplace"},{icon:We,label:"Food Rescue Dashboard",href:"/food-rescue-dashboard"},{icon:Yc,label:"Imperfect Surplus",href:"/imperfect-surplus-dashboard"}]},{title:"Farm Inputs",items:[{icon:re,label:"Farm Input Marketplace",href:"/farm-input-marketplace"},{icon:se,label:"Group Input Orders",href:"/inputs/group-orders"},{icon:ce,label:"Input Pricing Verification",href:"/inputs/pricing-verification"}]},{title:"Data & Analytics",items:[{icon:ce,label:"Sentiment Analysis",href:"/sentiment-analysis"},{icon:Ds,label:"Kilimo AMS Data",href:"/kilimo-ams-data"},{icon:Le,label:"API Documentation",href:"/api-docs"}]},{title:"Account & Support",items:[{icon:At,label:"Settings",href:"/profile"},{icon:Ve,label:"Privacy Policy",href:"/privacy-policy"},{icon:Ds,label:"Terms of Service",href:"/terms-of-service"},{icon:Zt,label:"FAQ",href:"/faq"},{icon:Ee,label:"Contact Us",href:"/contact"}]}];function Fh(){return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("div",{className:"container mx-auto p-4 space-y-6 pb-24",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"More Features"}),e.jsx("p",{className:"text-muted-foreground",children:"Explore all SokoConnect features and services"})]}),e.jsx("div",{className:"space-y-6",children:Eh.map(s=>e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{className:"text-lg",children:s.title}),e.jsx(G,{children:"Access specialized tools and services"})]}),e.jsx(_,{children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:s.items.map(t=>{const a=t.icon;return e.jsxs(X,{to:t.href,className:"flex items-center gap-3 p-3 rounded-lg border hover:bg-accent transition-colors",children:[e.jsx(a,{className:"h-5 w-5 text-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"font-medium",children:t.label}),t.badge&&e.jsx(I,{variant:"secondary",className:"ml-2 text-xs",children:t.badge})]})]},t.href)})})})]},s.title))})]}),e.jsx(Gs,{})]})}const Yr={async getStages(s){const{data:t,error:a}=await F.from("supply_chain_stages").select("*").eq("user_id",s).order("created_at",{ascending:!1});if(a)throw a;return t},async getStageById(s){const{data:t,error:a}=await F.from("supply_chain_stages").select("*").eq("id",s).single();if(a)throw a;return t},async createStage(s){const{data:t,error:a}=await F.from("supply_chain_stages").insert(s).select().single();if(a)throw a;return t},async updateStage(s,t){const{data:a,error:r}=await F.from("supply_chain_stages").update(t).eq("id",s).select().single();if(r)throw r;return a},async deleteStage(s){const{error:t}=await F.from("supply_chain_stages").delete().eq("id",s);if(t)throw t},async getFinancialAnalysis(s,t){let a=F.from("supply_chain_financial_analysis").select("*").eq("user_id",s);t&&(a=a.eq("stage_id",t));const{data:r,error:n}=await a.order("created_at",{ascending:!1});if(n)throw n;return r},async createFinancialAnalysis(s){const{data:t,error:a}=await F.from("supply_chain_financial_analysis").insert(s).select().single();if(a)throw a;return t},async getFinancialSummary(s){const{data:t,error:a}=await F.from("supply_chain_financial_analysis").select("cost_type, amount, currency").eq("user_id",s);if(a)throw a;return t.reduce((n,c)=>(n[c.cost_type]||(n[c.cost_type]=0),n[c.cost_type]+=parseFloat(c.amount),n),{})}},qh=()=>{const{user:s}=je(),[t,a]=i.useState([]),[r,n]=i.useState({}),[c,l]=i.useState(!0);i.useEffect(()=>{s!=null&&s.id&&x()},[s]);const x=async()=>{try{l(!0);const[v,p]=await Promise.all([Yr.getStages(s.id),Yr.getFinancialSummary(s.id)]);a(v),n(p)}catch(v){console.error("Error loading supply chain data:",v),Te.error("Failed to load supply chain data")}finally{l(!1)}},f=v=>({planting:Ha,growth:ce,harvest:re,storage:Ts,transport:ye,market:Ge})[v]||re,j=v=>({active:is,completed:fe,delayed:Se,problem:pt})[v]||is,N=v=>({active:"text-blue-500",completed:"text-green-500",delayed:"text-yellow-500",problem:"text-red-500"})[v]||"text-gray-500",g=()=>{const v=Object.values(r).reduce((p,m)=>p+Number(m||0),0);return Number(v)||0},u=()=>{const v=t.filter(m=>m.status==="completed").length,p=g();return Number(p)*(1+v*.15)},d=()=>u()-g(),h=()=>{const v=u();return v===0?0:(d()/v*100).toFixed(1)};return c?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):s?e.jsx("div",{className:"space-y-6",children:t.length===0?e.jsx(xt,{children:e.jsx(ht,{children:"No supply chain data yet. Start tracking your farm production by adding crops and supply chain stages in the Farmer Portal."})}):e.jsxs(e.Fragment,{children:[e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Supply Chain Stages"}),e.jsx(G,{children:"Track your production through every stage"})]}),e.jsx(_,{className:"space-y-4",children:t.map(v=>{const p=f(v.stage_name),m=j(v.status);return e.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(p,{className:"h-6 w-6 text-primary"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold capitalize",children:v.stage_name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(m,{className:`h-4 w-4 ${N(v.status)}`}),e.jsx("span",{className:"text-sm text-muted-foreground capitalize",children:v.status})]})]})]}),e.jsxs(I,{variant:"outline",children:[v.progress,"%"]})]}),e.jsx(Za,{value:v.progress,className:"h-2"}),v.issues&&v.issues.length>0&&e.jsxs(xt,{variant:"destructive",children:[e.jsx(Se,{className:"h-4 w-4"}),e.jsxs(ht,{children:[v.issues.length," issue(s) detected"]})]}),v.start_date&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Started: ",new Date(v.start_date).toLocaleDateString(),v.end_date&&` â€¢ Expected completion: ${new Date(v.end_date).toLocaleDateString()}`]})]},v.id)})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(w,{children:[e.jsxs(q,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Total Costs"}),e.jsx(Ae,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(_,{children:e.jsxs("div",{className:"text-2xl font-bold",children:["KES ",g().toLocaleString()]})})]}),e.jsxs(w,{children:[e.jsxs(q,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Expected Revenue"}),e.jsx(ce,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(_,{children:e.jsxs("div",{className:"text-2xl font-bold",children:["KES ",u().toLocaleString()]})})]}),e.jsxs(w,{children:[e.jsxs(q,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Projected Profit"}),e.jsx(ce,{className:"h-4 w-4 text-green-500"})]}),e.jsx(_,{children:e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["KES ",d().toLocaleString()]})})]}),e.jsxs(w,{children:[e.jsxs(q,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Profit Margin"}),e.jsx(ce,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(_,{children:e.jsxs("div",{className:"text-2xl font-bold",children:[h(),"%"]})})]})]}),Object.keys(r).length>0&&e.jsxs(w,{children:[e.jsx(q,{children:e.jsx(L,{children:"Cost Breakdown"})}),e.jsx(_,{children:e.jsx("div",{className:"space-y-3",children:Object.entries(r).map(([v,p])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm capitalize",children:v.replace(/_/g," ")}),e.jsxs("span",{className:"font-semibold",children:["KES ",Number(p).toLocaleString()]})]},v))})})]})]})}):e.jsx(xt,{children:e.jsx(ht,{children:"Please log in to view your supply chain dashboard."})})};function Lh(){return e.jsx(er,{title:"Supply Chain Dashboard",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Supply Chain Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Track your farm production through every stage of the supply chain"})]}),e.jsx(qh,{})]})})}const Mh=[{title:"Core Marketplaces",items:[{icon:re,title:"Farm Input Marketplace",description:"Seeds, fertilizers, pesticides, and farming equipment",href:"/farm-input-marketplace",color:"bg-blue-500"},{icon:Ts,title:"Equipment Marketplace",description:"Rent, lease, or buy agricultural machinery and tools",href:"/equipment-marketplace",color:"bg-green-500"},{icon:ce,title:"Commodity Trading",description:"Buy and sell agricultural produce and commodities",href:"/commodity-trading",color:"bg-orange-500"}]},{title:"Specialized Markets",items:[{icon:Le,title:"Export Market Opportunities",description:"International buyers and export opportunities",href:"/export-market-opportunities",color:"bg-purple-500",badge:"A1-A9"},{icon:Tt,title:"Contract Farming",description:"Guaranteed purchase contracts with agribusiness",href:"/contract-farming",color:"bg-indigo-500"},{icon:ee,title:"City Markets",description:"Urban wholesale and retail market directory",href:"/city-markets",color:"bg-red-500"}]},{title:"Alternative Trading",items:[{icon:Ae,title:"Barter Exchange",description:"Trade goods and services without money",href:"/barter-exchange",color:"bg-teal-500"},{icon:se,title:"Group Input Orders",description:"Bulk purchasing for better prices",href:"/inputs/group-orders",color:"bg-cyan-500"},{icon:ee,title:"Road Markets (A1-A9)",description:"Highway sellers and roadside farmers",href:"/road-markets",color:"bg-yellow-500",badge:"A1-A9"}]},{title:"Logistics & Support",items:[{icon:ye,title:"Transport & Logistics",description:"Find transporters and logistics solutions",href:"/logistics",color:"bg-gray-500"},{icon:We,title:"Food Rescue",description:"Donate surplus produce to those in need",href:"/food-rescue-dashboard",color:"bg-pink-500"},{icon:Ye,title:"Bulk Orders",description:"Large volume procurement and sales",href:"/bulk-orders",color:"bg-slate-500"}]}],Ih=()=>e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(ne,{}),e.jsx("section",{className:"bg-gradient-to-r from-primary to-primary-foreground text-primary-foreground py-16",children:e.jsxs("div",{className:"container mx-auto px-4 text-center",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-6",children:"Agricultural Marketplace"}),e.jsx("p",{className:"text-xl mb-8 max-w-3xl mx-auto",children:"Your one-stop platform for buying, selling, and trading agricultural products, equipment, and services across Kenya and beyond."})]})}),e.jsxs("div",{className:"container mx-auto px-4 py-16",children:[e.jsx("div",{className:"space-y-12",children:Mh.map(s=>e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:s.title}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.items.map(t=>{const a=t.icon;return e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${t.color} bg-opacity-10`,children:e.jsx(a,{className:"h-6 w-6",style:{color:t.color.replace("bg-","").replace("-500","")}})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"text-lg",children:t.title}),t.badge&&e.jsx("span",{className:"px-2 py-1 bg-primary text-primary-foreground text-xs rounded-full",children:t.badge})]}),e.jsx(G,{className:"mt-2",children:t.description})]})]})}),e.jsx(_,{children:e.jsx(X,{to:t.href,children:e.jsxs(b,{className:"w-full",children:["Explore ",t.title]})})})]},t.href)})})]},s.title))}),e.jsxs("section",{className:"mt-16 bg-muted/30 rounded-lg p-8 text-center",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Start Trading Today"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-6 max-w-2xl mx-auto",children:"Join thousands of farmers, traders, and agribusiness professionals already using our platform to grow their businesses."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsx(X,{to:"/register",children:e.jsx(b,{size:"lg",children:"Create Account"})}),e.jsx(X,{to:"/community-forum",children:e.jsx(b,{variant:"outline",size:"lg",children:"Join Community"})})]})]})]})]});function Rh(){const[s,t]=i.useState([]),[a,r]=i.useState(!0),[n,c]=i.useState(!1),{toast:l}=Z(),[x,f]=i.useState({name:"",description:"",group_type:"cooperative",location:"",county:"",contact_person:"",contact_phone:""});i.useEffect(()=>{j()},[]);const j=async()=>{try{const{data:g,error:u}=await F.from("cooperative_groups").select("*").eq("status","active").order("created_at",{ascending:!1});if(u)throw u;t(g||[])}catch(g){console.error("Error fetching groups:",g),l({title:"Error",description:"Failed to load cooperative groups",variant:"destructive"})}finally{r(!1)}},N=async g=>{g.preventDefault();try{const{data:{user:u}}=await F.auth.getUser();if(!u){l({title:"Authentication Required",description:"Please log in to create a group",variant:"destructive"});return}const{error:d}=await F.from("cooperative_groups").insert({...x,group_leader_id:u.id});if(d)throw d;l({title:"Success",description:"Cooperative group created successfully!"}),c(!1),f({name:"",description:"",group_type:"cooperative",location:"",county:"",contact_person:"",contact_phone:""}),j()}catch(u){l({title:"Error",description:u.message||"Failed to create group",variant:"destructive"})}};return e.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(se,{className:"h-8 w-8 text-primary"}),"Cooperative Groups"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Join or create farming cooperatives and groups"})]}),e.jsxs(b,{onClick:()=>c(!n),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Create Group"]})]}),n&&e.jsxs(w,{className:"mb-6",children:[e.jsxs(q,{children:[e.jsx(L,{children:"Create New Cooperative Group"}),e.jsx(G,{children:"Start a new farming cooperative or group"})]}),e.jsx(_,{children:e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Group Name"}),e.jsx(D,{value:x.name,onChange:g=>f({...x,name:g.target.value}),placeholder:"E.g., Nakuru Farmers Cooperative",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Group Type"}),e.jsxs(Q,{value:x.group_type,onValueChange:g=>f({...x,group_type:g}),children:[e.jsx(W,{children:e.jsx(J,{})}),e.jsxs(Y,{children:[e.jsx(T,{value:"cooperative",children:"Cooperative"}),e.jsx(T,{value:"farmers_group",children:"Farmers Group"}),e.jsx(T,{value:"savings_group",children:"Savings Group"}),e.jsx(T,{value:"marketing_group",children:"Marketing Group"}),e.jsx(T,{value:"women_group",children:"Women Group"}),e.jsx(T,{value:"youth_group",children:"Youth Group"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx(le,{value:x.description,onChange:g=>f({...x,description:g.target.value}),placeholder:"Describe your group's purpose and activities",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Location"}),e.jsx(D,{value:x.location,onChange:g=>f({...x,location:g.target.value}),placeholder:"Town/Village",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"County"}),e.jsx(D,{value:x.county,onChange:g=>f({...x,county:g.target.value}),placeholder:"County",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Contact Person"}),e.jsx(D,{value:x.contact_person,onChange:g=>f({...x,contact_person:g.target.value}),placeholder:"Full Name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Contact Phone"}),e.jsx(D,{value:x.contact_phone,onChange:g=>f({...x,contact_phone:g.target.value}),placeholder:"+254...",required:!0})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{type:"submit",children:"Create Group"}),e.jsx(b,{type:"button",variant:"outline",onClick:()=>c(!1),children:"Cancel"})]})]})})]}),a?e.jsx("div",{className:"text-center py-12",children:"Loading groups..."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(g=>e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(L,{className:"text-lg",children:g.name}),e.jsx(I,{variant:"outline",className:"mt-2",children:g.group_type.replace("_"," ")})]}),e.jsx(se,{className:"h-6 w-6 text-primary"})]})}),e.jsxs(_,{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:g.description}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(ee,{className:"h-4 w-4"}),e.jsxs("span",{children:[g.location,", ",g.county]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsxs("span",{children:[g.member_count," members"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Ee,{className:"h-4 w-4"}),e.jsx("span",{children:g.contact_phone})]}),g.activities&&g.activities.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:g.activities.slice(0,3).map((u,d)=>e.jsx(I,{variant:"secondary",className:"text-xs",children:u},d))})]}),e.jsx(b,{className:"w-full mt-4",size:"sm",children:"Join Group"})]})]},g.id))}),!a&&s.length===0&&e.jsx(w,{children:e.jsxs(_,{className:"text-center py-12",children:[e.jsx(se,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"No cooperative groups found"}),e.jsx(b,{onClick:()=>c(!0),children:"Create First Group"})]})})]}),e.jsx(Gs,{})]})}const zh=()=>{const{user:s}=je(),t=Ne(),{toast:a}=Z(),[r,n]=i.useState("hosts"),[c,l]=i.useState([]),[x,f]=i.useState([]),[j,N]=i.useState([]),[g,u]=i.useState(!0),[d,h]=i.useState(!1),[v,p]=i.useState({farm_name:"",description:"",location:"",county:"",crops:"",livestock:"",business_type:"",contact_phone:"",contact_email:"",website_url:"",amenities:""}),[m,o]=i.useState({title:"",description:"",event_type:"",location:"",county:"",start_date:"",end_date:"",entry_fee:0,poster_url:"",contact_phone:"",contact_email:"",requirements:"",tags:""}),[y,k]=i.useState({name:"",description:"",organization_type:"",location:"",contact_phone:"",contact_email:"",website_url:"",services:"",focus_areas:""});i.useEffect(()=>{A()},[]);const A=async()=>{u(!0);try{const{data:R,error:M}=await F.from("farm_tourism_hosts").select("*").eq("is_verified",!0).order("rating",{ascending:!1});if(M)throw M;l(R||[]);const{data:O,error:te}=await F.from("agricultural_events").select("*").eq("status","upcoming").gte("start_date",new Date().toISOString()).order("start_date");if(te)throw te;f(O||[]);const{data:ue,error:z}=await F.from("agricultural_organizations").select("*").eq("is_verified",!0).order("rating",{ascending:!1});if(z)throw z;N(ue||[])}catch(R){a({title:"Error",description:R.message||"Failed to fetch data",variant:"destructive"})}finally{u(!1)}},S=async R=>{if(R.preventDefault(),!s){a({title:"Authentication Required",description:"Please sign in to add your farm for tourism",variant:"destructive"}),t("/auth");return}try{const{error:M}=await F.from("farm_tourism_hosts").insert({host_id:s.id,farm_name:v.farm_name,description:v.description,location:v.location,county:v.county,crops:v.crops.split(",").map(O=>O.trim()),livestock:v.livestock.split(",").map(O=>O.trim()),business_type:v.business_type,contact_phone:v.contact_phone,contact_email:v.contact_email,website_url:v.website_url,amenities:v.amenities.split(",").map(O=>O.trim())});if(M)throw M;a({title:"Success",description:"Your farm has been submitted for verification. You'll be notified once approved."}),h(!1),p({farm_name:"",description:"",location:"",county:"",crops:"",livestock:"",business_type:"",contact_phone:"",contact_email:"",website_url:"",amenities:""})}catch(M){a({title:"Error",description:M.message||"Failed to add farm",variant:"destructive"})}},E=async R=>{if(R.preventDefault(),!s){a({title:"Authentication Required",description:"Please sign in to add events",variant:"destructive"}),t("/auth");return}try{const{error:M}=await F.from("agricultural_events").insert({organizer_id:s.id,title:m.title,description:m.description,event_type:m.event_type,location:m.location,county:m.county,start_date:m.start_date,end_date:m.end_date,entry_fee:m.entry_fee,poster_url:m.poster_url,contact_info:{phone:m.contact_phone,email:m.contact_email},tags:m.tags.split(",").map(O=>O.trim()),requirements:m.requirements});if(M)throw M;a({title:"Success",description:"Your event has been added successfully!"}),h(!1),A()}catch(M){a({title:"Error",description:M.message||"Failed to add event",variant:"destructive"})}},P=async R=>{if(R.preventDefault(),!s){a({title:"Authentication Required",description:"Please sign in to suggest organizations",variant:"destructive"}),t("/auth");return}try{const{error:M}=await F.from("agricultural_organizations").insert({name:y.name,description:y.description,organization_type:y.organization_type,location:y.location,contact_phone:y.contact_phone,contact_email:y.contact_email,website_url:y.website_url,services:y.services.split(",").map(O=>O.trim()),focus_areas:y.focus_areas.split(",").map(O=>O.trim())});if(M)throw M;a({title:"Success",description:"Organization has been submitted for verification. Thank you for your contribution!"}),h(!1),k({name:"",description:"",organization_type:"",location:"",contact_phone:"",contact_email:"",website_url:"",services:"",focus_areas:""})}catch(M){a({title:"Error",description:M.message||"Failed to add organization",variant:"destructive"})}};return g?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(ne,{}),e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})]}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(ne,{}),e.jsxs("main",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Agricultural Tourism & Resources"}),e.jsx("p",{className:"text-muted-foreground",children:"Discover farm tourism opportunities, agricultural events, and connect with organizations"})]}),e.jsxs(ge,{value:r,onValueChange:n,className:"w-full",children:[e.jsxs(pe,{className:"grid w-full grid-cols-3",children:[e.jsx(B,{value:"hosts",children:"Farm Tourism"}),e.jsx(B,{value:"events",children:"Events"}),e.jsx(B,{value:"organizations",children:"Organizations"})]}),e.jsxs(V,{value:"hosts",className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Farm Tourism Hosts"}),e.jsxs(b,{onClick:()=>h(!d),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Add Your Farm"]})]}),d&&e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Add Your Farm for Tourism"}),e.jsx(G,{children:"Share your farm experience with visitors and tourists"})]}),e.jsx(_,{children:e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"farm_name",children:"Farm Name *"}),e.jsx(D,{id:"farm_name",value:v.farm_name,onChange:R=>p({...v,farm_name:R.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"business_type",children:"Business Type *"}),e.jsx(D,{id:"business_type",placeholder:"e.g., Organic Farm, Dairy Farm, Agritourism",value:v.business_type,onChange:R=>p({...v,business_type:R.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"location",children:"Location *"}),e.jsx(D,{id:"location",value:v.location,onChange:R=>p({...v,location:R.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"county",children:"County *"}),e.jsx(D,{id:"county",value:v.county,onChange:R=>p({...v,county:R.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"crops",children:"Crops (comma-separated)"}),e.jsx(D,{id:"crops",placeholder:"e.g., Maize, Beans, Coffee",value:v.crops,onChange:R=>p({...v,crops:R.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"livestock",children:"Livestock (comma-separated)"}),e.jsx(D,{id:"livestock",placeholder:"e.g., Cattle, Poultry, Goats",value:v.livestock,onChange:R=>p({...v,livestock:R.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"contact_phone",children:"Contact Phone"}),e.jsx(D,{id:"contact_phone",value:v.contact_phone,onChange:R=>p({...v,contact_phone:R.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"contact_email",children:"Contact Email"}),e.jsx(D,{id:"contact_email",type:"email",value:v.contact_email,onChange:R=>p({...v,contact_email:R.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"description",children:"Description *"}),e.jsx(le,{id:"description",placeholder:"Describe your farm, activities, and what visitors can expect",value:v.description,onChange:R=>p({...v,description:R.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"amenities",children:"Amenities (comma-separated)"}),e.jsx(D,{id:"amenities",placeholder:"e.g., Parking, Restrooms, Guided Tours, Farm Store",value:v.amenities,onChange:R=>p({...v,amenities:R.target.value})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{type:"submit",children:"Submit for Review"}),e.jsx(b,{type:"button",variant:"outline",onClick:()=>h(!1),children:"Cancel"})]})]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map(R=>e.jsxs(w,{className:"overflow-hidden",children:[e.jsxs(q,{children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-lg",children:R.farm_name}),e.jsxs(G,{className:"flex items-center mt-1",children:[e.jsx(ee,{className:"h-4 w-4 mr-1"}),R.location,", ",R.county]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(es,{className:"h-4 w-4 text-yellow-500 mr-1"}),e.jsx("span",{className:"text-sm",children:R.rating.toFixed(1)})]})]}),e.jsx(I,{variant:"outline",children:R.business_type})]}),e.jsxs(_,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-3 line-clamp-3",children:R.description}),R.crops.length>0&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Crops: "}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[R.crops.slice(0,3).join(", "),R.crops.length>3&&"..."]})]}),R.livestock.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"text-sm font-medium",children:"Livestock: "}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[R.livestock.slice(0,3).join(", "),R.livestock.length>3&&"..."]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:R.amenities.slice(0,3).map((M,O)=>e.jsx(I,{variant:"secondary",className:"text-xs",children:M},O))}),e.jsxs("div",{className:"flex gap-2",children:[R.contact_phone&&e.jsxs(b,{size:"sm",variant:"outline",className:"flex-1",children:[e.jsx(Ee,{className:"h-4 w-4 mr-1"}),"Call"]}),R.contact_email&&e.jsxs(b,{size:"sm",variant:"outline",className:"flex-1",children:[e.jsx(He,{className:"h-4 w-4 mr-1"}),"Email"]})]})]})]},R.id))})]}),e.jsxs(V,{value:"events",className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Agricultural Events"}),e.jsxs(b,{onClick:()=>h(!d),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Add Event"]})]}),d&&e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Add Agricultural Event"}),e.jsx(G,{children:"Share your agricultural event with the community"})]}),e.jsx(_,{children:e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"event_title",children:"Event Title *"}),e.jsx(D,{id:"event_title",value:m.title,onChange:R=>o({...m,title:R.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"event_type",children:"Event Type *"}),e.jsx(D,{id:"event_type",placeholder:"e.g., Workshop, Conference, Field Day",value:m.event_type,onChange:R=>o({...m,event_type:R.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"event_location",children:"Location *"}),e.jsx(D,{id:"event_location",value:m.location,onChange:R=>o({...m,location:R.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"event_county",children:"County *"}),e.jsx(D,{id:"event_county",value:m.county,onChange:R=>o({...m,county:R.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"start_date",children:"Start Date *"}),e.jsx(D,{id:"start_date",type:"datetime-local",value:m.start_date,onChange:R=>o({...m,start_date:R.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"end_date",children:"End Date *"}),e.jsx(D,{id:"end_date",type:"datetime-local",value:m.end_date,onChange:R=>o({...m,end_date:R.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"entry_fee",children:"Entry Fee (KES)"}),e.jsx(D,{id:"entry_fee",type:"number",min:"0",value:m.entry_fee,onChange:R=>o({...m,entry_fee:parseFloat(R.target.value)||0})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"poster_url",children:"Poster Image URL"}),e.jsx(D,{id:"poster_url",type:"url",value:m.poster_url,onChange:R=>o({...m,poster_url:R.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"event_description",children:"Description *"}),e.jsx(le,{id:"event_description",placeholder:"Describe the event, agenda, and what participants will learn",value:m.description,onChange:R=>o({...m,description:R.target.value}),required:!0})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{type:"submit",children:"Add Event"}),e.jsx(b,{type:"button",variant:"outline",onClick:()=>h(!1),children:"Cancel"})]})]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map(R=>e.jsxs(w,{className:"overflow-hidden",children:[R.poster_url&&e.jsx("div",{className:"h-48 bg-cover bg-center",style:{backgroundImage:`url(${R.poster_url})`}}),e.jsxs(q,{children:[e.jsx(L,{className:"text-lg",children:R.title}),e.jsxs(G,{className:"flex items-center",children:[e.jsx(ee,{className:"h-4 w-4 mr-1"}),R.location,", ",R.county]}),e.jsx(I,{variant:"outline",children:R.event_type})]}),e.jsxs(_,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-3 line-clamp-3",children:R.description}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),new Date(R.start_date).toLocaleDateString()," - ",new Date(R.end_date).toLocaleDateString()]}),R.entry_fee>0&&e.jsxs("div",{className:"text-sm font-medium text-green-600",children:["Entry Fee: ",R.currency," ",R.entry_fee]}),R.entry_fee===0&&e.jsx("div",{className:"text-sm font-medium text-green-600",children:"Free Event"})]}),e.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:R.tags.slice(0,3).map((M,O)=>e.jsx(I,{variant:"secondary",className:"text-xs",children:M},O))}),e.jsx(b,{size:"sm",className:"w-full",children:"View Details"})]})]},R.id))})]}),e.jsxs(V,{value:"organizations",className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Agricultural Organizations"}),e.jsxs(b,{onClick:()=>h(!d),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Suggest Organization"]})]}),d&&e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Suggest Agricultural Organization"}),e.jsx(G,{children:"Help others discover valuable agricultural organizations"})]}),e.jsx(_,{children:e.jsxs("form",{onSubmit:P,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"org_name",children:"Organization Name *"}),e.jsx(D,{id:"org_name",value:y.name,onChange:R=>k({...y,name:R.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"org_type",children:"Organization Type *"}),e.jsx(D,{id:"org_type",placeholder:"e.g., NGO, Government Agency, Cooperative",value:y.organization_type,onChange:R=>k({...y,organization_type:R.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"org_location",children:"Location *"}),e.jsx(D,{id:"org_location",value:y.location,onChange:R=>k({...y,location:R.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"org_phone",children:"Contact Phone"}),e.jsx(D,{id:"org_phone",value:y.contact_phone,onChange:R=>k({...y,contact_phone:R.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"org_email",children:"Contact Email"}),e.jsx(D,{id:"org_email",type:"email",value:y.contact_email,onChange:R=>k({...y,contact_email:R.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"org_website",children:"Website URL"}),e.jsx(D,{id:"org_website",type:"url",value:y.website_url,onChange:R=>k({...y,website_url:R.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"org_description",children:"Description *"}),e.jsx(le,{id:"org_description",placeholder:"Describe the organization's mission and activities",value:y.description,onChange:R=>k({...y,description:R.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"org_services",children:"Services (comma-separated)"}),e.jsx(D,{id:"org_services",placeholder:"e.g., Training, Funding, Technical Support",value:y.services,onChange:R=>k({...y,services:R.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"org_focus",children:"Focus Areas (comma-separated)"}),e.jsx(D,{id:"org_focus",placeholder:"e.g., Crop Production, Livestock, Technology",value:y.focus_areas,onChange:R=>k({...y,focus_areas:R.target.value})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{type:"submit",children:"Submit for Review"}),e.jsx(b,{type:"button",variant:"outline",onClick:()=>h(!1),children:"Cancel"})]})]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:j.map(R=>e.jsxs(w,{className:"overflow-hidden",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-lg",children:R.name}),e.jsxs(G,{className:"flex items-center mt-1",children:[e.jsx(Zs,{className:"h-4 w-4 mr-1"}),R.organization_type]}),e.jsxs(G,{className:"flex items-center",children:[e.jsx(ee,{className:"h-4 w-4 mr-1"}),R.location]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(es,{className:"h-4 w-4 text-yellow-500 mr-1"}),e.jsx("span",{className:"text-sm",children:R.rating.toFixed(1)})]})]})}),e.jsxs(_,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-3 line-clamp-3",children:R.description}),R.services.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"text-sm font-medium",children:"Services: "}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:R.services.slice(0,3).map((M,O)=>e.jsx(I,{variant:"secondary",className:"text-xs",children:M},O))})]}),e.jsxs("div",{className:"flex gap-2",children:[R.contact_phone&&e.jsxs(b,{size:"sm",variant:"outline",className:"flex-1",children:[e.jsx(Ee,{className:"h-4 w-4 mr-1"}),"Call"]}),R.website_url&&e.jsxs(b,{size:"sm",variant:"outline",className:"flex-1",children:[e.jsx(Le,{className:"h-4 w-4 mr-1"}),"Visit"]})]})]})]},R.id))})]})]})]}),e.jsx(Gs,{})]})},Oh=()=>{const{toast:s}=Z(),[t,a]=i.useState([]),[r,n]=i.useState(!0),[c,l]=i.useState(""),[x,f]=i.useState("");i.useEffect(()=>{j()},[]);const j=async v=>{n(!0);try{let p=F.from("weather_forecasts").select("*").gte("forecast_date",new Date().toISOString().split("T")[0]).order("forecast_date");v&&(p=p.ilike("location",`%${v}%`));const{data:m,error:o}=await p.limit(50);if(o)throw o;a(m||[]),(!m||m.length===0)&&v&&await N(v)}catch(p){s({title:"Error",description:p.message||"Failed to fetch weather data",variant:"destructive"})}finally{n(!1)}},N=async v=>{const p={location:v,county:"Sample County",forecast_date:new Date().toISOString().split("T")[0],temperature_min:18,temperature_max:26,humidity:65,rainfall:2.5,wind_speed:15,wind_direction:"NE",weather_condition:"Partly Cloudy",weather_description:"Partly cloudy with chance of light rain",visibility:10,uv_index:6,pressure:1013,agricultural_advisory:"Good conditions for field work. Monitor soil moisture levels.",planting_recommendation:"Suitable for planting drought-resistant crops.",harvesting_recommendation:"Good weather for harvesting mature crops.",pest_disease_alert:"Moderate humidity may favor fungal diseases. Monitor crops closely.",coordinates:{lat:-1.2921,lng:36.8219}};try{const{error:m}=await F.from("weather_forecasts").insert([p]);if(m)throw m;s({title:"Weather Data Added",description:`Weather forecast for ${v} has been added to the database.`}),j()}catch(m){console.error("Error adding weather data:",m)}},g=()=>{c.trim()?(f(c),j(c)):(f(""),j())},u=v=>{const p=v.toLowerCase();return p.includes("rain")?e.jsx(wr,{className:"h-6 w-6"}):p.includes("cloud")?e.jsx(_t,{className:"h-6 w-6"}):p.includes("snow")?e.jsx(Xc,{className:"h-6 w-6"}):p.includes("sun")||p.includes("clear")?e.jsx(Fa,{className:"h-6 w-6"}):e.jsx(_t,{className:"h-6 w-6"})},d=v=>v<=2?"bg-green-500":v<=5?"bg-yellow-500":v<=7?"bg-orange-500":v<=10?"bg-red-500":"bg-purple-500",h=t.reduce((v,p)=>{const m=p.location;return v[m]||(v[m]=[]),v[m].push(p),v},{});return r?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(ne,{}),e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})]}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(ne,{}),e.jsxs("main",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold text-foreground mb-2 flex items-center",children:[e.jsx(_t,{className:"h-8 w-8 mr-3 text-blue-500"}),"Agricultural Weather Forecast"]}),e.jsx("p",{className:"text-muted-foreground",children:"Get detailed weather forecasts with agricultural insights for better farming decisions"})]}),e.jsxs(w,{className:"mb-8",children:[e.jsxs(q,{children:[e.jsx(L,{children:"Search Weather by Location"}),e.jsx(G,{children:"Enter a location to get specific weather forecasts"})]}),e.jsx(_,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{placeholder:"Enter location (e.g., Nairobi, Mombasa, Nakuru)",value:c,onChange:v=>l(v.target.value),onKeyPress:v=>v.key==="Enter"&&g(),className:"flex-1"}),e.jsx(b,{onClick:g,children:"Search"}),e.jsx(b,{variant:"outline",onClick:()=>{l(""),f(""),j()},children:"Clear"})]})})]}),Object.entries(h).length===0?e.jsx(w,{children:e.jsxs(_,{className:"text-center py-12",children:[e.jsx(_t,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Weather Data Available"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Try searching for a specific location to get weather forecasts."}),e.jsx(b,{onClick:()=>N("Nairobi"),children:"Load Sample Data"})]})}):e.jsx("div",{className:"space-y-8",children:Object.entries(h).map(([v,p])=>{var m;return e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-semibold mb-4 flex items-center",children:[e.jsx(ee,{className:"h-5 w-5 mr-2 text-primary"}),v,((m=p[0])==null?void 0:m.county)&&e.jsxs("span",{className:"text-sm text-muted-foreground ml-2",children:[", ",p[0].county]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.slice(0,7).map(o=>e.jsxs(w,{className:"overflow-hidden",children:[e.jsx(q,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs(L,{className:"text-lg flex items-center",children:[u(o.weather_condition),e.jsx("span",{className:"ml-2",children:o.weather_condition})]}),e.jsxs(G,{className:"flex items-center mt-1",children:[e.jsx(xe,{className:"h-4 w-4 mr-1"}),new Date(o.forecast_date).toLocaleDateString("en-GB",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold",children:[o.temperature_max,"Â°C"]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Min: ",o.temperature_min,"Â°C"]})]})]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:o.weather_description}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(en,{className:"h-4 w-4 mr-2 text-blue-500"}),e.jsx("span",{className:"text-muted-foreground",children:"Humidity:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[o.humidity,"%"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(wr,{className:"h-4 w-4 mr-2 text-blue-600"}),e.jsx("span",{className:"text-muted-foreground",children:"Rainfall:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[o.rainfall,"mm"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Qc,{className:"h-4 w-4 mr-2 text-gray-500"}),e.jsx("span",{className:"text-muted-foreground",children:"Wind:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[o.wind_speed," km/h ",o.wind_direction]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(qs,{className:"h-4 w-4 mr-2 text-gray-600"}),e.jsx("span",{className:"text-muted-foreground",children:"Visibility:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[o.visibility," km"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Jc,{className:"h-4 w-4 mr-2 text-gray-700"}),e.jsx("span",{className:"text-muted-foreground",children:"Pressure:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[o.pressure," hPa"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Fa,{className:"h-4 w-4 mr-2 text-yellow-500"}),e.jsx("span",{className:"text-muted-foreground",children:"UV Index:"}),e.jsx(I,{className:`ml-1 ${d(o.uv_index)} text-white text-xs`,children:o.uv_index})]})]}),e.jsxs("div",{className:"space-y-3 pt-4 border-t",children:[e.jsxs("h4",{className:"font-semibold text-sm flex items-center",children:[e.jsx(as,{className:"h-4 w-4 mr-2 text-green-500"}),"Agricultural Insights"]}),o.agricultural_advisory&&e.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Advisory:"})," ",o.agricultural_advisory]})}),o.planting_recommendation&&e.jsx("div",{className:"bg-green-50 p-3 rounded-lg",children:e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Planting:"})," ",o.planting_recommendation]})}),o.harvesting_recommendation&&e.jsx("div",{className:"bg-yellow-50 p-3 rounded-lg",children:e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Harvesting:"})," ",o.harvesting_recommendation]})}),o.pest_disease_alert&&e.jsx("div",{className:"bg-red-50 p-3 rounded-lg",children:e.jsxs("p",{className:"text-sm flex items-start",children:[e.jsx(Se,{className:"h-4 w-4 mr-2 text-red-500 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Alert:"})," ",o.pest_disease_alert]})]})})]})]})]},o.id))})]},v)})}),e.jsxs(w,{className:"mt-8",children:[e.jsx(q,{children:e.jsx(L,{children:"Understanding Weather Forecasts for Agriculture"})}),e.jsx(_,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Temperature Guidelines"}),e.jsxs("ul",{className:"space-y-1 text-muted-foreground",children:[e.jsx("li",{children:"â€¢ Optimal growing: 20-30Â°C for most crops"}),e.jsx("li",{children:"â€¢ Below 10Â°C: Risk of frost damage"}),e.jsx("li",{children:"â€¢ Above 35Â°C: Heat stress for plants"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Rainfall Indicators"}),e.jsxs("ul",{className:"space-y-1 text-muted-foreground",children:[e.jsx("li",{children:"â€¢ 0-5mm: Light rain, good for irrigation"}),e.jsx("li",{children:"â€¢ 5-15mm: Moderate rain, ideal for most crops"}),e.jsx("li",{children:"â€¢ 15mm+: Heavy rain, possible flooding risk"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Humidity Effects"}),e.jsxs("ul",{className:"space-y-1 text-muted-foreground",children:[e.jsx("li",{children:"â€¢ 40-60%: Optimal for most crops"}),e.jsx("li",{children:"â€¢ Below 40%: Risk of water stress"}),e.jsx("li",{children:"â€¢ Above 80%: Increased disease risk"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"UV Index Guide"}),e.jsxs("ul",{className:"space-y-1 text-muted-foreground",children:[e.jsx("li",{children:"â€¢ 0-2: Low, minimal crop protection needed"}),e.jsx("li",{children:"â€¢ 3-5: Moderate, standard growing conditions"}),e.jsx("li",{children:"â€¢ 6-7: High, consider shade for sensitive crops"}),e.jsx("li",{children:"â€¢ 8+: Very high, protect crops from sun damage"})]})]})]})})]})]}),e.jsx(Gs,{})]})},Kh=()=>{const{user:s}=je(),t=Ne(),{toast:a}=Z(),[r,n]=i.useState([]),[c,l]=i.useState(!0),[x,f]=i.useState(!1),[j,N]=i.useState(""),[g,u]=i.useState(""),[d,h]=i.useState({contractor_name:"",contractor_type:"Company",crop_type:"",variety:"",required_quantity:0,unit:"kg",contract_price:0,location:"",county:"",planting_season:"",harvest_period:"",contract_duration:"",requirements:"",benefits_offered:"",support_provided:"",payment_terms:"",quality_standards:"",delivery_terms:"",contact_phone:"",contact_email:"",application_deadline:"",max_farmers:0});i.useEffect(()=>{v()},[]);const v=async()=>{l(!0);try{const{data:o,error:y}=await F.from("contract_farming").select("*").eq("status","open").gte("application_deadline",new Date().toISOString().split("T")[0]).order("created_at",{ascending:!1});if(y)throw y;n(o||[])}catch(o){a({title:"Error",description:o.message||"Failed to fetch contracts",variant:"destructive"})}finally{l(!1)}},p=async o=>{if(o.preventDefault(),!s){a({title:"Authentication Required",description:"Please sign in to post contract farming opportunities",variant:"destructive"}),t("/auth");return}try{const{error:y}=await F.from("contract_farming").insert({contractor_id:s.id,contractor_name:d.contractor_name,contractor_type:d.contractor_type,crop_type:d.crop_type,variety:d.variety,required_quantity:d.required_quantity,unit:d.unit,contract_price:d.contract_price,location:d.location,county:d.county,planting_season:d.planting_season,harvest_period:d.harvest_period,contract_duration:d.contract_duration,requirements:d.requirements,benefits_offered:d.benefits_offered,support_provided:d.support_provided.split(",").map(k=>k.trim()),payment_terms:d.payment_terms,quality_standards:d.quality_standards,delivery_terms:d.delivery_terms,contact_phone:d.contact_phone,contact_email:d.contact_email,application_deadline:d.application_deadline,max_farmers:d.max_farmers});if(y)throw y;a({title:"Success",description:"Contract farming opportunity has been posted successfully!"}),f(!1),h({contractor_name:"",contractor_type:"Company",crop_type:"",variety:"",required_quantity:0,unit:"kg",contract_price:0,location:"",county:"",planting_season:"",harvest_period:"",contract_duration:"",requirements:"",benefits_offered:"",support_provided:"",payment_terms:"",quality_standards:"",delivery_terms:"",contact_phone:"",contact_email:"",application_deadline:"",max_farmers:0}),v()}catch(y){a({title:"Error",description:y.message||"Failed to post contract",variant:"destructive"})}},m=r.filter(o=>{const y=j===""||o.crop_type.toLowerCase().includes(j.toLowerCase())||o.contractor_name.toLowerCase().includes(j.toLowerCase()),k=g===""||o.location.toLowerCase().includes(g.toLowerCase())||o.county.toLowerCase().includes(g.toLowerCase());return y&&k});return c?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(ne,{}),e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})]}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(ne,{}),e.jsxs("main",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Contract Farming"}),e.jsx("p",{className:"text-muted-foreground",children:"Connect with contractors for guaranteed market opportunities and agricultural support"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsx(D,{placeholder:"Search by crop type or contractor...",value:j,onChange:o=>N(o.target.value),className:"flex-1"}),e.jsx(D,{placeholder:"Filter by location...",value:g,onChange:o=>u(o.target.value),className:"flex-1"}),e.jsxs(b,{onClick:()=>f(!x),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Post Contract"]})]}),x&&e.jsxs(w,{className:"mb-8",children:[e.jsxs(q,{children:[e.jsx(L,{children:"Post Contract Farming Opportunity"}),e.jsx(G,{children:"Create a contract farming opportunity for farmers in your area"})]}),e.jsx(_,{children:e.jsxs("form",{onSubmit:p,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"contractor_name",children:"Contractor Name *"}),e.jsx(D,{id:"contractor_name",value:d.contractor_name,onChange:o=>h({...d,contractor_name:o.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"contractor_type",children:"Contractor Type"}),e.jsxs("select",{id:"contractor_type",value:d.contractor_type,onChange:o=>h({...d,contractor_type:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"Company",children:"Company"}),e.jsx("option",{value:"Cooperative",children:"Cooperative"}),e.jsx("option",{value:"Government",children:"Government Agency"}),e.jsx("option",{value:"NGO",children:"NGO"}),e.jsx("option",{value:"Individual",children:"Individual"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"crop_type",children:"Crop Type *"}),e.jsx(D,{id:"crop_type",placeholder:"e.g., Maize, Rice, Coffee",value:d.crop_type,onChange:o=>h({...d,crop_type:o.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"variety",children:"Variety"}),e.jsx(D,{id:"variety",placeholder:"e.g., H614, Basmati",value:d.variety,onChange:o=>h({...d,variety:o.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"required_quantity",children:"Required Quantity *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{id:"required_quantity",type:"number",min:"1",value:d.required_quantity,onChange:o=>h({...d,required_quantity:parseFloat(o.target.value)||0}),required:!0}),e.jsxs("select",{value:d.unit,onChange:o=>h({...d,unit:o.target.value}),className:"px-3 py-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"kg",children:"kg"}),e.jsx("option",{value:"tonnes",children:"tonnes"}),e.jsx("option",{value:"bags",children:"bags"}),e.jsx("option",{value:"crates",children:"crates"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"contract_price",children:"Contract Price per Unit (KES) *"}),e.jsx(D,{id:"contract_price",type:"number",min:"0",step:"0.01",value:d.contract_price,onChange:o=>h({...d,contract_price:parseFloat(o.target.value)||0}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"max_farmers",children:"Maximum Farmers"}),e.jsx(D,{id:"max_farmers",type:"number",min:"1",value:d.max_farmers,onChange:o=>h({...d,max_farmers:parseInt(o.target.value)||0})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"application_deadline",children:"Application Deadline *"}),e.jsx(D,{id:"application_deadline",type:"date",value:d.application_deadline,onChange:o=>h({...d,application_deadline:o.target.value}),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"location",children:"Location *"}),e.jsx(D,{id:"location",value:d.location,onChange:o=>h({...d,location:o.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"county",children:"County *"}),e.jsx(D,{id:"county",value:d.county,onChange:o=>h({...d,county:o.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"planting_season",children:"Planting Season *"}),e.jsx(D,{id:"planting_season",placeholder:"e.g., March-April 2024",value:d.planting_season,onChange:o=>h({...d,planting_season:o.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"harvest_period",children:"Expected Harvest Period *"}),e.jsx(D,{id:"harvest_period",placeholder:"e.g., July-August 2024",value:d.harvest_period,onChange:o=>h({...d,harvest_period:o.target.value}),required:!0})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"requirements",children:"Requirements *"}),e.jsx(le,{id:"requirements",placeholder:"Describe farmer requirements, land size, experience, etc.",value:d.requirements,onChange:o=>h({...d,requirements:o.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"benefits_offered",children:"Benefits Offered *"}),e.jsx(le,{id:"benefits_offered",placeholder:"Describe benefits: guaranteed purchase, price security, technical support, etc.",value:d.benefits_offered,onChange:o=>h({...d,benefits_offered:o.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"support_provided",children:"Support Provided (comma-separated)"}),e.jsx(D,{id:"support_provided",placeholder:"e.g., Seeds, Fertilizers, Technical Training, Equipment",value:d.support_provided,onChange:o=>h({...d,support_provided:o.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"payment_terms",children:"Payment Terms *"}),e.jsx(le,{id:"payment_terms",placeholder:"When and how payments will be made",value:d.payment_terms,onChange:o=>h({...d,payment_terms:o.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"quality_standards",children:"Quality Standards *"}),e.jsx(le,{id:"quality_standards",placeholder:"Describe quality requirements and standards",value:d.quality_standards,onChange:o=>h({...d,quality_standards:o.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"delivery_terms",children:"Delivery Terms *"}),e.jsx(le,{id:"delivery_terms",placeholder:"How and where crops should be delivered",value:d.delivery_terms,onChange:o=>h({...d,delivery_terms:o.target.value}),required:!0})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"contact_phone",children:"Contact Phone *"}),e.jsx(D,{id:"contact_phone",type:"tel",value:d.contact_phone,onChange:o=>h({...d,contact_phone:o.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"contact_email",children:"Contact Email"}),e.jsx(D,{id:"contact_email",type:"email",value:d.contact_email,onChange:o=>h({...d,contact_email:o.target.value})})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{type:"submit",children:"Post Contract"}),e.jsx(b,{type:"button",variant:"outline",onClick:()=>f(!1),children:"Cancel"})]})]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:m.map(o=>e.jsxs(w,{className:"overflow-hidden",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-lg",children:o.crop_type}),o.variety&&e.jsx(G,{children:o.variety}),e.jsxs(G,{className:"flex items-center mt-1",children:[e.jsx(ee,{className:"h-4 w-4 mr-1"}),o.location,", ",o.county]})]}),e.jsx(I,{variant:"outline",children:o.contractor_type})]})}),e.jsxs(_,{className:"space-y-3",children:[e.jsxs("div",{className:"text-lg font-semibold text-green-600",children:["KES ",o.contract_price.toLocaleString()," per ",o.unit]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"Contractor:"})," ",o.contractor_name]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"Quantity Needed:"})," ",o.required_quantity.toLocaleString()," ",o.unit]}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(xe,{className:"h-4 w-4 mr-1"}),"Planting: ",o.planting_season]}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(xe,{className:"h-4 w-4 mr-1"}),"Harvest: ",o.harvest_period]}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(is,{className:"h-4 w-4 mr-1"}),"Apply by: ",new Date(o.application_deadline).toLocaleDateString()]}),o.max_farmers>0&&e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(se,{className:"h-4 w-4 mr-1"}),o.current_applications,"/",o.max_farmers," farmers"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"Benefits:"}),e.jsx("p",{className:"text-muted-foreground line-clamp-2",children:o.benefits_offered})]}),o.support_provided.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:o.support_provided.slice(0,3).map((y,k)=>e.jsx(I,{variant:"secondary",className:"text-xs",children:y},k))})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(b,{size:"sm",className:"flex-1",children:[e.jsx(qs,{className:"h-4 w-4 mr-1"}),"View Details"]}),e.jsx(b,{size:"sm",variant:"outline",children:"Apply"})]})]})]},o.id))}),m.length===0&&e.jsx(w,{children:e.jsxs(_,{className:"text-center py-12",children:[e.jsx(Ds,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Contract Farming Opportunities"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:j||g?"No contracts match your search criteria. Try adjusting your filters.":"Be the first to post a contract farming opportunity!"}),!j&&!g&&e.jsx(b,{onClick:()=>f(!0),children:"Post First Contract"})]})})]}),e.jsx(Gs,{})]})},Bh="/assets/equipment-bg-D64HPwx6.png",Uh=["Tractor","Plough","Harvester","Planter","Cultivator","Sprayer","Irrigation Equipment","Generator","Water Pump","Thresher","Disc Harrow","Mower","Baler","Transplanter","Other"],Vh=["New","Excellent","Good","Fair","Poor"],$h=["Nairobi","Mombasa","Kisumu","Nakuru","Eldoret","Nyeri","Kiambu","Muranga","Kericho","Bomet","Uasin Gishu","Trans Nzoia","Nandi","Migori","Kisii","Homabay","Siaya","Bungoma","Busia","Vihiga","Kakamega","Samburu","Isiolo","Laikipia","Embu","Tharaka Nithi","Machakos","Makueni","Kajiado","Narok","Maasai","Kitui","Garissa","Wajir","Mandera","Lamu","Taita Taveta","Kwale"],Gh=({isOpen:s,onClose:t,onSuccess:a,userId:r})=>{const{toast:n}=Z(),[c,l]=i.useState(!1),[x,f]=i.useState(!1),[j,N]=i.useState([]),[g,u]=i.useState({equipment_name:"",equipment_type:"Tractor",brand:"",model:"",year_manufactured:new Date().getFullYear(),condition:"Good",location:"",county:"Nairobi",description:"",specifications:"",tags:"",contact_phone:"",contact_email:"",sale_price:0,price_negotiable:!0,rental_enabled:!1,rental_price_per_day:0,minimum_rental_days:1,lease_enabled:!1,lease_price_per_month:0,lease_terms:"12 months",images:[]}),d=o=>{const{name:y,value:k,type:A}=o.target;u(S=>({...S,[y]:A==="checkbox"?o.target.checked:k}))},h=o=>{const y=Array.from(o.target.files||[]);if(y.length+g.images.length>5){n({title:"Too Many Images",description:"Maximum 5 images allowed per listing",variant:"destructive"});return}u(k=>({...k,images:[...k.images,...y]})),y.forEach(k=>{const A=new FileReader;A.onloadend=()=>{N(S=>[...S,A.result])},A.readAsDataURL(k)})},v=o=>{u(y=>({...y,images:y.images.filter((k,A)=>A!==o)})),N(y=>y.filter((k,A)=>A!==o))},p=async()=>{if(g.images.length===0)return[];f(!0);const o=[];try{for(const y of g.images){const k=`${r}/${Date.now()}-${y.name}`,{error:A,data:S}=await F.storage.from("equipment-images").upload(k,y);if(A)throw A;const{data:E}=F.storage.from("equipment-images").getPublicUrl(k);o.push(E.publicUrl)}}catch(y){throw n({title:"Upload Error",description:y.message||"Failed to upload images",variant:"destructive"}),f(!1),y}return f(!1),o},m=async o=>{if(o.preventDefault(),!g.equipment_name||!g.location||!g.county){n({title:"Validation Error",description:"Please fill in all required fields",variant:"destructive"});return}l(!0);try{const y=await p(),k=g.specifications?JSON.parse(g.specifications):{},A={seller_id:r,equipment_name:g.equipment_name,equipment_type:g.equipment_type,brand:g.brand,model:g.model,year_manufactured:g.year_manufactured,condition:g.condition,price:g.sale_price,currency:"KES",negotiable:g.price_negotiable,location:g.location,county:g.county,description:g.description,specifications:k,images:y,availability_status:"available",rental_option:g.rental_enabled,rental_price_per_day:g.rental_price_per_day,rental_minimum_days:g.minimum_rental_days,tags:g.tags.split(",").map(P=>P.trim()).filter(P=>P),contact_phone:g.contact_phone,contact_email:g.contact_email,is_featured:!1,view_count:0},{error:S}=await F.from("equipment_marketplace").insert(A);if(S)throw S;const{error:E}=await F.from("equipment_marketplace_listings").insert({seller_id:r,equipment_type:g.equipment_type,brand:g.brand,model:g.model,location:g.location,county:g.county,sale_price:g.sale_price,sale_available:!0,rental_available:g.rental_enabled,rental_price_per_day:g.rental_price_per_day,lease_available:g.lease_enabled,lease_price_per_month:g.lease_price_per_month,lease_terms:g.lease_terms,images:y,status:"active"});if(E)throw E;n({title:"Success!",description:"Equipment listing created successfully"}),a(),t()}catch(y){n({title:"Error",description:y.message||"Failed to create listing",variant:"destructive"})}finally{l(!1)}};return e.jsx(_e,{open:s,onOpenChange:t,children:e.jsxs(we,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Ce,{children:[e.jsx(ke,{children:"List Equipment for Sale or Rent"}),e.jsx(it,{children:"Create a detailed listing to reach more buyers and renters"})]}),e.jsxs("form",{onSubmit:m,className:"space-y-6",children:[e.jsxs(ge,{defaultValue:"basic",className:"w-full",children:[e.jsxs(pe,{className:"grid w-full grid-cols-4",children:[e.jsx(B,{value:"basic",children:"Basic Info"}),e.jsx(B,{value:"sale",children:"Sale"}),e.jsx(B,{value:"rental",children:"Rental"}),e.jsx(B,{value:"images",children:"Images"})]}),e.jsxs(V,{value:"basic",className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"equipment_name",children:"Equipment Name *"}),e.jsx(D,{id:"equipment_name",name:"equipment_name",placeholder:"e.g., John Deere 5045D Tractor",value:g.equipment_name,onChange:d,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"equipment_type",children:"Equipment Type *"}),e.jsx("select",{id:"equipment_type",name:"equipment_type",value:g.equipment_type,onChange:d,className:"w-full px-3 py-2 border rounded-md",required:!0,children:Uh.map(o=>e.jsx("option",{value:o,children:o},o))})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"condition",children:"Condition *"}),e.jsx("select",{id:"condition",name:"condition",value:g.condition,onChange:d,className:"w-full px-3 py-2 border rounded-md",children:Vh.map(o=>e.jsx("option",{value:o,children:o},o))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"brand",children:"Brand"}),e.jsx(D,{id:"brand",name:"brand",placeholder:"e.g., John Deere",value:g.brand,onChange:d})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"model",children:"Model"}),e.jsx(D,{id:"model",name:"model",placeholder:"e.g., 5045D",value:g.model,onChange:d})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"year_manufactured",children:"Year Manufactured"}),e.jsx(D,{id:"year_manufactured",name:"year_manufactured",type:"number",min:"1950",max:new Date().getFullYear(),value:g.year_manufactured,onChange:d})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"location",children:"Location *"}),e.jsx(D,{id:"location",name:"location",placeholder:"Town/City",value:g.location,onChange:d,required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"county",children:"County *"}),e.jsx("select",{id:"county",name:"county",value:g.county,onChange:d,className:"w-full px-3 py-2 border rounded-md",required:!0,children:$h.map(o=>e.jsx("option",{value:o,children:o},o))})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"description",children:"Description *"}),e.jsx(le,{id:"description",name:"description",placeholder:"Detailed description of equipment condition, features, and any issues",value:g.description,onChange:d,rows:3,required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"specifications",children:"Specifications (JSON)"}),e.jsx(le,{id:"specifications",name:"specifications",placeholder:'{"horsepower": "45 HP", "fuel_type": "Diesel"}',value:g.specifications,onChange:d,rows:2})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"tags",children:"Tags (comma-separated)"}),e.jsx(D,{id:"tags",name:"tags",placeholder:"e.g., hydraulic, 4WD, low hours, serviced",value:g.tags,onChange:d})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"contact_phone",children:"Contact Phone"}),e.jsx(D,{id:"contact_phone",name:"contact_phone",type:"tel",placeholder:"+254...",value:g.contact_phone,onChange:d})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"contact_email",children:"Contact Email"}),e.jsx(D,{id:"contact_email",name:"contact_email",type:"email",value:g.contact_email,onChange:d})]})]})]}),e.jsxs(V,{value:"sale",className:"space-y-4",children:[e.jsx("div",{className:"bg-blue-50 p-4 rounded-md mb-4",children:e.jsx("p",{className:"text-sm text-blue-900",children:"Set your equipment sale price and negotiation options"})}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"sale_price",children:"Sale Price (KES) *"}),e.jsx(D,{id:"sale_price",name:"sale_price",type:"number",min:"0",step:"0.01",value:g.sale_price,onChange:d,required:!0})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"price_negotiable",name:"price_negotiable",checked:g.price_negotiable,onChange:d}),e.jsx(C,{htmlFor:"price_negotiable",className:"mb-0",children:"Price is negotiable"})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-md",children:[e.jsx("p",{className:"text-sm font-semibold text-green-900 mb-2",children:"ðŸ’¡ Sale Tips:"}),e.jsxs("ul",{className:"text-sm text-green-800 space-y-1",children:[e.jsx("li",{children:"â€¢ Use competitive pricing for faster sales"}),e.jsx("li",{children:"â€¢ Enable negotiation for better customer engagement"}),e.jsx("li",{children:"â€¢ Add detailed specifications to increase trust"}),e.jsx("li",{children:"â€¢ Clear photos significantly improve inquiries"})]})]})]}),e.jsxs(V,{value:"rental",className:"space-y-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border-l-4 border-orange-500 pl-4 py-2",children:[e.jsx("h3",{className:"font-semibold text-sm mb-2",children:"Rental Options"}),e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx("input",{type:"checkbox",id:"rental_enabled",name:"rental_enabled",checked:g.rental_enabled,onChange:d}),e.jsx(C,{htmlFor:"rental_enabled",className:"mb-0",children:"Enable Rental Service"})]}),g.rental_enabled&&e.jsxs("div",{className:"space-y-3 bg-orange-50 p-3 rounded",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"rental_price_per_day",children:"Daily Rental Rate (KES)"}),e.jsx(D,{id:"rental_price_per_day",name:"rental_price_per_day",type:"number",min:"0",step:"0.01",value:g.rental_price_per_day,onChange:d})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"minimum_rental_days",children:"Minimum Rental Days"}),e.jsx(D,{id:"minimum_rental_days",name:"minimum_rental_days",type:"number",min:"1",value:g.minimum_rental_days,onChange:d})]})]})]}),e.jsxs("div",{className:"border-l-4 border-purple-500 pl-4 py-2",children:[e.jsx("h3",{className:"font-semibold text-sm mb-2",children:"Lease Options"}),e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx("input",{type:"checkbox",id:"lease_enabled",name:"lease_enabled",checked:g.lease_enabled,onChange:d}),e.jsx(C,{htmlFor:"lease_enabled",className:"mb-0",children:"Enable Lease Service"})]}),g.lease_enabled&&e.jsxs("div",{className:"space-y-3 bg-purple-50 p-3 rounded",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"lease_price_per_month",children:"Monthly Lease Rate (KES)"}),e.jsx(D,{id:"lease_price_per_month",name:"lease_price_per_month",type:"number",min:"0",step:"0.01",value:g.lease_price_per_month,onChange:d})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"lease_terms",children:"Lease Terms"}),e.jsxs("select",{id:"lease_terms",name:"lease_terms",value:g.lease_terms,onChange:d,className:"w-full px-3 py-2 border rounded-md",children:[e.jsx("option",{value:"3 months",children:"3 months"}),e.jsx("option",{value:"6 months",children:"6 months"}),e.jsx("option",{value:"12 months",children:"12 months"}),e.jsx("option",{value:"24 months",children:"24 months"}),e.jsx("option",{value:"36 months",children:"36 months"}),e.jsx("option",{value:"flexible",children:"Flexible"})]})]})]})]})]}),e.jsxs("div",{className:"bg-amber-50 p-4 rounded-md",children:[e.jsx("p",{className:"text-sm font-semibold text-amber-900 mb-2",children:"ðŸ’¼ Rental/Lease Tips:"}),e.jsxs("ul",{className:"text-sm text-amber-800 space-y-1",children:[e.jsx("li",{children:"â€¢ Daily rates for short-term usage (1-30 days)"}),e.jsx("li",{children:"â€¢ Monthly rates for longer-term commitment"}),e.jsx("li",{children:"â€¢ Set minimum rental days to ensure profitability"}),e.jsx("li",{children:"â€¢ Include maintenance responsibilities in lease terms"})]})]})]}),e.jsxs(V,{value:"images",className:"space-y-4",children:[e.jsx("div",{className:"bg-blue-50 p-4 rounded-md mb-4",children:e.jsx("p",{className:"text-sm text-blue-900",children:"Upload up to 5 high-quality images of your equipment"})}),j.length===0?e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-8 text-center",children:[e.jsx(sn,{className:"h-12 w-12 mx-auto text-muted-foreground mb-2"}),e.jsx("p",{className:"mb-2 text-sm",children:"Drag and drop images here or click to select"}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:h,className:"hidden",id:"image-upload"}),e.jsx("label",{htmlFor:"image-upload",children:e.jsx(b,{type:"button",variant:"outline",onClick:()=>{var o;return(o=document.getElementById("image-upload"))==null?void 0:o.click()},children:"Select Images"})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Supported formats: JPG, PNG, WebP (Max 5MB each)"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-2 gap-4",children:j.map((o,y)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:o,alt:`Preview ${y+1}`,className:"w-full h-32 object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>v(y),className:"absolute top-1 right-1 bg-red-500 text-white p-1 rounded-full",children:e.jsx(Be,{className:"h-4 w-4"})})]},y))}),j.length<5&&e.jsxs("div",{children:[e.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:h,className:"hidden",id:"image-upload-more"}),e.jsx("label",{htmlFor:"image-upload-more",children:e.jsxs(b,{type:"button",variant:"outline",onClick:()=>{var o;return(o=document.getElementById("image-upload-more"))==null?void 0:o.click()},children:["Add More Images (",j.length,"/5)"]})})]})]})]})]}),e.jsxs("div",{className:"flex gap-2 justify-end pt-4 border-t",children:[e.jsx(b,{type:"button",variant:"outline",onClick:t,disabled:c||x,children:"Cancel"}),e.jsx(b,{type:"submit",disabled:c||x,children:c||x?e.jsxs(e.Fragment,{children:[e.jsx(As,{className:"h-4 w-4 mr-2 animate-spin"}),x?"Uploading Images...":"Creating Listing..."]}):"Create Listing"})]})]})]})})},Hh=()=>{const{user:s}=je(),t=Ne(),{toast:a}=Z(),[r,n]=i.useState([]),[c,l]=i.useState(!0),[x,f]=i.useState(!1),[j,N]=i.useState(!0),[g,u]=i.useState(""),[d,h]=i.useState(""),[v,p]=i.useState(""),[m,o]=i.useState("all"),y=["Tractor","Plough","Harvester","Planter","Cultivator","Sprayer","Irrigation Equipment","Generator","Water Pump","Thresher","Disc Harrow","Mower","Baler","Transplanter","Other"];i.useEffect(()=>{k()},[]);const k=async()=>{l(!0);try{const{data:E,error:P}=await F.from("equipment_marketplace").select("*").eq("availability_status","available").order("created_at",{ascending:!1});if(P)throw P;n(E||[])}catch(E){a({title:"Error",description:E.message||"Failed to fetch equipment",variant:"destructive"})}finally{l(!1)}},A=()=>{k(),a({title:"Success!",description:"Your equipment listing has been created"})},S=r.filter(E=>{const P=g===""||E.equipment_name.toLowerCase().includes(g.toLowerCase())||E.brand.toLowerCase().includes(g.toLowerCase())||E.model.toLowerCase().includes(g.toLowerCase()),R=d===""||E.equipment_type===d,M=v===""||E.location.toLowerCase().includes(v.toLowerCase())||E.county.toLowerCase().includes(v.toLowerCase());let O=!0;return m==="sale"?O=E.price>0:m==="rental"?O=E.rental_option&&E.rental_price_per_day>0:m==="lease"&&(O=!0),P&&R&&M&&O});return c?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(ne,{}),e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})]}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(ne,{}),j&&e.jsx(_s,{marketplaceType:"equipment",onAccept:()=>N(!1)}),e.jsxs("section",{className:"relative text-white py-16 bg-cover bg-center",style:{backgroundImage:`url(${Bh})`,backgroundAttachment:"fixed"},children:[e.jsx("div",{className:"absolute inset-0 bg-black/40"}),e.jsxs("div",{className:"relative container mx-auto px-4 text-center",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-6",children:"Equipment Marketplace"}),e.jsx("p",{className:"text-xl mb-8 max-w-3xl mx-auto",children:"Buy, sell, and rent agricultural equipment from trusted sellers across Kenya"})]})]}),e.jsxs("main",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-foreground mb-2",children:"Browse Equipment"}),e.jsx("p",{className:"text-muted-foreground",children:"Find the right agricultural equipment for your farm"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsx(D,{placeholder:"Search equipment, brand, or model...",value:g,onChange:E=>u(E.target.value),className:"flex-1"}),e.jsxs("select",{value:d,onChange:E=>h(E.target.value),className:"px-3 py-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"",children:"All Types"}),y.map(E=>e.jsx("option",{value:E,children:E},E))]}),e.jsx(D,{placeholder:"Filter by location...",value:v,onChange:E=>p(E.target.value),className:"flex-1"}),e.jsxs(b,{onClick:()=>{if(!s){t("/auth");return}f(!0)},className:"bg-green-600 hover:bg-green-700",children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"List Equipment"]})]}),e.jsx("div",{className:"flex gap-2 mb-6",children:["all","sale","rental","lease"].map(E=>e.jsxs(I,{variant:m===E?"default":"outline",className:"cursor-pointer",onClick:()=>o(E),children:[E==="all"&&"ðŸ“¦ All Listings",E==="sale"&&"ðŸ’° For Sale",E==="rental"&&"ðŸ”„ For Rent",E==="lease"&&"ðŸ“‹ For Lease"]},E))}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:S.map(E=>{var P;return e.jsxs(w,{className:"overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"h-40 bg-gray-200 overflow-hidden relative",children:[e.jsx(xr,{src:(P=E.images)==null?void 0:P[0],alt:E.equipment_name,className:"w-full h-full object-cover"}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-1",children:[E.is_featured&&e.jsx(I,{className:"bg-yellow-500 text-white text-xs",children:"â­ Featured"}),E.rental_option&&e.jsx(I,{className:"bg-orange-500 text-white text-xs",children:"ðŸ”„ Rentable"})]})]}),e.jsx(q,{className:"pb-3",children:e.jsxs("div",{children:[e.jsx(L,{className:"text-base line-clamp-2",children:E.equipment_name}),e.jsxs(G,{className:"flex items-center mt-1 text-xs",children:[e.jsx(At,{className:"h-3 w-3 mr-1"}),E.equipment_type]}),e.jsxs(G,{className:"flex items-center text-xs",children:[e.jsx(ee,{className:"h-3 w-3 mr-1"}),E.location,", ",E.county]})]})}),e.jsxs(_,{className:"space-y-2 pb-3",children:[e.jsxs("div",{className:"border-l-4 border-green-500 pl-3 py-2 bg-green-50 rounded",children:[e.jsxs("div",{className:"text-sm font-semibold text-green-700",children:["ðŸ’° Sale: KES ",E.price.toLocaleString()]}),E.negotiable&&e.jsx("div",{className:"text-xs text-green-600",children:"âœ“ Price negotiable"})]}),E.rental_option&&E.rental_price_per_day>0&&e.jsxs("div",{className:"border-l-4 border-orange-500 pl-3 py-2 bg-orange-50 rounded",children:[e.jsxs("div",{className:"text-sm font-semibold text-orange-700",children:["ðŸ”„ Rent: KES ",E.rental_price_per_day.toLocaleString(),"/day"]}),E.rental_minimum_days&&E.rental_minimum_days>1&&e.jsxs("div",{className:"text-xs text-orange-600",children:["Min ",E.rental_minimum_days," days"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[E.brand&&e.jsxs("div",{className:"bg-gray-100 p-2 rounded",children:[e.jsx("span",{className:"font-semibold",children:"Brand:"})," ",E.brand]}),E.year_manufactured&&e.jsxs("div",{className:"bg-gray-100 p-2 rounded",children:[e.jsx("span",{className:"font-semibold",children:"Year:"})," ",E.year_manufactured]})]}),e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"font-semibold",children:"Condition:"}),e.jsx(I,{variant:"outline",className:"ml-1 text-xs",children:E.condition})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs pt-1 border-t",children:[e.jsxs("div",{className:"bg-blue-50 p-2 rounded",children:[e.jsx("span",{className:"font-semibold text-blue-900",children:"âœ“ Warranty"}),e.jsx("div",{className:"text-blue-700 text-xs",children:"Available"})]}),e.jsxs("div",{className:"bg-purple-50 p-2 rounded",children:[e.jsx("span",{className:"font-semibold text-purple-900",children:"ðŸ›¡ï¸ Insurance"}),e.jsx("div",{className:"text-purple-700 text-xs",children:"Options available"})]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs bg-green-50 p-2 rounded border border-green-200",children:[e.jsx(es,{className:"h-3 w-3 text-green-600"}),e.jsx("span",{className:"text-green-700 font-semibold",children:"Verified Seller"})]}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:E.description}),E.tags&&E.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 pt-1",children:[E.tags.slice(0,2).map((R,M)=>e.jsx(I,{variant:"secondary",className:"text-xs",children:R},M)),E.tags.length>2&&e.jsxs(I,{variant:"secondary",className:"text-xs",children:["+",E.tags.length-2]})]}),e.jsxs("div",{className:"flex gap-1 pt-2",children:[e.jsxs(b,{size:"sm",className:"flex-1 text-xs h-8",children:[e.jsx(qs,{className:"h-3 w-3 mr-1"}),"View Details"]}),E.contact_phone&&e.jsx(b,{size:"sm",variant:"outline",className:"h-8",children:e.jsx(Ee,{className:"h-3 w-3"})}),E.rental_option&&e.jsx(b,{size:"sm",variant:"outline",className:"h-8",children:e.jsx(gt,{className:"h-3 w-3"})})]})]})]},E.id)})}),S.length===0&&e.jsx(w,{children:e.jsxs(_,{className:"text-center py-12",children:[e.jsx(At,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Equipment Found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:g||d||v?"No equipment matches your search criteria. Try adjusting your filters.":"Be the first to list agricultural equipment!"}),!g&&!d&&!v&&e.jsx(b,{onClick:()=>{if(!s){t("/auth");return}f(!0)},className:"bg-green-600 hover:bg-green-700",children:"List First Equipment"})]})})]}),s&&e.jsx(Gh,{isOpen:x,onClose:()=>f(!1),onSuccess:A,userId:s.id}),e.jsx(Gs,{})]})},Wh="/assets/advertise-bg-DHBJqsne.png",Yh=()=>{const s=Ne(),{user:t}=je(),{toast:a}=Z(),[r,n]=i.useState(null),c=130,l=[{name:"1 Month Package",price:`KES ${(10*c).toLocaleString()}`,usdPrice:"$10",period:"/month",planId:"ad-1month",amount:Da["ad-1month"].amount,features:["Business profile listing","Contact information display","Business flyer upload","30-day visibility","Basic analytics"],color:"border-green-200"},{name:"3 Months Package",price:`KES ${(20*c).toLocaleString()}`,usdPrice:"$20",period:"/3 months",planId:"ad-3months",amount:Da["ad-3months"].amount,features:["Business profile listing","Contact information display","Business flyer upload","90-day visibility","Advanced analytics","Priority support"],color:"border-green-500",popular:!0},{name:"1 Year Package",price:`KES ${(30*c).toLocaleString()}`,usdPrice:"$30",period:"/year",planId:"ad-1year",amount:Da["ad-1year"].amount,features:["Business profile listing","Contact information display","Business flyer upload","365-day visibility","Premium analytics","Dedicated account manager"],color:"border-green-700"}],x=async(j,N,g)=>{if(!(t!=null&&t.email)){a({title:"Login Required",description:"Please log in to purchase an advertising package.",variant:"destructive"}),s("/auth");return}n(j);try{const u=await Oa({email:t.email,amount:N,plan_id:j,plan_type:"advertising",metadata:{user_id:t.id,plan_name:g}});u.success&&u.authorization_url?(a({title:"Redirecting to Payment",description:"You'll be redirected to Paystack to complete payment."}),Ka(u.authorization_url)):a({title:"Payment Error",description:u.error||"Failed to initialize payment. Please try again.",variant:"destructive"})}catch(u){console.error("Payment error:",u),a({title:"Error",description:"An error occurred. Please try again later.",variant:"destructive"})}finally{n(null)}},f=[{icon:se,title:"Reach Thousands of Farmers",description:"Connect directly with farmers, cooperatives, and agribusinesses across Kenya"},{icon:na,title:"Targeted Marketing",description:"Reach the right audience with location-based and category-specific targeting"},{icon:ce,title:"Boost Your Sales",description:"Increase visibility and drive more customers to your agricultural business"},{icon:ys,title:"Direct Communication",description:"Build relationships with potential customers through direct messaging"}];return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(ne,{}),e.jsx("section",{className:"relative py-12",style:{backgroundImage:`linear-gradient(rgba(22, 163, 74, 0.7), rgba(22, 163, 74, 0.7)), url(${Wh})`,backgroundSize:"cover",backgroundPosition:"center"},children:e.jsxs("div",{className:"container mx-auto px-4 text-center text-white relative z-10",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-4",children:"Advertise Your Agricultural Business"}),e.jsx("p",{className:"text-xl max-w-3xl mx-auto",children:"Reach thousands of farmers, suppliers, and buyers across Kenya"})]})}),e.jsxs("div",{className:"container mx-auto px-4 py-12",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-16",children:f.map((j,N)=>e.jsx(w,{children:e.jsx(_,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-full mb-4",children:e.jsx(j.icon,{className:"h-6 w-6 text-green-600"})}),e.jsx("h3",{className:"font-semibold mb-2",children:j.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:j.description})]})})},N))}),e.jsxs("div",{className:"mb-12",children:[e.jsx("h2",{className:"text-3xl font-bold text-center mb-8",children:"Choose Your Advertising Package"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:l.map((j,N)=>e.jsxs(w,{className:`relative ${j.color} border-2 ${j.popular?"shadow-lg scale-105":""}`,children:[j.popular&&e.jsx("div",{className:"absolute -top-4 left-1/2 transform -translate-x-1/2",children:e.jsxs("span",{className:"bg-green-600 text-white px-4 py-1 rounded-full text-sm font-semibold flex items-center gap-1",children:[e.jsx(es,{className:"h-4 w-4"})," Most Popular"]})}),e.jsxs(q,{children:[e.jsx(L,{className:"text-2xl",children:j.name}),e.jsxs("div",{className:"mt-4",children:[e.jsx("span",{className:"text-4xl font-bold",children:j.price}),e.jsx("span",{className:"text-muted-foreground",children:j.period}),e.jsxs("div",{className:"text-sm text-muted-foreground mt-1",children:["(",j.usdPrice," USD)"]})]})]}),e.jsxs(_,{children:[e.jsx("ul",{className:"space-y-3 mb-6",children:j.features.map((g,u)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(fe,{className:"h-5 w-5 text-green-600 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-sm",children:g})]},u))}),e.jsx(b,{className:`w-full ${j.popular?"bg-green-600 hover:bg-green-700":""}`,variant:j.popular?"default":"outline",onClick:()=>x(j.planId,j.amount,j.name),disabled:r===j.planId,children:r===j.planId?e.jsxs(e.Fragment,{children:[e.jsx(As,{className:"h-4 w-4 mr-2 animate-spin"}),"Processing..."]}):"Get Started"})]})]},N))})]}),e.jsx(w,{className:"bg-gradient-to-r from-green-600 to-green-700 text-white",children:e.jsx(_,{className:"p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Ready to Grow Your Business?"}),e.jsx("p",{className:"text-lg mb-6 opacity-90",children:"Join hundreds of successful agribusinesses already advertising on SokoConnect"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsx(b,{size:"lg",variant:"secondary",onClick:()=>s("/contact"),children:"Contact Sales"}),e.jsx(b,{size:"lg",variant:"outline",className:"bg-white text-green-700 hover:bg-gray-100",onClick:()=>s("/service-provider-registration"),children:"Register Your Business"})]})]})})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 mt-12",children:[{number:"10,000+",label:"Active Users"},{number:"47",label:"Counties Covered"},{number:"500+",label:"Listed Businesses"},{number:"95%",label:"Customer Satisfaction"}].map((j,N)=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:j.number}),e.jsx("div",{className:"text-sm text-muted-foreground",children:j.label})]},N))})]})]})},Qh=()=>{const s=Ne();return i.useEffect(()=>{s("/community-forums",{replace:!0})},[s]),e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"text-center",children:e.jsx("p",{children:"Redirecting to Community Forums..."})})})},Jh="/assets/farm-inputs-bg-C_4qHkdz.png",Qr=()=>{const[s,t]=i.useState([]),[a,r]=i.useState(!0),[n,c]=i.useState(""),[l,x]=i.useState("all"),[f,j]=i.useState("all"),[N,g]=i.useState(!1),[u,d]=i.useState(!0),{toast:h}=Z(),{user:v}=je(),[p,m]=i.useState({product_name:"",product_category:"fertilizer",subcategory:"",brand:"",description:"",price:"",unit:"kg",quantity_in_stock:"",min_order_quantity:"",bulk_discount_percentage:"",available_counties:[],delivery_available:!0});i.useEffect(()=>{o()},[]);async function o(){r(!0);try{const{data:E,error:P}=await F.from("farm_input_products").select("*").eq("status","active").order("created_at",{ascending:!1});if(P)throw P;t(E||[])}catch(E){console.error("Error fetching products:",E),h({title:"Error",description:"Failed to load farm input products",variant:"destructive"})}finally{r(!1)}}const y=async()=>{if(!v){h({title:"Authentication Required",description:"Please sign in to add products",variant:"destructive"});return}try{const{data:E,error:P}=await F.from("farm_input_products").insert([{supplier_id:v.id,product_name:p.product_name,product_category:p.product_category,subcategory:p.subcategory,brand:p.brand,description:p.description,price:parseFloat(p.price),unit:p.unit,quantity_in_stock:parseInt(p.quantity_in_stock),min_order_quantity:parseInt(p.min_order_quantity),bulk_discount_percentage:parseFloat(p.bulk_discount_percentage||"0"),available_counties:p.available_counties,delivery_available:p.delivery_available}]).select().single();if(P)throw P;h({title:"Success",description:"Product added successfully"}),g(!1),o()}catch(E){h({title:"Error",description:E.message||"Failed to add product",variant:"destructive"})}},k=Array.from(new Set(s.map(E=>E.product_category))),A=Array.from(new Set(s.flatMap(E=>E.available_counties||[]))),S=s.filter(E=>{var O;const P=E.product_name.toLowerCase().includes(n.toLowerCase())||((O=E.brand)==null?void 0:O.toLowerCase().includes(n.toLowerCase())),R=l==="all"||E.product_category===l,M=f==="all"||(E.available_counties||[]).includes(f);return P&&R&&M});return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(ne,{}),u&&e.jsx(_s,{marketplaceType:"farm-inputs",onAccept:()=>d(!1)}),e.jsx("section",{className:"relative py-16",style:{backgroundImage:`linear-gradient(rgba(34, 197, 94, 0.85), rgba(22, 163, 74, 0.9)), url(${Jh})`,backgroundSize:"cover",backgroundPosition:"center"},children:e.jsxs("div",{className:"container mx-auto px-4 text-white",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-4",children:"Farm Input Marketplace"}),e.jsx("p",{className:"text-xl mb-6 max-w-2xl",children:"Quality agricultural inputs from verified suppliers. Get fertilizers, seeds, pesticides, animal feed, and farming equipment delivered to your farm."}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ns,{className:"h-5 w-5"}),e.jsx("span",{children:"Verified Suppliers"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ns,{className:"h-5 w-5"}),e.jsx("span",{children:"Quality Guaranteed"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ns,{className:"h-5 w-5"}),e.jsx("span",{children:"Bulk Discounts"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ns,{className:"h-5 w-5"}),e.jsx("span",{children:"Fast Delivery"})]})]})]})}),e.jsxs("main",{className:"py-12 px-4 md:px-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"bg-primary/5 border border-primary/20 rounded-lg p-6 mb-8 flex flex-col md:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:"Are you a farm input supplier?"}),e.jsx("p",{className:"text-muted-foreground",children:"List your products here â€” fertilizers, seeds, pesticides, equipment & more. Reach thousands of farmers across Kenya."})]}),v?e.jsxs(b,{size:"lg",onClick:()=>g(!0),children:[e.jsx(ie,{className:"h-5 w-5 mr-2"})," List Your Product"]}):e.jsx(b,{size:"lg",onClick:()=>window.location.href="/auth",children:"Sign In to List Products"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-8",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Pe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(D,{placeholder:"Search farm inputs...",value:n,onChange:E=>c(E.target.value),className:"pl-10"})]}),e.jsxs(Q,{value:l,onValueChange:x,children:[e.jsx(W,{className:"w-full md:w-48",children:e.jsx(J,{placeholder:"All Categories"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Categories"}),k.map(E=>e.jsx(T,{value:E,children:E},E))]})]}),e.jsxs(Q,{value:f,onValueChange:j,children:[e.jsx(W,{className:"w-full md:w-48",children:e.jsx(J,{placeholder:"All Counties"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Counties"}),A.map(E=>e.jsx(T,{value:E,children:E},E))]})]}),v&&e.jsxs(_e,{open:N,onOpenChange:g,children:[e.jsx(Ie,{asChild:!0,children:e.jsxs(b,{children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Add Product"]})}),e.jsxs(we,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Ce,{children:e.jsx(ke,{children:"Add Farm Input Product"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"product_name",children:"Product Name *"}),e.jsx(D,{id:"product_name",value:p.product_name,onChange:E=>m({...p,product_name:E.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"brand",children:"Brand"}),e.jsx(D,{id:"brand",value:p.brand,onChange:E=>m({...p,brand:E.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"category",children:"Category *"}),e.jsxs(Q,{value:p.product_category,onValueChange:E=>m({...p,product_category:E}),children:[e.jsx(W,{children:e.jsx(J,{})}),e.jsxs(Y,{children:[e.jsx(T,{value:"fertilizer",children:"Fertilizer"}),e.jsx(T,{value:"seed",children:"Seeds"}),e.jsx(T,{value:"pesticide",children:"Pesticides"}),e.jsx(T,{value:"equipment",children:"Equipment"}),e.jsx(T,{value:"feed",children:"Animal Feed"}),e.jsx(T,{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"subcategory",children:"Subcategory"}),e.jsx(D,{id:"subcategory",value:p.subcategory,onChange:E=>m({...p,subcategory:E.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"description",children:"Description *"}),e.jsx(le,{id:"description",value:p.description,onChange:E=>m({...p,description:E.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"price",children:"Price (KES) *"}),e.jsx(D,{id:"price",type:"number",value:p.price,onChange:E=>m({...p,price:E.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"unit",children:"Unit *"}),e.jsxs(Q,{value:p.unit,onValueChange:E=>m({...p,unit:E}),children:[e.jsx(W,{children:e.jsx(J,{})}),e.jsxs(Y,{children:[e.jsx(T,{value:"kg",children:"Kilogram (kg)"}),e.jsx(T,{value:"bag",children:"Bag"}),e.jsx(T,{value:"litre",children:"Litre"}),e.jsx(T,{value:"piece",children:"Piece"})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"stock",children:"Stock Quantity *"}),e.jsx(D,{id:"stock",type:"number",value:p.quantity_in_stock,onChange:E=>m({...p,quantity_in_stock:E.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"min_order",children:"Min Order Quantity *"}),e.jsx(D,{id:"min_order",type:"number",value:p.min_order_quantity,onChange:E=>m({...p,min_order_quantity:E.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"bulk_discount",children:"Bulk Discount %"}),e.jsx(D,{id:"bulk_discount",type:"number",value:p.bulk_discount_percentage,onChange:E=>m({...p,bulk_discount_percentage:E.target.value})})]})]}),e.jsx(b,{onClick:y,className:"w-full",children:"Add Product"})]})]})]})]}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:a?e.jsx("div",{className:"col-span-full text-center py-12",children:"Loading products..."}):S.length>0?S.map(E=>{var P;return e.jsxs(w,{className:"overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsx("div",{className:"h-40 w-full overflow-hidden bg-gray-200",children:e.jsx(xr,{src:(P=E.images)==null?void 0:P[0],alt:E.product_name,className:"w-full h-full object-cover"})}),e.jsxs(q,{children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx(L,{className:"text-lg",children:E.product_name}),E.is_verified&&e.jsxs(I,{variant:"default",className:"bg-green-600",children:[e.jsx(ns,{className:"h-3 w-3 mr-1"}),"Verified"]})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(I,{variant:"outline",children:E.product_category}),E.brand&&e.jsx(I,{variant:"secondary",children:E.brand}),E.is_organic&&e.jsx(I,{variant:"default",className:"bg-green-500",children:"Organic"})]})]}),e.jsxs(_,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4 line-clamp-2",children:E.description}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-2xl font-bold text-primary",children:[E.currency," ",E.price.toLocaleString()]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["per ",E.unit]})]}),E.bulk_discount_percentage>0&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600",children:[e.jsx(ce,{className:"h-4 w-4"}),E.bulk_discount_percentage,"% bulk discount available"]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(re,{className:"h-4 w-4"}),e.jsxs("span",{children:["Min Order: ",E.min_order_quantity," ",E.unit]})]}),E.rating>0&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(es,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsxs("span",{children:[E.rating.toFixed(1)," (",E.review_count," reviews)"]})]})]}),e.jsxs(b,{className:"w-full mt-4",children:[e.jsx(rs,{className:"h-4 w-4 mr-2"}),"Order Now"]})]})]},E.id)}):e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx(re,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{children:"No farm input products found."})]})})]})]})},Xh=()=>{const[s,t]=i.useState([]),[a,r]=i.useState(!0),[n,c]=i.useState(""),[l,x]=i.useState("all"),[f,j]=i.useState(!1),[N,g]=i.useState(!1),[u,d]=i.useState(null),{toast:h}=Z(),{user:v}=je(),[p,m]=i.useState({company_name:"",opportunity_type:"buyer",commodity:"",target_market:[],quantity_required:"",unit:"tons",price_range_min:"",price_range_max:"",quality_standards:[],delivery_terms:"FOB",payment_terms:"",description:"",location:"",contact_phone:"",contact_email:""}),[o,y]=i.useState({message:"",proposed_price:"",proposed_quantity:"",contact_phone:"",contact_email:""});i.useEffect(()=>{k()},[]);async function k(){r(!0);try{const{data:M,error:O}=await F.from("export_opportunities").select("*").eq("status","active").order("created_at",{ascending:!1});if(O)throw O;t(M||[])}catch(M){console.error("Error fetching opportunities:",M),h({title:"Error",description:"Failed to load export opportunities",variant:"destructive"})}finally{r(!1)}}const A=async()=>{if(!v){h({title:"Authentication Required",description:"Please sign in to post opportunities",variant:"destructive"});return}try{const{data:M,error:O}=await F.from("export_opportunities").insert([{poster_id:v.id,...p,quantity_required:parseFloat(p.quantity_required),price_range_min:p.price_range_min?parseFloat(p.price_range_min):null,price_range_max:p.price_range_max?parseFloat(p.price_range_max):null}]).select().single();if(O)throw O;h({title:"Success",description:"Export opportunity posted successfully"}),j(!1),k()}catch(M){h({title:"Error",description:M.message||"Failed to post opportunity",variant:"destructive"})}},S=async()=>{if(!(!v||!u))try{const{error:M}=await F.from("export_opportunity_responses").insert([{opportunity_id:u.id,responder_id:v.id,response_type:"bid",message:o.message,proposed_price:o.proposed_price?parseFloat(o.proposed_price):null,proposed_quantity:o.proposed_quantity?parseFloat(o.proposed_quantity):null,contact_phone:o.contact_phone,contact_email:o.contact_email}]);if(M)throw M;await F.from("export_opportunities").update({response_count:(u.response_count||0)+1}).eq("id",u.id),h({title:"Success",description:"Response sent successfully"}),g(!1),y({message:"",proposed_price:"",proposed_quantity:"",contact_phone:"",contact_email:""}),k()}catch(M){h({title:"Error",description:M.message||"Failed to send response",variant:"destructive"})}},E=s.filter(M=>{const O=M.company_name.toLowerCase().includes(n.toLowerCase())||M.commodity.toLowerCase().includes(n.toLowerCase()),te=l==="all"||M.opportunity_type===l;return O&&te}),[P,R]=i.useState(!0);return e.jsxs("div",{className:"min-h-screen bg-background pb-20 md:pb-0",children:[e.jsx(ne,{}),P&&e.jsx(_s,{marketplaceType:"export-market",onAccept:()=>R(!1)}),e.jsx("section",{className:"bg-gradient-to-r from-blue-600 to-blue-800 text-white py-16",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx(_r,{className:"h-12 w-12"}),e.jsx("h1",{className:"text-4xl md:text-5xl font-bold",children:"Export Market Opportunities"})]}),e.jsx("p",{className:"text-xl mb-6 max-w-2xl",children:"Connect with international buyers, exporters, and certification bodies. Access global markets and grow your agricultural export business."}),e.jsx("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4 max-w-3xl",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(hs,{className:"h-5 w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Willing Buyer â€“ Willing Seller Marketplace"}),e.jsx("p",{className:"text-sm opacity-90",children:"SokoConnect connects buyers and sellers but does not guarantee transactions. Always verify export documentation and payment terms before proceeding."})]})]})})]})}),e.jsxs("main",{className:"py-12 px-4 md:px-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-8",children:[e.jsx(D,{placeholder:"Search opportunities...",value:n,onChange:M=>c(M.target.value),className:"flex-1"}),e.jsxs(Q,{value:l,onValueChange:x,children:[e.jsx(W,{className:"w-full md:w-48",children:e.jsx(J,{placeholder:"All Types"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Types"}),e.jsx(T,{value:"buyer",children:"Buyers"}),e.jsx(T,{value:"exporter",children:"Exporters"}),e.jsx(T,{value:"certification",children:"Certification"}),e.jsx(T,{value:"logistics",children:"Logistics"})]})]}),v&&e.jsxs(_e,{open:f,onOpenChange:j,children:[e.jsx(Ie,{asChild:!0,children:e.jsxs(b,{children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Post Opportunity"]})}),e.jsxs(we,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Ce,{children:e.jsx(ke,{children:"Post Export Opportunity"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Company Name *"}),e.jsx(D,{value:p.company_name,onChange:M=>m({...p,company_name:M.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Opportunity Type *"}),e.jsxs(Q,{value:p.opportunity_type,onValueChange:M=>m({...p,opportunity_type:M}),children:[e.jsx(W,{children:e.jsx(J,{})}),e.jsxs(Y,{children:[e.jsx(T,{value:"buyer",children:"Buyer"}),e.jsx(T,{value:"exporter",children:"Exporter"}),e.jsx(T,{value:"certification",children:"Certification"}),e.jsx(T,{value:"logistics",children:"Logistics"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Commodity *"}),e.jsx(D,{value:p.commodity,onChange:M=>m({...p,commodity:M.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Location *"}),e.jsx(D,{value:p.location,onChange:M=>m({...p,location:M.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Quantity Required *"}),e.jsx(D,{type:"number",value:p.quantity_required,onChange:M=>m({...p,quantity_required:M.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Unit *"}),e.jsxs(Q,{value:p.unit,onValueChange:M=>m({...p,unit:M}),children:[e.jsx(W,{children:e.jsx(J,{})}),e.jsxs(Y,{children:[e.jsx(T,{value:"tons",children:"Tons"}),e.jsx(T,{value:"kg",children:"Kilograms"}),e.jsx(T,{value:"containers",children:"Containers"})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Delivery Terms *"}),e.jsxs(Q,{value:p.delivery_terms,onValueChange:M=>m({...p,delivery_terms:M}),children:[e.jsx(W,{children:e.jsx(J,{})}),e.jsxs(Y,{children:[e.jsx(T,{value:"FOB",children:"FOB"}),e.jsx(T,{value:"CIF",children:"CIF"}),e.jsx(T,{value:"EXW",children:"EXW"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Min Price (USD)"}),e.jsx(D,{type:"number",value:p.price_range_min,onChange:M=>m({...p,price_range_min:M.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Max Price (USD)"}),e.jsx(D,{type:"number",value:p.price_range_max,onChange:M=>m({...p,price_range_max:M.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Payment Terms *"}),e.jsx(D,{value:p.payment_terms,onChange:M=>m({...p,payment_terms:M.target.value}),placeholder:"e.g., 30% advance, 70% on delivery"})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Description *"}),e.jsx(le,{value:p.description,onChange:M=>m({...p,description:M.target.value}),rows:4})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Contact Phone *"}),e.jsx(D,{value:p.contact_phone,onChange:M=>m({...p,contact_phone:M.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Contact Email"}),e.jsx(D,{type:"email",value:p.contact_email,onChange:M=>m({...p,contact_email:M.target.value})})]})]}),e.jsx(b,{onClick:A,className:"w-full",children:"Post Opportunity"})]})]})]})]}),e.jsx("div",{className:"grid gap-6",children:a?e.jsx("div",{className:"text-center py-12",children:"Loading opportunities..."}):E.length===0?e.jsx(w,{className:"text-center py-16",children:e.jsxs(_,{children:[e.jsx(_r,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No opportunities available"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"There are currently no export opportunities matching your criteria. Be the first to post an opportunity or check back later."}),v&&e.jsxs(b,{onClick:()=>j(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Post First Opportunity"]})]})}):E.map(M=>e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs(L,{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ye,{className:"h-5 w-5"}),M.company_name]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{variant:"default",children:M.opportunity_type}),e.jsx(I,{variant:"outline",children:M.commodity})]})]}),M.response_count>0&&e.jsxs(I,{variant:"secondary",children:[e.jsx(Ue,{className:"h-3 w-3 mr-1"}),M.response_count," responses"]})]})}),e.jsxs(_,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:M.description}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4"}),e.jsxs("span",{className:"font-medium",children:[M.quantity_required," ",M.unit," required"]})]}),M.price_range_min&&M.price_range_max&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsxs("span",{children:[M.currency," ",M.price_range_min.toLocaleString()," - ",M.price_range_max.toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"h-4 w-4"}),e.jsx("span",{children:M.target_market.join(", ")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4"}),e.jsxs("span",{children:["Posted ",new Date(M.created_at).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsxs(b,{onClick:()=>{d(M),g(!0)},children:[e.jsx(sa,{className:"h-4 w-4 mr-2"}),"Respond to Opportunity"]}),e.jsx(b,{variant:"outline",children:"View Details"})]})]})]},M.id))})]}),e.jsx(_e,{open:N,onOpenChange:g,children:e.jsxs(we,{className:"max-w-xl",children:[e.jsx(Ce,{children:e.jsx(ke,{children:"Respond to Export Opportunity"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Your Message *"}),e.jsx(le,{value:o.message,onChange:M=>y({...o,message:M.target.value}),rows:4,placeholder:"Introduce your business and explain why you're a good fit..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Proposed Price (USD)"}),e.jsx(D,{type:"number",value:o.proposed_price,onChange:M=>y({...o,proposed_price:M.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Proposed Quantity"}),e.jsx(D,{type:"number",value:o.proposed_quantity,onChange:M=>y({...o,proposed_quantity:M.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Contact Phone *"}),e.jsx(D,{value:o.contact_phone,onChange:M=>y({...o,contact_phone:M.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Contact Email"}),e.jsx(D,{type:"email",value:o.contact_email,onChange:M=>y({...o,contact_email:M.target.value})})]})]}),e.jsx(b,{onClick:S,className:"w-full",children:"Send Response"})]})]})}),e.jsx(Me,{})]})},Yt=[{id:"1",commodity:"Maize",price:45,unit:"kg",market:"Eldoret Grain Market",county:"Uasin Gishu",trend:"up",changePercent:5.2,lastUpdated:"2025-02-01"},{id:"2",commodity:"Beans",price:120,unit:"kg",market:"Wakulima Market",county:"Nairobi",trend:"down",changePercent:-3.1,lastUpdated:"2025-02-01"},{id:"3",commodity:"Potatoes",price:55,unit:"kg",market:"Nakuru Main Market",county:"Nakuru",trend:"stable",changePercent:.2,lastUpdated:"2025-02-01"},{id:"4",commodity:"Tomatoes",price:130,unit:"kg",market:"Gikomba Market",county:"Nairobi",trend:"up",changePercent:8.5,lastUpdated:"2025-02-01"},{id:"5",commodity:"Onions",price:85,unit:"kg",market:"Kongowea Market",county:"Mombasa",trend:"down",changePercent:-2.4,lastUpdated:"2025-02-01"},{id:"6",commodity:"Avocados",price:150,unit:"kg",market:"Thika Market",county:"Kiambu",trend:"up",changePercent:12.3,lastUpdated:"2025-02-01"},{id:"7",commodity:"Mangoes",price:90,unit:"kg",market:"Mombasa Fruit Market",county:"Mombasa",trend:"stable",changePercent:.5,lastUpdated:"2025-02-01"},{id:"8",commodity:"Rice",price:180,unit:"kg",market:"Mwea Market",county:"Kirinyaga",trend:"up",changePercent:3.8,lastUpdated:"2025-02-01"}],Zh=()=>{const s=Ne(),[t,a]=i.useState("all"),[r,n]=i.useState("all"),[c,l]=i.useState(Yt);i.useEffect(()=>{let g=[...Yt];t!=="all"&&(g=g.filter(u=>u.commodity.toLowerCase()===t.toLowerCase())),r!=="all"&&(g=g.filter(u=>u.county.toLowerCase()===r.toLowerCase())),l(g)},[t,r]);const x=g=>{switch(g){case"up":return e.jsx(ce,{className:"h-4 w-4 text-green-600"});case"down":return e.jsx(Fs,{className:"h-4 w-4 text-red-600"});default:return e.jsx(Zc,{className:"h-4 w-4 text-gray-500"})}},f=g=>{switch(g){case"up":return"text-green-600 bg-green-50";case"down":return"text-red-600 bg-red-50";default:return"text-gray-600 bg-gray-50"}},j=[...new Set(Yt.map(g=>g.commodity))],N=[...new Set(Yt.map(g=>g.county))];return e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(ne,{}),e.jsx("section",{className:"bg-gradient-to-r from-blue-600 to-green-600 text-white py-12",children:e.jsxs("div",{className:"container mx-auto px-4 text-center",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"Real-Time Market Prices"}),e.jsx("p",{className:"text-xl opacity-90 max-w-2xl mx-auto",children:"Access up-to-date commodity prices from markets across Kenya"})]})}),e.jsxs("div",{className:"container mx-auto px-4 py-8 flex-1",children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Commodity"}),e.jsxs(Q,{value:t,onValueChange:a,children:[e.jsx(W,{children:e.jsx(J,{placeholder:"All Commodities"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Commodities"}),j.map(g=>e.jsx(T,{value:g.toLowerCase(),children:g},g))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"County"}),e.jsxs(Q,{value:r,onValueChange:n,children:[e.jsx(W,{children:e.jsx(J,{placeholder:"All Counties"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Counties"}),N.map(g=>e.jsx(T,{value:g.toLowerCase(),children:g},g))]})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(b,{variant:"outline",className:"w-full",onClick:()=>{a("all"),n("all")},children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"})," Clear Filters"]})})]}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:c.map(g=>e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(q,{className:"pb-2",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(L,{className:"text-lg",children:g.commodity}),e.jsxs(I,{className:f(g.trend),children:[x(g.trend),e.jsxs("span",{className:"ml-1",children:[Math.abs(g.changePercent),"%"]})]})]})}),e.jsxs(_,{children:[e.jsxs("div",{className:"text-3xl font-bold text-primary mb-2",children:["KES ",g.price,"/",g.unit]}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground mb-1",children:[e.jsx(ee,{className:"h-3 w-3 mr-1"}),g.market]}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(xe,{className:"h-3 w-3 mr-1"}),g.lastUpdated]})]})]},g.id))}),c.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ce,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium",children:"No prices found"}),e.jsx("p",{className:"text-muted-foreground",children:"Try adjusting your filters"})]}),e.jsxs(w,{className:"mt-8",children:[e.jsx(q,{children:e.jsx(L,{children:"Explore More Market Data"})}),e.jsx(_,{children:e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs(b,{variant:"outline",className:"justify-between",onClick:()=>s("/market-demand-hotspot"),children:["Demand Hotspots ",e.jsx(ks,{className:"h-4 w-4"})]}),e.jsxs(b,{variant:"outline",className:"justify-between",onClick:()=>s("/price-trends"),children:["Price Trends ",e.jsx(ks,{className:"h-4 w-4"})]}),e.jsxs(b,{variant:"outline",className:"justify-between",onClick:()=>s("/kilimo-ams-data"),children:["Kilimo AMS Data ",e.jsx(ks,{className:"h-4 w-4"})]})]})})]})]}),e.jsx(Nt,{}),e.jsx(el,{})]})},ep=()=>{const s=Ne();return i.useEffect(()=>{s("/partners-showcase",{replace:!0})},[s]),e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"text-center",children:e.jsx("p",{children:"Redirecting to Partners..."})})})},Jr=()=>{const[s,t]=i.useState([]),[a,r]=i.useState([]),[n,c]=i.useState(""),[l,x]=i.useState(!0);i.useEffect(()=>{f()},[]);const f=async()=>{try{const{data:N}=await F.from("agricultural_events").select("*").eq("event_type","networking").order("start_date",{ascending:!0}).limit(6),{data:g}=await F.from("profiles").select("user_id, full_name, county, farming_type, bio, avatar_url").not("full_name","is",null).limit(12);t(N||[]),r(g||[])}catch(N){console.error("Error fetching networking data:",N)}finally{x(!1)}},j=[{icon:e.jsx(se,{className:"h-8 w-8 text-green-600"}),title:"Farmer Directory",description:"Connect with farmers across all 47 counties in Kenya",count:"5,000+"},{icon:e.jsx(Tt,{className:"h-8 w-8 text-blue-600"}),title:"Business Matching",description:"Find buyers, suppliers, and partners for your farm",count:"500+"},{icon:e.jsx(Cr,{className:"h-8 w-8 text-purple-600"}),title:"Mentorship Programs",description:"Learn from experienced farmers and agribusiness experts",count:"200+"},{icon:e.jsx(xe,{className:"h-8 w-8 text-orange-600"}),title:"Networking Events",description:"Attend agricultural expos, workshops, and field days",count:"50+"}];return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(ne,{}),e.jsx("section",{className:"bg-gradient-to-br from-green-700 via-green-600 to-emerald-500 text-white py-16",children:e.jsxs("div",{className:"container mx-auto px-4 text-center",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-4",children:"Agricultural Networking Hub"}),e.jsx("p",{className:"text-xl mb-8 max-w-3xl mx-auto opacity-90",children:"Connect with farmers, buyers, suppliers, and agricultural experts across Kenya. Build partnerships that grow your farm business."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center max-w-xl mx-auto",children:[e.jsxs("div",{className:"relative flex-1 w-full",children:[e.jsx(Pe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx(D,{placeholder:"Search farmers, events, or opportunities...",value:n,onChange:N=>c(N.target.value),className:"pl-10 bg-white/10 border-white/20 text-white placeholder:text-white/60"})]}),e.jsx(b,{size:"lg",variant:"secondary",children:"Find Connections"})]})]})}),e.jsx("section",{className:"py-12 bg-muted/30",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:j.map((N,g)=>e.jsx(w,{className:"text-center hover:shadow-lg transition-shadow",children:e.jsxs(_,{className:"pt-6",children:[e.jsx("div",{className:"flex justify-center mb-3",children:N.icon}),e.jsx("div",{className:"text-2xl font-bold text-primary mb-1",children:N.count}),e.jsx("h3",{className:"font-semibold mb-1",children:N.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:N.description})]})},g))})})}),e.jsx("section",{className:"py-12",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs(ge,{defaultValue:"farmers",className:"space-y-8",children:[e.jsxs(pe,{className:"grid w-full max-w-lg mx-auto grid-cols-3",children:[e.jsx(B,{value:"farmers",children:"Farmers"}),e.jsx(B,{value:"events",children:"Events"}),e.jsx(B,{value:"opportunities",children:"Opportunities"})]}),e.jsxs(V,{value:"farmers",className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Connect with Farmers"}),e.jsx("p",{className:"text-muted-foreground",children:"Find and connect with farmers across Kenya"})]}),l?e.jsx("div",{className:"text-center py-12",children:"Loading farmers..."}):e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:a.length>0?a.map(N=>e.jsx(w,{className:"hover:shadow-lg transition-shadow",children:e.jsxs(_,{className:"pt-6 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-primary/10 rounded-full mx-auto mb-4 flex items-center justify-center",children:N.avatar_url?e.jsx("img",{src:N.avatar_url,alt:N.full_name,className:"w-full h-full rounded-full object-cover"}):e.jsx(se,{className:"h-10 w-10 text-primary"})}),e.jsx("h3",{className:"font-semibold mb-1",children:N.full_name||"Anonymous Farmer"}),e.jsxs("div",{className:"flex items-center justify-center gap-1 text-sm text-muted-foreground mb-2",children:[e.jsx(ee,{className:"h-3 w-3"}),N.county||"Kenya"]}),N.farming_type&&e.jsx(I,{variant:"secondary",className:"mb-3",children:N.farming_type}),e.jsxs(b,{size:"sm",className:"w-full",variant:"outline",children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Connect"]})]})},N.user_id)):e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx(se,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No farmers found. Be the first to join!"})]})})]}),e.jsxs(V,{value:"events",className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Networking Events"}),e.jsx("p",{className:"text-muted-foreground",children:"Upcoming agricultural networking events"})]}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.length>0?s.map(N=>e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(q,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(I,{children:N.event_type}),e.jsx(I,{variant:"outline",children:N.county})]}),e.jsx(L,{className:"text-lg",children:N.title}),e.jsxs(G,{children:[e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(xe,{className:"h-4 w-4"}),new Date(N.start_date).toLocaleDateString()]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(ee,{className:"h-4 w-4"}),N.location]})]})]}),e.jsx(_,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[N.current_participants||0,"/",N.max_participants||"âˆž"," participants"]}),e.jsx(b,{size:"sm",children:"Register"})]})})]},N.id)):e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx(xe,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No upcoming events. Check back soon!"})]})})]}),e.jsxs(V,{value:"opportunities",className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Business Opportunities"}),e.jsx("p",{className:"text-muted-foreground",children:"Find partnerships, buyers, and investment opportunities"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs(w,{className:"hover:shadow-lg transition-shadow border-l-4 border-l-green-500",children:[e.jsxs(q,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Pi,{className:"h-5 w-5 text-green-500"}),e.jsx(I,{className:"bg-green-100 text-green-800",children:"Buyer Request"})]}),e.jsx(L,{className:"text-lg",children:"Bulk Maize Purchase"}),e.jsx(G,{children:"Looking for 50 tonnes of Grade A maize in Nakuru region"})]}),e.jsx(_,{children:e.jsx(b,{size:"sm",className:"w-full",children:"View Details"})})]}),e.jsxs(w,{className:"hover:shadow-lg transition-shadow border-l-4 border-l-blue-500",children:[e.jsxs(q,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ce,{className:"h-5 w-5 text-blue-500"}),e.jsx(I,{className:"bg-blue-100 text-blue-800",children:"Partnership"})]}),e.jsx(L,{className:"text-lg",children:"Export Partnership"}),e.jsx(G,{children:"Seeking farmers to supply avocados for export market"})]}),e.jsx(_,{children:e.jsx(b,{size:"sm",className:"w-full",children:"View Details"})})]}),e.jsxs(w,{className:"hover:shadow-lg transition-shadow border-l-4 border-l-purple-500",children:[e.jsxs(q,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Cr,{className:"h-5 w-5 text-purple-500"}),e.jsx(I,{className:"bg-purple-100 text-purple-800",children:"Mentorship"})]}),e.jsx(L,{className:"text-lg",children:"Dairy Farming Mentor"}),e.jsx(G,{children:"Experienced dairy farmer offering mentorship to beginners"})]}),e.jsx(_,{children:e.jsx(b,{size:"sm",className:"w-full",children:"View Details"})})]})]})]})]})})}),e.jsx("section",{className:"py-16 bg-primary text-primary-foreground",children:e.jsxs("div",{className:"container mx-auto px-4 text-center",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Ready to Grow Your Network?"}),e.jsx("p",{className:"text-xl mb-8 max-w-2xl mx-auto opacity-90",children:"Join thousands of farmers and agribusiness professionals on SokoConnect"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[e.jsxs(b,{size:"lg",variant:"secondary",children:[e.jsx(Qa,{className:"h-4 w-4 mr-2"}),"Create Profile"]}),e.jsxs(b,{size:"lg",variant:"outline",className:"border-white text-white hover:bg-white/10",children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),"Browse Directory"]})]})]})}),e.jsx(Nt,{})]})},sp=()=>{const{toast:s}=Z();Ne();const[t,a]=i.useState(""),[r,n]=i.useState(!1),[c,l]=i.useState(!1),x=async f=>{if(f.preventDefault(),!t){s({title:"Error",description:"Please enter your email address",variant:"destructive"});return}n(!0);try{const{error:j}=await F.auth.resetPasswordForEmail(t,{redirectTo:`${window.location.origin}/update-password`});if(j)throw j;l(!0),s({title:"Reset Link Sent",description:"Check your email for the password reset link."})}catch(j){s({title:"Error",description:j.message||"Failed to send reset link. Please try again.",variant:"destructive"})}finally{n(!1)}};return e.jsxs("div",{className:"min-h-screen relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{backgroundImage:`url(${xa})`,filter:"blur(8px)",transform:"scale(1.1)"}}),e.jsx("div",{className:"absolute inset-0 bg-black/50"}),e.jsx("div",{className:"relative z-10 min-h-screen flex items-center justify-center p-6",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("img",{src:sr,alt:"SokoConnect Logo",className:"h-16 w-16 object-contain"})}),e.jsxs("h1",{className:"text-3xl font-bold mb-2",children:[e.jsx("span",{className:"text-white",children:"Soko"}),e.jsx("span",{className:"text-green-400",children:"Connect"})]})]}),e.jsxs(w,{className:"backdrop-blur-md bg-white/10 border-white/20 shadow-2xl",children:[e.jsxs(q,{className:"text-center",children:[e.jsx(L,{className:"text-xl text-white",children:"Reset Password"}),e.jsx(G,{className:"text-gray-200",children:c?"Check your email for the reset link":"Enter your email to receive a password reset link"})]}),e.jsx(_,{children:c?e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-500/20 mb-4",children:e.jsx(fe,{className:"h-8 w-8 text-green-400"})}),e.jsxs("p",{className:"text-white mb-4",children:["We've sent a password reset link to ",e.jsx("strong",{children:t})]}),e.jsx("p",{className:"text-sm text-gray-300 mb-6",children:"Didn't receive the email? Check your spam folder or try again."}),e.jsx(b,{variant:"outline",onClick:()=>l(!1),className:"bg-white/20 border-white/30 text-white hover:bg-white/30",children:"Try Another Email"})]}):e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"email",className:"text-white",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(He,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(D,{id:"email",type:"email",placeholder:"your.email@example.com",value:t,onChange:f=>a(f.target.value),className:"bg-white/20 border-white/30 text-white placeholder:text-gray-300 pl-10",required:!0})]})]}),e.jsx(b,{type:"submit",className:"w-full bg-gradient-to-r from-green-500 to-blue-600 hover:from-green-600 hover:to-blue-700 text-white font-semibold py-3",disabled:r,children:r?"Sending...":"Send Reset Link"})]})}),e.jsx(me,{className:"flex justify-center",children:e.jsxs(X,{to:"/auth",className:"flex items-center gap-2 text-sm text-gray-300 hover:text-white transition-colors",children:[e.jsx(Wa,{className:"h-4 w-4"}),"Back to Sign In"]})})]})]})})]})},tp=()=>{const{toast:s}=Z(),t=Ne(),[a,r]=i.useState(""),[n,c]=i.useState(""),[l,x]=i.useState(!1),[f,j]=i.useState(!1),[N,g]=i.useState(!1);i.useEffect(()=>{(async()=>{const{data:{session:h}}=await F.auth.getSession();h||(s({title:"Invalid or Expired Link",description:"Please request a new password reset link.",variant:"destructive"}),t("/reset-password"))})()},[t,s]);const u=async d=>{if(d.preventDefault(),a.length<6){s({title:"Error",description:"Password must be at least 6 characters long",variant:"destructive"});return}if(a!==n){s({title:"Error",description:"Passwords do not match",variant:"destructive"});return}x(!0);try{const{error:h}=await F.auth.updateUser({password:a});if(h)throw h;g(!0),s({title:"Password Updated",description:"Your password has been successfully updated."}),setTimeout(()=>{t("/")},2e3)}catch(h){s({title:"Error",description:h.message||"Failed to update password. Please try again.",variant:"destructive"})}finally{x(!1)}};return e.jsxs("div",{className:"min-h-screen relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{backgroundImage:`url(${xa})`,filter:"blur(8px)",transform:"scale(1.1)"}}),e.jsx("div",{className:"absolute inset-0 bg-black/50"}),e.jsx("div",{className:"relative z-10 min-h-screen flex items-center justify-center p-6",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("img",{src:sr,alt:"SokoConnect Logo",className:"h-16 w-16 object-contain"})}),e.jsxs("h1",{className:"text-3xl font-bold mb-2",children:[e.jsx("span",{className:"text-white",children:"Soko"}),e.jsx("span",{className:"text-green-400",children:"Connect"})]})]}),e.jsxs(w,{className:"backdrop-blur-md bg-white/10 border-white/20 shadow-2xl",children:[e.jsxs(q,{className:"text-center",children:[e.jsx(L,{className:"text-xl text-white",children:"Set New Password"}),e.jsx(G,{className:"text-gray-200",children:N?"Your password has been updated":"Enter your new password below"})]}),e.jsx(_,{children:N?e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-500/20 mb-4",children:e.jsx(fe,{className:"h-8 w-8 text-green-400"})}),e.jsx("p",{className:"text-white mb-4",children:"Your password has been successfully updated!"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Redirecting you to the home page..."})]}):e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"password",className:"text-white",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ft,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(D,{id:"password",type:f?"text":"password",value:a,onChange:d=>r(d.target.value),className:"bg-white/20 border-white/30 text-white placeholder:text-gray-300 pl-10 pr-10",required:!0,minLength:6}),e.jsx("button",{type:"button",onClick:()=>j(!f),className:"absolute right-3 top-3 text-gray-400 hover:text-white",children:f?e.jsx(eo,{className:"h-4 w-4"}):e.jsx(qs,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-xs text-gray-300",children:"Must be at least 6 characters long"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"confirmPassword",className:"text-white",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ft,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(D,{id:"confirmPassword",type:f?"text":"password",value:n,onChange:d=>c(d.target.value),className:"bg-white/20 border-white/30 text-white placeholder:text-gray-300 pl-10",required:!0})]})]}),e.jsx(b,{type:"submit",className:"w-full bg-gradient-to-r from-green-500 to-blue-600 hover:from-green-600 hover:to-blue-700 text-white font-semibold py-3",disabled:l,children:l?"Updating...":"Update Password"})]})})]})]})})]})},ap=()=>{var d;const{userId:s}=cn(),t=Ne(),[a,r]=i.useState(null),[n,c]=i.useState(null),[l,x]=i.useState(null),[f,j]=i.useState(!0);i.useEffect(()=>{s&&N()},[s]);const N=async()=>{var h;try{j(!0);const{data:v,error:p}=await F.from("profiles").select("*").eq("user_id",s).single();if(p)throw p;r(v);const{data:m}=await F.from("trust_points").select("*").eq("user_id",s).single();m&&c(m);const{data:o}=await F.from("qr_codes").select("id").eq("user_id",s).eq("is_active",!0).single();if(o){const{data:y,count:k}=await F.from("qr_scans").select("scanned_by_user_id, created_at",{count:"exact"}).eq("qr_code_id",o.id).order("created_at",{ascending:!1});if(y){const A=new Set(y.map(S=>S.scanned_by_user_id)).size;x({total_scans:k||0,unique_scanners:A,last_scan:((h=y[0])==null?void 0:h.created_at)||""})}}}catch(v){console.error("Error loading profile:",v)}finally{j(!1)}},g=h=>{switch(h){case"diamond":return"bg-gradient-to-r from-purple-500 to-pink-500";case"platinum":return"bg-gradient-to-r from-gray-400 to-gray-600";case"gold":return"bg-gradient-to-r from-yellow-400 to-yellow-600";case"silver":return"bg-gradient-to-r from-gray-300 to-gray-400";default:return"bg-gradient-to-r from-orange-400 to-orange-600"}},u=h=>{switch(h){case"diamond":case"platinum":return"ðŸ’Ž";case"gold":return"ðŸ¥‡";case"silver":return"ðŸ¥ˆ";default:return"ðŸ¥‰"}};return f?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-pulse text-lg",children:"Loading profile..."})}):a?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 py-8 px-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsx(w,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-6",children:[e.jsxs(Us,{className:"h-24 w-24",children:[e.jsx(rt,{src:a.avatar_url}),e.jsx(Vs,{className:"text-2xl",children:((d=a.full_name)==null?void 0:d.charAt(0))||"U"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h1",{className:"text-3xl font-bold",children:a.full_name}),e.jsx(ns,{className:"h-6 w-6 text-green-500"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.jsxs(I,{variant:"secondary",className:"flex items-center gap-1",children:[e.jsx(Ve,{className:"h-3 w-3"}),"Verified Seller"]}),e.jsxs(I,{variant:"outline",children:["Member since ",kr(new Date(a.created_at),"MMM yyyy")]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[a.location&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:a.location})]}),a.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:a.phone})]})]})]})]})}),n&&e.jsx(w,{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:`inline-block px-6 py-3 rounded-full ${g(n.level)} text-white font-bold text-lg`,children:[u(n.level)," ",n.level.toUpperCase()," LEVEL"]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Ps,{className:"h-8 w-8 mx-auto mb-2 text-primary"}),e.jsx("div",{className:"text-3xl font-bold",children:n.total_points}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Trust Points"})]}),l&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center",children:[e.jsx(se,{className:"h-8 w-8 mx-auto mb-2 text-primary"}),e.jsx("div",{className:"text-3xl font-bold",children:l.unique_scanners}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Unique Verifiers"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(ce,{className:"h-8 w-8 mx-auto mb-2 text-primary"}),e.jsx("div",{className:"text-3xl font-bold",children:l.total_scans}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Scans"})]})]})]}),n.last_earned_at&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Last point earned: ",kr(new Date(n.last_earned_at),"PPp")]})]})}),e.jsx(w,{className:"p-6 bg-blue-50 border-blue-200",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ve,{className:"h-6 w-6 text-blue-600 mt-1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"What is a Trust Passport?"}),e.jsx("p",{className:"text-sm text-blue-800",children:"This seller has a verified Trust Passport on SokoConnect. Each time their QR code is scanned by a buyer, they earn trust points. Higher points mean more reliable and trustworthy sellers. The Trust Passport cannot be forged or manipulated."})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(b,{size:"lg",onClick:()=>t("/marketplace"),children:"Browse Products"}),e.jsx(b,{size:"lg",variant:"outline",onClick:()=>window.history.back(),children:"Go Back"})]})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs(w,{className:"p-8 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Profile Not Found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"This profile might not exist or has been removed"}),e.jsx(b,{onClick:()=>t("/"),children:"Go Home"})]})})},rp=({onScanComplete:s})=>{const[t,a]=i.useState(!1),[r,n]=i.useState(""),c=i.useRef(null),l=i.useRef(null),x=i.useRef(null),{toast:f}=Z(),j=Ne(),N="your-secret-key-change-in-production",g=(p,m)=>{const o=Oi.HmacSHA256(p,N).toString();return m===o};i.useEffect(()=>()=>{x.current&&x.current.getTracks().forEach(p=>p.stop())},[]);const u=async()=>{try{const p=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});x.current=p,c.current&&(c.current.srcObject=p,c.current.play()),a(!0),f({title:"Camera Active",description:"Point at a QR code or paste QR data below"})}catch(p){console.error("Camera error:",p),f({title:"Camera Unavailable",description:"You can paste QR code data manually instead.",variant:"destructive"}),a(!0)}},d=()=>{x.current&&(x.current.getTracks().forEach(p=>p.stop()),x.current=null),a(!1)},h=()=>{r.trim()&&(v(r.trim()),n(""))},v=async p=>{try{const m=JSON.parse(p);if(!m.data||!m.signature)throw new Error("Invalid QR code format");const o=JSON.stringify(m.data),y=g(o,m.signature);if(!y){f({title:"Invalid QR Code",description:"This QR code appears to be tampered with",variant:"destructive"});return}const{userId:k,userType:A,name:S,verified:E}=m.data,{data:{user:P}}=await F.auth.getUser();if(!P){f({title:"Login Required",description:"Please login to scan QR codes",variant:"destructive"});return}if(k===P.id){f({title:"Cannot Scan Own QR",description:"You cannot scan your own QR code",variant:"destructive"});return}const R=`${P.id}-${k}-${Date.now()}-${Math.random()}`,{data:M}=await F.from("qr_codes").select("id").eq("user_id",k).eq("is_active",!0).single();if(!M)throw new Error("QR code not found in database");const O=new Date(Date.now()-24*60*60*1e3).toISOString(),{data:te}=await F.from("qr_scans").select("id").eq("qr_code_id",M.id).eq("scanned_by_user_id",P.id).gte("created_at",O);if(te&&te.length>0){f({title:"Already Scanned Today",description:"You can only scan each QR code once per day",variant:"destructive"}),j(`/verify/${k}`);return}const{error:ue}=await F.from("qr_scans").insert({qr_code_id:M.id,scanned_by_user_id:P.id,scan_nonce:R,signature_valid:y,points_awarded:1,device_fingerprint:navigator.userAgent});if(ue)throw ue;const{error:z}=await F.rpc("award_trust_points",{p_user_id:k,p_points:1,p_transaction_type:"qr_scan",p_reference_id:M.id,p_metadata:{scanned_by:P.id,scan_time:new Date().toISOString()}});z&&console.error("Error awarding points:",z),f({title:"QR Code Scanned! âœ…",description:`${S} earned 1 trust point!`}),d(),j(`/verify/${k}`),s&&s(k,1)}catch(m){console.error("Error processing QR code:",m),f({title:"Processing Failed",description:"Could not process QR code data. Make sure it's a valid SokoConnect QR.",variant:"destructive"})}};return e.jsx(e.Fragment,{children:t?e.jsxs("div",{className:"fixed inset-0 z-50 bg-background flex flex-col",children:[e.jsxs("div",{className:"flex-1 relative overflow-hidden",children:[e.jsx("video",{ref:c,className:"w-full h-full object-cover",playsInline:!0,muted:!0}),e.jsx("canvas",{ref:l,className:"hidden"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:e.jsx("div",{className:"w-64 h-64 border-4 border-primary rounded-lg opacity-70"})}),e.jsx("div",{className:"absolute top-4 left-0 right-0 text-center",children:e.jsx("p",{className:"text-foreground text-lg font-semibold bg-background/80 inline-block px-4 py-2 rounded-full",children:"Point camera at QR code"})})]}),e.jsxs("div",{className:"p-4 bg-background border-t space-y-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Or paste QR data manually:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:r,onChange:p=>n(p.target.value),placeholder:"Paste QR code JSON data...",className:"flex-1 px-3 py-2 border rounded-md text-sm bg-background"}),e.jsx(b,{onClick:h,disabled:!r.trim(),children:"Submit"})]}),e.jsxs(b,{onClick:d,variant:"destructive",size:"lg",className:"w-full",children:[e.jsx(Be,{className:"h-5 w-5 mr-2"}),"Cancel Scan"]})]})]}):e.jsx(w,{className:"p-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(on,{className:"h-16 w-16 mx-auto text-primary"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Scan Trust Passport"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Scan a farmer's or provider's QR code to verify their profile and award trust points"})]}),e.jsxs(b,{onClick:u,size:"lg",className:"w-full",children:[e.jsx(zi,{className:"h-5 w-5 mr-2"}),"Start Scanning"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Camera access required â€¢ One scan per QR per day"})]})})})},ip=()=>{const[s,t]=i.useState(!1);return s?e.jsx(rp,{onScanComplete:()=>t(!1)}):e.jsx(b,{className:"fixed bottom-20 right-6 h-14 w-14 rounded-full shadow-lg z-40 md:bottom-6",size:"icon",onClick:()=>t(!0),children:e.jsx(on,{className:"h-6 w-6"})})},np=[{name:"User & Auth",icon:e.jsx(se,{className:"h-4 w-4"}),tables:["profiles","user_roles","auth_logs","trust_points","qr_codes","qr_scans"]},{name:"Marketplace",icon:e.jsx(rs,{className:"h-4 w-4"}),tables:["products","produce_listings","orders","transactions","reviews","favorites"]},{name:"Supply Chain",icon:e.jsx(ye,{className:"h-4 w-4"}),tables:["logistics_providers","shipments","fleet_routes","warehouses","inventory"]},{name:"Verification",icon:e.jsx(fe,{className:"h-4 w-4"}),tables:["verification_requests","certifications","compliance_records","inspections"]},{name:"Payments",icon:e.jsx(Ae,{className:"h-4 w-4"}),tables:["payments","subscriptions","invoices","payment_methods"]},{name:"Content",icon:e.jsx(Ue,{className:"h-4 w-4"}),tables:["posts","comments","notifications","announcements","faqs"]},{name:"Analytics",icon:e.jsx(Re,{className:"h-4 w-4"}),tables:["analytics_events","user_activity","performance_metrics"]},{name:"Admin",icon:e.jsx(Ve,{className:"h-4 w-4"}),tables:["admin_audit_log","system_settings","feature_flags"]}],lp=()=>{const[s,t]=i.useState(!0),[a,r]=i.useState(["User & Auth"]),[n,c]=i.useState(""),l=Ne(),x=Es(),{user:f}=je(),j=async()=>{await F.auth.signOut(),l("/auth")},N=d=>{r(h=>h.includes(d)?h.filter(v=>v!==d):[...h,d])},g=d=>x.pathname.includes(`/admin/tables/${d}`),u=np.map(d=>({...d,tables:d.tables.filter(h=>h.toLowerCase().includes(n.toLowerCase()))})).filter(d=>d.tables.length>0);return e.jsxs("div",{className:"flex h-screen bg-gray-50",children:[e.jsxs("aside",{className:`${s?"w-64":"w-0"} bg-white border-r border-gray-200 transition-all duration-300 overflow-hidden flex flex-col`,children:[e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"h-6 w-6 text-primary"}),e.jsx("h2",{className:"font-bold text-lg",children:"Admin Panel"})]}),e.jsx(b,{variant:"ghost",size:"icon",onClick:()=>t(!1),className:"md:hidden",children:e.jsx(Be,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Pe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(D,{placeholder:"Search tables...",value:n,onChange:d=>c(d.target.value),className:"pl-10"})]})]}),e.jsx(ut,{className:"flex-1 p-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs(b,{variant:x.pathname==="/admin"?"default":"ghost",className:"w-full justify-start",onClick:()=>l("/admin"),children:[e.jsx(so,{className:"h-4 w-4 mr-2"}),"Dashboard"]}),e.jsxs(b,{variant:x.pathname==="/admin/users"?"default":"ghost",className:"w-full justify-start",onClick:()=>l("/admin/users"),children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"User Management"]}),e.jsxs(b,{variant:x.pathname==="/admin/verifications"?"default":"ghost",className:"w-full justify-start",onClick:()=>l("/admin/verifications"),children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),"Verifications"]}),e.jsxs(b,{variant:x.pathname==="/admin/analytics"?"default":"ghost",className:"w-full justify-start",onClick:()=>l("/admin/analytics"),children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),"Analytics"]}),e.jsx("div",{className:"my-4 border-t border-gray-200"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-xs font-semibold text-muted-foreground",children:[e.jsx(st,{className:"h-3 w-3"}),"DATABASE TABLES"]}),u.map(d=>e.jsxs("div",{children:[e.jsxs(b,{variant:"ghost",className:"w-full justify-start",onClick:()=>N(d.name),children:[a.includes(d.name)?e.jsx(Lt,{className:"h-4 w-4 mr-2"}):e.jsx(ft,{className:"h-4 w-4 mr-2"}),d.icon,e.jsx("span",{className:"ml-2 flex-1 text-left",children:d.name}),e.jsx(I,{variant:"secondary",className:"ml-auto",children:d.tables.length})]}),a.includes(d.name)&&e.jsx("div",{className:"ml-6 mt-1 space-y-1",children:d.tables.map(h=>e.jsxs(b,{variant:g(h)?"secondary":"ghost",size:"sm",className:"w-full justify-start text-sm",onClick:()=>l(`/admin/tables/${h}`),children:[e.jsx(Ds,{className:"h-3 w-3 mr-2"}),h]},h))})]},d.name))]})]})}),e.jsxs("div",{className:"p-4 border-t border-gray-200",children:[e.jsx(w,{className:"p-3 bg-blue-50 border-blue-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-200 flex items-center justify-center",children:e.jsx(se,{className:"h-5 w-5 text-blue-700"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:f==null?void 0:f.email}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Admin"})]})]})}),e.jsxs(b,{variant:"ghost",className:"w-full justify-start mt-2",onClick:j,children:[e.jsx($a,{className:"h-4 w-4 mr-2"}),"Logout"]})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx("header",{className:"bg-white border-b border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(b,{variant:"ghost",size:"icon",onClick:()=>t(!0),className:s?"hidden":"block",children:e.jsx(la,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Admin Dashboard"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage all aspects of the SokoConnect platform"})]})]}),e.jsx(b,{onClick:()=>l("/"),children:"Back to App"})]})}),e.jsx("main",{className:"flex-1 overflow-auto p-6",children:e.jsx(to,{})})]})]})},cp=()=>{const s=[{title:"Total Users",value:"2,543",change:"+12.5%",icon:e.jsx(se,{className:"h-5 w-5"}),color:"text-blue-600"},{title:"Active Orders",value:"156",change:"+8.2%",icon:e.jsx(rs,{className:"h-5 w-5"}),color:"text-green-600"},{title:"Revenue (Monthly)",value:"KSh 1.2M",change:"+23.1%",icon:e.jsx(Ae,{className:"h-5 w-5"}),color:"text-yellow-600"},{title:"Trust Points Awarded",value:"8,432",change:"+45.3%",icon:e.jsx(Ps,{className:"h-5 w-5"}),color:"text-purple-600"},{title:"Products Listed",value:"1,234",change:"+15.7%",icon:e.jsx(re,{className:"h-5 w-5"}),color:"text-orange-600"},{title:"Pending Verifications",value:"23",change:"-5.2%",icon:e.jsx(fe,{className:"h-5 w-5"}),color:"text-red-600"}],t=[{action:"New user registered",user:"john@example.com",time:"2 minutes ago"},{action:"Order completed",user:"Order #1234",time:"15 minutes ago"},{action:"QR Code scanned",user:"Farmer John Doe",time:"1 hour ago"},{action:"Verification approved",user:"Exporter ABC Ltd",time:"2 hours ago"},{action:"Payment received",user:"KSh 15,000",time:"3 hours ago"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold",children:"Welcome to Admin Dashboard"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Monitor and manage all aspects of the SokoConnect platform"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map((a,r)=>e.jsx(w,{children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:a.title}),e.jsx("p",{className:"text-2xl font-bold mt-2",children:a.value}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(I,{variant:a.change.startsWith("+")?"default":"destructive",children:a.change}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"vs last month"})]})]}),e.jsx("div",{className:`${a.color}`,children:a.icon})]})})},r))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Recent Activity"}),e.jsx(G,{children:"Latest actions across the platform"})]}),e.jsx(_,{children:e.jsx("div",{className:"space-y-4",children:t.map((a,r)=>e.jsxs("div",{className:"flex items-center gap-4 pb-3 border-b last:border-0",children:[e.jsx(ao,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:a.action}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a.user})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:a.time})]},r))})})]}),e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Quick Actions"}),e.jsx(G,{children:"Common administrative tasks"})]}),e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{className:"p-4 text-left border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(se,{className:"h-5 w-5 mb-2 text-blue-600"}),e.jsx("p",{className:"font-medium text-sm",children:"Manage Users"})]}),e.jsxs("button",{className:"p-4 text-left border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(fe,{className:"h-5 w-5 mb-2 text-green-600"}),e.jsx("p",{className:"font-medium text-sm",children:"Verifications"})]}),e.jsxs("button",{className:"p-4 text-left border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(re,{className:"h-5 w-5 mb-2 text-orange-600"}),e.jsx("p",{className:"font-medium text-sm",children:"Products"})]}),e.jsxs("button",{className:"p-4 text-left border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(ce,{className:"h-5 w-5 mb-2 text-purple-600"}),e.jsx("p",{className:"font-medium text-sm",children:"Analytics"})]})]})})]})]})]})},op=()=>{const{tableName:s}=cn(),[t,a]=i.useState([]),[r,n]=i.useState([]),[c,l]=i.useState(!0),[x,f]=i.useState(""),[j,N]=i.useState(1),[g,u]=i.useState(0),[d,h]=i.useState(null),[v,p]=i.useState(!1),[m,o]=i.useState(!1),{toast:y}=Z(),k=20;i.useEffect(()=>{s&&(S(),A())},[s,j,x]);const A=async()=>{try{const{data:M,error:O}=await F.rpc("get_table_columns",{table_name:s});if(O){const{data:te}=await F.from(s).select("*").limit(1).single();if(te){const ue=Object.keys(te).map(z=>({column_name:z,data_type:typeof te[z],is_nullable:"YES"}));n(ue)}}else n(M||[])}catch(M){console.error("Error loading schema:",M)}},S=async()=>{if(s)try{l(!0);let M=F.from(s).select("*",{count:"exact"});if(x&&r.length>0){const ae=r.find(be=>["text","character varying","varchar"].includes(be.data_type.toLowerCase()));ae&&(M=M.ilike(ae.column_name,`%${x}%`))}const O=(j-1)*k,te=O+k-1;M=M.range(O,te),r.some(ae=>ae.column_name==="created_at")&&(M=M.order("created_at",{ascending:!1}));const{data:z,error:U,count:K}=await M;if(U)throw U;a(z||[]),u(K||0)}catch(M){console.error("Error loading table data:",M),y({title:"Error Loading Data",description:M.message,variant:"destructive"})}finally{l(!1)}},E=async M=>{if(confirm("Are you sure you want to delete this record?"))try{const{error:O}=await F.from(s).delete().eq("id",M);if(O)throw O;y({title:"Record Deleted",description:"Successfully deleted record"}),S()}catch(O){y({title:"Error Deleting Record",description:O.message,variant:"destructive"})}},P=()=>{const M=r.map(K=>K.column_name).join(","),O=t.map(K=>r.map(ae=>JSON.stringify(K[ae.column_name]||"")).join(",")),te=[M,...O].join(`
`),ue=new Blob([te],{type:"text/csv"}),z=URL.createObjectURL(ue),U=document.createElement("a");U.href=z,U.download=`${s}_${new Date().toISOString()}.csv`,U.click()},R=Math.ceil(g/k);return c&&t.length===0?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(Ss,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsx("div",{className:"space-y-4",children:e.jsxs(w,{children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-2xl capitalize",children:s==null?void 0:s.replace(/_/g," ")}),e.jsxs(G,{children:["Managing ",g," records"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(b,{onClick:()=>S(),variant:"outline",size:"sm",children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsxs(b,{onClick:P,variant:"outline",size:"sm",children:[e.jsx(ca,{className:"h-4 w-4 mr-2"}),"Export CSV"]}),e.jsxs(b,{onClick:()=>o(!0),size:"sm",children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Create New"]})]})]})}),e.jsxs(_,{children:[e.jsx("div",{className:"flex items-center gap-4 mb-4",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Pe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(D,{placeholder:"Search...",value:x,onChange:M=>{f(M.target.value),N(1)},className:"pl-10"})]})}),e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(Ls,{children:[e.jsx(Ms,{children:e.jsxs(Oe,{children:[r.slice(0,8).map(M=>e.jsx(oe,{className:"font-semibold",children:M.column_name},M.column_name)),e.jsx(oe,{className:"text-right",children:"Actions"})]})}),e.jsx(Is,{children:t.map((M,O)=>e.jsxs(Oe,{children:[r.slice(0,8).map(te=>e.jsx(de,{children:dp(M[te.column_name],te.data_type)},te.column_name)),e.jsx(de,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>{h(M),p(!0)},children:e.jsx(tt,{className:"h-4 w-4"})}),e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>E(M.id),children:e.jsx(at,{className:"h-4 w-4 text-destructive"})})]})})]},M.id||O))})]})}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",(j-1)*k+1," to ",Math.min(j*k,g)," of ",g]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{variant:"outline",size:"sm",onClick:()=>N(M=>Math.max(1,M-1)),disabled:j===1,children:e.jsx(Ga,{className:"h-4 w-4"})}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{className:"text-sm",children:["Page ",j," of ",R]})}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>N(M=>Math.min(R,M+1)),disabled:j===R,children:e.jsx(ft,{className:"h-4 w-4"})})]})]})]})]})})},dp=(s,t)=>{if(s==null)return e.jsx("span",{className:"text-muted-foreground italic",children:"null"});if(typeof s=="boolean")return e.jsx(I,{variant:s?"default":"secondary",children:s?"true":"false"});if(t.includes("timestamp")||t.includes("date"))return new Date(s).toLocaleString();if(typeof s=="object")return e.jsxs("span",{className:"text-xs text-muted-foreground",children:[JSON.stringify(s).slice(0,50),"..."]});const a=String(s);return a.length>50?`${a.slice(0,50)}...`:a},mp=()=>{const[s,t]=i.useState([]),[a,r]=i.useState(!0),[n,c]=i.useState(""),[l,x]=i.useState("all"),{toast:f}=Z();i.useEffect(()=>{j()},[n,l]);const j=async()=>{try{r(!0);let u=F.from("profiles").select(`
          *,
          user_roles (
            role
          ),
          trust_points (
            total_points,
            level
          )
        `);n&&(u=u.or(`full_name.ilike.%${n}%,email.ilike.%${n}%`));const{data:d,error:h}=await u.order("created_at",{ascending:!1});if(h)throw h;t(d||[])}catch(u){f({title:"Error Loading Users",description:u.message,variant:"destructive"})}finally{r(!1)}},N=async(u,d)=>{try{const{error:h}=await F.from("user_roles").upsert({user_id:u,role:d,assigned_at:new Date().toISOString()});if(h)throw h;f({title:"Role Updated",description:"User role has been successfully updated"}),j()}catch(h){f({title:"Error Updating Role",description:h.message,variant:"destructive"})}},g=async(u,d)=>{try{const{error:h}=await F.from("profiles").update({is_active:!d}).eq("user_id",u);if(h)throw h;f({title:d?"User Deactivated":"User Activated",description:"User status has been updated"}),j()}catch(h){f({title:"Error Updating Status",description:h.message,variant:"destructive"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold",children:"User Management"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage user accounts, roles, and permissions"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(w,{children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Users"}),e.jsx("p",{className:"text-2xl font-bold mt-2",children:s.length})]}),e.jsx(vs,{className:"h-5 w-5 text-blue-600"})]})})}),e.jsx(w,{children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Active Users"}),e.jsx("p",{className:"text-2xl font-bold mt-2",children:s.filter(u=>u.is_active).length})]}),e.jsx(Qa,{className:"h-5 w-5 text-green-600"})]})})}),e.jsx(w,{children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Admins"}),e.jsx("p",{className:"text-2xl font-bold mt-2",children:s.filter(u=>{var d,h;return((h=(d=u.user_roles)==null?void 0:d[0])==null?void 0:h.role)==="admin"}).length})]}),e.jsx(Ve,{className:"h-5 w-5 text-purple-600"})]})})}),e.jsx(w,{children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Suspended"}),e.jsx("p",{className:"text-2xl font-bold mt-2",children:s.filter(u=>!u.is_active).length})]}),e.jsx(ro,{className:"h-5 w-5 text-red-600"})]})})})]}),e.jsxs(w,{children:[e.jsx(q,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(L,{children:"All Users"}),e.jsx(G,{children:"View and manage user accounts"})]})})}),e.jsxs(_,{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Pe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(D,{placeholder:"Search by name or email...",value:n,onChange:u=>c(u.target.value),className:"pl-10"})]}),e.jsxs(Q,{value:l,onValueChange:x,children:[e.jsx(W,{className:"w-48",children:e.jsx(J,{placeholder:"Filter by role"})}),e.jsxs(Y,{children:[e.jsx(T,{value:"all",children:"All Roles"}),e.jsx(T,{value:"admin",children:"Admin"}),e.jsx(T,{value:"farmer",children:"Farmer"}),e.jsx(T,{value:"buyer",children:"Buyer"}),e.jsx(T,{value:"supplier",children:"Supplier"})]})]})]}),e.jsx("div",{className:"border rounded-lg",children:e.jsxs(Ls,{children:[e.jsx(Ms,{children:e.jsxs(Oe,{children:[e.jsx(oe,{children:"User"}),e.jsx(oe,{children:"Contact"}),e.jsx(oe,{children:"Role"}),e.jsx(oe,{children:"Trust Level"}),e.jsx(oe,{children:"Status"}),e.jsx(oe,{children:"Joined"}),e.jsx(oe,{className:"text-right",children:"Actions"})]})}),e.jsx(Is,{children:s.map(u=>{var d,h,v;return e.jsxs(Oe,{children:[e.jsx(de,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(vs,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:u.full_name||"N/A"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[u.user_id.slice(0,8),"..."]})]})]})}),e.jsx(de,{children:e.jsxs("div",{className:"space-y-1",children:[u.email&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(He,{className:"h-3 w-3"}),u.email]}),u.phone&&e.jsx("div",{className:"text-sm text-muted-foreground",children:u.phone})]})}),e.jsx(de,{children:e.jsxs(Q,{value:((h=(d=u.user_roles)==null?void 0:d[0])==null?void 0:h.role)||"user",onValueChange:p=>N(u.user_id,p),children:[e.jsx(W,{className:"w-32",children:e.jsx(J,{})}),e.jsxs(Y,{children:[e.jsx(T,{value:"user",children:"User"}),e.jsx(T,{value:"farmer",children:"Farmer"}),e.jsx(T,{value:"buyer",children:"Buyer"}),e.jsx(T,{value:"supplier",children:"Supplier"}),e.jsx(T,{value:"admin",children:"Admin"})]})]})}),e.jsx(de,{children:(v=u.trust_points)!=null&&v[0]?e.jsx("div",{children:e.jsxs(I,{variant:"secondary",children:[u.trust_points[0].level," - ",u.trust_points[0].total_points," pts"]})}):e.jsx("span",{className:"text-muted-foreground text-sm",children:"No points"})}),e.jsx(de,{children:e.jsx(I,{variant:u.is_active?"default":"destructive",children:u.is_active?"Active":"Suspended"})}),e.jsx(de,{children:e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(xe,{className:"h-3 w-3"}),new Date(u.created_at).toLocaleDateString()]})}),e.jsx(de,{className:"text-right",children:e.jsx(b,{variant:u.is_active?"destructive":"default",size:"sm",onClick:()=>g(u.user_id,u.is_active),children:u.is_active?"Suspend":"Activate"})})]},u.user_id)})})]})})]})]})]})},up=()=>{var m,o;const[s,t]=i.useState([]),[a,r]=i.useState(null),[n,c]=i.useState(!1),[l,x]=i.useState(""),[f,j]=i.useState(!0),{toast:N}=Z();i.useEffect(()=>{g()},[]);const g=async()=>{try{j(!0);const{data:y,error:k}=await F.from("profiles").select(`
          *,
          user_roles (role)
        `).in("verification_status",["pending","verified","rejected"]).order("created_at",{ascending:!1});if(k)throw k;t(y||[])}catch(y){N({title:"Error Loading Verifications",description:y.message,variant:"destructive"})}finally{j(!1)}},u=async y=>{try{const{error:k}=await F.from("profiles").update({verification_status:"verified",verified_at:new Date().toISOString()}).eq("user_id",y);if(k)throw k;await F.rpc("award_trust_points",{p_user_id:y,p_points:50,p_transaction_type:"bonus",p_metadata:{reason:"Account verified"}}),N({title:"Verification Approved",description:"User has been verified successfully"}),g(),c(!1)}catch(k){N({title:"Error Approving Verification",description:k.message,variant:"destructive"})}},d=async y=>{try{const{error:k}=await F.from("profiles").update({verification_status:"rejected",verification_notes:l}).eq("user_id",y);if(k)throw k;N({title:"Verification Rejected",description:"User has been notified of the rejection"}),g(),c(!1),x("")}catch(k){N({title:"Error Rejecting Verification",description:k.message,variant:"destructive"})}},h=s.filter(y=>y.verification_status==="pending").length,v=s.filter(y=>y.verification_status==="verified").length,p=s.filter(y=>y.verification_status==="rejected").length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold",children:"Verification Dashboard"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Review and approve user verification requests"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(w,{children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold mt-2",children:h})]}),e.jsx(is,{className:"h-5 w-5 text-yellow-600"})]})})}),e.jsx(w,{children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Verified"}),e.jsx("p",{className:"text-2xl font-bold mt-2",children:v})]}),e.jsx(fe,{className:"h-5 w-5 text-green-600"})]})})}),e.jsx(w,{children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Rejected"}),e.jsx("p",{className:"text-2xl font-bold mt-2",children:p})]}),e.jsx(pt,{className:"h-5 w-5 text-red-600"})]})})})]}),e.jsxs(w,{children:[e.jsxs(q,{children:[e.jsx(L,{children:"Verification Requests"}),e.jsx(G,{children:"Review and process user verification requests"})]}),e.jsx(_,{children:e.jsx("div",{className:"border rounded-lg",children:e.jsxs(Ls,{children:[e.jsx(Ms,{children:e.jsxs(Oe,{children:[e.jsx(oe,{children:"User"}),e.jsx(oe,{children:"Type"}),e.jsx(oe,{children:"Location"}),e.jsx(oe,{children:"Status"}),e.jsx(oe,{children:"Requested"}),e.jsx(oe,{className:"text-right",children:"Actions"})]})}),e.jsx(Is,{children:s.map(y=>{var k,A,S,E;return e.jsxs(Oe,{children:[e.jsx(de,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:((A=(k=y.user_roles)==null?void 0:k[0])==null?void 0:A.role)==="supplier"?e.jsx(Ye,{className:"h-5 w-5"}):e.jsx(vs,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:y.full_name||"N/A"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:y.email})]})]})}),e.jsx(de,{children:e.jsx(I,{variant:"outline",children:((E=(S=y.user_roles)==null?void 0:S[0])==null?void 0:E.role)||"user"})}),e.jsx(de,{children:y.location||"N/A"}),e.jsx(de,{children:e.jsx(I,{variant:y.verification_status==="verified"?"default":y.verification_status==="rejected"?"destructive":"secondary",children:y.verification_status})}),e.jsx(de,{children:new Date(y.created_at).toLocaleDateString()}),e.jsx(de,{className:"text-right",children:e.jsx("div",{className:"flex justify-end gap-2",children:e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>{r(y),c(!0)},children:[e.jsx(qs,{className:"h-4 w-4 mr-1"}),"Review"]})})})]},y.user_id)})})]})})})]}),e.jsx(_e,{open:n,onOpenChange:c,children:e.jsxs(we,{className:"max-w-2xl",children:[e.jsxs(Ce,{children:[e.jsx(ke,{children:"Review Verification Request"}),e.jsx(it,{children:"Approve or reject this verification request"})]}),a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"User Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Name:"})," ",a.full_name]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Role:"})," ",((o=(m=a.user_roles)==null?void 0:m[0])==null?void 0:o.role)||"user"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Email:"})," ",a.email]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Phone:"})," ",a.phone||"N/A"]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Location:"})," ",a.location||"N/A"]})]})]}),a.verification_status==="pending"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Rejection Reason (optional)"}),e.jsx(le,{placeholder:"Enter reason for rejection...",value:l,onChange:y=>x(y.target.value),className:"mt-2"})]})]}),e.jsxs(Ze,{children:[(a==null?void 0:a.verification_status)==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs(b,{variant:"destructive",onClick:()=>d(a.user_id),children:[e.jsx(pt,{className:"h-4 w-4 mr-2"}),"Reject"]}),e.jsxs(b,{onClick:()=>u(a.user_id),children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),"Approve"]})]}),e.jsx(b,{variant:"outline",onClick:()=>c(!1),children:"Close"})]})]})})]})};Bs.lazy(()=>Ya(()=>import("./BatchTrackingPage-QNf5taf-.js"),__vite__mapDeps([3,1,2])).then(s=>({default:s.BatchTrackingPage})));function xp(){return e.jsx(io,{children:e.jsx(mo,{defaultTheme:"light",storageKey:"vite-ui-theme",children:e.jsxs("div",{className:"min-h-screen bg-background font-sans antialiased",children:[e.jsx(Ru,{}),e.jsxs(_o,{children:[e.jsx(Bs.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:e.jsxs(no,{children:[e.jsx(H,{path:"/",element:e.jsx(gd,{})}),e.jsx(H,{path:"/auth",element:e.jsx(Vd,{})}),e.jsx(H,{path:"/reset-password",element:e.jsx(sp,{})}),e.jsx(H,{path:"/update-password",element:e.jsx(tp,{})}),e.jsx(H,{path:"/about",element:e.jsx(Gd,{})}),e.jsx(H,{path:"/contact",element:e.jsx(Hd,{})}),e.jsx(H,{path:"/profile",element:e.jsx(Yd,{})}),e.jsx(H,{path:"/verify/:userId",element:e.jsx(ap,{})}),e.jsxs(H,{path:"/admin",element:e.jsx(lp,{}),children:[e.jsx(H,{index:!0,element:e.jsx(cp,{})}),e.jsx(H,{path:"users",element:e.jsx(mp,{})}),e.jsx(H,{path:"verifications",element:e.jsx(up,{})}),e.jsx(H,{path:"tables/:tableName",element:e.jsx(op,{})})]}),e.jsx(H,{path:"/search",element:e.jsx(Qd,{})}),e.jsx(H,{path:"/logistics",element:e.jsx(Zd,{})}),e.jsx(H,{path:"/farm-input-marketplace",element:e.jsx(Lx,{})}),e.jsx(H,{path:"/inputs/group-orders",element:e.jsx(Sd,{})}),e.jsx(H,{path:"/inputs/pricing-verification",element:e.jsx(qd,{})}),e.jsx(H,{path:"/bulk-auctions",element:e.jsx(Md,{})}),e.jsx(H,{path:"/f2c-subscriptions",element:e.jsx(Bd,{})}),e.jsx(H,{path:"/service-providers",element:e.jsx(nm,{})}),e.jsx(H,{path:"/quality-control-discussions",element:e.jsx(mm,{})}),e.jsx(H,{path:"/training-events",element:e.jsx(um,{})}),e.jsx(H,{path:"/market-linkages",element:e.jsx(hm,{})}),e.jsx(H,{path:"/sentiment-analysis",element:e.jsx(Nm,{})}),e.jsx(H,{path:"/supply-chain-problems",element:e.jsx(bm,{})}),e.jsx(H,{path:"/supply-chain-problems/logistics-issues",element:e.jsx(Pm,{})}),e.jsx(H,{path:"/supply-chain-problems/market-access",element:e.jsx(Am,{})}),e.jsx(H,{path:"/supply-chain-problems/post-harvest-losses",element:e.jsx(Tm,{})}),e.jsx(H,{path:"/supply-chain-problems/price-volatility",element:e.jsx(Dm,{})}),e.jsx(H,{path:"/supply-chain-problems/quality-control",element:e.jsx(Em,{})}),e.jsx(H,{path:"/batch-tracking",element:e.jsx(cx,{})}),e.jsx(H,{path:"/carbon-forum",element:e.jsx(Iu,{userId:"USER_ID_PLACEHOLDER"})}),e.jsx(H,{path:"/networking",element:e.jsx(Jr,{})}),e.jsx(H,{path:"/logistics-solutions-map",element:e.jsx(Bm,{})}),e.jsx(H,{path:"/market-demand-hotspot",element:e.jsx(Um,{})}),e.jsx(H,{path:"/commodity-trading",element:e.jsx(eu,{})}),e.jsx(H,{path:"/barter-exchange",element:e.jsx(zr,{})}),e.jsx(H,{path:"/commodity-trading/barter",element:e.jsx(zr,{})}),e.jsx(H,{path:"/marketplace",element:e.jsx(Ih,{})}),e.jsx(H,{path:"/marketplace-old",element:e.jsx(vd,{})}),e.jsx(H,{path:"/agricultural-marketplace",element:e.jsx(su,{})}),e.jsx(H,{path:"/bulk-orders",element:e.jsx(yd,{})}),e.jsx(H,{path:"/price-trends",element:e.jsx(tu,{})}),e.jsx(H,{path:"/my-trades",element:e.jsx(au,{})}),e.jsx(H,{path:"/community",element:e.jsx(Qh,{})}),e.jsx(H,{path:"/community-forums",element:e.jsx(ru,{})}),e.jsx(H,{path:"/city-markets",element:e.jsx(Ix,{})}),e.jsx(H,{path:"/farm-inputs-marketplace",element:e.jsx(Qr,{})}),e.jsx(H,{path:"/farm-inputs",element:e.jsx(Qr,{})}),e.jsx(H,{path:"/export-market",element:e.jsx(Xh,{})}),e.jsx(H,{path:"/farmer-portal",element:e.jsx(ju,{})}),e.jsx(H,{path:"/equipment-marketplace",element:e.jsx(zx,{})}),e.jsx(H,{path:"/food-rescue-dashboard",element:e.jsx(Ox,{user:{}})}),e.jsx(H,{path:"/imperfect-surplus-dashboard",element:e.jsx(Kx,{})}),e.jsx(H,{path:"/bulk-order-dashboard",element:e.jsx(Qx,{user:{}})}),e.jsx(H,{path:"/donation-form",element:e.jsx(eh,{})}),e.jsx(H,{path:"/donation-form-simple",element:e.jsx(Xx,{})}),e.jsx(H,{path:"/buy-requests",element:e.jsx(sh,{})}),e.jsx(H,{path:"/export-market-opportunities",element:e.jsx(ah,{})}),e.jsx(H,{path:"/export-opportunities",element:e.jsx(rh,{})}),e.jsx(H,{path:"/contract-farming",element:e.jsx(ih,{})}),e.jsx(H,{path:"/partner-with-us",element:e.jsx(Fx,{})}),e.jsx(H,{path:"/partner-dashboard",element:e.jsx(qx,{})}),e.jsx(H,{path:"/farmer-exporter-collaboration",element:e.jsx(Nu,{})}),e.jsx(H,{path:"/exporter-profile",element:e.jsx(bu,{})}),e.jsx(H,{path:"/farmer-success-stories",element:e.jsx(Or,{})}),e.jsx(H,{path:"/success-stories",element:e.jsx(Or,{})}),e.jsx(H,{path:"/community-forum",element:e.jsx(Su,{})}),e.jsx(H,{path:"/transporter-signup",element:e.jsx($u,{})}),e.jsx(H,{path:"/service-provider-registration",element:e.jsx(Gu,{})}),e.jsx(H,{path:"/kilimo-ams-data",element:e.jsx(Wu,{})}),e.jsx(H,{path:"/business-marketing",element:e.jsx(Yh,{})}),e.jsx(H,{path:"/api-docs",element:e.jsx(ex,{})}),e.jsx(H,{path:"/supply-chain-api",element:e.jsx(sx,{})}),e.jsx(H,{path:"/data-management",element:e.jsx(ux,{})}),e.jsx(H,{path:"/data-status",element:e.jsx(xx,{})}),e.jsx(H,{path:"/data-jobs",element:e.jsx(hx,{})}),e.jsx(H,{path:"/system-status",element:e.jsx(Cx,{})}),e.jsx(H,{path:"/admin",element:e.jsx(_h,{})}),e.jsx(H,{path:"/faq",element:e.jsx(Sx,{})}),e.jsx(H,{path:"/privacy-policy",element:e.jsx(Px,{})}),e.jsx(H,{path:"/terms-of-service",element:e.jsx(Ax,{})}),e.jsx(H,{path:"/bluetooth-marketplace",element:e.jsx(Dh,{})}),e.jsx(H,{path:"/more",element:e.jsx(Fh,{})}),e.jsx(H,{path:"/supply-chain-dashboard",element:e.jsx(Lh,{})}),e.jsx(H,{path:"/cooperative-groups",element:e.jsx(Rh,{})}),e.jsx(H,{path:"/farm-tourism",element:e.jsx(zh,{})}),e.jsx(H,{path:"/weather",element:e.jsx(Oh,{})}),e.jsx(H,{path:"/contract-farming-page",element:e.jsx(Kh,{})}),e.jsx(H,{path:"/equipment-marketplace-page",element:e.jsx(Hh,{})}),e.jsx(H,{path:"/partners-showcase",element:e.jsx(rx,{})}),e.jsx(H,{path:"/export-opportunities-new",element:e.jsx(ix,{})}),e.jsx(H,{path:"/f2c-marketplace",element:e.jsx(lx,{})}),e.jsx(H,{path:"/carbon-footprint",element:e.jsx(dx,{})}),e.jsx(H,{path:"/cooperatives-management",element:e.jsx(mx,{})}),e.jsx(H,{path:"/major-routes",element:e.jsx(Ta,{})}),e.jsx(H,{path:"/major-routes-marketplace",element:e.jsx(Ta,{})}),e.jsx(H,{path:"/road-markets",element:e.jsx(Ta,{})}),e.jsx(H,{path:"/market-prices",element:e.jsx(Zh,{})}),e.jsx(H,{path:"/partners",element:e.jsx(ep,{})}),e.jsx(H,{path:"/networking-page",element:e.jsx(Jr,{})}),e.jsx(H,{path:"*",element:e.jsx(Ch,{})})]})}),e.jsx(lo,{}),e.jsx(kh,{}),e.jsx(el,{}),e.jsx(ip,{}),e.jsx(Me,{})]})]})})})}function hp(){"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.js").then(s=>{console.log("ServiceWorker registration successful:",s)},s=>{console.log("ServiceWorker registration failed:",s)})})}co(document.getElementById("root")).render(e.jsx(xp,{}));hp();export{F as s};
